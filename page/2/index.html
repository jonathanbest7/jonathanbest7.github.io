<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/bitbug_favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/bitbug_favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jonathanbest7.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="一位逆向菜狗">
<meta property="og:type" content="website">
<meta property="og:title" content="bj777的blog">
<meta property="og:url" content="https://jonathanbest7.github.io/page/2/index.html">
<meta property="og:site_name" content="bj777的blog">
<meta property="og:description" content="一位逆向菜狗">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="bj777">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://jonathanbest7.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>bj777的blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">bj777的blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">记录学习每一瞬间</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">1</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">41</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/10/01/Bytectf2022/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/01/Bytectf2022/" class="post-title-link" itemprop="url">Bytectf2022</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-10-01 10:01:26 / 修改时间：16:51:15" itemprop="dateCreated datePublished" datetime="2022-10-01T10:01:26+08:00">2022-10-01</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Bytectf2022"><a href="#Bytectf2022" class="headerlink" title="Bytectf2022"></a>Bytectf2022</h1><p>题的质量都很高，而且绝大部分知识点都是我不会的，所以接下来一个月，抽时间就来复现。</p>
<h2 id="OhMySolidity"><a href="#OhMySolidity" class="headerlink" title="OhMySolidity"></a>OhMySolidity</h2><p>这个题是一个智能合约题，第一次接触这种类型的题，发现反编译出来的东西很抽象。</p>
<p>给了一个txt文件</p>
<p>我们将第一段input输入<a target="_blank" rel="noopener" href="https://ethervm.io/%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E5%B0%B1%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%88%B0%E5%8F%8D%E7%BC%96%E8%AF%91%E5%90%8E%E7%9A%84%E6%A0%B7%E5%AD%90%EF%BC%9A">https://ethervm.io/这个网站就可以得到反编译后的样子：</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br></pre></td><td class="code"><pre><span class="line">contract Contract &#123;</span><br><span class="line">    function main() &#123;</span><br><span class="line">        memory[0x40:0x60] = 0x80;</span><br><span class="line">        var var0 = msg.value;</span><br><span class="line">    </span><br><span class="line">        if (var0) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    </span><br><span class="line">        if (msg.data.length &lt; 0x04) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    </span><br><span class="line">        var0 = msg.data[0x00:0x20] &gt;&gt; 0xe0;</span><br><span class="line">    </span><br><span class="line">        if (var0 == 0x14edb54d) &#123;</span><br><span class="line">            // Dispatch table entry for k1()</span><br><span class="line">            var var1 = 0x006f;</span><br><span class="line">            var var2 = k1();</span><br><span class="line">            var temp0 = memory[0x40:0x60];</span><br><span class="line">            memory[temp0:temp0 + 0x20] = var2 &amp; 0xffffffff;</span><br><span class="line">            var temp1 = memory[0x40:0x60];</span><br><span class="line">            return memory[temp1:temp1 + (temp0 + 0x20) - temp1];</span><br><span class="line">        &#125; else if (var0 == 0x58f5382e) &#123;</span><br><span class="line">            // Dispatch table entry for challenge(string)</span><br><span class="line">            var1 = 0x014a;</span><br><span class="line">            var2 = 0x04;</span><br><span class="line">            var var3 = msg.data.length - var2;</span><br><span class="line">        </span><br><span class="line">            if (var3 &lt; 0x20) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">        </span><br><span class="line">            var1 = challenge(var2, var3);</span><br><span class="line">            var temp2 = memory[0x40:0x60];</span><br><span class="line">            var2 = temp2;</span><br><span class="line">            var3 = var2;</span><br><span class="line">            var temp3 = var3 + 0x20;</span><br><span class="line">            memory[var3:var3 + 0x20] = temp3 - var3;</span><br><span class="line">            var temp4 = var1;</span><br><span class="line">            memory[temp3:temp3 + 0x20] = memory[temp4:temp4 + 0x20];</span><br><span class="line">            var var4 = temp3 + 0x20;</span><br><span class="line">            var var6 = memory[temp4:temp4 + 0x20];</span><br><span class="line">            var var5 = temp4 + 0x20;</span><br><span class="line">            var var7 = var6;</span><br><span class="line">            var var8 = var4;</span><br><span class="line">            var var9 = var5;</span><br><span class="line">            var var10 = 0x00;</span><br><span class="line">        </span><br><span class="line">            if (var10 &gt;= var7) &#123;</span><br><span class="line">            label_018A:</span><br><span class="line">                var temp5 = var6;</span><br><span class="line">                var4 = temp5 + var4;</span><br><span class="line">                var5 = temp5 &amp; 0x1f;</span><br><span class="line">            </span><br><span class="line">                if (!var5) &#123;</span><br><span class="line">                    var temp6 = memory[0x40:0x60];</span><br><span class="line">                    return memory[temp6:temp6 + var4 - temp6];</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    var temp7 = var5;</span><br><span class="line">                    var temp8 = var4 - temp7;</span><br><span class="line">                    memory[temp8:temp8 + 0x20] = ~(0x0100 ** (0x20 - temp7) - 0x01) &amp; memory[temp8:temp8 + 0x20];</span><br><span class="line">                    var temp9 = memory[0x40:0x60];</span><br><span class="line">                    return memory[temp9:temp9 + (temp8 + 0x20) - temp9];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">            label_0178:</span><br><span class="line">                var temp10 = var10;</span><br><span class="line">                memory[var8 + temp10:var8 + temp10 + 0x20] = memory[var9 + temp10:var9 + temp10 + 0x20];</span><br><span class="line">                var10 = temp10 + 0x20;</span><br><span class="line">            </span><br><span class="line">                if (var10 &gt;= var7) &#123; goto label_018A; &#125;</span><br><span class="line">                else &#123; goto label_0178; &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (var0 == 0x93eed093) &#123;</span><br><span class="line">            // Dispatch table entry for 0x93eed093 (unknown)</span><br><span class="line">            var1 = 0x01cd;</span><br><span class="line">            var2 = func_056F();</span><br><span class="line">            var temp11 = memory[0x40:0x60];</span><br><span class="line">            memory[temp11:temp11 + 0x20] = var2 &amp; 0xffffffff;</span><br><span class="line">            var temp12 = memory[0x40:0x60];</span><br><span class="line">            return memory[temp12:temp12 + (temp11 + 0x20) - temp12];</span><br><span class="line">        &#125; else if (var0 == 0x9577a145) &#123;</span><br><span class="line">            // Dispatch table entry for 0x9577a145 (unknown)</span><br><span class="line">            var1 = 0x0251;</span><br><span class="line">            var2 = 0x04;</span><br><span class="line">            var3 = msg.data.length - var2;</span><br><span class="line">        </span><br><span class="line">            if (var3 &lt; 0x80) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">        </span><br><span class="line">            func_0205(var2, var3);</span><br><span class="line">            stop();</span><br><span class="line">        &#125; else if (var0 == 0xa7f81e6a) &#123;</span><br><span class="line">            // Dispatch table entry for k2()</span><br><span class="line">            var1 = 0x025b;</span><br><span class="line">            var2 = k2();</span><br><span class="line">            var temp13 = memory[0x40:0x60];</span><br><span class="line">            memory[temp13:temp13 + 0x20] = var2 &amp; 0xffffffff;</span><br><span class="line">            var temp14 = memory[0x40:0x60];</span><br><span class="line">            return memory[temp14:temp14 + (temp13 + 0x20) - temp14];</span><br><span class="line">        &#125; else if (var0 == 0xf0407ca7) &#123;</span><br><span class="line">            // Dispatch table entry for 0xf0407ca7 (unknown)</span><br><span class="line">            var1 = 0x0285;</span><br><span class="line">            var2 = func_0623();</span><br><span class="line">            var temp15 = memory[0x40:0x60];</span><br><span class="line">            memory[temp15:temp15 + 0x20] = var2 &amp; 0xffffffff;</span><br><span class="line">            var temp16 = memory[0x40:0x60];</span><br><span class="line">            return memory[temp16:temp16 + (temp15 + 0x20) - temp16];</span><br><span class="line">        &#125; else &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function challenge(var arg0, var arg1) returns (var r0) &#123;</span><br><span class="line">        var temp0 = arg0;</span><br><span class="line">        arg0 = temp0 + arg1;</span><br><span class="line">        arg1 = temp0;</span><br><span class="line">        var var1 = msg.data[arg1:arg1 + 0x20];</span><br><span class="line">        var var0 = arg1 + 0x20;</span><br><span class="line">    </span><br><span class="line">        if (var1 &gt; 0x0100000000) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    </span><br><span class="line">        var temp1 = arg1 + var1;</span><br><span class="line">        var1 = temp1;</span><br><span class="line">    </span><br><span class="line">        if (var1 + 0x20 &gt; arg0) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    </span><br><span class="line">        var temp2 = var1;</span><br><span class="line">        var temp3 = msg.data[temp2:temp2 + 0x20];</span><br><span class="line">        var1 = temp3;</span><br><span class="line">        var temp4 = var0;</span><br><span class="line">        var0 = temp2 + 0x20;</span><br><span class="line">        var var2 = temp4;</span><br><span class="line">    </span><br><span class="line">        if ((var1 &gt; 0x0100000000) | (var0 + var1 &gt; arg0)) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    </span><br><span class="line">        var temp5 = var1;</span><br><span class="line">        var temp6 = memory[0x40:0x60];</span><br><span class="line">        memory[0x40:0x60] = temp6 + (temp5 + 0x1f) / 0x20 * 0x20 + 0x20;</span><br><span class="line">        memory[temp6:temp6 + 0x20] = temp5;</span><br><span class="line">        var temp7 = temp6 + 0x20;</span><br><span class="line">        memory[temp7:temp7 + temp5] = msg.data[var0:var0 + temp5];</span><br><span class="line">        memory[temp7 + temp5:temp7 + temp5 + 0x20] = 0x00;</span><br><span class="line">        arg0 = temp6;</span><br><span class="line">        arg1 = 0x60;</span><br><span class="line">        var0 = arg0;</span><br><span class="line">        var1 = 0x00;</span><br><span class="line">        var2 = 0x08;</span><br><span class="line">        var var3 = memory[var0:var0 + 0x20];</span><br><span class="line">    </span><br><span class="line">        if (!var2) &#123; assert(); &#125;</span><br><span class="line">    </span><br><span class="line">        if (var3 % var2 != var1) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    </span><br><span class="line">        var1 = 0x60;</span><br><span class="line">        var temp8 = memory[var0:var0 + 0x20];</span><br><span class="line">        var temp9 = memory[0x40:0x60];</span><br><span class="line">        var2 = temp9;</span><br><span class="line">        var3 = temp8;</span><br><span class="line">        memory[var2:var2 + 0x20] = var3;</span><br><span class="line">        memory[0x40:0x60] = var2 + (var3 + 0x1f &amp; ~0x1f) + 0x20;</span><br><span class="line">    </span><br><span class="line">        if (!var3) &#123;</span><br><span class="line">            var1 = var2;</span><br><span class="line">            var2 = 0xdeadbeef;</span><br><span class="line">            var3 = 0x00;</span><br><span class="line">        </span><br><span class="line">            if (var3 &gt;= memory[var0:var0 + 0x20]) &#123;</span><br><span class="line">            label_0563:</span><br><span class="line">                return var1;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">            label_032D:</span><br><span class="line">                var var4 = 0x00;</span><br><span class="line">                var var5 = 0x00;</span><br><span class="line">                var var6 = 0x00;</span><br><span class="line">                var var7 = 0x00;</span><br><span class="line">            </span><br><span class="line">                if (var7 &amp; 0xff &gt;= 0x04) &#123;</span><br><span class="line">                label_03CD:</span><br><span class="line">                    var7 = 0x00;</span><br><span class="line">                </span><br><span class="line">                    if (var7 &amp; 0xff &gt;= 0x20) &#123;</span><br><span class="line">                    label_047F:</span><br><span class="line">                        var7 = 0x00;</span><br><span class="line">                    </span><br><span class="line">                        if (var7 &amp; 0xff &gt;= 0x04) &#123;</span><br><span class="line">                        label_0554:</span><br><span class="line">                            var3 = var3 + 0x08;</span><br><span class="line">                        </span><br><span class="line">                            if (var3 &gt;= memory[var0:var0 + 0x20]) &#123; goto label_0563; &#125;</span><br><span class="line">                            else &#123; goto label_032D; &#125;</span><br><span class="line">                        &#125; else &#123;</span><br><span class="line">                        label_0493:</span><br><span class="line">                            var temp10 = var7;</span><br><span class="line">                            var var8 = (((var5 &amp; 0xffffffff) &gt;&gt; (0x03 - temp10 * 0x08 &amp; 0xff)) &amp; 0xff) &lt;&lt; 0xf8;</span><br><span class="line">                            var var9 = var1;</span><br><span class="line">                            var var10 = var3 + (temp10 &amp; 0xff);</span><br><span class="line">                        </span><br><span class="line">                            if (var10 &gt;= memory[var9:var9 + 0x20]) &#123; assert(); &#125;</span><br><span class="line">                        </span><br><span class="line">                            memory[var10 + 0x20 + var9:var10 + 0x20 + var9 + 0x01] = byte(var8 &amp; ~0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff, 0x00);</span><br><span class="line">                            var temp11 = var7;</span><br><span class="line">                            var8 = (((var6 &amp; 0xffffffff) &gt;&gt; (0x03 - temp11 * 0x08 &amp; 0xff)) &amp; 0xff) &lt;&lt; 0xf8;</span><br><span class="line">                            var9 = var1;</span><br><span class="line">                            var10 = var3 + (temp11 &amp; 0xff) + 0x04;</span><br><span class="line">                        </span><br><span class="line">                            if (var10 &gt;= memory[var9:var9 + 0x20]) &#123; assert(); &#125;</span><br><span class="line">                        </span><br><span class="line">                            memory[var10 + 0x20 + var9:var10 + 0x20 + var9 + 0x01] = byte(var8 &amp; ~0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff, 0x00);</span><br><span class="line">                            var7 = var7 + 0x01;</span><br><span class="line">                        </span><br><span class="line">                            if (var7 &amp; 0xff &gt;= 0x04) &#123; goto label_0554; &#125;</span><br><span class="line">                            else &#123; goto label_0493; &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                    label_03E1:</span><br><span class="line">                        var temp12 = var4 + var2;</span><br><span class="line">                        var4 = temp12;</span><br><span class="line">                        var temp13 = var6;</span><br><span class="line">                        var temp14 = var5 + (((temp13 &amp; 0xffffffff) &lt;&lt; 0x04) + (storage[0x00] &amp; 0xffffffff) ~ temp13 + var4 ~ ((temp13 &amp; 0xffffffff) &gt;&gt; 0x05) + (storage[0x00] / 0x0100 ** 0x04 &amp; 0xffffffff));</span><br><span class="line">                        var5 = temp14;</span><br><span class="line">                        var6 = temp13 + (((var5 &amp; 0xffffffff) &lt;&lt; 0x04) + (storage[0x00] / 0x0100 ** 0x08 &amp; 0xffffffff) ~ var5 + var4 ~ ((var5 &amp; 0xffffffff) &gt;&gt; 0x05) + (storage[0x00] / 0x0100 ** 0x0c &amp; 0xffffffff));</span><br><span class="line">                        var7 = var7 + 0x01;</span><br><span class="line">                    </span><br><span class="line">                        if (var7 &amp; 0xff &gt;= 0x20) &#123; goto label_047F; &#125;</span><br><span class="line">                        else &#123; goto label_03E1; &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                label_034E:</span><br><span class="line">                    var temp15 = var7;</span><br><span class="line">                    var8 = 0x03 - temp15 * 0x08 &amp; 0xff;</span><br><span class="line">                    var9 = var0;</span><br><span class="line">                    var10 = var3 + (temp15 &amp; 0xff);</span><br><span class="line">                </span><br><span class="line">                    if (var10 &gt;= memory[var9:var9 + 0x20]) &#123; assert(); &#125;</span><br><span class="line">                </span><br><span class="line">                    var5 = var5 + (((((memory[var10 + 0x20 + var9:var10 + 0x20 + var9 + 0x20] &gt;&gt; 0xf8) &lt;&lt; 0xf8) &gt;&gt; 0xf8) &amp; 0xff) &lt;&lt; var8);</span><br><span class="line">                    var temp16 = var7;</span><br><span class="line">                    var8 = 0x03 - temp16 * 0x08 &amp; 0xff;</span><br><span class="line">                    var9 = var0;</span><br><span class="line">                    var10 = var3 + (temp16 &amp; 0xff) + 0x04;</span><br><span class="line">                </span><br><span class="line">                    if (var10 &gt;= memory[var9:var9 + 0x20]) &#123; assert(); &#125;</span><br><span class="line">                </span><br><span class="line">                    var6 = var6 + (((((memory[var10 + 0x20 + var9:var10 + 0x20 + var9 + 0x20] &gt;&gt; 0xf8) &lt;&lt; 0xf8) &gt;&gt; 0xf8) &amp; 0xff) &lt;&lt; var8);</span><br><span class="line">                    var7 = var7 + 0x01;</span><br><span class="line">                </span><br><span class="line">                    if (var7 &amp; 0xff &gt;= 0x04) &#123; goto label_03CD; &#125;</span><br><span class="line">                    else &#123; goto label_034E; &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            var temp17 = var3;</span><br><span class="line">            memory[var2 + 0x20:var2 + 0x20 + temp17] = code[code.length:code.length + temp17];</span><br><span class="line">            var1 = var2;</span><br><span class="line">            var2 = 0xdeadbeef;</span><br><span class="line">            var3 = 0x00;</span><br><span class="line">        </span><br><span class="line">            if (var3 &gt;= memory[var0:var0 + 0x20]) &#123; goto label_0563; &#125;</span><br><span class="line">            else &#123; goto label_032D; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function func_0205(var arg0, var arg1) &#123;</span><br><span class="line">        var temp0 = arg0;</span><br><span class="line">        var temp1 = temp0 + 0x20;</span><br><span class="line">        arg0 = msg.data[temp0:temp0 + 0x20] &amp; 0xffffffff;</span><br><span class="line">        var temp2 = temp1 + 0x20;</span><br><span class="line">        arg1 = msg.data[temp1:temp1 + 0x20] &amp; 0xffffffff;</span><br><span class="line">        var var0 = msg.data[temp2:temp2 + 0x20] &amp; 0xffffffff;</span><br><span class="line">        var var1 = msg.data[temp2 + 0x20:temp2 + 0x20 + 0x20] &amp; 0xffffffff;</span><br><span class="line">        storage[0x00] = (arg0 &amp; 0xffffffff) | (storage[0x00] &amp; ~0xffffffff);</span><br><span class="line">        storage[0x00] = (arg1 &amp; 0xffffffff) * 0x0100 ** 0x04 | (storage[0x00] &amp; ~(0xffffffff * 0x0100 ** 0x04));</span><br><span class="line">        storage[0x00] = (var0 &amp; 0xffffffff) * 0x0100 ** 0x08 | (storage[0x00] &amp; ~(0xffffffff * 0x0100 ** 0x08));</span><br><span class="line">        storage[0x00] = (var1 &amp; 0xffffffff) * 0x0100 ** 0x0c | (storage[0x00] &amp; ~(0xffffffff * 0x0100 ** 0x0c));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function k1() returns (var r0) &#123; return storage[0x00] / 0x0100 ** 0x04 &amp; 0xffffffff; &#125;</span><br><span class="line">    </span><br><span class="line">    function func_056F() returns (var r0) &#123; return storage[0x00] &amp; 0xffffffff; &#125;</span><br><span class="line">    </span><br><span class="line">    function k2() returns (var r0) &#123; return storage[0x00] / 0x0100 ** 0x08 &amp; 0xffffffff; &#125;</span><br><span class="line">    </span><br><span class="line">    function func_0623() returns (var r0) &#123; return storage[0x00] / 0x0100 ** 0x0c &amp; 0xffffffff; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看这个东西，要看if中的语句，比如下面，当输入0x93eed093时，会调用func_056F函数</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20221001101445496.png" alt="image-20221001101445496"></p>
<p>我们的第二段输入</p>
<p>0x9577a1450000000000000000000000000000000000000000000000000000000010000000000000000000000000000876543210000000000000002345678000000000000000000000000000000000000000000000000000000000000000000000aabbccdd0000000000000000000000000000000000000000000000000000000044332211</p>
<p>我们直接看func_0205函数</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20221001101725520.png" alt="image-20221001101725520"></p>
<p>这就要猜了，能看出是赋值了4个值到storage，四个值分别对应0x12345678、0x87654321、0xaabbccdd、0x44332211</p>
<p>第三次输入时challenge方法：输入0x59f5382e，并输出了0xa625e97482f83d2b7fc5125763dcbbffd8115b208c4754eee8711bdfac9e3377622bbf0cbb785e612b82c7f5143d5333</p>
<p>challeng函数是一个魔改的tea</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//加密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//解密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0xdeadbeef</span>*<span class="number">32</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0xdeadbeef</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">12</span>]=&#123;<span class="number">0xa625e974</span>,<span class="number">0x82f83d2b</span>,<span class="number">0x7fc51257</span>,<span class="number">0x63dcbbff</span>,<span class="number">0xd8115b20</span>,<span class="number">0x8c4754ee</span>,<span class="number">0xe8711bdf</span>,<span class="number">0xac9e3377</span>,<span class="number">0x622bbf0c</span>,<span class="number">0xbb785e61</span>,<span class="number">0x2b82c7f5</span>,<span class="number">0x143d5333</span>&#125;,k[<span class="number">4</span>]=&#123;<span class="number">0x12345678</span>,<span class="number">0x87654321</span>,<span class="number">0xaabbccdd</span>,<span class="number">0x44332211</span>&#125;;</span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i+=<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        decrypt(v + i, k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[i],v[i + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">bytectf</span>&#123;f2d9e0b6-<span class="number">274</span>d-<span class="number">47</span>e0-bc4c-<span class="number">40967015</span>ba79273&#125;</span><br></pre></td></tr></table></figure>

<h2 id="maze6d"><a href="#maze6d" class="headerlink" title="maze6d"></a>maze6d</h2><p>这个混淆看了一天，里面涉及到好多不清楚的地方，还有很多之前没搞明白的地方。</p>
<p>第一个点是GOT和PLT表：</p>
<p>GOT表是一个存储外部函数地址的表，PLT表是一个代码片段组成的表，每一个都能跳到GOT表项。众所周知，链接时要进行一个重定位，链接做的事情：对同名section进行合并，对代码段和数据段进行地址分配，进行重定位。</p>
<p>重定位是这样的：如果时在中间文件中定义好的函数，连接时直接可以重定位到函数地址，如果是动态链接库中的函数，只能生成额外的小段代码，就是PLT表，然后重定位到该代码片段。</p>
<p>运行时重定位：运行后加载动态库，把动态库中的相应函数地址填入GOT表</p>
<p>延迟重定位：只有动态库被调用时才会进行地址解析和重定位工作，这时候动态库函数地址被写到GOT表项中。</p>
<p>第一步由函数跳到PLT表中，第二步PLT表跳到GOT表（jmp），第三步GOT跳到PLT(push)，并进行压栈，把代表函数的id压栈，第四步跳到公共PLT表项中（jmp），第五步进入GOT表，然后_dl_runtime_resolve对动态函数进行地址解析和重定位，第七步把动态函数真实的地址写入GOT表项，然后执行函数并retn。</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20221001142814162.png" alt="image-20221001142814162"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/09/18/%E6%9F%8F%E9%B9%AD%E3%80%81MT%E3%80%81DASCTF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/09/18/%E6%9F%8F%E9%B9%AD%E3%80%81MT%E3%80%81DASCTF/" class="post-title-link" itemprop="url">柏鹭、MT、DASCTF</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-09-18 18:38:32" itemprop="dateCreated datePublished" datetime="2022-09-18T18:38:32+08:00">2022-09-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-10-01 17:08:57" itemprop="dateModified" datetime="2022-10-01T17:08:57+08:00">2022-10-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="柏鹭、MT、DASCTF"><a href="#柏鹭、MT、DASCTF" class="headerlink" title="柏鹭、MT、DASCTF"></a>柏鹭、MT、DASCTF</h1><p>这三天打了许多比赛，题目质量我不好说，但自己还是很菜，继续加油吧！</p>
<h2 id="柏鹭杯"><a href="#柏鹭杯" class="headerlink" title="柏鹭杯"></a>柏鹭杯</h2><p>他这个比赛的逆向，咋不直接改成密码呢？</p>
<h3 id="walk"><a href="#walk" class="headerlink" title="walk"></a>walk</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __noreturn <span class="title function_">sub_231280</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">const</span> <span class="class"><span class="keyword">struct</span> _<span class="title">s_FuncInfo</span> *<span class="title">v1</span>;</span> <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// al</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> *v5; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v8; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v9; <span class="comment">// bl</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v12; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v13; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v19; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// [esp-20h] [ebp-8Ch]</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// [esp-1Ch] [ebp-88h]</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// [esp-18h] [ebp-84h]</span></span><br><span class="line">  <span class="type">int</span> v23; <span class="comment">// [esp-14h] [ebp-80h]</span></span><br><span class="line">  <span class="type">int</span> v24; <span class="comment">// [esp-10h] [ebp-7Ch] BYREF</span></span><br><span class="line">  <span class="type">const</span> _ThrowInfo *v25; <span class="comment">// [esp-Ch] [ebp-78h]</span></span><br><span class="line">  <span class="type">int</span> v26; <span class="comment">// [esp-8h] [ebp-74h] BYREF</span></span><br><span class="line">  <span class="type">const</span> _ThrowInfo *v27; <span class="comment">// [esp-4h] [ebp-70h]</span></span><br><span class="line">  <span class="type">int</span> v28; <span class="comment">// [esp+0h] [ebp-6Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> v29[<span class="number">4</span>]; <span class="comment">// [esp+Ch] [ebp-60h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v30[<span class="number">3</span>]; <span class="comment">// [esp+1Ch] [ebp-50h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v31[<span class="number">3</span>]; <span class="comment">// [esp+28h] [ebp-44h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v32[<span class="number">8</span>]; <span class="comment">// [esp+34h] [ebp-38h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> *v33; <span class="comment">// [esp+40h] [ebp-2Ch]</span></span><br><span class="line">  _DWORD *v34; <span class="comment">// [esp+44h] [ebp-28h]</span></span><br><span class="line">  <span class="type">int</span> *v35; <span class="comment">// [esp+48h] [ebp-24h]</span></span><br><span class="line">  <span class="type">int</span> v36; <span class="comment">// [esp+4Ch] [ebp-20h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v37; <span class="comment">// [esp+50h] [ebp-1Ch]</span></span><br><span class="line">  <span class="type">const</span> <span class="class"><span class="keyword">struct</span> _<span class="title">s_FuncInfo</span> *<span class="title">v38</span>;</span> <span class="comment">// [esp+54h] [ebp-18h]</span></span><br><span class="line">  <span class="type">int</span> v39; <span class="comment">// [esp+58h] [ebp-14h]</span></span><br><span class="line">  <span class="type">int</span> *v40; <span class="comment">// [esp+5Ch] [ebp-10h]</span></span><br><span class="line">  <span class="type">int</span> v41; <span class="comment">// [esp+68h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v40 = &amp;v28;</span><br><span class="line">  v41 = <span class="number">0</span>;</span><br><span class="line">  sub_2311F0(v31, (<span class="type">int</span>)v25, v26, (<span class="type">int</span>)v27);</span><br><span class="line">  v27 = &amp;_TI1_AUTI__;</span><br><span class="line">  v26 = v0;</span><br><span class="line">  v40 = &amp;v26;</span><br><span class="line">  v1 = (<span class="type">const</span> <span class="keyword">struct</span> _s_FuncInfo *)v35[<span class="number">1</span>];</span><br><span class="line">  v2 = v35[<span class="number">2</span>];</span><br><span class="line">  v3 = *v35;</span><br><span class="line">  v39 = *v35;</span><br><span class="line">  v38 = v1;</span><br><span class="line">  v36 = v2;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)v1 &lt; v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = *((_BYTE *)v1 + v3);</span><br><span class="line">    <span class="keyword">if</span> ( v4 == <span class="string">&#x27;c&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      LOBYTE(v41) = <span class="number">2</span>;</span><br><span class="line">      __FrameHandler3::TryBlockMap::TryBlockMap((__FrameHandler3::TryBlockMap *)v32, v1, v2);</span><br><span class="line">      v25 = &amp;_TI1_AUTC1__;</span><br><span class="line">      v24 = v18;</span><br><span class="line">      v40 = &amp;v24;</span><br><span class="line">      <span class="keyword">if</span> ( *v34 + <span class="number">6</span> &lt;= v34[<span class="number">1</span>] )</span><br><span class="line">      &#123;</span><br><span class="line">        LOBYTE(v41) = <span class="number">4</span>;</span><br><span class="line">        sub_231230(v29, v20, v21, v22, v23);</span><br><span class="line">        v5 = v33;</span><br><span class="line">        <span class="keyword">if</span> ( sub_231150(*v33, v33[<span class="number">1</span>]) )</span><br><span class="line">        &#123;</span><br><span class="line">          v6 = v5[<span class="number">1</span>];</span><br><span class="line">          v7 = <span class="number">10</span> * *v5;</span><br><span class="line">          v8 = (<span class="type">unsigned</span> __int8 *)(v6 + v7 + v5[<span class="number">3</span>]);</span><br><span class="line">          v37 = v8;</span><br><span class="line">          v9 = *v8;</span><br><span class="line">          v10 = *v8;</span><br><span class="line">          <span class="keyword">if</span> ( *v8 )</span><br><span class="line">          &#123;</span><br><span class="line">            v11 = v7 + v6;</span><br><span class="line">            v12 = (<span class="type">unsigned</span> __int8 *)v38 + v39;</span><br><span class="line">            v13 = (<span class="type">unsigned</span> __int8 *)(<span class="number">5</span> * v11 + v5[<span class="number">2</span>]);</span><br><span class="line">            <span class="keyword">if</span> ( (v10 ^ *v13) != *((<span class="type">unsigned</span> __int8 *)v38 + v39 + <span class="number">1</span>)</span><br><span class="line">              || (v10 ^ v13[<span class="number">1</span>]) != v12[<span class="number">2</span>]</span><br><span class="line">              || (v10 ^ v13[<span class="number">2</span>]) != v12[<span class="number">3</span>]</span><br><span class="line">              || (v10 ^ v13[<span class="number">3</span>]) != v12[<span class="number">4</span>]</span><br><span class="line">              || (v10 ^ v13[<span class="number">4</span>]) != v12[<span class="number">5</span>] )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            v8 = v37;</span><br><span class="line">          &#125;</span><br><span class="line">          ++dword_2525DC;</span><br><span class="line">          dword_2525E4 += <span class="number">6</span>;</span><br><span class="line">          *v8 = v9 &amp; <span class="number">0xFE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v4 == <span class="string">&#x27;w&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( sub_2310B0(x - <span class="number">1</span>, y) )</span><br><span class="line">      &#123;</span><br><span class="line">        v14 = x;</span><br><span class="line">        v15 = <span class="number">5</span> * x;</span><br><span class="line">        byte_2518B0[<span class="number">10</span> * x + y] |= <span class="number">0x80</span>u;</span><br><span class="line">        x = v14 - <span class="number">1</span>;</span><br><span class="line">LABEL_33:</span><br><span class="line">        ++dword_2525E4;</span><br><span class="line">        LOBYTE(v41) = <span class="number">6</span>;</span><br><span class="line">        sub_231260(v30, v15, v2, v15);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v4 != <span class="string">&#x27;s&#x27;</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v4 == <span class="string">&#x27;a&#x27;</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( !sub_2310B0(x, y - <span class="number">1</span>) )</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">          v17 = y;</span><br><span class="line">          byte_2518B0[<span class="number">10</span> * x + y] |= <span class="number">0x80</span>u;</span><br><span class="line">          v15 = v17 - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( v4 != <span class="string">&#x27;d&#x27;</span> || !sub_2310B0(x, y + <span class="number">1</span>) )</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">          v19 = y;</span><br><span class="line">          byte_2518B0[<span class="number">10</span> * x + y] |= <span class="number">0x80</span>u;</span><br><span class="line">          v15 = v19 + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        y = v15;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_33;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( sub_2310B0(x + <span class="number">1</span>, y) )</span><br><span class="line">      &#123;</span><br><span class="line">        v16 = x;</span><br><span class="line">        v15 = <span class="number">5</span> * x;</span><br><span class="line">        byte_2518B0[<span class="number">10</span> * x + y] |= <span class="number">0x80</span>u;</span><br><span class="line">        x = v16 + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_33;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个题先是很多try_catch块，对应恢复后，是个迷宫。有五个字符，首先c字符，当当前位置在map中是奇数，后面的5个字符将要进行运算与对比，接下来就是wasd，走迷宫，要求是走的时候map中的值小于0x80</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> TMP_MAX</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span> = [<span class="number">0x61</span>, <span class="number">0x18</span>, <span class="number">0x60</span>, <span class="number">0x54</span>, <span class="number">0x52</span>, <span class="number">0x06</span>, <span class="number">0xD0</span>, <span class="number">0xA8</span>, <span class="number">0x9C</span>, <span class="number">0xCB</span>, <span class="number">0xDA</span>, <span class="number">0xF3</span>, <span class="number">0xE0</span>, <span class="number">0xA6</span>, <span class="number">0xE7</span>, <span class="number">0x60</span>, <span class="number">0xEC</span>, <span class="number">0xDD</span>, <span class="number">0x81</span>, <span class="number">0xE7</span>, <span class="number">0xFD</span>, <span class="number">0xB7</span>, <span class="number">0x71</span>, <span class="number">0x56</span>, <span class="number">0x50</span>, <span class="number">0x30</span>, <span class="number">0xE7</span>, <span class="number">0xD4</span>, <span class="number">0xA0</span>, <span class="number">0xAA</span>, <span class="number">0x88</span>, <span class="number">0xEC</span>, <span class="number">0x62</span>, <span class="number">0xC5</span>, <span class="number">0xE7</span>, <span class="number">0xEE</span>, <span class="number">0xD4</span>, <span class="number">0xF0</span>, <span class="number">0xCC</span>, <span class="number">0xA1</span>, <span class="number">0x94</span>, <span class="number">0x86</span>, <span class="number">0x08</span>, <span class="number">0x50</span>, <span class="number">0x74</span>, <span class="number">0x58</span>, <span class="number">0xA5</span>, <span class="number">0x88</span>, <span class="number">0xE9</span>, <span class="number">0xA7</span>, <span class="number">0x81</span>, <span class="number">0xC0</span>, <span class="number">0x8A</span>, <span class="number">0xE0</span>, <span class="number">0xFC</span>, <span class="number">0x04</span>, <span class="number">0xCF</span>, <span class="number">0xFE</span>, <span class="number">0xBC</span>, <span class="number">0x9A</span>, <span class="number">0xD1</span>, <span class="number">0x85</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x6C</span>, <span class="number">0xC0</span>, <span class="number">0xE6</span>, <span class="number">0xD5</span>, <span class="number">0xCB</span>, <span class="number">0xF3</span>, <span class="number">0xF0</span>, <span class="number">0x8A</span>, <span class="number">0x2C</span>, <span class="number">0xE1</span>, <span class="number">0xF5</span>, <span class="number">0xF7</span>, <span class="number">0xF7</span>, <span class="number">0x97</span>, <span class="number">0xC6</span>, <span class="number">0x9D</span>, <span class="number">0xEA</span>, <span class="number">0xC7</span>, <span class="number">0x40</span>, <span class="number">0x66</span>, <span class="number">0x0A</span>, <span class="number">0x44</span>, <span class="number">0x52</span>, <span class="number">0xD6</span>, <span class="number">0xAD</span>, <span class="number">0xCA</span>, <span class="number">0xBC</span>, <span class="number">0xE5</span>, <span class="number">0xAD</span>, <span class="number">0x84</span>, <span class="number">0x9E</span>, <span class="number">0xF2</span>, <span class="number">0x2A</span>, <span class="number">0x2D</span>, <span class="number">0xDD</span>]</span><br><span class="line">arr = [<span class="number">0x11</span>, <span class="number">0x0B</span>, <span class="number">0x15</span>, <span class="number">0x1B</span>, <span class="number">0x00</span>, <span class="number">0x7C</span>, <span class="number">0x6E</span>, <span class="number">0x69</span>, <span class="number">0x7B</span>, <span class="number">0x77</span>, <span class="number">0x0B</span>, <span class="number">0x16</span>, <span class="number">0x14</span>, <span class="number">0x0E</span>, <span class="number">0x01</span>, <span class="number">0x24</span>, <span class="number">0x22</span>, <span class="number">0x25</span>, <span class="number">0x3A</span>, <span class="number">0x35</span>, <span class="number">0x3F</span>, <span class="number">0x34</span>, <span class="number">0x22</span>, <span class="number">0x2B</span>, <span class="number">0x31</span>, <span class="number">0x6A</span>, <span class="number">0x67</span>, <span class="number">0x72</span>, <span class="number">0x61</span>, <span class="number">0x69</span>, <span class="number">0xB4</span>, <span class="number">0xA1</span>, <span class="number">0xBF</span>, <span class="number">0xA0</span>, <span class="number">0xA8</span>, <span class="number">0xDB</span>, <span class="number">0xDE</span>, <span class="number">0xC1</span>, <span class="number">0xC1</span>, <span class="number">0xD2</span>, <span class="number">0xFD</span>, <span class="number">0xFD</span>, <span class="number">0xEE</span>, <span class="number">0xE5</span>, <span class="number">0xF7</span>, <span class="number">0xAE</span>, <span class="number">0xA1</span>, <span class="number">0xA6</span>, <span class="number">0xBE</span>, <span class="number">0xAA</span>, <span class="number">0xAD</span>, <span class="number">0xA9</span>, <span class="number">0xB0</span>, <span class="number">0xA2</span>, <span class="number">0xB4</span>, <span class="number">0x84</span>, <span class="number">0x98</span>, <span class="number">0x92</span>, <span class="number">0x80</span>, <span class="number">0x9A</span>, <span class="number">0x8E</span>, <span class="number">0x8F</span>, <span class="number">0x82</span>, <span class="number">0x96</span>, <span class="number">0x84</span>, <span class="number">0xC9</span>, <span class="number">0xD5</span>, <span class="number">0xD3</span>, <span class="number">0xD5</span>, <span class="number">0xD5</span>, <span class="number">0x88</span>, <span class="number">0x9D</span>, <span class="number">0x80</span>, <span class="number">0x81</span>, <span class="number">0x92</span>, <span class="number">0x05</span>, <span class="number">0x07</span>, <span class="number">0x19</span>, <span class="number">0x04</span>, <span class="number">0x1A</span>, <span class="number">0x8D</span>, <span class="number">0x98</span>, <span class="number">0x9D</span>, <span class="number">0x98</span>, <span class="number">0x96</span>, <span class="number">0xB6</span>, <span class="number">0xB8</span>, <span class="number">0xAB</span>, <span class="number">0xB9</span>, <span class="number">0xB1</span>, <span class="number">0xE0</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0xE3</span>, <span class="number">0xF8</span>, <span class="number">0x8C</span>, <span class="number">0x8B</span>, <span class="number">0x9F</span>, <span class="number">0x9D</span>, <span class="number">0x96</span>, <span class="number">0x88</span>, <span class="number">0x9E</span>, <span class="number">0x8D</span>, <span class="number">0x96</span>, <span class="number">0x98</span>, <span class="number">0xDB</span>, <span class="number">0xC7</span>, <span class="number">0xD8</span>, <span class="number">0xDD</span>, <span class="number">0xCE</span>, <span class="number">0x15</span>, <span class="number">0x17</span>, <span class="number">0x08</span>, <span class="number">0x1E</span>, <span class="number">0x05</span>, <span class="number">0x34</span>, <span class="number">0x2C</span>, <span class="number">0x24</span>, <span class="number">0x3B</span>, <span class="number">0x3D</span>, <span class="number">0x31</span>, <span class="number">0x38</span>, <span class="number">0x21</span>, <span class="number">0x24</span>, <span class="number">0x21</span>, <span class="number">0x5E</span>, <span class="number">0x56</span>, <span class="number">0x52</span>, <span class="number">0x40</span>, <span class="number">0x58</span>, <span class="number">0x91</span>, <span class="number">0x9E</span>, <span class="number">0x83</span>, <span class="number">0x9E</span>, <span class="number">0x8A</span>, <span class="number">0xA1</span>, <span class="number">0xAC</span>, <span class="number">0xA6</span>, <span class="number">0xAD</span>, <span class="number">0xA7</span>, <span class="number">0xD4</span>, <span class="number">0xC3</span>, <span class="number">0xD2</span>, <span class="number">0xD4</span>, <span class="number">0xD5</span>, <span class="number">0xDC</span>, <span class="number">0xDF</span>, <span class="number">0xC4</span>, <span class="number">0xC2</span>, <span class="number">0xCC</span>, <span class="number">0xEB</span>, <span class="number">0xEC</span>, <span class="number">0xE4</span>, <span class="number">0xEA</span>, <span class="number">0xFC</span>, <span class="number">0x88</span>, <span class="number">0x98</span>, <span class="number">0x8D</span>, <span class="number">0x80</span>, <span class="number">0x9B</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x14</span>, <span class="number">0x11</span>, <span class="number">0xA2</span>, <span class="number">0xA1</span>, <span class="number">0xAE</span>, <span class="number">0xB2</span>, <span class="number">0xA6</span>, <span class="number">0x97</span>, <span class="number">0x84</span>, <span class="number">0x85</span>, <span class="number">0x86</span>, <span class="number">0x9F</span>, <span class="number">0x8A</span>, <span class="number">0x84</span>, <span class="number">0x89</span>, <span class="number">0x8D</span>, <span class="number">0x9E</span>, <span class="number">0xBF</span>, <span class="number">0xBD</span>, <span class="number">0xB8</span>, <span class="number">0xA4</span>, <span class="number">0xB6</span>, <span class="number">0x87</span>, <span class="number">0x98</span>, <span class="number">0x9E</span>, <span class="number">0x9A</span>, <span class="number">0x95</span>, <span class="number">0xB9</span>, <span class="number">0xAD</span>, <span class="number">0xA5</span>, <span class="number">0xB6</span>, <span class="number">0xBD</span>, <span class="number">0xC2</span>, <span class="number">0xC4</span>, <span class="number">0xD7</span>, <span class="number">0xD8</span>, <span class="number">0xC8</span>, <span class="number">0xED</span>, <span class="number">0xE2</span>, <span class="number">0xE3</span>, <span class="number">0xF2</span>, <span class="number">0xF8</span>, <span class="number">0xE5</span>, <span class="number">0xE1</span>, <span class="number">0xFF</span>, <span class="number">0xF7</span>, <span class="number">0xF6</span>, <span class="number">0x71</span>, <span class="number">0x6F</span>, <span class="number">0x6F</span>, <span class="number">0x7E</span>, <span class="number">0x7D</span>, <span class="number">0x3D</span>, <span class="number">0x29</span>, <span class="number">0x26</span>, <span class="number">0x3C</span>, <span class="number">0x27</span>, <span class="number">0x10</span>, <span class="number">0x07</span>, <span class="number">0x1E</span>, <span class="number">0x1D</span>, <span class="number">0x01</span>, <span class="number">0x20</span>, <span class="number">0x29</span>, <span class="number">0x3F</span>, <span class="number">0x2E</span>, <span class="number">0x2D</span>, <span class="number">0xC4</span>, <span class="number">0xDF</span>, <span class="number">0xCC</span>, <span class="number">0xD0</span>, <span class="number">0xDD</span>, <span class="number">0xFE</span>, <span class="number">0xF8</span>, <span class="number">0xEA</span>, <span class="number">0xF2</span>, <span class="number">0xEE</span>, <span class="number">0x81</span>, <span class="number">0x8B</span>, <span class="number">0x88</span>, <span class="number">0x84</span>, <span class="number">0x8E</span>, <span class="number">0xC3</span>, <span class="number">0xCA</span>, <span class="number">0xCE</span>, <span class="number">0xD6</span>, <span class="number">0xC5</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0xE3</span>, <span class="number">0xE9</span>, <span class="number">0xE6</span>, <span class="number">0xAC</span>, <span class="number">0xA7</span>, <span class="number">0xA9</span>, <span class="number">0xB1</span>, <span class="number">0xB0</span>, <span class="number">0xE5</span>, <span class="number">0xFB</span>, <span class="number">0xEB</span>, <span class="number">0xF2</span>, <span class="number">0xE9</span>, <span class="number">0x8C</span>, <span class="number">0x93</span>, <span class="number">0x93</span>, <span class="number">0x88</span>, <span class="number">0x9A</span>, <span class="number">0x8A</span>, <span class="number">0x97</span>, <span class="number">0x9F</span>, <span class="number">0x9A</span>, <span class="number">0x98</span>, <span class="number">0x73</span>, <span class="number">0x67</span>, <span class="number">0x62</span>, <span class="number">0x6C</span>, <span class="number">0x72</span>, <span class="number">0xBF</span>, <span class="number">0xBA</span>, <span class="number">0xBA</span>, <span class="number">0xAD</span>, <span class="number">0xBB</span>, <span class="number">0x9B</span>, <span class="number">0x8E</span>, <span class="number">0x93</span>, <span class="number">0x91</span>, <span class="number">0x96</span>, <span class="number">0xC4</span>, <span class="number">0xCB</span>, <span class="number">0xC6</span>, <span class="number">0xDD</span>, <span class="number">0xD3</span>, <span class="number">0xEE</span>, <span class="number">0xF6</span>, <span class="number">0xFB</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xBD</span>, <span class="number">0xB8</span>, <span class="number">0xBB</span>, <span class="number">0xB4</span>, <span class="number">0xBA</span>, <span class="number">0xE6</span>, <span class="number">0xF5</span>, <span class="number">0xED</span>, <span class="number">0xE0</span>, <span class="number">0xE2</span>, <span class="number">0xEE</span>, <span class="number">0xE3</span>, <span class="number">0xE8</span>, <span class="number">0xF2</span>, <span class="number">0xF2</span>, <span class="number">0x77</span>, <span class="number">0x79</span>, <span class="number">0x62</span>, <span class="number">0x69</span>, <span class="number">0x67</span>, <span class="number">0x79</span>, <span class="number">0x6E</span>, <span class="number">0x60</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x1E</span>, <span class="number">0x15</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0xAA</span>, <span class="number">0xA9</span>, <span class="number">0xB0</span>, <span class="number">0xAB</span>, <span class="number">0xAD</span>, <span class="number">0x88</span>, <span class="number">0x8E</span>, <span class="number">0x89</span>, <span class="number">0x8F</span>, <span class="number">0x94</span>, <span class="number">0xB1</span>, <span class="number">0xB3</span>, <span class="number">0xA2</span>, <span class="number">0xB7</span>, <span class="number">0xAC</span>, <span class="number">0xA1</span>, <span class="number">0xA0</span>, <span class="number">0xBC</span>, <span class="number">0xB8</span>, <span class="number">0xA5</span>, <span class="number">0x92</span>, <span class="number">0x9B</span>, <span class="number">0x86</span>, <span class="number">0x87</span>, <span class="number">0x89</span>, <span class="number">0x91</span>, <span class="number">0x8A</span>, <span class="number">0x95</span>, <span class="number">0x9E</span>, <span class="number">0x86</span>, <span class="number">0xE2</span>, <span class="number">0xED</span>, <span class="number">0xF3</span>, <span class="number">0xEE</span>, <span class="number">0xFF</span>, <span class="number">0x46</span>, <span class="number">0x46</span>, <span class="number">0x55</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0x8C</span>, <span class="number">0x88</span>, <span class="number">0x82</span>, <span class="number">0x87</span>, <span class="number">0x95</span>, <span class="number">0x93</span>, <span class="number">0x96</span>, <span class="number">0x9E</span>, <span class="number">0x92</span>, <span class="number">0x82</span>, <span class="number">0x95</span>, <span class="number">0x9C</span>, <span class="number">0x83</span>, <span class="number">0x98</span>, <span class="number">0x90</span>, <span class="number">0x9E</span>, <span class="number">0x81</span>, <span class="number">0x87</span>, <span class="number">0x92</span>, <span class="number">0x8E</span>, <span class="number">0xFA</span>, <span class="number">0xE3</span>, <span class="number">0xF5</span>, <span class="number">0xFD</span>, <span class="number">0xE1</span>, <span class="number">0xA1</span>, <span class="number">0xAB</span>, <span class="number">0xAA</span>, <span class="number">0xA4</span>, <span class="number">0xBF</span>, <span class="number">0xEB</span>, <span class="number">0xE4</span>, <span class="number">0xF7</span>, <span class="number">0xF7</span>, <span class="number">0xFC</span>, <span class="number">0x9C</span>, <span class="number">0x89</span>, <span class="number">0x80</span>, <span class="number">0x83</span>, <span class="number">0x9B</span>, <span class="number">0xA2</span>, <span class="number">0xB0</span>, <span class="number">0xB5</span>, <span class="number">0xB4</span>, <span class="number">0xA4</span>, <span class="number">0x35</span>, <span class="number">0x32</span>, <span class="number">0x38</span>, <span class="number">0x23</span>, <span class="number">0x35</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x1F</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x64</span>, <span class="number">0x70</span>, <span class="number">0x64</span>, <span class="number">0x7F</span>, <span class="number">0x65</span>, <span class="number">0x34</span>, <span class="number">0x20</span>, <span class="number">0x28</span>, <span class="number">0x29</span>, <span class="number">0x2B</span>, <span class="number">0x3A</span>, <span class="number">0x27</span>, <span class="number">0x3E</span>, <span class="number">0x27</span>, <span class="number">0x31</span>, <span class="number">0xA4</span>, <span class="number">0xB1</span>, <span class="number">0xBC</span>, <span class="number">0xB4</span>, <span class="number">0xAE</span>, <span class="number">0xCF</span>, <span class="number">0xCF</span>, <span class="number">0xCE</span>, <span class="number">0xDE</span>, <span class="number">0xDF</span>, <span class="number">0xA8</span>, <span class="number">0xB8</span>, <span class="number">0xBD</span>, <span class="number">0xB3</span>, <span class="number">0xB9</span>, <span class="number">0xC5</span>, <span class="number">0xCA</span>, <span class="number">0xD4</span>, <span class="number">0xD8</span>, <span class="number">0xDF</span>, <span class="number">0x87</span>, <span class="number">0x97</span>, <span class="number">0x86</span>, <span class="number">0x80</span>, <span class="number">0x93</span>, <span class="number">0xDC</span>, <span class="number">0xCB</span>, <span class="number">0xDA</span>, <span class="number">0xC2</span>, <span class="number">0xD4</span>, <span class="number">0xF2</span>, <span class="number">0xE7</span>, <span class="number">0xFD</span>, <span class="number">0xEA</span>, <span class="number">0xEE</span>, <span class="number">0xE6</span>, <span class="number">0xE6</span>, <span class="number">0xF9</span>, <span class="number">0xEC</span>, <span class="number">0xFA</span>, <span class="number">0x97</span>, <span class="number">0x9F</span>, <span class="number">0x95</span>, <span class="number">0x93</span>, <span class="number">0x95</span>, <span class="number">0x4B</span>, <span class="number">0x45</span>, <span class="number">0x5B</span>, <span class="number">0x4F</span>, <span class="number">0x45</span>, <span class="number">0x4C</span>, <span class="number">0x48</span>, <span class="number">0x55</span>, <span class="number">0x59</span>, <span class="number">0x5F</span>, <span class="number">0xBF</span>, <span class="number">0xAB</span>, <span class="number">0xBE</span>, <span class="number">0xA8</span>, <span class="number">0xA5</span>]</span><br><span class="line">tmp = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">map</span>)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">map</span>[i] &lt; <span class="number">0x80</span>:</span><br><span class="line">        tmp.append(<span class="built_in">map</span>[i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">map</span>[i] = <span class="number">0xff</span></span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">map</span>[i*<span class="number">10</span>+j])[<span class="number">2</span>:].zfill(<span class="number">2</span>),end=<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; &quot;</span>)</span><br><span class="line">stra = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">map</span>)):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">map</span>[i]!=<span class="number">0xff</span>):</span><br><span class="line">        tmp=i*<span class="number">5</span></span><br><span class="line">        tmp_str = <span class="string">&quot;c&quot;</span> </span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            tmp_str+=<span class="built_in">chr</span>(<span class="built_in">map</span>[i]^arr[tmp+j])</span><br><span class="line">        stra.append(tmp_str)</span><br><span class="line"><span class="built_in">print</span>(stra)</span><br></pre></td></tr></table></figure>

<p>生成地图和c开头的字符串，只考虑地图<strong>dddddssaaassdddssaassddddsd</strong>，c开头的要筛选，当tmp中是奇数，就是要找的，得到路线<strong>cpjtzadddddssaaacdfyotssdddssacxoahkassddddsdcaextr</strong>，输入得flag。</p>
<h2 id="MTCTF"><a href="#MTCTF" class="headerlink" title="MTCTF"></a>MTCTF</h2><h3 id="small"><a href="#small" class="headerlink" title="small"></a>small</h3><p>直接审汇编，发现不能反汇编，其实将0xea处改为retn就行，该处本来就是exit，所以没问题</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220920155829547.png" alt="image-20220920155829547"></p>
<p>得到返汇编后，发现是一个tea加密</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall sub_67(__int64 a1,<span class="built_in"> int </span>a2)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned<span class="built_in"> int </span>v2; // eax</span><br><span class="line"> <span class="built_in"> int </span>v3; // ebx</span><br><span class="line"> <span class="built_in"> int </span>v4; // ebp</span><br><span class="line"> <span class="built_in"> int </span>v5; // edi</span><br><span class="line">  _BYTE *v6; // rsi</span><br><span class="line">  unsigned<span class="built_in"> int </span>v7; // ebp</span><br><span class="line"> <span class="built_in"> int </span>v8; // edi</span><br><span class="line">  _BYTE *result; // rax</span><br><span class="line"> <span class="built_in"> int </span>v10; // esi</span><br><span class="line"> <span class="built_in"> int </span>v11; // [rsp+10h] [rbp+10h]</span><br><span class="line"></span><br><span class="line">  *(_BYTE *)(a1 + 1159922115) += v2;</span><br><span class="line">  v7 = ((v3 + v5) ^ ((v2 &gt;&gt; 5) + 35) ^ (16 * a1 + 1)) + v4;</span><br><span class="line">  v8 = ((v3 + v7) ^ (16 * v7 + 69) ^ ((v7 &gt;&gt; 5) + 103)) + v5;</span><br><span class="line"> <span class="built_in"> if </span>( a2 + 1 &lt; 35 )</span><br><span class="line">    JUMPOUT(0x52i64);</span><br><span class="line">  *((_DWORD *)v6 - 2) = v7;</span><br><span class="line">  *((_DWORD *)v6 - 1) = v8;</span><br><span class="line"> <span class="built_in"> if </span>( (int)v6 &lt; v11 + 32 )</span><br><span class="line">    JUMPOUT(0x1Ci64);</span><br><span class="line">  result = v6;</span><br><span class="line">  v10 = 32;</span><br><span class="line">  while ( *(_BYTE *)(unsigned int)(v10 + 65783) == *result )</span><br><span class="line">  &#123;</span><br><span class="line">    --v10;</span><br><span class="line">    --result;</span><br><span class="line">   <span class="built_in"> if </span>( !v10 )</span><br><span class="line">    &#123;</span><br><span class="line">      result = (_BYTE *)(&amp;loc_0 + 1);</span><br><span class="line">      __asm &#123; syscall; Low latency<span class="keyword"> system</span> call &#125;</span><br><span class="line">     <span class="built_in"> return </span>result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="built_in"> return </span>result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//加密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//解密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0x67452301</span>*<span class="number">35</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x67452301</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">35</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[]=&#123;<span class="number">0xDE087143</span>, <span class="number">0xC4F91BD2</span>, <span class="number">0xDAF6DADC</span>, <span class="number">0x6D9ED54C</span>, <span class="number">0x75EB4EE7</span>, <span class="number">0x5D1DDC04</span>, <span class="number">0x511B0FD9</span>, <span class="number">0x51DC88FB</span>&#125;,k[<span class="number">4</span>]=&#123;<span class="number">0x01</span>,<span class="number">0x23</span>,<span class="number">0x45</span>,<span class="number">0x67</span>&#125;;</span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i+=<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        decrypt(v+i, k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[i],v[<span class="number">1</span>+i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag&#123;327a6c4304ad5938eaf0efb6cc3e53dc&#125;</span></span><br></pre></td></tr></table></figure>

<p>delta是0x67452301，很简单。</p>
<h2 id="DASCTF"><a href="#DASCTF" class="headerlink" title="DASCTF"></a>DASCTF</h2><h3 id="landing"><a href="#landing" class="headerlink" title="landing"></a>landing</h3><p>这题还是很简单的，就是try、catch</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">std</span>::ostream *v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="built_in">std</span>::ostream *v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">32</span>]; <span class="comment">// [rsp+450h] [rbp+3D0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+48Ch] [rbp+40Ch]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  v3 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;Input something.&quot;</span>);</span><br><span class="line">  refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_(v3);</span><br><span class="line">  <span class="built_in">std</span>::operator&gt;&gt;&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt3cin, Str);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(Str) == <span class="number">28</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">27</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      Str[i] ^= <span class="number">0x22</span>u;</span><br><span class="line">      ++Str[i];</span><br><span class="line">    &#125;</span><br><span class="line">    func1(Str);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;nono&quot;</span>);</span><br><span class="line">    refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_(v4);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主程序是这样的，func1里是一个base64加密不过是骗人的，发现func1处有一个try块，找到对应catch块，然后patch一下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">std</span>::ostream *v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  <span class="built_in">std</span>::ostream *v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">size_t</span> v7; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">void</span> *v8; <span class="comment">// rsp</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">size_t</span> v10; <span class="comment">// rax</span></span><br><span class="line">  <span class="built_in">std</span>::ostream *v11; <span class="comment">// rax</span></span><br><span class="line">  <span class="built_in">std</span>::ostream *v12; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v13[<span class="number">15</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v14[<span class="number">25</span>]; <span class="comment">// [rsp+2Fh] [rbp-51h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str1[<span class="number">1024</span>]; <span class="comment">// [rsp+50h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">32</span>]; <span class="comment">// [rsp+450h] [rbp+3D0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *Str2; <span class="comment">// [rsp+470h] [rbp+3F0h]</span></span><br><span class="line">  <span class="type">size_t</span> v18; <span class="comment">// [rsp+478h] [rbp+3F8h]</span></span><br><span class="line">  <span class="type">void</span> *v19; <span class="comment">// [rsp+480h] [rbp+400h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+488h] [rbp+408h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+48Ch] [rbp+40Ch]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  v3 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;Input something.&quot;</span>);</span><br><span class="line">  refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_(v3);</span><br><span class="line">  <span class="built_in">std</span>::operator&gt;&gt;&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt3cin, Str);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(Str) == <span class="number">28</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">27</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      Str[i] ^= <span class="number">0x22</span>u;</span><br><span class="line">      v4 = (<span class="type">unsigned</span> <span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[i]++ + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v4 == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v19 = _cxa_begin_catch(Str);</span><br><span class="line">      qmemcpy(v13, <span class="string">&quot;GUw\\D~UHG#kYG~&quot;</span>, <span class="number">14</span>);</span><br><span class="line">      v13[<span class="number">14</span>] = <span class="number">127</span>;</span><br><span class="line">      qmemcpy(v14, <span class="string">&quot;BA#&#123;QJT(\\A &#123;BG~$BG~$BGz//&quot;</span>, <span class="keyword">sizeof</span>(v14));</span><br><span class="line">      v7 = <span class="built_in">strlen</span>(v13);</span><br><span class="line">      v18 = v7 - <span class="number">1</span>;</span><br><span class="line">      v8 = alloca(<span class="number">16</span> * ((v7 + <span class="number">15</span>) &gt;&gt; <span class="number">4</span>));</span><br><span class="line">      Str2 = v13;</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(v13); ++j )</span><br><span class="line">        Str2[j] = v13[j] ^ <span class="number">0x12</span>;</span><br><span class="line">      v9 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">      nothing(Str1, Str, v9);</span><br><span class="line">      v10 = <span class="built_in">strlen</span>(Str2);</span><br><span class="line">      <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(Str1, Str2, v10) )</span><br><span class="line">        v11 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(</span><br><span class="line">                                refptr__ZSt4cout,</span><br><span class="line">                                <span class="string">&quot;Goodgood!\n...Please packed the flag with\&quot;DASCTF&#123;&#125;\&quot;&quot;</span>);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        v11 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;nono&quot;</span>);</span><br><span class="line">      refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_(v11);</span><br><span class="line">      system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">      _cxa_end_catch();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      _cxa_begin_catch(Str);</span><br><span class="line">      v12 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;nono&quot;</span>);</span><br><span class="line">      refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_(v12);</span><br><span class="line">      system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">      _cxa_end_catch();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;nono&quot;</span>);</span><br><span class="line">    refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_(v5);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这时主加密其实很清楚就是对一个初始化的对比密文的操作，而对我们输入进行操作的是在nothing里，nothing这个函数点个U就可以看了，发现是个base64，一眼魔改。</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">void __fastcall nothing(char *a1,<span class="built_in"> const </span>char *a2,<span class="built_in"> int </span>a3)</span><br><span class="line">&#123;</span><br><span class="line">  char *v3; // rax</span><br><span class="line">  char *v4; // rax</span><br><span class="line">  char *v5; // rax</span><br><span class="line">  char *v6; // rax</span><br><span class="line">  unsigned __int64 i; // [rsp+8h] [rbp-18h]</span><br><span class="line"> <span class="built_in"> int </span>v8; // [rsp+14h] [rbp-Ch]</span><br><span class="line"> <span class="built_in"> int </span>v9; // [rsp+18h] [rbp-8h]</span><br><span class="line"> <span class="built_in"> int </span>v10; // [rsp+1Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  v10 = 0;</span><br><span class="line">  v9 = 2;</span><br><span class="line">  for ( i = 0i64; a3 &gt; i; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    switch ( v9 )</span><br><span class="line">    &#123;</span><br><span class="line">      case 2:</span><br><span class="line">        v8 = (*a2 &gt;&gt; 2) &amp; 0x3F;</span><br><span class="line">        break;</span><br><span class="line">      case 4:</span><br><span class="line">        v8 = (*a2 &gt;&gt; 4) &amp; 0xF;</span><br><span class="line">        break;</span><br><span class="line">      case 6:</span><br><span class="line">        v8 = (*a2 &gt;&gt; 6) &amp; 3;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    v8 += v10;</span><br><span class="line">    v3 = a1++;</span><br><span class="line">    *v3 = nothing(char *,char const*,int)::aaa[v8] + 1;</span><br><span class="line">    v10 = (*a2 &lt;&lt; (6 - v9)) &amp; 0x3F;</span><br><span class="line">    v9 += 2;</span><br><span class="line">   <span class="built_in"> if </span>( v9 == 8 )</span><br><span class="line">    &#123;</span><br><span class="line">      v8 = *a2 &amp; 0x3F;</span><br><span class="line">      v4 = a1++;</span><br><span class="line">      *v4 = nothing(char *,char const*,int)::aaa[*a2 &amp; 0x3F] + 1;</span><br><span class="line">      v10 = 0;</span><br><span class="line">      v9 = 2;</span><br><span class="line">    &#125;</span><br><span class="line">    ++a2;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="built_in"> if </span>( v10 )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = a1++;</span><br><span class="line">    *v5 = nothing(char *,char const*,int)::aaa[v10] + 1;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="built_in"> if </span>( a3 % 3 == 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = a1++;</span><br><span class="line">    *v6 = 61;</span><br><span class="line">    *a1 = 61;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="built_in"> if </span>( a3 % 3 == 2 )</span><br><span class="line">    *a1 = 61;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很明显在赋值的时候给每个base64后的数加了1，那么我们就很清楚加密流程了。输入-&gt;异或-&gt;加1-&gt;base64-&gt;加1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&#x27;UGeNVlGZU1yKUlmPS1iCXF:NS2iPUl6PUl6PUh&#x27;</span></span><br><span class="line">flag11 = <span class="string">&quot;&quot;</span></span><br><span class="line">flag=[<span class="number">0</span>]*<span class="number">28</span></span><br><span class="line">flag1=<span class="string">&#x27;LWLRAXOLININGHAXOLGXNNNNNNNN&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(a[i]) - <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">28</span>):</span><br><span class="line">    flag[i] = <span class="built_in">ord</span>(flag1[i]) - <span class="number">1</span></span><br><span class="line">    flag[i] ^=<span class="number">0x22</span></span><br><span class="line">    flag11+=<span class="built_in">chr</span>(flag[i])</span><br><span class="line"><span class="built_in">print</span>(flag11)</span><br></pre></td></tr></table></figure>

<h3 id="cbNET"><a href="#cbNET" class="headerlink" title="cbNET"></a>cbNET</h3><p>c#逆向</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">method_3</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">string</span> text = <span class="keyword">this</span>.vmethod_0().Text;</span><br><span class="line">	<span class="built_in">string</span>[] array = <span class="keyword">new</span> <span class="built_in">string</span>[<span class="number">24</span>];</span><br><span class="line">	<span class="built_in">int</span>[] array2 = <span class="keyword">new</span> <span class="built_in">int</span>[]</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">309</span>,</span><br><span class="line">		<span class="number">1981</span>,</span><br><span class="line">		<span class="number">2823</span>,</span><br><span class="line">		<span class="number">6979</span>,</span><br><span class="line">		<span class="number">28339</span>,</span><br><span class="line">		<span class="number">39487</span>,</span><br><span class="line">		<span class="number">33035</span>,</span><br><span class="line">		<span class="number">283711</span>,</span><br><span class="line">		<span class="number">623</span>,</span><br><span class="line">		<span class="number">4109</span>,</span><br><span class="line">		<span class="number">23551</span>,</span><br><span class="line">		<span class="number">54761</span>,</span><br><span class="line">		<span class="number">67985</span>,</span><br><span class="line">		<span class="number">231149</span>,</span><br><span class="line">		<span class="number">499603</span>,</span><br><span class="line">		<span class="number">1354567</span>,</span><br><span class="line">		<span class="number">213</span>,</span><br><span class="line">		<span class="number">2651</span>,</span><br><span class="line">		<span class="number">22559</span>,</span><br><span class="line">		<span class="number">52549</span>,</span><br><span class="line">		<span class="number">484663</span>,</span><br><span class="line">		<span class="number">290793</span>,</span><br><span class="line">		<span class="number">532213</span>,</span><br><span class="line">		<span class="number">1746643</span></span><br><span class="line">	&#125;;</span><br><span class="line">	checked</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (text.Length != array2.Length + <span class="number">7</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>.vmethod_2().Content = <span class="string">&quot;wrong&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (Operators.CompareString(Strings.Mid(text, <span class="number">1</span>, <span class="number">6</span>), <span class="string">&quot;CBCTF&#123;&quot;</span>, <span class="literal">false</span>) != <span class="number">0</span> | Operators.CompareString(Strings.Mid(text, array2.Length + <span class="number">7</span>, <span class="number">1</span>), <span class="string">&quot;&#125;&quot;</span>, <span class="literal">false</span>) != <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>.vmethod_2().Content = <span class="string">&quot;wrong&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>.method_0(<span class="keyword">ref</span> array, text);</span><br><span class="line">			<span class="keyword">this</span>.method_2(<span class="keyword">ref</span> array);</span><br><span class="line">			<span class="built_in">int</span> num = array2.Length - <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt;= num; i++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (Conversions.ToDouble(array[i]) != (<span class="built_in">double</span>)array2[i])</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">this</span>.vmethod_2().Content = <span class="string">&quot;wrong&quot;</span>;</span><br><span class="line">					<span class="keyword">return</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">this</span>.vmethod_2().Content = <span class="string">&quot;correct&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">object</span> <span class="title">method_2</span>(<span class="params"><span class="keyword">ref</span> <span class="built_in">string</span>[] string_0</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">int</span> num = checked(string_0.Length - <span class="number">1</span>);</span><br><span class="line">		<span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (i &lt;= num)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">try</span></span><br><span class="line">			&#123;</span><br><span class="line">				string_0[i] = Conversions.ToString((<span class="built_in">double</span>)(Conversions.ToLong(string_0[i]) ^ Conversions.ToLong(string_0[checked(i - <span class="number">1</span>)]) / (<span class="built_in">long</span>)(i % <span class="number">8</span>)) + Conversions.ToDouble(string_0[checked(i - <span class="number">1</span>)]) % (<span class="built_in">double</span>)(i % <span class="number">8</span>));</span><br><span class="line">				<span class="keyword">goto</span> IL_F3;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">catch</span> (Exception ex)</span><br><span class="line">			&#123;</span><br><span class="line">				string_0[i] = Conversions.ToString((<span class="built_in">double</span>)(Conversions.ToLong(string_0[i]) ^ Conversions.ToLong(string_0[checked(i + <span class="number">7</span>)]) / <span class="number">8L</span>) + Conversions.ToDouble(string_0[checked(i + <span class="number">7</span>)]) % <span class="number">8.0</span>);</span><br><span class="line">				<span class="keyword">goto</span> IL_F3;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">goto</span> IL_98;</span><br><span class="line">			IL_EA:</span><br><span class="line">			<span class="built_in">double</span> num2;</span><br><span class="line">			<span class="built_in">double</span> num3;</span><br><span class="line">			checked</span><br><span class="line">			&#123;</span><br><span class="line">				i++;</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">				IL_CE:</span><br><span class="line">				<span class="keyword">if</span> (num2 &gt; num3)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">goto</span> IL_EA;</span><br><span class="line">				&#125;</span><br><span class="line">				IL_98:;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (checked(<span class="keyword">this</span>.method_1((<span class="built_in">int</span>)Math.Round(num2)) &amp; <span class="keyword">this</span>.method_1((<span class="built_in">int</span>)Math.Round(<span class="keyword">unchecked</span>(Conversions.ToDouble(string_0[i]) - num2)))) == <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				num2 += <span class="number">1.0</span>;</span><br><span class="line">				<span class="keyword">goto</span> IL_CE;</span><br><span class="line">			&#125;</span><br><span class="line">			string_0[i] = Conversions.ToString(num2 * (Conversions.ToDouble(string_0[i]) - num2));</span><br><span class="line">			<span class="keyword">goto</span> IL_EA;</span><br><span class="line">			IL_F3:</span><br><span class="line">			string_0[i] = Conversions.ToString(Conversions.ToDouble(string_0[i]) - <span class="number">2.0</span> - Conversions.ToDouble(string_0[i]) % <span class="number">2.0</span>);</span><br><span class="line">			num3 = Conversions.ToDouble(string_0[i]) - <span class="number">2.0</span>;</span><br><span class="line">			num2 = <span class="number">2.0</span>;</span><br><span class="line">			<span class="keyword">goto</span> IL_CE;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">int</span> <span class="title">method_1</span>(<span class="params"><span class="built_in">int</span> int_0</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		checked</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">int</span> result;</span><br><span class="line">			<span class="keyword">if</span> (int_0 &lt; <span class="number">2</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				result = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">int</span> num = int_0 - <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">2</span>; i &lt;= num; i++)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">if</span> (int_0 % i == <span class="number">0</span>)</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				result = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> result;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">object</span> <span class="title">method_0</span>(<span class="params"><span class="keyword">ref</span> <span class="built_in">string</span>[] string_0, <span class="built_in">string</span> string_1</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">string</span> text = <span class="string">&quot;0rays&quot;</span>;</span><br><span class="line">		<span class="built_in">int</span> num = <span class="number">0</span>;</span><br><span class="line">		checked</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">int</span> num2 = string_1.Length - <span class="number">2</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">6</span>; i &lt;= num2; i++)</span><br><span class="line">			&#123;</span><br><span class="line">				string_0[i - <span class="number">6</span>] = Conversions.ToString(string_1[i]);</span><br><span class="line">				string_0[i - <span class="number">6</span>] = Conversions.ToString(Strings.Asc(string_0[i - <span class="number">6</span>]) ^ Strings.Asc(text[num]));</span><br><span class="line">				num = (num + <span class="number">1</span> ^ <span class="number">5</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>这个题是真坐牢啊，脚本跑不对，真的难受</p>
<p>学习一下官方wp，如何爆破这种类型题目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isPrime</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n % i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xordecrypt</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&quot;0rays&quot;</span></span><br><span class="line">    circle = <span class="number">0</span></span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">        flag = flag + <span class="built_in">chr</span>(key[i] ^ <span class="built_in">ord</span>(<span class="built_in">str</span>[circle]))</span><br><span class="line">        circle = (circle + <span class="number">1</span>) ^ <span class="number">5</span></span><br><span class="line">    flag = <span class="string">&quot;CBCTF&#123;&quot;</span> + flag + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">    t = hashlib.sha256()</span><br><span class="line">    t.update(flag.encode())</span><br><span class="line">    finalflag = t.hexdigest()</span><br><span class="line">    <span class="keyword">if</span> finalflag == <span class="string">&quot;15c4ac7645546a1ef8141441b48e1824954fdbb159bf96400061b17db1af9edf&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recursion</span>(<span class="params">key2, i</span>):</span><br><span class="line">    key = key2.copy()</span><br><span class="line">    <span class="keyword">if</span> (i % <span class="number">8</span>) != <span class="number">0</span>:</span><br><span class="line">        key[i] = (key[i] - key[i - <span class="number">1</span>] % (i % <span class="number">8</span>)) ^ (key[i - <span class="number">1</span>] // (i % <span class="number">8</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        key[i] = (key[i] - key[i + <span class="number">7</span>] % <span class="number">8</span>) ^ (key[i + <span class="number">7</span>] // <span class="number">8</span>)</span><br><span class="line">    <span class="keyword">if</span> i != <span class="number">0</span>:</span><br><span class="line">        decrypt(key, i - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        xordecrypt(key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">key1, i</span>):</span><br><span class="line">    key = key1.copy()</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, key[i] - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> key[i] % j == <span class="number">0</span> <span class="keyword">and</span> isPrime(j) <span class="keyword">and</span> isPrime(key[i] // j): <span class="comment"># key[i] % j == 0 因为指数相乘所以是肯定余数为0</span></span><br><span class="line">            key[i] = j + key[i] // j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    key[i] = key[i] + <span class="number">2</span> <span class="comment">#+2或者+1都进行测试</span></span><br><span class="line">    recursion(key, i)</span><br><span class="line">    key[i] = key[i] + <span class="number">1</span> </span><br><span class="line">    recursion(key, i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = [<span class="number">309</span>, <span class="number">1981</span>, <span class="number">2823</span>, <span class="number">6979</span>, <span class="number">28339</span>, <span class="number">39487</span>, <span class="number">33035</span>, <span class="number">283711</span>, <span class="number">623</span>, <span class="number">4109</span>, <span class="number">23551</span>, <span class="number">54761</span>, <span class="number">67985</span>, <span class="number">231149</span>, <span class="number">499603</span>, <span class="number">1354567</span>, <span class="number">213</span>, <span class="number">2651</span>, <span class="number">22559</span>, <span class="number">52549</span>, <span class="number">484663</span>, <span class="number">290793</span>, <span class="number">532213</span>, <span class="number">1746643</span>]</span><br><span class="line">decrypt(key, <span class="number">23</span>) </span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/09/11/%E7%BD%91%E9%BC%8E%E6%9D%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/09/11/%E7%BD%91%E9%BC%8E%E6%9D%AF/" class="post-title-link" itemprop="url">网鼎杯</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-09-11 16:25:05 / 修改时间：16:34:41" itemprop="dateCreated datePublished" datetime="2022-09-11T16:25:05+08:00">2022-09-11</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="网鼎杯"><a href="#网鼎杯" class="headerlink" title="网鼎杯"></a>网鼎杯</h1><p>这次网鼎杯总共3道re，出了两道，第三道出了一半卡在了写脚本，总之还是不错的。</p>
<h2 id="fakeshell"><a href="#fakeshell" class="headerlink" title="fakeshell"></a>fakeshell</h2><p>很简单的一道题，主要是setjmp和longjmp这个知识点，已经做了三次这种题了，经过调试发现是一个加法和一个异或然后进行对比，直接给出脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cmp = [<span class="number">0x0000004B</span>, <span class="number">0x00000048</span>, <span class="number">0x00000079</span>, <span class="number">0x00000013</span>, <span class="number">0x00000045</span>, <span class="number">0x00000030</span>, <span class="number">0x0000005C</span>, <span class="number">0x00000049</span>, <span class="number">0x0000005A</span>, <span class="number">0x00000079</span>, <span class="number">0x00000013</span>, <span class="number">0x00000070</span>, <span class="number">0x0000006D</span>, <span class="number">0x00000078</span>, <span class="number">0x00000013</span>, <span class="number">0x0000006F</span>, <span class="number">0x00000048</span>, <span class="number">0x0000005D</span>, <span class="number">0x00000064</span>, <span class="number">0x00000064</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cmp)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(((cmp[i]^<span class="number">0x50</span>)-<span class="number">10</span>)^<span class="number">0x66</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="handmake"><a href="#handmake" class="headerlink" title="handmake"></a>handmake</h2><p>纯纯动脑子题，一眼看出是个go语言，本来想着慢慢找，但发现他们都做的很快，其实可以直接改几处源码就行，15k行只用改main就行，将要得到的值输出就行。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> nFAzj, CuSkl <span class="type">string</span></span><br><span class="line">	jjxXf := []<span class="type">byte</span>&#123;</span><br><span class="line">		<span class="number">37</span>, <span class="number">73</span>, <span class="number">151</span>, <span class="number">135</span>, <span class="number">65</span>, <span class="number">58</span>, <span class="number">241</span>, <span class="number">90</span>, <span class="number">33</span>, <span class="number">86</span>, <span class="number">71</span>, <span class="number">41</span>, <span class="number">102</span>, <span class="number">241</span>, <span class="number">213</span>, <span class="number">234</span>, <span class="number">67</span>, <span class="number">144</span>, <span class="number">139</span>, <span class="number">20</span>, <span class="number">112</span>, <span class="number">150</span>, <span class="number">41</span>, <span class="number">7</span>, <span class="number">158</span>, <span class="number">251</span>, <span class="number">167</span>, <span class="number">249</span>, <span class="number">24</span>, <span class="number">129</span>, <span class="number">72</span>, <span class="number">64</span>, <span class="number">83</span>, <span class="number">142</span>, <span class="number">166</span>, <span class="number">236</span>, <span class="number">67</span>, <span class="number">18</span>, <span class="number">211</span>, <span class="number">100</span>, <span class="number">91</span>, <span class="number">38</span>, <span class="number">83</span>, <span class="number">147</span>, <span class="number">40</span>, <span class="number">78</span>, <span class="number">239</span>, <span class="number">113</span>, <span class="number">232</span>, <span class="number">83</span>, <span class="number">227</span>, <span class="number">47</span>, <span class="number">192</span>, <span class="number">227</span>, <span class="number">70</span>, <span class="number">167</span>, <span class="number">201</span>, <span class="number">249</span>, <span class="number">156</span>, <span class="number">101</span>, <span class="number">216</span>, <span class="number">159</span>, <span class="number">116</span>, <span class="number">210</span>, <span class="number">152</span>, <span class="number">234</span>, <span class="number">38</span>, <span class="number">145</span>, <span class="number">198</span>, <span class="number">58</span>, <span class="number">24</span>, <span class="number">183</span>, <span class="number">72</span>, <span class="number">143</span>, <span class="number">136</span>, <span class="number">234</span>, <span class="number">246</span>&#125;</span><br><span class="line">	KdlaH := []<span class="type">byte</span>&#123;</span><br><span class="line">		<span class="number">191</span>, <span class="number">140</span>, <span class="number">114</span>, <span class="number">245</span>, <span class="number">142</span>, <span class="number">55</span>, <span class="number">190</span>, <span class="number">30</span>, <span class="number">161</span>, <span class="number">18</span>, <span class="number">200</span>, <span class="number">7</span>, <span class="number">21</span>, <span class="number">59</span>, <span class="number">17</span>, <span class="number">44</span>, <span class="number">34</span>, <span class="number">181</span>, <span class="number">109</span>, <span class="number">116</span>, <span class="number">146</span>, <span class="number">145</span>, <span class="number">189</span>, <span class="number">68</span>, <span class="number">142</span>, <span class="number">113</span>, <span class="number">0</span>, <span class="number">33</span>, <span class="number">46</span>, <span class="number">184</span>, <span class="number">21</span>, <span class="number">33</span>, <span class="number">66</span>, <span class="number">99</span>, <span class="number">124</span>, <span class="number">167</span>, <span class="number">201</span>, <span class="number">88</span>, <span class="number">133</span>, <span class="number">20</span>, <span class="number">211</span>, <span class="number">67</span>, <span class="number">133</span>, <span class="number">250</span>, <span class="number">62</span>, <span class="number">28</span>, <span class="number">138</span>, <span class="number">229</span>, <span class="number">105</span>, <span class="number">102</span>, <span class="number">125</span>, <span class="number">124</span>, <span class="number">208</span>, <span class="number">180</span>, <span class="number">50</span>, <span class="number">146</span>, <span class="number">67</span>, <span class="number">39</span>, <span class="number">55</span>, <span class="number">240</span>, <span class="number">239</span>, <span class="number">203</span>, <span class="number">230</span>, <span class="number">142</span>, <span class="number">20</span>, <span class="number">90</span>, <span class="number">205</span>, <span class="number">27</span>, <span class="number">128</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">140</span>, <span class="number">222</span>, <span class="number">92</span>, <span class="number">152</span>, <span class="number">1</span>, <span class="number">222</span>, <span class="number">138</span>, <span class="number">254</span>, <span class="number">246</span>, <span class="number">223</span>, <span class="number">224</span>, <span class="number">236</span>, <span class="number">33</span>, <span class="number">60</span>, <span class="number">170</span>, <span class="number">189</span>, <span class="number">77</span>, <span class="number">124</span>, <span class="number">72</span>, <span class="number">135</span>, <span class="number">46</span>, <span class="number">235</span>, <span class="number">17</span>, <span class="number">32</span>, <span class="number">28</span>, <span class="number">245</span>&#125;</span><br><span class="line">	fmt.Print(MPyt9GWTRfAFNvb1(jjxXf))</span><br><span class="line">	fmt.Scanf(<span class="string">&quot;%20s\n&quot;</span>, &amp;nFAzj)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;First scanf: %s\n&quot;</span>, nFAzj)</span><br><span class="line">	fmt.Print(kZ2BFvOxepd5ALDR(KdlaH))</span><br><span class="line">	fmt.Scanf(<span class="string">&quot;%20s&quot;</span>, &amp;CuSkl)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Second Scanf: %s\n&quot;</span>, CuSkl)</span><br><span class="line">	vNvUO := GwSqNHQ7dPXpIG64(nFAzj)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;vNvUO %s\n&quot;</span>, vNvUO)</span><br><span class="line">	YJCya := <span class="string">&quot;&quot;</span></span><br><span class="line">	mvOxK := YI3z8ZxOKhfLmTPC(CuSkl)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;mvOxK %s\n&quot;</span>, mvOxK)</span><br><span class="line">	<span class="keyword">if</span> mvOxK != <span class="literal">nil</span> &#123;</span><br><span class="line">		YJCya = mvOxK()</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> YJCya != <span class="string">&quot;&quot;</span> &amp;&amp; vNvUO != <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;flag&#123;%s%s&#125;\n&quot;</span>, vNvUO, YJCya)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Input the first function, which has <span class="number">6</span> parameters and the third named gLIhR: </span><br><span class="line">ZlXDJkH3OZN4Mayd</span><br><span class="line">First scanf: ZlXDJkH3OZN4Mayd</span><br><span class="line">Input the second function, which has <span class="number">3</span> callers and invokes the function named cHZv5op8rOmlAkb6:</span><br><span class="line">YsMgm9rKB7qiuQ1d</span><br><span class="line">Second Scanf: YsMgm9rKB7qiuQ1d</span><br><span class="line">vNvUO <span class="number">3</span>a4e76449355c414</span><br><span class="line"></span><br><span class="line">mvOxK %!s(main.dIWKr=<span class="number">0x877d80</span>)</span><br><span class="line">flag&#123;<span class="number">3</span>a4e76449355c4148ce3da2b46019f75&#125;</span><br></pre></td></tr></table></figure>

<h2 id="whereiscode"><a href="#whereiscode" class="headerlink" title="whereiscode"></a>whereiscode</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/08/30/test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/30/test/" class="post-title-link" itemprop="url">test</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-08-30 19:21:57" itemprop="dateCreated datePublished" datetime="2022-08-30T19:21:57+08:00">2022-08-30</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/08/02/qwb2022/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/02/qwb2022/" class="post-title-link" itemprop="url">qwb2022</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-08-02 00:52:33" itemprop="dateCreated datePublished" datetime="2022-08-02T00:52:33+08:00">2022-08-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-30 16:21:51" itemprop="dateModified" datetime="2022-08-30T16:21:51+08:00">2022-08-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="qwb2022"><a href="#qwb2022" class="headerlink" title="qwb2022"></a>qwb2022</h1><p>这次还是很坐牢，但跟师傅们学习到了很多方法</p>
<h2 id="deeprev"><a href="#deeprev" class="headerlink" title="deeprev"></a>deeprev</h2><p>我们会发现，这个题给了个libsecret.so文件和deeprev文件，deeprev里很清楚，只要check函数等于0就行，但在程序中根本找不到check函数。经搜索发现是GoogleCTF改编题，直接跑下面脚本，把关于flag的运算直接跑出来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Author: hgarrereyn</span></span><br><span class="line"><span class="comment"># Desc: Lifter solution for GoogleCTF 2022 eldar</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lief</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Any</span></span><br><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">md = Cs(CS_ARCH_X86, CS_MODE_64)</span><br><span class="line"></span><br><span class="line">b = <span class="literal">None</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    b = lief.ELF.parse(<span class="string">&#x27;./deeprev&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&#x27;Must have the ./eldar binary in cwd&#x27;</span>)</span><br><span class="line"></span><br><span class="line">rela = [x <span class="keyword">for</span> x <span class="keyword">in</span> b.sections <span class="keyword">if</span> x.name == <span class="string">&#x27;.rela.dyn&#x27;</span>][<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(rela)</span><br><span class="line">dynsym = [x <span class="keyword">for</span> x <span class="keyword">in</span> b.sections <span class="keyword">if</span> x.name == <span class="string">&#x27;.dynsym&#x27;</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Symbol</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    idx: <span class="built_in">int</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;s<span class="subst">&#123;self.idx&#125;</span>&#x27;</span></span><br><span class="line">        </span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Reloc</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    idx: <span class="built_in">int</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;r<span class="subst">&#123;self.idx&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Ref</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    val: <span class="type">Any</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;&amp;<span class="subst">&#123;self.val&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SymAddr</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    sym: Symbol</span><br><span class="line">    field: <span class="built_in">str</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;self.sym&#125;</span>.<span class="subst">&#123;self.field&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RelocAddr</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    reloc: Reloc</span><br><span class="line">    field: <span class="built_in">str</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;self.reloc&#125;</span>.<span class="subst">&#123;self.field&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">vaddr</span>(<span class="params">self</span>):</span><br><span class="line">        off = <span class="number">0</span></span><br><span class="line">        match self.field:</span><br><span class="line">            case <span class="string">&#x27;r_address&#x27;</span>:off = <span class="number">0</span></span><br><span class="line">            case <span class="string">&#x27;r_info&#x27;</span>: off = <span class="number">8</span></span><br><span class="line">            case <span class="string">&#x27;r_addend&#x27;</span>: off = <span class="number">16</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> (self.reloc.idx * <span class="number">24</span>) + off + rela.virtual_address</span><br><span class="line">    </span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FlagAddr</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    idx: <span class="built_in">int</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;flag[<span class="subst">&#123;self.idx&#125;</span>]&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OutAddr</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    idx: <span class="built_in">int</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;out[<span class="subst">&#123;self.idx&#125;</span>]&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ArrAddr</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    idx: <span class="built_in">int</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;arr[<span class="subst">&#123;self.idx&#125;</span>]&#x27;</span></span><br><span class="line"></span><br><span class="line">BaseAddr = namedtuple(<span class="string">&#x27;baseaddr&#x27;</span>, [])</span><br><span class="line">FailAddr = namedtuple(<span class="string">&#x27;fail&#x27;</span>, [])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">format_addr</span>(<span class="params">addr: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">if</span> addr &gt;= rela.virtual_address <span class="keyword">and</span> addr &lt; rela.virtual_address + rela.size:</span><br><span class="line">        offset = addr - rela.virtual_address</span><br><span class="line">        r_offset = (offset // <span class="number">24</span>)</span><br><span class="line">        r_rem = offset % <span class="number">24</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> r_offset &gt;= <span class="number">3</span> <span class="keyword">and</span> r_offset &lt;= <span class="number">88</span>:</span><br><span class="line">            arr_idx = (r_offset - <span class="number">3</span>) * <span class="number">3</span> + (r_rem // <span class="number">8</span>)</span><br><span class="line">            <span class="keyword">return</span> ArrAddr(arr_idx)</span><br><span class="line">        <span class="keyword">elif</span> r_offset == <span class="number">89</span>:</span><br><span class="line">            <span class="keyword">return</span> OutAddr(r_rem)</span><br><span class="line">        </span><br><span class="line">        match r_rem:</span><br><span class="line">            case <span class="number">0</span>: <span class="keyword">return</span> RelocAddr(Reloc(r_offset), <span class="string">&#x27;r_address&#x27;</span>)</span><br><span class="line">            case <span class="number">8</span>: <span class="keyword">return</span> RelocAddr(Reloc(r_offset), <span class="string">&#x27;r_info&#x27;</span>)</span><br><span class="line">            case <span class="number">16</span>: <span class="keyword">return</span> RelocAddr(Reloc(r_offset), <span class="string">&#x27;r_addend&#x27;</span>)</span><br><span class="line">            case _: <span class="keyword">return</span> RelocAddr(Reloc(r_offset), r_rem)</span><br><span class="line">    <span class="keyword">elif</span> addr &gt; dynsym.virtual_address <span class="keyword">and</span> addr &lt; dynsym.virtual_address + dynsym.size:</span><br><span class="line">        offset = addr - dynsym.virtual_address</span><br><span class="line">        r_offset = (offset // <span class="number">24</span>)</span><br><span class="line">        r_rem = offset % <span class="number">24</span></span><br><span class="line">        </span><br><span class="line">        match r_rem:</span><br><span class="line">            case <span class="number">0</span>: <span class="keyword">return</span> SymAddr(Symbol(r_offset), <span class="string">&#x27;st_name&#x27;</span>)</span><br><span class="line">            case <span class="number">8</span>: <span class="keyword">return</span> Symbol(r_offset)</span><br><span class="line">            case <span class="number">16</span>: <span class="keyword">return</span> SymAddr(Symbol(r_offset), <span class="string">&#x27;st_size&#x27;</span>)</span><br><span class="line">            case _: <span class="keyword">return</span> SymAddr(Symbol(r_offset), r_rem)</span><br><span class="line">    <span class="keyword">elif</span> addr &gt;= <span class="number">0x404040</span> <span class="keyword">and</span> addr &lt; <span class="number">0x404040</span>+<span class="number">33</span>:</span><br><span class="line">        off = addr-<span class="number">0x404040</span></span><br><span class="line">        <span class="keyword">return</span> FlagAddr(off)</span><br><span class="line">    <span class="keyword">elif</span> addr == <span class="number">0x804000</span>:</span><br><span class="line">        <span class="keyword">return</span> BaseAddr()</span><br><span class="line">    <span class="keyword">elif</span> addr == <span class="number">0x404064</span>:</span><br><span class="line">        <span class="keyword">return</span> FailAddr()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> addr</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_sym</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(name) == <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> Symbol(<span class="built_in">ord</span>(name[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">Rel = namedtuple(<span class="string">&#x27;REL&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>,<span class="string">&#x27;val&#x27;</span>,<span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line">Copy = namedtuple(<span class="string">&#x27;CPY&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>, <span class="string">&#x27;symbol&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line">R64 = namedtuple(<span class="string">&#x27;R64&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>,<span class="string">&#x27;symbol&#x27;</span>,<span class="string">&#x27;addend&#x27;</span>,<span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line">R32 = namedtuple(<span class="string">&#x27;R32&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>,<span class="string">&#x27;symbol&#x27;</span>,<span class="string">&#x27;addend&#x27;</span>,<span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">b</span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[*] Loading relocations...&#x27;</span>)</span><br><span class="line">    relocs = <span class="built_in">list</span>(b.relocations)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[*] Parsing...&#x27;</span>)</span><br><span class="line">    instructions = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="built_in">len</span>(relocs)):</span><br><span class="line">        r = relocs[i]</span><br><span class="line">        match r.<span class="built_in">type</span>:</span><br><span class="line">            case <span class="number">1</span>: <span class="comment"># R64</span></span><br><span class="line">                instructions.append(R64(format_addr(r.address), to_sym(r.symbol.name), format_addr(r.addend), i))</span><br><span class="line">            case <span class="number">5</span>: <span class="comment"># CPY</span></span><br><span class="line">                instructions.append(Copy(format_addr(r.address), to_sym(r.symbol.name), i))</span><br><span class="line">            case <span class="number">8</span>: <span class="comment"># REL</span></span><br><span class="line">                instructions.append(Rel(format_addr(r.address), format_addr(r.addend), i))</span><br><span class="line">            case <span class="number">10</span>: <span class="comment"># R32</span></span><br><span class="line">                instructions.append(R32(format_addr(r.address), to_sym(r.symbol.name), format_addr(r.addend), i))</span><br><span class="line">                </span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Mov = namedtuple(<span class="string">&#x27;mov&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;sz&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line">Add = namedtuple(<span class="string">&#x27;add&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;addend&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_mov_add</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    sizes = []</span><br><span class="line">    curr = [<span class="number">8</span>] * <span class="number">8</span></span><br><span class="line">    sizes.append(curr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> instr <span class="keyword">in</span> instructions:</span><br><span class="line">        c = <span class="built_in">list</span>(curr)</span><br><span class="line">        match instr:</span><br><span class="line">            case Rel(SymAddr(Symbol(idx), <span class="string">&#x27;st_size&#x27;</span>), val, ridx):</span><br><span class="line">                c[idx] = val</span><br><span class="line">        sizes.append(c)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx]:</span><br><span class="line">            case Rel(dst, val, ridx):</span><br><span class="line">                instructions[idx] = Mov(dst, Ref(val), <span class="number">8</span>, ridx)</span><br><span class="line">            case Copy(dst, sym, ridx):</span><br><span class="line">                instructions[idx] = Mov(dst, sym, sizes[idx][sym.idx], ridx)</span><br><span class="line">            case R64(dst, sym, add, ridx):</span><br><span class="line">                instructions[idx] = Add(dst, sym, add, ridx)</span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove_sizes</span>(<span class="params">instructions</span>):</span><br><span class="line">    <span class="comment"># Sizes are now nops</span></span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx]:</span><br><span class="line">            case Mov(SymAddr(Symbol(s), <span class="string">&#x27;st_size&#x27;</span>), _, _, _) <span class="keyword">if</span> s != <span class="number">3</span>:</span><br><span class="line">                instructions[idx:idx+<span class="number">1</span>] = []</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_indirect</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">3</span>]:</span><br><span class="line">            case [</span><br><span class="line">                Mov(RelocAddr(Reloc(rel_1), <span class="string">&#x27;r_addend&#x27;</span>), Symbol(sidx_1), sz_1, ridx_1),</span><br><span class="line">                Add(dst_2, sym_2, _, ridx_2),</span><br><span class="line">                Mov(RelocAddr(Reloc(rel_3), <span class="string">&#x27;r_addend&#x27;</span>), Ref(<span class="number">0</span>), sz_3, _),</span><br><span class="line">            ] <span class="keyword">if</span> (</span><br><span class="line">                (rel_1 == ridx_2) <span class="keyword">and</span> (rel_3 == ridx_2)</span><br><span class="line">            ):</span><br><span class="line">                instructions[idx:idx+<span class="number">3</span>] = [</span><br><span class="line">                    Add(dst_2, sym_2, Symbol(sidx_1), ridx_1)</span><br><span class="line">                ]</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Block = namedtuple(<span class="string">&#x27;block&#x27;</span>, [<span class="string">&#x27;arr&#x27;</span>, <span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line">Output = namedtuple(<span class="string">&#x27;output&#x27;</span>, [<span class="string">&#x27;out&#x27;</span>, <span class="string">&#x27;arr&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_block</span>(<span class="params">instructions</span>):</span><br><span class="line"> </span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">18</span>]:</span><br><span class="line">            case [</span><br><span class="line">                Mov(_,arr,_,ridx),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,flag,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                R32(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">            ]:</span><br><span class="line">                instructions[idx:idx+<span class="number">18</span>] = [</span><br><span class="line">                    Block(arr, flag, ridx)</span><br><span class="line">                ]</span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Reset = namedtuple(<span class="string">&#x27;reset&#x27;</span>, [<span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line">ShuffleBlock = namedtuple(<span class="string">&#x27;shuffleblock&#x27;</span>, [<span class="string">&#x27;f1&#x27;</span>, <span class="string">&#x27;f2&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_reset</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions) - <span class="number">256</span>:</span><br><span class="line">        good = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            op = instructions[idx+i]</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">type</span>(op) == Mov:</span><br><span class="line">                dst, src, _, _ = op</span><br><span class="line">                <span class="keyword">if</span> dst != ArrAddr(i) <span class="keyword">or</span> src != Ref(i):</span><br><span class="line">                    good = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                good = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> good:</span><br><span class="line">            instructions[idx:idx+<span class="number">256</span>] = [Reset(instructions[idx].ridx)]</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_shuffle_block</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions) - <span class="number">256</span>:</span><br><span class="line">        good = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            op = instructions[idx+i]</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">type</span>(op) == Block:</span><br><span class="line">                arr, flag, ridx = op</span><br><span class="line">                <span class="keyword">if</span> arr != Ref(ArrAddr(i)):</span><br><span class="line">                    good = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                good = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> good:</span><br><span class="line">            instructions[idx:idx+<span class="number">256</span>] = [ShuffleBlock(instructions[idx].flag, instructions[idx+<span class="number">1</span>].flag, instructions[idx].ridx)]</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Output = namedtuple(<span class="string">&#x27;output&#x27;</span>, [<span class="string">&#x27;out&#x27;</span>, <span class="string">&#x27;arr&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_output</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">26</span>]:</span><br><span class="line">            case [</span><br><span class="line">                Mov(_,arr,_,ridx),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                R32(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                R32(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(out,_,_,_),</span><br><span class="line">            ]:</span><br><span class="line">                instructions[idx:idx+<span class="number">26</span>] = [Output(out, arr, ridx)]</span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">MultAdd = namedtuple(<span class="string">&#x27;multadd&#x27;</span>, [<span class="string">&#x27;out&#x27;</span>, <span class="string">&#x27;val&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_multadd</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">3</span>]:</span><br><span class="line">            <span class="comment"># block prefix</span></span><br><span class="line">            case [</span><br><span class="line">                Mov(Symbol(<span class="number">2</span>), out, _, ridx),</span><br><span class="line">                Mov(Symbol(<span class="number">5</span>), Symbol(<span class="number">2</span>), _, _),</span><br><span class="line">                Mov(Symbol(<span class="number">6</span>), Ref(<span class="number">0</span>), _, _),</span><br><span class="line">            ]:</span><br><span class="line">                k = <span class="number">0</span></span><br><span class="line">                double = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">                ptr = idx + <span class="number">3</span></span><br><span class="line"></span><br><span class="line">                good = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">while</span> ptr &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">                    match instructions[ptr]:</span><br><span class="line">                        case Mov(Symbol(<span class="number">2</span>), Ref(Symbol(<span class="number">6</span>)), _, _):</span><br><span class="line">                            double = <span class="literal">True</span></span><br><span class="line">                        case Mov(Symbol(<span class="number">2</span>), Ref(Symbol(<span class="number">5</span>)), _, _):</span><br><span class="line">                            double = <span class="literal">False</span></span><br><span class="line">                        case Add(Symbol(<span class="number">6</span>), Symbol(<span class="number">6</span>), Symbol(<span class="number">2</span>), _):</span><br><span class="line">                            k = (k * <span class="number">2</span>) <span class="keyword">if</span> double <span class="keyword">else</span> (k + <span class="number">1</span>)</span><br><span class="line">                        case Add(Symbol(<span class="number">7</span>), Symbol(<span class="number">7</span>), Symbol(<span class="number">2</span>), _):</span><br><span class="line">                            ptr += <span class="number">1</span></span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        case _:</span><br><span class="line">                            good = <span class="literal">False</span></span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">                    ptr += <span class="number">1</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> good:</span><br><span class="line">                    instructions[idx:ptr] = [</span><br><span class="line">                        MultAdd(Symbol(<span class="number">7</span>), out, k, ridx)</span><br><span class="line">                    ]</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Trunc = namedtuple(<span class="string">&#x27;trunc&#x27;</span>, [<span class="string">&#x27;val&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_truncate</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">2</span>]:</span><br><span class="line">            case [</span><br><span class="line">                Mov(Symbol(<span class="number">2</span>), Ref(SymAddr(Symbol(<span class="number">5</span>), <span class="number">11</span>)), _, ridx),</span><br><span class="line">                Mov(SymAddr(Symbol(<span class="number">7</span>), <span class="number">11</span>), Symbol(<span class="number">2</span>), <span class="number">5</span>, _)</span><br><span class="line">            ]:</span><br><span class="line">                instructions[idx:idx+<span class="number">2</span>] = [</span><br><span class="line">                    Trunc(Symbol(<span class="number">7</span>), <span class="number">0xffffff</span>, ridx)]</span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">ArraySlots = namedtuple(<span class="string">&#x27;arr&#x27;</span>, [<span class="string">&#x27;values&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_array_slots</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx]:</span><br><span class="line">            case Mov(BaseAddr(), Ref(<span class="number">0</span>), _, ridx):</span><br><span class="line">                ptr = idx+<span class="number">1</span></span><br><span class="line">                <span class="keyword">while</span> ptr &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">                    op = instructions[ptr]</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">type</span>(op) != Mov <span class="keyword">or</span> op.dst != BaseAddr():</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    ptr += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                start = idx</span><br><span class="line">                end = ptr</span><br><span class="line"></span><br><span class="line">                data = []</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Check for movs into array.</span></span><br><span class="line">                vstart = RelocAddr(Reloc(ridx), <span class="string">&#x27;r_address&#x27;</span>).vaddr()</span><br><span class="line">                offset = <span class="number">0</span></span><br><span class="line">                <span class="keyword">while</span> end + offset &lt; <span class="built_in">len</span>(instructions) <span class="keyword">and</span> offset &lt; ((end - start) * <span class="number">3</span>):</span><br><span class="line">                    op = instructions[end + offset]</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">type</span>(op) == Mov <span class="keyword">and</span> <span class="built_in">type</span>(op.dst) <span class="keyword">is</span> RelocAddr <span class="keyword">and</span> op.dst.vaddr() == vstart + (offset * <span class="number">8</span>):</span><br><span class="line">                        data.append(op.src.val)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    offset += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(data) &gt; <span class="number">0</span>:</span><br><span class="line">                    data += [<span class="number">0</span>] * (((end - start) * <span class="number">3</span>) - <span class="built_in">len</span>(data))   </span><br><span class="line">                    instructions[idx:end+offset] = [</span><br><span class="line">                        ArraySlots(data, ridx)</span><br><span class="line">                    ]</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Shellcode = namedtuple(<span class="string">&#x27;shellcode&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>, <span class="string">&#x27;code&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_shellcode</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">6</span>]:</span><br><span class="line">            case [</span><br><span class="line">                ArraySlots(values, ridx),</span><br><span class="line">                Mov(Symbol(<span class="number">3</span>), Ref(RelocAddr(Reloc(rel2), <span class="string">&#x27;r_address&#x27;</span>)), _, _),</span><br><span class="line">                Mov(SymAddr(Symbol(<span class="number">3</span>), <span class="string">&#x27;st_name&#x27;</span>), _, _, _),</span><br><span class="line">                Add(dst, Symbol(<span class="number">3</span>), _, _),</span><br><span class="line">                Mov(Symbol(<span class="number">2</span>), _, _, _),</span><br><span class="line">                Mov(RelocAddr(Reloc(rel6), <span class="string">&#x27;r_address&#x27;</span>), Symbol(<span class="number">2</span>), _, _)</span><br><span class="line">            ] <span class="keyword">if</span> (rel2 == ridx) <span class="keyword">and</span> (rel6 == ridx):</span><br><span class="line">                instructions[idx:idx+<span class="number">6</span>] = [</span><br><span class="line">                    Shellcode(dst, <span class="string">b&#x27;&#x27;</span>.join([(x &amp; <span class="number">0xffffffffffffffff</span>).to_bytes(<span class="number">8</span>, <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> values]), ridx)</span><br><span class="line">                ]</span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Aop = namedtuple(<span class="string">&#x27;aop&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>, <span class="string">&#x27;op&#x27;</span>, <span class="string">&#x27;val&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_aop</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">5</span>]:</span><br><span class="line">            case [</span><br><span class="line">                Mov(Symbol(<span class="number">2</span>), val, _, ridx),</span><br><span class="line">                Mov(Symbol(<span class="number">5</span>), Symbol(<span class="number">2</span>), _, _),</span><br><span class="line">                Shellcode(_, data, _),</span><br><span class="line">                Mov(Symbol(<span class="number">2</span>), Ref(Symbol(<span class="number">5</span>)), _, _),</span><br><span class="line">                Add(dst, dst2, Symbol(<span class="number">2</span>), _)</span><br><span class="line">            ] <span class="keyword">if</span> <span class="built_in">len</span>(data) == <span class="number">24</span> <span class="keyword">and</span> (dst == dst2):</span><br><span class="line">                op = <span class="built_in">next</span>(md.disasm(data, <span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">                t = op.mnemonic</span><br><span class="line">                k = <span class="built_in">int</span>(op.op_str.split(<span class="string">&#x27;, &#x27;</span>)[-<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">                instructions[idx:idx+<span class="number">5</span>] = [</span><br><span class="line">                    Aop(dst, t, val, k, ridx)</span><br><span class="line">                ]</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">instructions</span>):</span><br><span class="line">    <span class="keyword">for</span> op <span class="keyword">in</span> instructions:</span><br><span class="line">        match op:</span><br><span class="line">            case Mov(SymAddr(sym, <span class="string">&#x27;st_name&#x27;</span>), Ref(val), <span class="number">8</span>, ridx) <span class="keyword">if</span> <span class="built_in">type</span>(val) <span class="keyword">is</span> <span class="built_in">int</span>:</span><br><span class="line">                name = val &amp; <span class="number">0xffffffff</span></span><br><span class="line">                info = (val &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xff</span></span><br><span class="line">                other = (val &gt;&gt; <span class="number">5</span>) &amp; <span class="number">0xff</span></span><br><span class="line">                shndx = (val &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0xffff</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: setinfo <span class="subst">&#123;sym&#125;</span>, name=0x<span class="subst">&#123;name:x&#125;</span>, info=0x<span class="subst">&#123;info:x&#125;</span>, other=0x<span class="subst">&#123;other:x&#125;</span>, shndx=0x<span class="subst">&#123;shndx:x&#125;</span>&#x27;</span>)</span><br><span class="line">            case Mov(BaseAddr(), Ref(<span class="number">0</span>), _, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: [ARRAY SLOT]&#x27;</span>)</span><br><span class="line">            case Mov(dst, src, <span class="number">8</span>, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: mov <span class="subst">&#123;dst&#125;</span>, <span class="subst">&#123;src&#125;</span>&#x27;</span>)</span><br><span class="line">            case Mov(dst, src, sz, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: mov(<span class="subst">&#123;sz&#125;</span>) <span class="subst">&#123;dst&#125;</span>, <span class="subst">&#123;src&#125;</span>&#x27;</span>)</span><br><span class="line">            case Add(dst, src, add, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: add <span class="subst">&#123;dst&#125;</span>, <span class="subst">&#123;src&#125;</span>, <span class="subst">&#123;add&#125;</span>&#x27;</span>)</span><br><span class="line">            case R32(dst, src, add, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: r32 <span class="subst">&#123;dst&#125;</span>, <span class="subst">&#123;src&#125;</span>, <span class="subst">&#123;add&#125;</span>&#x27;</span>)</span><br><span class="line">            case Block(arr, flag, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: shuffle <span class="subst">&#123;arr&#125;</span>, <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">            case Output(out, arr, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: output <span class="subst">&#123;out&#125;</span>, <span class="subst">&#123;arr&#125;</span>&#x27;</span>)</span><br><span class="line">            case ShuffleBlock(f1, f2, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: shuffleblock <span class="subst">&#123;f1&#125;</span>, <span class="subst">&#123;f2&#125;</span>&#x27;</span>)</span><br><span class="line">            case MultAdd(dst, val, k, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: madd <span class="subst">&#123;dst&#125;</span> += (<span class="subst">&#123;val&#125;</span> * <span class="subst">&#123;k&#125;</span>)&#x27;</span>)</span><br><span class="line">            case Aop(dst, op, val, k, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: aop <span class="subst">&#123;dst&#125;</span> += (<span class="subst">&#123;val&#125;</span> <span class="subst">&#123;op&#125;</span> <span class="subst">&#123;k&#125;</span>)&#x27;</span>)</span><br><span class="line">            case Reset(ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: reset&#x27;</span>)</span><br><span class="line">            case Trunc(val, k, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: trunc <span class="subst">&#123;val&#125;</span> &amp;= 0x<span class="subst">&#123;k:x&#125;</span>&#x27;</span>)</span><br><span class="line">            case ArraySlots(values, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: array [<span class="subst">&#123;<span class="string">&quot;, &quot;</span>.join([<span class="built_in">hex</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> values])&#125;</span>]&#x27;</span>)</span><br><span class="line">            case Shellcode(dst, code, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: exec <span class="subst">&#123;dst&#125;</span> &lt;- <span class="subst">&#123;code.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">20</span>)</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> md.disasm(code, <span class="number">0</span>):</span><br><span class="line">                    <span class="keyword">if</span> i.mnemonic == <span class="string">&#x27;ret&#x27;</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;    0x%x:\t%s\t%s&quot;</span> %(i.address, i.mnemonic, i.op_str.replace(<span class="string">&#x27;0x8040e4&#x27;</span>, <span class="string">&#x27;s5&#x27;</span>).replace(<span class="string">&#x27;0x8040cc&#x27;</span>, <span class="string">&#x27;s4&#x27;</span>)))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">20</span>)</span><br><span class="line">            case _:</span><br><span class="line">                <span class="built_in">print</span>(op)</span><br><span class="line"></span><br><span class="line">LIFTS = [</span><br><span class="line">    lift_mov_add,</span><br><span class="line">    remove_sizes,</span><br><span class="line">    lift_indirect,</span><br><span class="line">    lift_block,</span><br><span class="line">    lift_reset,</span><br><span class="line">    lift_shuffle_block,</span><br><span class="line">    lift_output,</span><br><span class="line">    lift_multadd,</span><br><span class="line">    lift_truncate,</span><br><span class="line">    lift_array_slots,</span><br><span class="line">    lift_shellcode,</span><br><span class="line">    lift_aop,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift</span>(<span class="params">instructions</span>):</span><br><span class="line">    <span class="keyword">for</span> lift_fn <span class="keyword">in</span> LIFTS:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;[*] <span class="subst">&#123;lift_fn.__name__&#125;</span>...&#x27;</span>)</span><br><span class="line">        instructions = lift_fn(instructions)</span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">instructions = parse(b)</span><br><span class="line">instructions = lift(instructions)</span><br><span class="line">dump(instructions)</span><br></pre></td></tr></table></figure>

<p>然后得到下面的类似汇编，甚至还有机器码。</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br></pre></td><td class="code"><pre><span class="line">[0005] :: mov s2, &amp;flag[0]</span><br><span class="line">[0007] :: mov(1) s4, s2</span><br><span class="line">[0008] :: [ARRAY SLOT]</span><br><span class="line">[0009] :: mov arr[15], &amp;1585408084625667200</span><br><span class="line">[0010] :: mov arr[16], &amp;195</span><br><span class="line">[0011] :: mov s3, &amp;arr[15]</span><br><span class="line">[0012] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0013] :: add arr[15], s3, 0</span><br><span class="line">[0014] :: mov s2, &amp;r101002.r_address</span><br><span class="line">[0016] :: mov(24) arr[15], s2</span><br><span class="line">[0017] :: [ARRAY SLOT]</span><br><span class="line">[0018] :: mov arr[42], &amp;141015791240320</span><br><span class="line">[0019] :: mov arr[43], &amp;195</span><br><span class="line">[0020] :: mov s3, &amp;arr[42]</span><br><span class="line">[0021] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0022] :: add arr[42], s3, 0</span><br><span class="line">[0023] :: mov arr[42], s2</span><br><span class="line">[0024] :: mov s2, &amp;s4</span><br><span class="line">[0026] :: mov(1) arr[0], s2</span><br><span class="line">[0027] :: mov s2, &amp;flag[1]</span><br><span class="line">[0028] :: mov s4, s2</span><br><span class="line">[0029] :: [ARRAY SLOT]</span><br><span class="line">[0030] :: mov arr[78], &amp;1657465678663595136</span><br><span class="line">[0031] :: mov arr[79], &amp;195</span><br><span class="line">[0032] :: mov s3, &amp;arr[78]</span><br><span class="line">[0033] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0034] :: add arr[78], s3, 0</span><br><span class="line">[0035] :: mov s2, &amp;r101002.r_address</span><br><span class="line">[0037] :: mov(24) arr[78], s2</span><br><span class="line">[0038] :: [ARRAY SLOT]</span><br><span class="line">[0039] :: mov arr[105], &amp;72198609829168256</span><br><span class="line">[0040] :: mov arr[106], &amp;195</span><br><span class="line">[0041] :: mov s3, &amp;arr[105]</span><br><span class="line">[0042] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0043] :: add arr[105], s3, 0</span><br><span class="line">[0044] :: mov arr[105], s2</span><br><span class="line">[0045] :: mov s2, &amp;s4</span><br><span class="line">[0047] :: mov(1) arr[0], s2</span><br><span class="line">[0048] :: mov s2, &amp;flag[2]</span><br><span class="line">[0049] :: mov s4, s2</span><br><span class="line">[0050] :: [ARRAY SLOT]</span><br><span class="line">[0051] :: mov arr[141], &amp;1153062520398099584</span><br><span class="line">[0052] :: mov arr[142], &amp;195</span><br><span class="line">[0053] :: mov s3, &amp;arr[141]</span><br><span class="line">[0054] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0055] :: add arr[141], s3, 0</span><br><span class="line">[0056] :: mov s2, &amp;r101002.r_address</span><br><span class="line">[0058] :: mov(24) arr[141], s2</span><br><span class="line">[0059] :: [ARRAY SLOT]</span><br><span class="line">[0060] :: mov arr[168], &amp;144256203867096192</span><br><span class="line">[0061] :: mov arr[169], &amp;195</span><br><span class="line">[0062] :: mov s3, &amp;arr[168]</span><br><span class="line">[0063] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0064] :: add arr[168], s3, 0</span><br><span class="line">[0065] :: mov arr[168], s2</span><br><span class="line">[0066] :: mov s2, &amp;s4</span><br><span class="line">[0068] :: mov(1) arr[0], s2</span><br><span class="line">[0069] :: mov s2, &amp;flag[3]</span><br><span class="line">[0070] :: mov s4, s2</span><br><span class="line">[0071] :: [ARRAY SLOT]</span><br><span class="line">[0072] :: mov arr[204], &amp;1297177708473955456</span><br><span class="line">[0073] :: mov arr[205], &amp;195</span><br><span class="line">[0074] :: mov s3, &amp;arr[204]</span><br><span class="line">[0075] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0076] :: add arr[204], s3, 0</span><br><span class="line">[0077] :: mov s2, &amp;r101002.r_address</span><br><span class="line">[0079] :: mov(24) arr[204], s2</span><br><span class="line">[0080] :: [ARRAY SLOT]</span><br><span class="line">[0081] :: mov arr[231], &amp;216313797905024128</span><br><span class="line">[0082] :: mov arr[232], &amp;195</span><br><span class="line">[0083] :: mov s3, &amp;arr[231]</span><br><span class="line">[0084] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0085] :: add arr[231], s3, 0</span><br><span class="line">[0086] :: mov arr[231], s2</span><br><span class="line">[0087] :: mov s2, &amp;s4</span><br><span class="line">[0089] :: mov(1) arr[0], s2</span><br><span class="line">[0090] :: mov s2, &amp;flag[4]</span><br><span class="line">[0091] :: mov s4, s2</span><br><span class="line">[0092] :: exec r92.r_address &lt;- 803425cc40800010c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x10</span><br><span class="line">--------------------</span><br><span class="line">[0101] :: array [0x4008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0104] :: mov s3, &amp;r101.r_address</span><br><span class="line">[0105] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0106] :: add r101.r_address, s3, 0</span><br><span class="line">[0107] :: mov r101.r_address, s2</span><br><span class="line">[0108] :: mov s2, &amp;s4</span><br><span class="line">[0110] :: mov(1) arr[0], s2</span><br><span class="line">[0111] :: mov s2, &amp;flag[5]</span><br><span class="line">[0112] :: mov s4, s2</span><br><span class="line">[0113] :: exec r113.r_address &lt;- 803425cc40800011c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x11</span><br><span class="line">--------------------</span><br><span class="line">[0122] :: array [0x5008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0125] :: mov s3, &amp;r122.r_address</span><br><span class="line">[0126] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0127] :: add r122.r_address, s3, 0</span><br><span class="line">[0128] :: mov r122.r_address, s2</span><br><span class="line">[0129] :: mov s2, &amp;s4</span><br><span class="line">[0131] :: mov(1) arr[0], s2</span><br><span class="line">[0132] :: mov s2, &amp;flag[6]</span><br><span class="line">[0133] :: mov s4, s2</span><br><span class="line">[0134] :: exec r134.r_address &lt;- 803425cc40800012c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x12</span><br><span class="line">--------------------</span><br><span class="line">[0143] :: array [0x6008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0146] :: mov s3, &amp;r143.r_address</span><br><span class="line">[0147] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0148] :: add r143.r_address, s3, 0</span><br><span class="line">[0149] :: mov r143.r_address, s2</span><br><span class="line">[0150] :: mov s2, &amp;s4</span><br><span class="line">[0152] :: mov(1) arr[0], s2</span><br><span class="line">[0153] :: mov s2, &amp;flag[7]</span><br><span class="line">[0154] :: mov s4, s2</span><br><span class="line">[0155] :: exec r155.r_address &lt;- 803425cc40800013c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x13</span><br><span class="line">--------------------</span><br><span class="line">[0164] :: array [0x7008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0167] :: mov s3, &amp;r164.r_address</span><br><span class="line">[0168] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0169] :: add r164.r_address, s3, 0</span><br><span class="line">[0170] :: mov r164.r_address, s2</span><br><span class="line">[0171] :: mov s2, &amp;s4</span><br><span class="line">[0173] :: mov(1) arr[0], s2</span><br><span class="line">[0174] :: mov s2, &amp;flag[8]</span><br><span class="line">[0175] :: mov s4, s2</span><br><span class="line">[0176] :: exec r176.r_address &lt;- 803425cc40800014c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x14</span><br><span class="line">--------------------</span><br><span class="line">[0185] :: array [0x8008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0188] :: mov s3, &amp;r185.r_address</span><br><span class="line">[0189] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0190] :: add r185.r_address, s3, 0</span><br><span class="line">[0191] :: mov r185.r_address, s2</span><br><span class="line">[0192] :: mov s2, &amp;s4</span><br><span class="line">[0194] :: mov(1) arr[1], s2</span><br><span class="line">[0195] :: mov s2, &amp;flag[9]</span><br><span class="line">[0196] :: mov s4, s2</span><br><span class="line">[0197] :: exec r197.r_address &lt;- 803425cc40800015c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x15</span><br><span class="line">--------------------</span><br><span class="line">[0206] :: array [0x9008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0209] :: mov s3, &amp;r206.r_address</span><br><span class="line">[0210] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0211] :: add r206.r_address, s3, 0</span><br><span class="line">[0212] :: mov r206.r_address, s2</span><br><span class="line">[0213] :: mov s2, &amp;s4</span><br><span class="line">[0215] :: mov(1) arr[1], s2</span><br><span class="line">[0216] :: mov s2, &amp;flag[10]</span><br><span class="line">[0217] :: mov s4, s2</span><br><span class="line">[0218] :: exec r218.r_address &lt;- 803425cc40800016c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x16</span><br><span class="line">--------------------</span><br><span class="line">[0227] :: array [0xa008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0230] :: mov s3, &amp;r227.r_address</span><br><span class="line">[0231] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0232] :: add r227.r_address, s3, 0</span><br><span class="line">[0233] :: mov r227.r_address, s2</span><br><span class="line">[0234] :: mov s2, &amp;s4</span><br><span class="line">[0236] :: mov(1) arr[1], s2</span><br><span class="line">[0237] :: mov s2, &amp;flag[11]</span><br><span class="line">[0238] :: mov s4, s2</span><br><span class="line">[0239] :: exec r239.r_address &lt;- 803425cc40800017c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x17</span><br><span class="line">--------------------</span><br><span class="line">[0248] :: array [0xb008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0251] :: mov s3, &amp;r248.r_address</span><br><span class="line">[0252] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0253] :: add r248.r_address, s3, 0</span><br><span class="line">[0254] :: mov r248.r_address, s2</span><br><span class="line">[0255] :: mov s2, &amp;s4</span><br><span class="line">[0257] :: mov(1) arr[1], s2</span><br><span class="line">[0258] :: mov s2, &amp;flag[12]</span><br><span class="line">[0259] :: mov s4, s2</span><br><span class="line">[0260] :: exec r260.r_address &lt;- 803425cc40800018c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x18</span><br><span class="line">--------------------</span><br><span class="line">[0269] :: array [0xc008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0272] :: mov s3, &amp;r269.r_address</span><br><span class="line">[0273] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0274] :: add r269.r_address, s3, 0</span><br><span class="line">[0275] :: mov r269.r_address, s2</span><br><span class="line">[0276] :: mov s2, &amp;s4</span><br><span class="line">[0278] :: mov(1) arr[1], s2</span><br><span class="line">[0279] :: mov s2, &amp;flag[13]</span><br><span class="line">[0280] :: mov s4, s2</span><br><span class="line">[0281] :: exec r281.r_address &lt;- 803425cc40800019c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x19</span><br><span class="line">--------------------</span><br><span class="line">[0290] :: array [0xd008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0293] :: mov s3, &amp;r290.r_address</span><br><span class="line">[0294] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0295] :: add r290.r_address, s3, 0</span><br><span class="line">[0296] :: mov r290.r_address, s2</span><br><span class="line">[0297] :: mov s2, &amp;s4</span><br><span class="line">[0299] :: mov(1) arr[1], s2</span><br><span class="line">[0300] :: mov s2, &amp;flag[14]</span><br><span class="line">[0301] :: mov s4, s2</span><br><span class="line">[0302] :: exec r302.r_address &lt;- 803425cc40800024c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x24</span><br><span class="line">--------------------</span><br><span class="line">[0311] :: array [0xe008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0314] :: mov s3, &amp;r311.r_address</span><br><span class="line">[0315] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0316] :: add r311.r_address, s3, 0</span><br><span class="line">[0317] :: mov r311.r_address, s2</span><br><span class="line">[0318] :: mov s2, &amp;s4</span><br><span class="line">[0320] :: mov(1) arr[1], s2</span><br><span class="line">[0321] :: mov s2, &amp;flag[15]</span><br><span class="line">[0322] :: mov s4, s2</span><br><span class="line">[0323] :: exec r323.r_address &lt;- 803425cc4080002cc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x2c</span><br><span class="line">--------------------</span><br><span class="line">[0332] :: array [0xf008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0335] :: mov s3, &amp;r332.r_address</span><br><span class="line">[0336] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0337] :: add r332.r_address, s3, 0</span><br><span class="line">[0338] :: mov r332.r_address, s2</span><br><span class="line">[0339] :: mov s2, &amp;s4</span><br><span class="line">[0341] :: mov(1) arr[1], s2</span><br><span class="line">[0342] :: mov s2, &amp;flag[16]</span><br><span class="line">[0343] :: mov s4, s2</span><br><span class="line">[0344] :: exec r344.r_address &lt;- 803425cc40800026c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x26</span><br><span class="line">--------------------</span><br><span class="line">[0353] :: array [0x10008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0356] :: mov s3, &amp;r353.r_address</span><br><span class="line">[0357] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0358] :: add r353.r_address, s3, 0</span><br><span class="line">[0359] :: mov r353.r_address, s2</span><br><span class="line">[0360] :: mov s2, &amp;s4</span><br><span class="line">[0362] :: mov(1) arr[2], s2</span><br><span class="line">[0363] :: mov s2, &amp;flag[17]</span><br><span class="line">[0364] :: mov s4, s2</span><br><span class="line">[0365] :: exec r365.r_address &lt;- 803425cc4080001ec3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x1e</span><br><span class="line">--------------------</span><br><span class="line">[0374] :: array [0x11008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0377] :: mov s3, &amp;r374.r_address</span><br><span class="line">[0378] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0379] :: add r374.r_address, s3, 0</span><br><span class="line">[0380] :: mov r374.r_address, s2</span><br><span class="line">[0381] :: mov s2, &amp;s4</span><br><span class="line">[0383] :: mov(1) arr[2], s2</span><br><span class="line">[0384] :: mov s2, &amp;flag[18]</span><br><span class="line">[0385] :: mov s4, s2</span><br><span class="line">[0386] :: exec r386.r_address &lt;- 803425cc4080001fc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x1f</span><br><span class="line">--------------------</span><br><span class="line">[0395] :: array [0x12008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0398] :: mov s3, &amp;r395.r_address</span><br><span class="line">[0399] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0400] :: add r395.r_address, s3, 0</span><br><span class="line">[0401] :: mov r395.r_address, s2</span><br><span class="line">[0402] :: mov s2, &amp;s4</span><br><span class="line">[0404] :: mov(1) arr[2], s2</span><br><span class="line">[0405] :: mov s2, &amp;flag[19]</span><br><span class="line">[0406] :: mov s4, s2</span><br><span class="line">[0407] :: exec r407.r_address &lt;- 803425cc40800020c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x20</span><br><span class="line">--------------------</span><br><span class="line">[0416] :: array [0x13008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0419] :: mov s3, &amp;r416.r_address</span><br><span class="line">[0420] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0421] :: add r416.r_address, s3, 0</span><br><span class="line">[0422] :: mov r416.r_address, s2</span><br><span class="line">[0423] :: mov s2, &amp;s4</span><br><span class="line">[0425] :: mov(1) arr[2], s2</span><br><span class="line">[0426] :: mov s2, &amp;flag[20]</span><br><span class="line">[0427] :: mov s4, s2</span><br><span class="line">[0428] :: exec r428.r_address &lt;- 803425cc40800020c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x20</span><br><span class="line">--------------------</span><br><span class="line">[0437] :: array [0x14008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0440] :: mov s3, &amp;r437.r_address</span><br><span class="line">[0441] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0442] :: add r437.r_address, s3, 0</span><br><span class="line">[0443] :: mov r437.r_address, s2</span><br><span class="line">[0444] :: mov s2, &amp;s4</span><br><span class="line">[0446] :: mov(1) arr[2], s2</span><br><span class="line">[0447] :: mov s2, &amp;flag[21]</span><br><span class="line">[0448] :: mov s4, s2</span><br><span class="line">[0449] :: exec r449.r_address &lt;- 803425cc40800021c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x21</span><br><span class="line">--------------------</span><br><span class="line">[0458] :: array [0x15008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0461] :: mov s3, &amp;r458.r_address</span><br><span class="line">[0462] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0463] :: add r458.r_address, s3, 0</span><br><span class="line">[0464] :: mov r458.r_address, s2</span><br><span class="line">[0465] :: mov s2, &amp;s4</span><br><span class="line">[0467] :: mov(1) arr[2], s2</span><br><span class="line">[0468] :: mov s2, &amp;flag[22]</span><br><span class="line">[0469] :: mov s4, s2</span><br><span class="line">[0470] :: exec r470.r_address &lt;- 803425cc40800023c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x23</span><br><span class="line">--------------------</span><br><span class="line">[0479] :: array [0x16008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0482] :: mov s3, &amp;r479.r_address</span><br><span class="line">[0483] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0484] :: add r479.r_address, s3, 0</span><br><span class="line">[0485] :: mov r479.r_address, s2</span><br><span class="line">[0486] :: mov s2, &amp;s4</span><br><span class="line">[0488] :: mov(1) arr[2], s2</span><br><span class="line">[0489] :: mov s2, &amp;flag[23]</span><br><span class="line">[0490] :: mov s4, s2</span><br><span class="line">[0491] :: exec r491.r_address &lt;- 803425cc40800027c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x27</span><br><span class="line">--------------------</span><br><span class="line">[0500] :: array [0x17008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0503] :: mov s3, &amp;r500.r_address</span><br><span class="line">[0504] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0505] :: add r500.r_address, s3, 0</span><br><span class="line">[0506] :: mov r500.r_address, s2</span><br><span class="line">[0507] :: mov s2, &amp;s4</span><br><span class="line">[0509] :: mov(1) arr[2], s2</span><br><span class="line">[0510] :: mov s2, &amp;flag[24]</span><br><span class="line">[0511] :: mov s4, s2</span><br><span class="line">[0512] :: exec r512.r_address &lt;- 803425cc40800024c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x24</span><br><span class="line">--------------------</span><br><span class="line">[0521] :: array [0x18008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0524] :: mov s3, &amp;r521.r_address</span><br><span class="line">[0525] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0526] :: add r521.r_address, s3, 0</span><br><span class="line">[0527] :: mov r521.r_address, s2</span><br><span class="line">[0528] :: mov s2, &amp;s4</span><br><span class="line">[0530] :: mov(1) arr[3], s2</span><br><span class="line">[0531] :: mov s2, &amp;flag[25]</span><br><span class="line">[0532] :: mov s4, s2</span><br><span class="line">[0533] :: exec r533.r_address &lt;- 803425cc40800025c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x25</span><br><span class="line">--------------------</span><br><span class="line">[0542] :: array [0x19008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0545] :: mov s3, &amp;r542.r_address</span><br><span class="line">[0546] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0547] :: add r542.r_address, s3, 0</span><br><span class="line">[0548] :: mov r542.r_address, s2</span><br><span class="line">[0549] :: mov s2, &amp;s4</span><br><span class="line">[0551] :: mov(1) arr[3], s2</span><br><span class="line">[0552] :: mov s2, &amp;flag[26]</span><br><span class="line">[0553] :: mov s4, s2</span><br><span class="line">[0554] :: exec r554.r_address &lt;- 803425cc40800026c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x26</span><br><span class="line">--------------------</span><br><span class="line">[0563] :: array [0x1a008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0566] :: mov s3, &amp;r563.r_address</span><br><span class="line">[0567] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0568] :: add r563.r_address, s3, 0</span><br><span class="line">[0569] :: mov r563.r_address, s2</span><br><span class="line">[0570] :: mov s2, &amp;s4</span><br><span class="line">[0572] :: mov(1) arr[3], s2</span><br><span class="line">[0573] :: mov s2, &amp;flag[27]</span><br><span class="line">[0574] :: mov s4, s2</span><br><span class="line">[0575] :: exec r575.r_address &lt;- 803425cc40800027c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x27</span><br><span class="line">--------------------</span><br><span class="line">[0584] :: array [0x1b008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0587] :: mov s3, &amp;r584.r_address</span><br><span class="line">[0588] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0589] :: add r584.r_address, s3, 0</span><br><span class="line">[0590] :: mov r584.r_address, s2</span><br><span class="line">[0591] :: mov s2, &amp;s4</span><br><span class="line">[0593] :: mov(1) arr[3], s2</span><br><span class="line">[0594] :: mov s4, &amp;0</span><br><span class="line">[0595] :: mov fail(), &amp;0</span><br><span class="line">[0596] :: mov s5, &amp;0</span><br><span class="line">[0597] :: mov s2, &amp;arr[0]</span><br><span class="line">[0599] :: mov s6, s2</span><br><span class="line">[0600] :: exec r600.r_address &lt;- 803425fc40800070c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x70</span><br><span class="line">--------------------</span><br><span class="line">[0609] :: mov s2, &amp;s6</span><br><span class="line">[0611] :: add s5, s5, s2</span><br><span class="line">[0614] :: mov s6, &amp;0</span><br><span class="line">[0615] :: mov s2, &amp;arr[0]</span><br><span class="line">[0616] :: mov s6, s2</span><br><span class="line">[0617] :: exec r617.r_address &lt;- 803425fc4080007cc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x7c</span><br><span class="line">--------------------</span><br><span class="line">[0626] :: mov s2, &amp;s6</span><br><span class="line">[0628] :: add s5, s5, s2</span><br><span class="line">[0631] :: mov s6, &amp;0</span><br><span class="line">[0632] :: mov s2, &amp;arr[0]</span><br><span class="line">[0633] :: mov s6, s2</span><br><span class="line">[0634] :: exec r634.r_address &lt;- 803425fc40800073c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x73</span><br><span class="line">--------------------</span><br><span class="line">[0643] :: mov s2, &amp;s6</span><br><span class="line">[0645] :: add s5, s5, s2</span><br><span class="line">[0648] :: mov s6, &amp;0</span><br><span class="line">[0649] :: mov s2, &amp;arr[0]</span><br><span class="line">[0650] :: mov s6, s2</span><br><span class="line">[0651] :: exec r651.r_address &lt;- 803425fc40800078c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x78</span><br><span class="line">--------------------</span><br><span class="line">[0660] :: mov s2, &amp;s6</span><br><span class="line">[0662] :: add s5, s5, s2</span><br><span class="line">[0665] :: mov s6, &amp;0</span><br><span class="line">[0666] :: mov s2, &amp;arr[0]</span><br><span class="line">[0667] :: mov s6, s2</span><br><span class="line">[0668] :: exec r668.r_address &lt;- 803425fc4080006fc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x6f</span><br><span class="line">--------------------</span><br><span class="line">[0677] :: mov s2, &amp;s6</span><br><span class="line">[0679] :: add s5, s5, s2</span><br><span class="line">[0682] :: mov s6, &amp;0</span><br><span class="line">[0683] :: mov s2, &amp;arr[0]</span><br><span class="line">[0684] :: mov s6, s2</span><br><span class="line">[0685] :: exec r685.r_address &lt;- 803425fc40800027c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x27</span><br><span class="line">--------------------</span><br><span class="line">[0694] :: mov s2, &amp;s6</span><br><span class="line">[0696] :: add s5, s5, s2</span><br><span class="line">[0699] :: mov s6, &amp;0</span><br><span class="line">[0700] :: mov s2, &amp;arr[0]</span><br><span class="line">[0701] :: mov s6, s2</span><br><span class="line">[0702] :: exec r702.r_address &lt;- 803425fc4080002ac3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x2a</span><br><span class="line">--------------------</span><br><span class="line">[0711] :: mov s2, &amp;s6</span><br><span class="line">[0713] :: add s5, s5, s2</span><br><span class="line">[0716] :: mov s6, &amp;0</span><br><span class="line">[0717] :: mov s2, &amp;arr[0]</span><br><span class="line">[0718] :: mov s6, s2</span><br><span class="line">[0719] :: exec r719.r_address &lt;- 803425fc4080002cc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x2c</span><br><span class="line">--------------------</span><br><span class="line">[0728] :: mov s2, &amp;s6</span><br><span class="line">[0730] :: add s5, s5, s2</span><br><span class="line">[0733] :: mov s6, &amp;0</span><br><span class="line">[0734] :: mov s2, &amp;arr[1]</span><br><span class="line">[0735] :: mov s6, s2</span><br><span class="line">[0736] :: exec r736.r_address &lt;- 803425fc4080007fc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x7f</span><br><span class="line">--------------------</span><br><span class="line">[0745] :: mov s2, &amp;s6</span><br><span class="line">[0747] :: add s5, s5, s2</span><br><span class="line">[0750] :: mov s6, &amp;0</span><br><span class="line">[0751] :: mov s2, &amp;arr[1]</span><br><span class="line">[0752] :: mov s6, s2</span><br><span class="line">[0753] :: exec r753.r_address &lt;- 803425fc40800035c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x35</span><br><span class="line">--------------------</span><br><span class="line">[0762] :: mov s2, &amp;s6</span><br><span class="line">[0764] :: add s5, s5, s2</span><br><span class="line">[0767] :: mov s6, &amp;0</span><br><span class="line">[0768] :: mov s2, &amp;arr[1]</span><br><span class="line">[0769] :: mov s6, s2</span><br><span class="line">[0770] :: exec r770.r_address &lt;- 803425fc4080002dc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x2d</span><br><span class="line">--------------------</span><br><span class="line">[0779] :: mov s2, &amp;s6</span><br><span class="line">[0781] :: add s5, s5, s2</span><br><span class="line">[0784] :: mov s6, &amp;0</span><br><span class="line">[0785] :: mov s2, &amp;arr[1]</span><br><span class="line">[0786] :: mov s6, s2</span><br><span class="line">[0787] :: exec r787.r_address &lt;- 803425fc40800032c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x32</span><br><span class="line">--------------------</span><br><span class="line">[0796] :: mov s2, &amp;s6</span><br><span class="line">[0798] :: add s5, s5, s2</span><br><span class="line">[0801] :: mov s6, &amp;0</span><br><span class="line">[0802] :: mov s2, &amp;arr[1]</span><br><span class="line">[0803] :: mov s6, s2</span><br><span class="line">[0804] :: exec r804.r_address &lt;- 803425fc40800037c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x37</span><br><span class="line">--------------------</span><br><span class="line">[0813] :: mov s2, &amp;s6</span><br><span class="line">[0815] :: add s5, s5, s2</span><br><span class="line">[0818] :: mov s6, &amp;0</span><br><span class="line">[0819] :: mov s2, &amp;arr[1]</span><br><span class="line">[0820] :: mov s6, s2</span><br><span class="line">[0821] :: exec r821.r_address &lt;- 803425fc4080003bc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x3b</span><br><span class="line">--------------------</span><br><span class="line">[0830] :: mov s2, &amp;s6</span><br><span class="line">[0832] :: add s5, s5, s2</span><br><span class="line">[0835] :: mov s6, &amp;0</span><br><span class="line">[0836] :: mov s2, &amp;arr[1]</span><br><span class="line">[0837] :: mov s6, s2</span><br><span class="line">[0838] :: exec r838.r_address &lt;- 803425fc40800022c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x22</span><br><span class="line">--------------------</span><br><span class="line">[0847] :: mov s2, &amp;s6</span><br><span class="line">[0849] :: add s5, s5, s2</span><br><span class="line">[0852] :: mov s6, &amp;0</span><br><span class="line">[0853] :: mov s2, &amp;arr[1]</span><br><span class="line">[0854] :: mov s6, s2</span><br><span class="line">[0855] :: exec r855.r_address &lt;- 803425fc40800059c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x59</span><br><span class="line">--------------------</span><br><span class="line">[0864] :: mov s2, &amp;s6</span><br><span class="line">[0866] :: add s5, s5, s2</span><br><span class="line">[0869] :: mov s6, &amp;0</span><br><span class="line">[0870] :: mov s2, &amp;arr[2]</span><br><span class="line">[0871] :: mov s6, s2</span><br><span class="line">[0872] :: exec r872.r_address &lt;- 803425fc40800053c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x53</span><br><span class="line">--------------------</span><br><span class="line">[0881] :: mov s2, &amp;s6</span><br><span class="line">[0883] :: add s5, s5, s2</span><br><span class="line">[0886] :: mov s6, &amp;0</span><br><span class="line">[0887] :: mov s2, &amp;arr[2]</span><br><span class="line">[0888] :: mov s6, s2</span><br><span class="line">[0889] :: exec r889.r_address &lt;- 803425fc4080008ec3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x8e</span><br><span class="line">--------------------</span><br><span class="line">[0898] :: mov s2, &amp;s6</span><br><span class="line">[0900] :: add s5, s5, s2</span><br><span class="line">[0903] :: mov s6, &amp;0</span><br><span class="line">[0904] :: mov s2, &amp;arr[2]</span><br><span class="line">[0905] :: mov s6, s2</span><br><span class="line">[0906] :: exec r906.r_address &lt;- 803425fc4080003dc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x3d</span><br><span class="line">--------------------</span><br><span class="line">[0915] :: mov s2, &amp;s6</span><br><span class="line">[0917] :: add s5, s5, s2</span><br><span class="line">[0920] :: mov s6, &amp;0</span><br><span class="line">[0921] :: mov s2, &amp;arr[2]</span><br><span class="line">[0922] :: mov s6, s2</span><br><span class="line">[0923] :: exec r923.r_address &lt;- 803425fc4080002ac3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x2a</span><br><span class="line">--------------------</span><br><span class="line">[0932] :: mov s2, &amp;s6</span><br><span class="line">[0934] :: add s5, s5, s2</span><br><span class="line">[0937] :: mov s6, &amp;0</span><br><span class="line">[0938] :: mov s2, &amp;arr[2]</span><br><span class="line">[0939] :: mov s6, s2</span><br><span class="line">[0940] :: exec r940.r_address &lt;- 803425fc40800059c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x59</span><br><span class="line">--------------------</span><br><span class="line">[0949] :: mov s2, &amp;s6</span><br><span class="line">[0951] :: add s5, s5, s2</span><br><span class="line">[0954] :: mov s6, &amp;0</span><br><span class="line">[0955] :: mov s2, &amp;arr[2]</span><br><span class="line">[0956] :: mov s6, s2</span><br><span class="line">[0957] :: exec r957.r_address &lt;- 803425fc40800027c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x27</span><br><span class="line">--------------------</span><br><span class="line">[0966] :: mov s2, &amp;s6</span><br><span class="line">[0968] :: add s5, s5, s2</span><br><span class="line">[0971] :: mov s6, &amp;0</span><br><span class="line">[0972] :: mov s2, &amp;arr[2]</span><br><span class="line">[0973] :: mov s6, s2</span><br><span class="line">[0974] :: exec r974.r_address &lt;- 803425fc4080002dc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x2d</span><br><span class="line">--------------------</span><br><span class="line">[0983] :: mov s2, &amp;s6</span><br><span class="line">[0985] :: add s5, s5, s2</span><br><span class="line">[0988] :: mov s6, &amp;0</span><br><span class="line">[0989] :: mov s2, &amp;arr[2]</span><br><span class="line">[0990] :: mov s6, s2</span><br><span class="line">[0991] :: exec r991.r_address &lt;- 803425fc40800029c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x29</span><br><span class="line">--------------------</span><br><span class="line">[1000] :: mov s2, &amp;s6</span><br><span class="line">[1002] :: add s5, s5, s2</span><br><span class="line">[1005] :: mov s6, &amp;0</span><br><span class="line">[1006] :: mov s2, &amp;arr[3]</span><br><span class="line">[1007] :: mov s6, s2</span><br><span class="line">[1008] :: exec r1008.r_address &lt;- 803425fc40800034c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x34</span><br><span class="line">--------------------</span><br><span class="line">[1017] :: mov s2, &amp;s6</span><br><span class="line">[1019] :: add s5, s5, s2</span><br><span class="line">[1022] :: mov s6, &amp;0</span><br><span class="line">[1023] :: mov s2, &amp;arr[3]</span><br><span class="line">[1024] :: mov s6, s2</span><br><span class="line">[1025] :: exec r1025.r_address &lt;- 803425fc4080002dc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x2d</span><br><span class="line">--------------------</span><br><span class="line">[1034] :: mov s2, &amp;s6</span><br><span class="line">[1036] :: add s5, s5, s2</span><br><span class="line">[1039] :: mov s6, &amp;0</span><br><span class="line">[1040] :: mov s2, &amp;arr[3]</span><br><span class="line">[1041] :: mov s6, s2</span><br><span class="line">[1042] :: exec r1042.r_address &lt;- 803425fc40800061c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x61</span><br><span class="line">--------------------</span><br><span class="line">[1051] :: mov s2, &amp;s6</span><br><span class="line">[1053] :: add s5, s5, s2</span><br><span class="line">[1056] :: mov s6, &amp;0</span><br><span class="line">[1057] :: mov s2, &amp;arr[3]</span><br><span class="line">[1058] :: mov s6, s2</span><br><span class="line">[1059] :: exec r1059.r_address &lt;- 803425fc40800032c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x32</span><br><span class="line">--------------------</span><br><span class="line">[1068] :: mov s2, &amp;s6</span><br><span class="line">[1070] :: add s5, s5, s2</span><br><span class="line">[1073] :: mov s6, &amp;0</span><br><span class="line">[1074] :: mov s2, &amp;flag[28]</span><br><span class="line">[1075] :: mov s6, s2</span><br><span class="line">[1076] :: mov s2, &amp;flag[29]</span><br><span class="line">[1077] :: mov s7, s2</span><br><span class="line">[1078] :: mov s8, &amp;0</span><br><span class="line">[1079] :: mov s2, &amp;s8</span><br><span class="line">[1080] :: add s8, s8, s2</span><br><span class="line">[1083] :: mov s2, &amp;s6</span><br><span class="line">[1084] :: add s8, s8, s2</span><br><span class="line">[1087] :: mov s9, &amp;0</span><br><span class="line">[1088] :: mov s2, &amp;s9</span><br><span class="line">[1089] :: add s9, s9, s2</span><br><span class="line">[1092] :: mov s2, &amp;s7</span><br><span class="line">[1093] :: add s9, s9, s2</span><br><span class="line">[1096] :: mov s2, &amp;s9</span><br><span class="line">[1097] :: add s10, s8, s2</span><br><span class="line">[1100] :: exec r1100.r_address &lt;- 8034255c4180006cc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x80415c], 0x6c</span><br><span class="line">--------------------</span><br><span class="line">[1109] :: mov s2, &amp;s10</span><br><span class="line">[1111] :: add s5, s5, s2</span><br><span class="line">[1114] :: mov s6, &amp;0</span><br><span class="line">[1115] :: mov s7, &amp;0</span><br><span class="line">[1116] :: mov s8, &amp;0</span><br><span class="line">[1117] :: mov s9, &amp;0</span><br><span class="line">[1118] :: mov s10, &amp;0</span><br><span class="line">[1119] :: mov s2, &amp;flag[28]</span><br><span class="line">[1120] :: mov s6, s2</span><br><span class="line">[1121] :: mov s2, &amp;flag[29]</span><br><span class="line">[1122] :: mov s7, s2</span><br><span class="line">[1123] :: mov s8, &amp;0</span><br><span class="line">[1124] :: mov s2, &amp;s8</span><br><span class="line">[1125] :: add s8, s8, s2</span><br><span class="line">[1128] :: mov s2, &amp;s6</span><br><span class="line">[1129] :: add s8, s8, s2</span><br><span class="line">[1132] :: mov s2, &amp;s8</span><br><span class="line">[1133] :: add s8, s8, s2</span><br><span class="line">[1136] :: mov s9, &amp;0</span><br><span class="line">[1137] :: mov s2, &amp;s9</span><br><span class="line">[1138] :: add s9, s9, s2</span><br><span class="line">[1141] :: mov s2, &amp;s7</span><br><span class="line">[1142] :: add s9, s9, s2</span><br><span class="line">[1145] :: mov s2, &amp;s9</span><br><span class="line">[1146] :: add s10, s8, s2</span><br><span class="line">[1149] :: exec r1149.r_address &lt;- 8034255c418000a1c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x80415c], 0xa1</span><br><span class="line">--------------------</span><br><span class="line">[1158] :: mov s2, &amp;s10</span><br><span class="line">[1160] :: add s5, s5, s2</span><br><span class="line">[1163] :: mov s6, &amp;0</span><br><span class="line">[1164] :: mov s7, &amp;0</span><br><span class="line">[1165] :: mov s8, &amp;0</span><br><span class="line">[1166] :: mov s9, &amp;0</span><br><span class="line">[1167] :: mov s10, &amp;0</span><br><span class="line">[1168] :: mov s2, &amp;flag[30]</span><br><span class="line">[1169] :: mov s6, s2</span><br><span class="line">[1170] :: mov s2, &amp;flag[31]</span><br><span class="line">[1171] :: mov s7, s2</span><br><span class="line">[1172] :: mov s8, &amp;0</span><br><span class="line">[1173] :: mov s2, &amp;s8</span><br><span class="line">[1174] :: add s8, s8, s2</span><br><span class="line">[1177] :: mov s2, &amp;s6</span><br><span class="line">[1178] :: add s8, s8, s2</span><br><span class="line">[1181] :: mov s9, &amp;0</span><br><span class="line">[1182] :: mov s2, &amp;s9</span><br><span class="line">[1183] :: add s9, s9, s2</span><br><span class="line">[1186] :: mov s2, &amp;s7</span><br><span class="line">[1187] :: add s9, s9, s2</span><br><span class="line">[1190] :: mov s2, &amp;s9</span><br><span class="line">[1191] :: add s10, s8, s2</span><br><span class="line">[1194] :: exec r1194.r_address &lt;- 8034255c418000b1c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x80415c], 0xb1</span><br><span class="line">--------------------</span><br><span class="line">[1203] :: mov s2, &amp;s10</span><br><span class="line">[1205] :: add s5, s5, s2</span><br><span class="line">[1208] :: mov s6, &amp;0</span><br><span class="line">[1209] :: mov s7, &amp;0</span><br><span class="line">[1210] :: mov s8, &amp;0</span><br><span class="line">[1211] :: mov s9, &amp;0</span><br><span class="line">[1212] :: mov s10, &amp;0</span><br><span class="line">[1213] :: mov s2, &amp;flag[30]</span><br><span class="line">[1214] :: mov s6, s2</span><br><span class="line">[1215] :: mov s2, &amp;flag[31]</span><br><span class="line">[1216] :: mov s7, s2</span><br><span class="line">[1217] :: mov s8, &amp;0</span><br><span class="line">[1218] :: mov s2, &amp;s8</span><br><span class="line">[1219] :: add s8, s8, s2</span><br><span class="line">[1222] :: mov s2, &amp;s6</span><br><span class="line">[1223] :: add s8, s8, s2</span><br><span class="line">[1226] :: mov s2, &amp;s8</span><br><span class="line">[1227] :: add s8, s8, s2</span><br><span class="line">[1230] :: mov s9, &amp;0</span><br><span class="line">[1231] :: mov s2, &amp;s9</span><br><span class="line">[1232] :: add s9, s9, s2</span><br><span class="line">[1235] :: mov s2, &amp;s7</span><br><span class="line">[1236] :: add s9, s9, s2</span><br><span class="line">[1239] :: mov s2, &amp;s9</span><br><span class="line">[1240] :: add s10, s8, s2</span><br><span class="line">[1243] :: exec r1243.r_address &lt;- 8034255c418000e5c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x80415c], 0xe5</span><br><span class="line">--------------------</span><br><span class="line">[1252] :: mov s2, &amp;s10</span><br><span class="line">[1254] :: add s5, s5, s2</span><br><span class="line">[1257] :: mov s6, &amp;0</span><br><span class="line">[1258] :: mov s7, &amp;0</span><br><span class="line">[1259] :: mov s8, &amp;0</span><br><span class="line">[1260] :: mov s9, &amp;0</span><br><span class="line">[1261] :: mov s10, &amp;0</span><br><span class="line">[1262] :: mov s2, &amp;s5</span><br><span class="line">[1264] :: mov(1) fail(),</span><br></pre></td></tr></table></figure>

<p>我们选择一个进行分析</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    <span class="number">0</span>x0:	xor	byte ptr <span class="selector-attr">[s4]</span>, <span class="number">0</span>x10</span><br><span class="line">--------------------</span><br><span class="line"><span class="selector-attr">[0101]</span> :: array <span class="selector-attr">[0x4008040cc250480, 0xc3, 0x0]</span></span><br><span class="line"><span class="selector-attr">[0104]</span> :: mov s3, &amp;r101<span class="selector-class">.r_address</span></span><br><span class="line"><span class="selector-attr">[0105]</span> :: setinfo s3, name=<span class="number">0</span>x1a, info=<span class="number">0</span>x1, other=<span class="number">0</span>x0, shndx=<span class="number">0</span>x0</span><br><span class="line"><span class="selector-attr">[0106]</span> :: add r101<span class="selector-class">.r_address</span>, s3, <span class="number">0</span></span><br><span class="line"><span class="selector-attr">[0107]</span> :: mov r101<span class="selector-class">.r_address</span>, s2</span><br><span class="line"><span class="selector-attr">[0108]</span> :: mov s2, &amp;s4</span><br><span class="line"><span class="selector-attr">[0110]</span> :: <span class="built_in">mov</span>(<span class="number">1</span>) arr<span class="selector-attr">[0]</span>, s2</span><br><span class="line"><span class="selector-attr">[0111]</span> :: mov s2, &amp;flag<span class="selector-attr">[5]</span></span><br><span class="line"><span class="selector-attr">[0112]</span> :: mov s4, s2</span><br><span class="line"><span class="selector-attr">[0113]</span> :: exec r113<span class="selector-class">.r_address</span> &lt;- <span class="number">803425</span>cc40800011c3000000000000000000000000000000</span><br></pre></td></tr></table></figure>

<p>array里的机器码转变顺序放到ida里就是add 0x4，后面的exec其实就是个异或，那么我们能够看出这个题的逻辑是flag先异或在加上自己在数组的位置就等于后面的encflag，根据提示还得爆破后4位才行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">xor=[<span class="number">0x16</span>,<span class="number">0x17</span>,<span class="number">0x10</span>,<span class="number">0x12</span>,<span class="number">0x10</span>,<span class="number">0x11</span>,<span class="number">0x12</span>,<span class="number">0x13</span>,<span class="number">0x14</span>,<span class="number">0x15</span>,<span class="number">0x16</span>,<span class="number">0x17</span>,<span class="number">0x18</span>,<span class="number">0x19</span>,<span class="number">0x24</span>,<span class="number">0x2c</span>,<span class="number">0x26</span>,<span class="number">0x1e</span>,<span class="number">0x1f</span>,<span class="number">0x20</span>,<span class="number">0x20</span>,<span class="number">0x21</span>,<span class="number">0x23</span>,<span class="number">0x27</span>,<span class="number">0x24</span>,<span class="number">0x25</span>,<span class="number">0x26</span>,<span class="number">0x27</span>]</span><br><span class="line">encflag=[<span class="number">0x70</span>,<span class="number">0x7c</span>,<span class="number">0x73</span>,<span class="number">0x78</span>,<span class="number">0x6f</span>,<span class="number">0x27</span>,<span class="number">0x2a</span>,<span class="number">0x2c</span>,<span class="number">0x7f</span>,<span class="number">0x35</span>,<span class="number">0x2d</span>,<span class="number">0x32</span>,<span class="number">0x37</span>,<span class="number">0x3b</span>,<span class="number">0x22</span>,<span class="number">0x59</span>,<span class="number">0x53</span>,<span class="number">0x8e</span>,<span class="number">0x3d</span>,<span class="number">0x2a</span>,<span class="number">0x59</span>,<span class="number">0x27</span>,<span class="number">0x2d</span>,<span class="number">0x29</span>,<span class="number">0x34</span>,<span class="number">0x2d</span>,<span class="number">0x61</span>,<span class="number">0x32</span>]</span><br><span class="line">a=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encflag)):</span><br><span class="line">   a+=<span class="built_in">chr</span>((encflag[i]-i)^xor[i])</span><br><span class="line">l = <span class="string">&quot;1234567890abcdef&quot;</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> l:</span><br><span class="line"> <span class="keyword">for</span> c <span class="keyword">in</span> l:</span><br><span class="line">  <span class="keyword">for</span> d <span class="keyword">in</span> l:</span><br><span class="line">    flag = a+b+c+d+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">    sha = hashlib.sha256(flag.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> sha[<span class="number">0</span>:<span class="number">16</span>] == <span class="string">&quot;f860464d767610bb&quot;</span>:</span><br><span class="line">     <span class="built_in">print</span>(flag)</span><br><span class="line">     <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="gamemaster"><a href="#gamemaster" class="headerlink" title="gamemaster"></a>gamemaster</h2><p>是个经典21点游戏</p>
<p>发现dll文件是c#写的，放入dnspy，发现似乎是对文件异或和进行了aes加密，那么源文件已经给了，直接模拟生成一下</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220802171638649.png" alt="image-20220802171638649"></p>
<p>发现里面有个MZ签名，dump出来还是一个c#写的</p>
<p>EasyRe</p>
<p>这个题每一行都要分析，能学到很多东西。</p>
<p>先用finger跑一下会发现清晰很多。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_4021BB</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// er8</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// er9</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  sub_402150();<span class="comment">//将re3的shellcode写到文件中</span></span><br><span class="line">  v5 = fork();<span class="comment">//创建子进程，返回子进程id</span></span><br><span class="line">  <span class="keyword">if</span> ( v5 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_401F2F(v5);<span class="comment">//主进程进入函数</span></span><br><span class="line">    remove((__int64)<span class="string">&quot;re3&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sys_ptrace(PTRACE_TRACEME, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>, v12, v13, a2);<span class="comment">//ptrace函数</span></span><br><span class="line">    sub_44B680((<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;re3&quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;re3&quot;</span>, *(_QWORD *)(a2 + <span class="number">8</span>), <span class="number">0</span>, v2, v3, a2);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ptrace函数最重要的是第一个参数request，它决定了系统调用</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830094057553.png" alt="image-20220830094057553"></p>
<p>我们主要看主进程进入的函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_401F2F</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// r8</span></span><br><span class="line">  __int64 v2; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// ecx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// r8</span></span><br><span class="line">  __int64 v7; <span class="comment">// r9</span></span><br><span class="line">  __int64 v8; <span class="comment">// r8</span></span><br><span class="line">  __int64 v9; <span class="comment">// r9</span></span><br><span class="line">  __int64 v10; <span class="comment">// r8</span></span><br><span class="line">  __int64 v11; <span class="comment">// r9</span></span><br><span class="line">  __int64 v12; <span class="comment">// r8</span></span><br><span class="line">  __int64 v13; <span class="comment">// r9</span></span><br><span class="line">  __int64 v14; <span class="comment">// r8</span></span><br><span class="line">  __int64 v15; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [rsp+0h] [rbp-130h]</span></span><br><span class="line">  <span class="type">char</span> v17; <span class="comment">// [rsp+0h] [rbp-130h]</span></span><br><span class="line">  <span class="type">char</span> v18; <span class="comment">// [rsp+0h] [rbp-130h]</span></span><br><span class="line">  <span class="type">char</span> v19; <span class="comment">// [rsp+0h] [rbp-130h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v20; <span class="comment">// [rsp+10h] [rbp-120h]</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// [rsp+2Ch] [rbp-104h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v23[<span class="number">128</span>]; <span class="comment">// [rsp+30h] [rbp-100h] BYREF</span></span><br><span class="line">  __int64 v24; <span class="comment">// [rsp+B0h] [rbp-80h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+108h] [rbp-28h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+110h] [rbp-20h]</span></span><br><span class="line">  __int64 v27; <span class="comment">// [rsp+118h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+124h] [rbp-Ch]</span></span><br><span class="line">  __int64 v29; <span class="comment">// [rsp+128h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  sys_wait(a1, <span class="number">0LL</span>, <span class="number">0</span>);<span class="comment">//等待子进程信号</span></span><br><span class="line">  sys_ptrace(PTRACE_CONT, a1, <span class="number">0LL</span>, <span class="number">0LL</span>, v1, v2, v16);<span class="comment">//重新运行处于stopped状态程序</span></span><br><span class="line">  v27 = sub_401A30(a1);</span><br><span class="line">  v3 = sub_4017E5();<span class="comment">//如下表，将下表数据存到result</span></span><br><span class="line">  result = v4;</span><br><span class="line">  v20 = v3;</span><br><span class="line">  v21 = v4;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">2</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v22 = <span class="number">0</span>;</span><br><span class="line">    sys_wait(a1, &amp;v22, <span class="number">0</span>);	<span class="comment">//等待子进程信号</span></span><br><span class="line">    result = v22 &amp; <span class="number">0x7F</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (v22 &amp; <span class="number">0x7F</span>) == <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    sys_ptrace(PTRACE_GETREGS, a1, <span class="number">0LL</span>, v23, v6, v7, v17);<span class="comment">//复制通用寄存器</span></span><br><span class="line">    v26 = v24 - <span class="number">1</span>;</span><br><span class="line">    v25 = sys_ptrace(PTRACE_PEEKTEXT, a1, v24 - <span class="number">1</span>, <span class="number">0LL</span>, v8, v9, v18);<span class="comment">//子进程给父进程数据</span></span><br><span class="line">    <span class="keyword">if</span> ( v25 == <span class="number">0xCAFEB055BFCC</span>LL )</span><br><span class="line">    &#123;</span><br><span class="line">      v29 = v26;</span><br><span class="line">      sub_401BB1(a1, v26, v27, v20, v21);</span><br><span class="line">      v24 = v26 + <span class="number">10</span>;</span><br><span class="line">      sys_ptrace(<span class="number">13LL</span>, a1, <span class="number">0LL</span>, v23, v12, v13, v19);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v25 == <span class="number">0xCAFE1055BFCC</span>LL )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_401D78(a1, v29, v26, v27, v20, v21);</span><br><span class="line">      v24 = v26 + <span class="number">10</span>;</span><br><span class="line">      sys_ptrace(PTRACE_SETREGS, a1, <span class="number">0LL</span>, v23, v14, v15, v19);</span><br><span class="line">    &#125;</span><br><span class="line">    result = sys_ptrace(PTRACE_CONT, a1, <span class="number">0LL</span>, <span class="number">0LL</span>, v10, v11, v19);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830102915693.png" alt="image-20220830102915693"></p>
<p>当子进程给父进程数据时，有两个选择，我们需要知道进入了哪个地方。</p>
<p>接下来看re3这个数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">jmp_buf_tag</span> <span class="title">env</span>[1];</span> <span class="comment">// [rsp+10h] [rbp-850h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">jmp_buf_tag</span> <span class="title">v5</span>[1];</span> <span class="comment">// [rsp+E0h] [rbp-780h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">jmp_buf_tag</span> <span class="title">v6</span>[1];</span> <span class="comment">// [rsp+1B0h] [rbp-6B0h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">jmp_buf_tag</span> <span class="title">v7</span>[1];</span> <span class="comment">// [rsp+280h] [rbp-5E0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v8[<span class="number">640</span>]; <span class="comment">// [rsp+350h] [rbp-510h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v9[<span class="number">636</span>]; <span class="comment">// [rsp+5D0h] [rbp-290h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+84Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+850h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+854h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [rsp+858h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+85Ch] [rbp-4h]</span></span><br><span class="line">  __int64 savedregs; <span class="comment">// [rsp+860h] [rbp+0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v14 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a1 != <span class="number">2</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  (sub_2490)(a2[<span class="number">1</span>], a2, a3);<span class="comment">//主要加密我们现在不关心</span></span><br><span class="line">  (loc_21F9)(&amp;unk_55C0, v9, v8);<span class="comment">//这个地方要注意</span></span><br><span class="line">  v13 = _setjmp(env);</span><br><span class="line">  <span class="keyword">if</span> ( v13 &lt;= <span class="number">24</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = _setjmp(v5);</span><br><span class="line">    <span class="keyword">if</span> ( v11 &lt; byte_50A0[<span class="number">25</span> * v13] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( byte_50A0[<span class="number">25</span> * v13 + <span class="number">1</span> + v11] != *(&amp;savedregs + <span class="number">25</span> * v13 + v11 - <span class="number">655</span>) )</span><br><span class="line">        v14 = <span class="number">0</span>;</span><br><span class="line">      longjmp(v5, v11 + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    longjmp(env, v13 + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v12 = _setjmp(v6);</span><br><span class="line">  <span class="keyword">if</span> ( v12 &lt;= <span class="number">24</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = _setjmp(v7);</span><br><span class="line">    <span class="keyword">if</span> ( v10 &lt; byte_5320[<span class="number">25</span> * v12] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( byte_5320[<span class="number">25</span> * v12 + <span class="number">1</span> + v10] != *(&amp;savedregs + <span class="number">25</span> * v12 + v10 - <span class="number">1295</span>) )</span><br><span class="line">        v14 = <span class="number">0</span>;</span><br><span class="line">      longjmp(v7, v10 + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    longjmp(v6, v12 + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v14 == <span class="number">1</span> )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;GOOD JOB&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(loc_21F9)(&amp;unk_55C0, v9, v8);</span><br></pre></td></tr></table></figure>

<p>这个地方的数据非常奇怪，无法反编译，我们需要仔细看一下</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830105602247.png" alt="image-20220830105602247"></p>
<p>发现int 3，并且有一个CAFEB055BF这样一个数据，这个数据是在主进程里进行判断的数据，那么我们可以推测这个题的主要逻辑就是：主进程先等待子进程运行，子进程抛出int 3等待主进程调试，主进程判断异常类型，进行对上面的smc处理。</p>
<p>获取smc加密后文件的方法有两种：分别是静态分析和动态调试</p>
<p>静态分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_401BB1</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1, __int64 a2, <span class="type">int</span> a3, <span class="type">char</span> a4, __int64 a5)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v5; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v6; <span class="comment">// r8</span></span><br><span class="line">  __int64 v7; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// er8</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// er9</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// er8</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// er9</span></span><br><span class="line">  __int64 v13; <span class="comment">// r8</span></span><br><span class="line">  __int64 v14; <span class="comment">// r9</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [rsp+0h] [rbp-C0h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v17; <span class="comment">// [rsp+0h] [rbp-C0h]</span></span><br><span class="line">  <span class="type">char</span> v18; <span class="comment">// [rsp+0h] [rbp-C0h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v21; <span class="comment">// [rsp+20h] [rbp-A0h]</span></span><br><span class="line">  <span class="type">char</span> v22[<span class="number">32</span>]; <span class="comment">// [rsp+30h] [rbp-90h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v23[<span class="number">32</span>]; <span class="comment">// [rsp+50h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v24[<span class="number">24</span>]; <span class="comment">// [rsp+70h] [rbp-50h] BYREF</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+88h] [rbp-38h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+90h] [rbp-30h]</span></span><br><span class="line">  <span class="type">int</span> v27; <span class="comment">// [rsp+9Ch] [rbp-24h]</span></span><br><span class="line">  __int64 v28; <span class="comment">// [rsp+A0h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> v29; <span class="comment">// [rsp+ACh] [rbp-14h]</span></span><br><span class="line">  __int64 v30; <span class="comment">// [rsp+B0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+B8h] [rbp-8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+BCh] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v16 = a4;</span><br><span class="line">  v30 = sub_401AC2(a1, a2);</span><br><span class="line">  v29 = (v30 - a2 - <span class="number">10</span>) &gt;&gt; <span class="number">4</span>;</span><br><span class="line">  v21 = a2 + <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= v29 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v28 = sys_ptrace(PTRACE_PEEKTEXT, a1, v21, v5, v6, v7, v16);</span><br><span class="line">    v27 = sub_40190E((v21 - a3), v17, a5);</span><br><span class="line">    <span class="built_in">sprintf</span>(v23, &amp;unk_490008, v27, &amp;unk_490008, v8, v9, v17);</span><br><span class="line">    v10 = j_strnlen(v23);</span><br><span class="line">    md5(v23, v10, v24);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">15</span>; j &gt; <span class="number">7</span>; --j )</span><br><span class="line">      <span class="built_in">sprintf</span>(&amp;v22[<span class="number">2</span> * (<span class="number">15</span> - j)], <span class="string">&quot;%02x&quot;</span>, v24[j], &amp;v22[<span class="number">2</span> * (<span class="number">15</span> - j)], v11, v12, v18);</span><br><span class="line">    v26 = sub_40B660(v22, <span class="number">0LL</span>, <span class="number">16LL</span>);</span><br><span class="line">    v25 = v26 ^ v28;</span><br><span class="line">    sys_ptrace(PTRACE_POKETEXT, a1, v21, v26 ^ v28, v13, v14, v18);</span><br><span class="line">    v21 += <span class="number">16LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们直接看主进程进入的smc函数，最重要的是一个md5一个异或2，经过动态调试</p>
<p>，可以知道v28是在子程序中取int 3后面的qword，v26是将原始值进行md5后再将从第八个字节倒序。如何获取这个值呢，我们需要利用条件断点</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830115323802.png" alt="image-20220830115323802"></p>
<p>拿到值后我们直接去子进程用idapython恢复一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">xorKey = &#123;<span class="number">8723</span>: <span class="number">2533025110152939745</span>, <span class="number">8739</span>: <span class="number">5590097037203163468</span>, <span class="number">8755</span>: <span class="number">17414346542877855401</span>, <span class="number">8771</span>: <span class="number">17520503086133755340</span>, <span class="number">8787</span>: <span class="number">12492599841064285544</span>, <span class="number">8803</span>: <span class="number">12384833368350302160</span>, <span class="number">8819</span>: <span class="number">11956541642520230699</span>, <span class="number">8835</span>: <span class="number">12628929057681570616</span>, <span class="number">8851</span>: <span class="number">910654967627959011</span>, <span class="number">8867</span>: <span class="number">5684234031469876551</span>, <span class="number">8883</span>: <span class="number">6000358478182005051</span>, <span class="number">8899</span>: <span class="number">3341586462889168127</span>, <span class="number">8915</span>: <span class="number">11094889238442167020</span>, <span class="number">8931</span>: <span class="number">17237527861538956365</span>, <span class="number">8947</span>: <span class="number">17178915143649401084</span>, <span class="number">8963</span>: <span class="number">11176844209899222046</span>, <span class="number">8979</span>: <span class="number">18079493192679046363</span>, <span class="number">8995</span>: <span class="number">7090159446630928781</span>, <span class="number">9011</span>: <span class="number">863094436381699168</span>, <span class="number">9027</span>: <span class="number">6906972144372600884</span>, <span class="number">9043</span>: <span class="number">16780793948225765908</span>, <span class="number">9059</span>: <span class="number">7086655467811962655</span>, <span class="number">9075</span>: <span class="number">13977154540038163446</span>, <span class="number">9091</span>: <span class="number">7066662532691991888</span>, <span class="number">9107</span>: <span class="number">15157921356638311270</span>, <span class="number">9123</span>: <span class="number">12585839823593393444</span>, <span class="number">9139</span>: <span class="number">1360651393631625694</span>, <span class="number">9155</span>: <span class="number">2139328426318955142</span>, <span class="number">9171</span>: <span class="number">2478274715212481947</span>, <span class="number">9187</span>: <span class="number">12876028885252459748</span>, <span class="number">9203</span>: <span class="number">18132176846268847269</span>, <span class="number">9219</span>: <span class="number">17242441603067001509</span>, <span class="number">9235</span>: <span class="number">8492111998925944081</span>, <span class="number">9251</span>: <span class="number">14679986489201789069</span>, <span class="number">9267</span>: <span class="number">13188777131396593592</span>, <span class="number">9283</span>: <span class="number">5298970373130621883</span>, <span class="number">9299</span>: <span class="number">525902164359904478</span>, <span class="number">9315</span>: <span class="number">2117701741234018776</span>, <span class="number">9331</span>: <span class="number">9158760851580517972</span>&#125;</span><br><span class="line"></span><br><span class="line">addr = <span class="number">0x2213</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    data = get_qword(addr)</span><br><span class="line">    key = xorKey[addr]</span><br><span class="line">    dec = data ^ key</span><br><span class="line">    idc.patch_qword(addr, dec)</span><br><span class="line">    addr += <span class="number">16</span></span><br></pre></td></tr></table></figure>

<p>动态调试：</p>
<p>也就是经常说的patch死循环，但之前一直没操作过，这次学会了。</p>
<p>patch死循环目的是什么呢？我们知道如果不patch我们是没法在主进程中查看子进程的，通过patch死循环可以直接调试子进程。</p>
<p>为什么for循环3次呢？第一次是int3处理smc解密，第二次是int3处理smc加密，就是将解密完的数据再加密回去，第三次是等待子进程结束。</p>
<p>如何操作？先找到子进程末尾，在末尾写个死循环就是jmp到本地址，第二步为了不使smc又把解密完的数据加密回去，异或改为0，第三步patch 401F2F函数的 for 循环为2</p>
<p>patch前</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830155226276.png" alt="image-20220830155226276"></p>
<p>patch后</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830155301280.png" alt="image-20220830155301280"></p>
<p>异或改为0：</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830155531523.png" alt="image-20220830155531523"></p>
<p>for循环改为1：</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830155554253.png" alt="image-20220830155554253"></p>
<p>修改完后运行发现仍然再跑</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830155922080.png" alt="image-20220830155922080"></p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830160100683.png" alt="image-20220830160100683"></p>
<p>成功！</p>
<p>用下面脚本找到smc那个函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">0x56534AF3F00C</span></span><br><span class="line"><span class="keyword">while</span>(a &lt; <span class="number">0x56534af3f48d</span>):</span><br><span class="line">    <span class="keyword">if</span>(get_wide_byte(a) == <span class="number">0x55</span> <span class="keyword">and</span> get_wide_byte(a+<span class="number">1</span>) == <span class="number">0x48</span> <span class="keyword">and</span> get_wide_byte(a+<span class="number">4</span>) == <span class="number">0x48</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(a),end = <span class="string">&quot;, &quot;</span>)</span><br><span class="line">    a+=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830160553793.png" alt="image-20220830160553793"></p>
<p>这样就可以把这个dump出来了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// positive sp value has been detected, the output may be wrong!</span></span><br><span class="line"><span class="type">void</span> __fastcall <span class="title function_">sub_21F9</span><span class="params">(__int64 input, __int64 data1, __int64 data2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> offsett; <span class="comment">// [rsp+20h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> statee; <span class="comment">// [rsp+24h] [rbp-24h]</span></span><br><span class="line">  <span class="type">char</span> count2; <span class="comment">// [rsp+28h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> jj; <span class="comment">// [rsp+2Ch] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+30h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> offset; <span class="comment">// [rsp+34h] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> state; <span class="comment">// [rsp+38h] [rbp-10h]</span></span><br><span class="line">  <span class="type">char</span> lineCount; <span class="comment">// [rsp+3Ch] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> ii; <span class="comment">// [rsp+40h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+44h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">24</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    ii = <span class="number">0</span>;</span><br><span class="line">    lineCount = <span class="number">0</span>;</span><br><span class="line">    state = <span class="number">0</span>;</span><br><span class="line">    offset = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ( ii &lt;= <span class="number">24</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(<span class="number">25</span> * i + ii + input) )            </span><br><span class="line">      &#123;</span><br><span class="line">        ++lineCount;</span><br><span class="line">        state = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( state )                            </span><br><span class="line">        &#123;</span><br><span class="line">          *(data1 + <span class="number">25LL</span> * i + offset) = lineCount;</span><br><span class="line">          lineCount = <span class="number">0</span>;</span><br><span class="line">          ++offset;</span><br><span class="line">        &#125;</span><br><span class="line">        state = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( ++ii == <span class="number">25</span> &amp;&amp; state )                </span><br><span class="line">      &#123;</span><br><span class="line">        *(data1 + <span class="number">25LL</span> * i + offset) = lineCount;</span><br><span class="line">        lineCount = <span class="number">0</span>;</span><br><span class="line">        ++offset;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    *(<span class="number">25LL</span> * i + data1) = offset - <span class="number">1</span>;           </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">24</span>; ++j )                   </span><br><span class="line">  &#123;</span><br><span class="line">    jj = <span class="number">0</span>;</span><br><span class="line">    count2 = <span class="number">0</span>;</span><br><span class="line">    statee = <span class="number">0</span>;</span><br><span class="line">    offsett = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ( jj &lt;= <span class="number">24</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(<span class="number">25</span> * jj + j + input) )</span><br><span class="line">      &#123;</span><br><span class="line">        ++count2;</span><br><span class="line">        statee = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( statee )</span><br><span class="line">        &#123;</span><br><span class="line">          *(data2 + <span class="number">25LL</span> * j + offsett) = count2;</span><br><span class="line">          count2 = <span class="number">0</span>;</span><br><span class="line">          ++offsett;</span><br><span class="line">        &#125;</span><br><span class="line">        statee = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( ++jj == <span class="number">25</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( statee )</span><br><span class="line">        &#123;</span><br><span class="line">          *(data2 + <span class="number">25LL</span> * j + offsett) = count2;</span><br><span class="line">          count2 = <span class="number">0</span>;</span><br><span class="line">          ++offsett;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    *(<span class="number">25LL</span> * j + data2) = offsett - <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实前面的操作就很难了，后面这个加密更难，其实是个数织游戏</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830161743593.png" alt="image-20220830161743593"></p>
<p>这个地方取出来的数据其实是不对的，因为在程序运行的时候init段进行了初始化，真正的在</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830161940268.png" alt="image-20220830161940268"></p>
<p>找到在线网站解密就行<a target="_blank" rel="noopener" href="https://handsomeone.github.io/Nonogram/%EF%BC%8C%E6%B3%A8%E6%84%8F%E6%AF%8F%E8%A1%8C%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%95%B0%E6%98%AF%E5%81%8F%E7%A7%BB%EF%BC%8C%E4%B8%8D%E8%83%BD%E5%87%BA%E7%8E%B0%E5%9C%A8%E8%A7%A3%E5%AF%86%E9%87%8C">https://handsomeone.github.io/Nonogram/，注意每行第一个数是偏移，不能出现在解密里</a></p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830162146771.png" alt="image-20220830162146771"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/25/DASCTF-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/25/DASCTF-7/" class="post-title-link" itemprop="url">DASCTF_7</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-07-25 11:30:54" itemprop="dateCreated datePublished" datetime="2022-07-25T11:30:54+08:00">2022-07-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-26 09:50:48" itemprop="dateModified" datetime="2022-07-26T09:50:48+08:00">2022-07-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="DASCTF-7月赛"><a href="#DASCTF-7月赛" class="headerlink" title="DASCTF_7月赛"></a>DASCTF_7月赛</h1><p>这次逆向没以前那么坐牢了。</p>
<h2 id="隐秘的角落"><a href="#隐秘的角落" class="headerlink" title="隐秘的角落"></a>隐秘的角落</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">main_main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v1; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v2; <span class="comment">// [rsp+8h] [rbp-88h]</span></span><br><span class="line">  _QWORD *v3; <span class="comment">// [rsp+8h] [rbp-88h]</span></span><br><span class="line">  _QWORD *v4; <span class="comment">// [rsp+50h] [rbp-40h]</span></span><br><span class="line">  _QWORD v5[<span class="number">4</span>]; <span class="comment">// [rsp+58h] [rbp-38h] BYREF</span></span><br><span class="line">  __int64 v6[<span class="number">2</span>]; <span class="comment">// [rsp+78h] [rbp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sync___ptr_WaitGroup__Add((__int64)&amp;main_wg, <span class="number">1LL</span>);</span><br><span class="line">  runtime_newobject((__int64)&amp;unk_4B0DA0, v2);</span><br><span class="line">  v4 = v3;</span><br><span class="line">  v6[<span class="number">0</span>] = (__int64)&amp;unk_4B0DA0;</span><br><span class="line">  v6[<span class="number">1</span>] = (__int64)&amp;off_4E9BB0;</span><br><span class="line">  fmt_Fprintln((__int64)&amp;go_itab__os_File_io_Writer, os_Stdout, (__int64)v6, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  v5[<span class="number">2</span>] = &amp;unk_4AE9C0;</span><br><span class="line">  v5[<span class="number">3</span>] = v4;</span><br><span class="line">  fmt_Fscanf(v0, v1, (<span class="type">const</span> <span class="type">char</span> *)&amp;go_itab__os_File_io_Reader);</span><br><span class="line">  runtime_newproc(<span class="number">16</span>, (<span class="type">char</span>)&amp;off_4D2310, *v4);</span><br><span class="line">  v5[<span class="number">0</span>] = &amp;unk_4B0DA0;</span><br><span class="line">  v5[<span class="number">1</span>] = &amp;off_4E9BC0;</span><br><span class="line">  fmt_Fprintln((__int64)&amp;go_itab__os_File_io_Writer, os_Stdout, (__int64)v5, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  sync___ptr_WaitGroup__Wait((__int64)&amp;main_wg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也是个go，通过动调发现关键函数在off_4D2310，点进去发现有check函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __golang <span class="title function_">main_checkflag</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v2; <span class="comment">// al</span></span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+18h] [rbp-70h]</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [rsp+18h] [rbp-70h]</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+20h] [rbp-68h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">32</span>]; <span class="comment">// [rsp+40h] [rbp-48h] BYREF</span></span><br><span class="line">  _QWORD v7[<span class="number">2</span>]; <span class="comment">// [rsp+60h] [rbp-28h] BYREF</span></span><br><span class="line">  _QWORD v8[<span class="number">2</span>]; <span class="comment">// [rsp+70h] [rbp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = runtime_stringtoslicebyte((__int64)v6, a1, a2);</span><br><span class="line">  main_Myencode(v3);</span><br><span class="line">  <span class="keyword">if</span> ( v5 == qword_55EA78 )</span><br><span class="line">  &#123;</span><br><span class="line">    runtime_memequal((__int64)main_enc, v3, qword_55EA78, v3);</span><br><span class="line">    v2 = v4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v8[<span class="number">0</span>] = &amp;unk_4B0DA0;</span><br><span class="line">    v8[<span class="number">1</span>] = &amp;off_4E9B90;</span><br><span class="line">    fmt_Fprintln((__int64)&amp;go_itab__os_File_io_Writer, os_Stdout, (__int64)v8, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v7[<span class="number">0</span>] = &amp;unk_4B0DA0;</span><br><span class="line">    v7[<span class="number">1</span>] = &amp;off_4E9BA0;</span><br><span class="line">    fmt_Fprintln((__int64)&amp;go_itab__os_File_io_Writer, os_Stdout, (__int64)v7, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sync___ptr_WaitGroup__Add((__int64)&amp;main_wg, <span class="number">-1LL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接看encode，发现是rc4，交叉引用密文和密钥，发现密文在init段被异或了，拿脚本直接解了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_main</span>(<span class="params">key=<span class="string">&quot;init_key&quot;</span>, message=<span class="string">&quot;init_message&quot;</span></span>):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;RC4解密主函数调用成功&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  s_box = rc4_init_sbox(key)</span><br><span class="line">  crypt = rc4_excrypt(message, s_box)</span><br><span class="line">  <span class="keyword">return</span> crypt</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_init_sbox</span>(<span class="params">key</span>):</span><br><span class="line">  s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;原来的 s 盒：%s&quot;</span> % s_box)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  j = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    j = (j + s_box[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">    s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;混乱后的 s 盒：%s&quot;</span> % s_box)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> s_box</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_excrypt</span>(<span class="params">plain, box</span>):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;调用解密程序成功。&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  plain = base64.b64decode(plain.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">  plain = <span class="built_in">bytes</span>.decode(plain)</span><br><span class="line">  res = []</span><br><span class="line">  i = j = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">    i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">    j = (j + box[i]) % <span class="number">256</span></span><br><span class="line">    box[i], box[j] = box[j], box[i]</span><br><span class="line">    t = (box[i] + box[j]) % <span class="number">256</span></span><br><span class="line">    k = box[t]</span><br><span class="line">    res.append((<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;res用于解密字符串，解密后是：%res&quot;</span> % res)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  cipher = <span class="string">&quot;&quot;</span>.join(res)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;解密后的字符串是：%s&quot;</span> % cipher)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> cipher</span><br><span class="line"><span class="comment">#a=[0xE0,0xB2,0x5F,0x3D,0x8F,0xFA,0x94,0xB6,0xE7,0x9D,0x6C,0x98,0x66,0xD2,0x0F,0xEA,0x6D,0x6F,0xBE,0xC5,0x71,0x40,0x08,0x1B,0xF6,0xF3,0xBD,0xA8,0x8D,0x09,0x7B,0x7C]</span></span><br><span class="line">a = [<span class="number">251</span>, <span class="number">198</span>, <span class="number">166</span>, <span class="number">157</span>, <span class="number">196</span>, <span class="number">219</span>, <span class="number">123</span>, <span class="number">86</span>, <span class="number">182</span>, <span class="number">70</span>, <span class="number">166</span>, <span class="number">192</span>, <span class="number">133</span>, <span class="number">100</span>, <span class="number">122</span>, <span class="number">154</span>, <span class="number">55</span>, <span class="number">76</span>, <span class="number">16</span>, <span class="number">150</span>, <span class="number">233</span>, <span class="number">167</span>, <span class="number">40</span>, <span class="number">196</span>, <span class="number">177</span>, <span class="number">45</span>, <span class="number">241</span>, <span class="number">222</span>, <span class="number">71</span>, <span class="number">59</span>, <span class="number">181</span>, <span class="number">243</span>, <span class="number">44</span>, <span class="number">125</span>, <span class="number">103</span>, <span class="number">29</span>]</span><br><span class="line">s = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">  s += <span class="built_in">chr</span>(i)</span><br><span class="line">s = <span class="built_in">str</span>(base64.b64encode(s.encode(<span class="string">&#x27;utf-8&#x27;</span>)), <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">rc4_main(<span class="string">&quot;thisiskkk&quot;</span>, s)</span><br></pre></td></tr></table></figure>



<h2 id="EzGo"><a href="#EzGo" class="headerlink" title="EzGo"></a>EzGo</h2><p>这个题又是go，确实不难。难的是解方程。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">main_main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v1; <span class="comment">// rsi</span></span><br><span class="line">  __int128 v2; <span class="comment">// xmm0</span></span><br><span class="line">  __int64 v3; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 i; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+10h] [rbp-120h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+10h] [rbp-120h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int64 v12; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int128 v13; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  <span class="type">char</span> v15; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  _QWORD *v16; <span class="comment">// [rsp+20h] [rbp-110h]</span></span><br><span class="line">  __int64 v17; <span class="comment">// [rsp+20h] [rbp-110h]</span></span><br><span class="line">  __int64 v18; <span class="comment">// [rsp+20h] [rbp-110h]</span></span><br><span class="line">  __int64 v19; <span class="comment">// [rsp+28h] [rbp-108h]</span></span><br><span class="line">  __int64 v20; <span class="comment">// [rsp+28h] [rbp-108h]</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp+30h] [rbp-100h]</span></span><br><span class="line">  __int64 v22; <span class="comment">// [rsp+30h] [rbp-100h]</span></span><br><span class="line">  __int64 v23; <span class="comment">// [rsp+38h] [rbp-F8h]</span></span><br><span class="line">  __int128 v24; <span class="comment">// [rsp+40h] [rbp-F0h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+50h] [rbp-E0h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+58h] [rbp-D8h]</span></span><br><span class="line">  __int64 v27; <span class="comment">// [rsp+60h] [rbp-D0h]</span></span><br><span class="line">  <span class="type">char</span> v28[<span class="number">24</span>]; <span class="comment">// [rsp+68h] [rbp-C8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v29; <span class="comment">// [rsp+80h] [rbp-B0h] BYREF</span></span><br><span class="line">  __int64 v30; <span class="comment">// [rsp+88h] [rbp-A8h]</span></span><br><span class="line">  __int64 *v31; <span class="comment">// [rsp+90h] [rbp-A0h]</span></span><br><span class="line">  _QWORD v32[<span class="number">2</span>]; <span class="comment">// [rsp+98h] [rbp-98h] BYREF</span></span><br><span class="line">  _QWORD v33[<span class="number">2</span>]; <span class="comment">// [rsp+A8h] [rbp-88h] BYREF</span></span><br><span class="line">  _QWORD v34[<span class="number">2</span>]; <span class="comment">// [rsp+B8h] [rbp-78h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v35[<span class="number">8</span>]; <span class="comment">// [rsp+C8h] [rbp-68h] BYREF</span></span><br><span class="line">  __int64 v36; <span class="comment">// [rsp+D0h] [rbp-60h]</span></span><br><span class="line">  __int128 v37; <span class="comment">// [rsp+D8h] [rbp-58h]</span></span><br><span class="line">  <span class="type">char</span> v38[<span class="number">8</span>]; <span class="comment">// [rsp+E8h] [rbp-48h] BYREF</span></span><br><span class="line">  __int64 v39; <span class="comment">// [rsp+F0h] [rbp-40h]</span></span><br><span class="line">  __int128 v40; <span class="comment">// [rsp+F8h] [rbp-38h]</span></span><br><span class="line">  <span class="type">char</span> v41[<span class="number">8</span>]; <span class="comment">// [rsp+108h] [rbp-28h] BYREF</span></span><br><span class="line">  __int64 v42; <span class="comment">// [rsp+110h] [rbp-20h]</span></span><br><span class="line">  __int128 v43; <span class="comment">// [rsp+118h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int64)&amp;v29 &lt;= *(_QWORD *)(*(_QWORD *)NtCurrentTeb()-&gt;NtTib.ArbitraryUserPointer + <span class="number">16LL</span>) )</span><br><span class="line">    runtime_morestack_noctxt();</span><br><span class="line">  v31 = (__int64 *)runtime_newobject((__int64)&amp;unk_4D3020);</span><br><span class="line">  v34[<span class="number">0</span>] = <span class="string">&quot;\b&quot;</span>;</span><br><span class="line">  v34[<span class="number">1</span>] = v31;</span><br><span class="line">  v9 = <span class="number">2</span>;</span><br><span class="line">  v16 = v34;</span><br><span class="line">  v19 = <span class="number">1LL</span>;</span><br><span class="line">  v21 = <span class="number">1LL</span>;</span><br><span class="line">  fmt_Fscanf(v0, v1, (<span class="type">const</span> <span class="type">char</span> *)&amp;off_515980);</span><br><span class="line">  <span class="keyword">if</span> ( v31[<span class="number">1</span>] != <span class="number">40</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">  v41[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v42 = <span class="number">0LL</span>;</span><br><span class="line">  v2 = <span class="number">0LL</span>;</span><br><span class="line">  v43 = <span class="number">0LL</span>;</span><br><span class="line">  v3 = *v31;</span><br><span class="line">  v30 = *v31;</span><br><span class="line">  v4 = v31[<span class="number">1</span>];</span><br><span class="line">  v27 = v4;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; v4; i = v26 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(<span class="type">unsigned</span> __int8 *)(v3 + i) &gt;= <span class="number">0x80</span>u )</span><br><span class="line">    &#123;</span><br><span class="line">      runtime_decoderune(v3, v4, i, v9, (__int64)v16);</span><br><span class="line">      v6 = v17;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v26 = v6;</span><br><span class="line">    v25 = math_big_nat_shl(</span><br><span class="line">            v42,</span><br><span class="line">            v43,</span><br><span class="line">            *((__int64 *)&amp;v43 + <span class="number">1</span>),</span><br><span class="line">            v42,</span><br><span class="line">            v43,</span><br><span class="line">            *((__int64 *)&amp;v43 + <span class="number">1</span>),</span><br><span class="line">            <span class="number">8LL</span>,</span><br><span class="line">            v23,</span><br><span class="line">            v24,</span><br><span class="line">            *((__int64 *)&amp;v24 + <span class="number">1</span>));</span><br><span class="line">    v43 = v24;</span><br><span class="line">    v42 = v23;</span><br><span class="line">    v38[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    v39 = <span class="number">0LL</span>;</span><br><span class="line">    v40 = <span class="number">0LL</span>;</span><br><span class="line">    v10 = math_big___ptr_Int__SetInt64((__int64)v38, SHIDWORD(v25), v7);</span><br><span class="line">    v16 = (_QWORD *)math_big___ptr_Int__Add((__int64)v41, (__int64)v41, v8, v10);</span><br><span class="line">    v4 = v27;</span><br><span class="line">    v3 = v30;</span><br><span class="line">    v2 = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v35[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v36 = <span class="number">0LL</span>;</span><br><span class="line">  v37 = v2;</span><br><span class="line">  v22 = math_big___ptr_Int__SetString(</span><br><span class="line">          (__int64)v35,</span><br><span class="line">          (__int64)<span class="string">&quot;13145309456454850877228433642468099885703532627357198144609408341691751453534987676043709654743561019&quot;</span></span><br><span class="line">                   <span class="string">&quot;0391556347148927592380050533193934285571983556924577144473815598516557161&quot;</span>,</span><br><span class="line">          <span class="number">174LL</span>,</span><br><span class="line">          <span class="number">10LL</span>,</span><br><span class="line">          (__int64)v16,</span><br><span class="line">          v19);</span><br><span class="line">  math_big___ptr_Int__Mul((__int64)v41, (__int64)v41, (__int64)v41, v11);</span><br><span class="line">  math_big___ptr_Int__Mod((__int64)v41, (__int64)v41, (__int64)v35, v12);</span><br><span class="line">  math_big_nat_itoa(v42, v43, DWORD2(v43), v41[<span class="number">0</span>], <span class="number">10LL</span>, v19, v22, v23);</span><br><span class="line">  v19 = runtime_slicebytetostring((__int64)v28, v20, v21, v13);</span><br><span class="line">  <span class="keyword">if</span> ( v18 != <span class="number">173</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">  runtime_memequal(</span><br><span class="line">    v14,</span><br><span class="line">    (__int64)<span class="string">&quot;33529281532734294938614341047870321616766628114182320093600990983456360122704185955921012051918080449587733&quot;</span></span><br><span class="line">             <span class="string">&quot;939007294096845300395098833835443815283246602601870001850089370636&quot;</span>,</span><br><span class="line">    <span class="number">173LL</span>,</span><br><span class="line">    v14);</span><br><span class="line">  <span class="keyword">if</span> ( v15 )</span><br><span class="line">  &#123;</span><br><span class="line">    v33[<span class="number">0</span>] = &amp;unk_4D3020;</span><br><span class="line">    v33[<span class="number">1</span>] = &amp;off_514208;</span><br><span class="line">    fmt_Fprintln((__int64)&amp;off_5159A0, qword_59D910, (__int64)v33, <span class="number">1LL</span>, <span class="number">1LL</span>, v19, v21, v23);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_10:</span><br><span class="line">    v32[<span class="number">0</span>] = &amp;unk_4D3020;</span><br><span class="line">    v32[<span class="number">1</span>] = &amp;off_514218;</span><br><span class="line">    fmt_Fprintln((__int64)&amp;off_5159A0, qword_59D910, (__int64)v32, <span class="number">1LL</span>, <span class="number">1LL</span>, v19, v21, v23);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>v14是我们通过输入计算出的值，来看程序，首先是输入，然后是一个for循环，for里嵌套一个decode程序，不知道是干什么的，刚开始还以为是解密程序，准备试试能不能解密，发现好像不行，那就慢慢跟程序，else里的是把输入的flag转换成ascii然后拼在一块，接下来是一个Mul函数，是将其乘方，然后是一个Mod函数，也就是mod这个大数，最后是equal函数，与大数对比。我们通过输入和输出就可以判断出自己的想法是否正确。</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">输入 <span class="string">&#x27;1&#x27;</span> * <span class="number">40</span></span><br><span class="line">得到 <span class="number">44940666680036190507667229736237320843945547872118244516233712832889597565447002558460113570518306630271439743085954562346590579900861429645286911145287866527699481049284543</span></span><br><span class="line"></span><br><span class="line">猜测：<span class="number">0</span>x31313131313131313131313131313131313131313131313131313131313131313131313131313131 * <span class="number">0</span>x31313131313131313131313131313131313131313131313131313131313131313131313131313131 <span class="comment">% 131453094564548508772284336424680998857035326273571981446094083416917514535349876760437096547435610190391556347148927592380050533193934285571983556924577144473815598516557161 = 44940666680036190507667229736237320843945547872118244516233712832889597565447002558460113570518306630271439743085954562346590579900861429645286911145287866527699481049284543</span></span><br><span class="line">所以我们可以知道，我们要解一个方程 x^<span class="number">2</span> <span class="comment">% big_num = result</span></span><br></pre></td></tr></table></figure>

<p>这玩意是个rabin，纯密码学了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="comment">#导入公钥</span></span><br><span class="line">n=<span class="number">131453094564548508772284336424680998857035326273571981446094083416917514535349876760437096547435610190391556347148927592380050533193934285571983556924577144473815598516557161</span></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line">c=<span class="number">33529281532734294938614341047870321616766628114182320093600990983456360122704185955921012051918080449587733939007294096845300395098833835443815283246602601870001850089370636</span></span><br><span class="line"><span class="comment">#n 在线分解</span></span><br><span class="line">p=<span class="number">17489158711316178659</span></span><br><span class="line">q=<span class="number">7516261744453902635364442762653073356746063224482072262455102025715350278471780391042196223686233375846890331396948280463168691132631674699134296333350979</span></span><br><span class="line">inv_p = gmpy2.invert(p, q)</span><br><span class="line">inv_q = gmpy2.invert(q, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">a = (inv_p * p * mq + inv_q * q * mp) % n</span><br><span class="line">b = n - <span class="built_in">int</span>(a)</span><br><span class="line">c = (inv_p * p * mq - inv_q * q * mp) % n</span><br><span class="line">d = n - <span class="built_in">int</span>(c)</span><br><span class="line"><span class="comment">#因为rabin 加密有四种结果，全部列出。</span></span><br><span class="line">aa=[a,b,c,d]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(i)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#DASCTF&#123;48fa8aa2b489e9adac1750ea16ddc7b5&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="fantansic-maze"><a href="#fantansic-maze" class="headerlink" title="fantansic maze"></a>fantansic maze</h2><p>这题刚开始比赛的时候就在看这个，首先是与靶机交互，先爆破四位sha256，然后得到base64加密的ELF文件，创建新文件发现迷宫，就是要走1000次然后到达func1000。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000001358</span>                 public function_0</span><br><span class="line">.text:<span class="number">0000000000001358</span> function_0      proc near               ; CODE XREF: function_156+<span class="number">85</span>↓p</span><br><span class="line">.text:<span class="number">0000000000001358</span>                                         ; function_328+C1↓p ...</span><br><span class="line">.text:<span class="number">0000000000001358</span></span><br><span class="line">.text:<span class="number">0000000000001358</span> var_4           = dword ptr <span class="number">-4</span></span><br><span class="line">.text:<span class="number">0000000000001358</span></span><br><span class="line">.text:<span class="number">0000000000001358</span> ; __unwind &#123;</span><br><span class="line">.text:<span class="number">0000000000001358</span>                 endbr64</span><br><span class="line">.text:<span class="number">000000000000135</span>C                 push    rbp</span><br><span class="line">.text:<span class="number">000000000000135</span>D                 mov     rbp, rsp</span><br><span class="line">.text:<span class="number">0000000000001360</span>                 sub     rsp, <span class="number">10</span>h</span><br><span class="line">.text:<span class="number">0000000000001364</span>                 mov     eax, cs:tmp</span><br><span class="line">.text:<span class="number">000000000000136</span>A                 add     eax, <span class="number">1</span></span><br><span class="line">.text:<span class="number">000000000000136</span>D                 mov     cs:tmp, eax</span><br><span class="line">.text:<span class="number">0000000000001373</span>                 lea     rdi, s          ; <span class="string">&quot;step1:&quot;</span></span><br><span class="line">.text:<span class="number">000000000000137</span>A                 call    _puts</span><br><span class="line">.text:<span class="number">000000000000137F</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001384</span>                 call    read_num</span><br><span class="line">.text:<span class="number">0000000000001389</span>                 mov     [rbp+var_4], eax</span><br><span class="line">.text:<span class="number">000000000000138</span>C                 cmp     [rbp+var_4], <span class="number">0</span>Ah</span><br><span class="line">.text:<span class="number">0000000000001390</span>                 ja      loc_141E</span><br><span class="line">.text:<span class="number">0000000000001396</span>                 mov     eax, [rbp+var_4]</span><br><span class="line">.text:<span class="number">0000000000001399</span>                 lea     rdx, ds:<span class="number">0</span>[rax*<span class="number">4</span>]</span><br><span class="line">.text:<span class="number">00000000000013</span>A1                 lea     rax, unk_3501C</span><br><span class="line">.text:<span class="number">00000000000013</span>A8                 mov     eax, [rdx+rax]</span><br><span class="line">.text:<span class="number">00000000000013</span>AB                 cdqe</span><br><span class="line">.text:<span class="number">00000000000013</span>AD                 lea     rdx, unk_3501C</span><br><span class="line">.text:<span class="number">00000000000013B</span>4                 add     rax, rdx</span><br><span class="line">.text:<span class="number">00000000000013B</span>7                 db      <span class="number">3</span>Eh</span><br><span class="line">.text:<span class="number">00000000000013B</span>7                 jmp     rax</span><br><span class="line">.text:<span class="number">00000000000013B</span>A ; ---------------------------------------------------------------------------</span><br><span class="line">.text:<span class="number">00000000000013B</span>A                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013B</span>F                 call    function_163</span><br><span class="line">.text:<span class="number">00000000000013</span>C4                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013</span>C9                 call    function_451</span><br><span class="line">.text:<span class="number">00000000000013</span>CE                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013</span>D3                 call    function_771</span><br><span class="line">.text:<span class="number">00000000000013</span>D8                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013</span>DD                 call    function_602</span><br><span class="line">.text:<span class="number">00000000000013E2</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013E7</span>                 call    function_859</span><br><span class="line">.text:<span class="number">00000000000013</span>EC                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013F</span>1                 call    function_998</span><br><span class="line">.text:<span class="number">00000000000013F</span>6                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013F</span>B                 call    function_958</span><br><span class="line">.text:<span class="number">0000000000001400</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001405</span>                 call    function_437</span><br><span class="line">.text:<span class="number">000000000000140</span>A                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">000000000000140F</span>                 call    function_582</span><br><span class="line">.text:<span class="number">0000000000001414</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001419</span>                 call    function_474</span><br><span class="line">.text:<span class="number">000000000000141</span>E</span><br><span class="line">.text:<span class="number">000000000000141</span>E loc_141E:                               ; CODE XREF: function_0+<span class="number">38</span>↑j</span><br><span class="line">.text:<span class="number">000000000000141</span>E                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001423</span>                 call    main</span><br><span class="line">.text:<span class="number">0000000000001428</span>                 nop</span><br><span class="line">.text:<span class="number">0000000000001429</span>                 leave</span><br><span class="line">.text:<span class="number">000000000000142</span>A                 retn</span><br><span class="line">.text:<span class="number">000000000000142</span>A ; &#125; <span class="comment">// starts at 1358</span></span><br><span class="line">.text:<span class="number">000000000000142</span>A function_0      endp</span><br></pre></td></tr></table></figure>

<p>直接看汇编，也就是一个switch，输入1就跳转到function_163这样的。这种switch操作是通过rax寄存器进行跳转，并不是找表来跳转。如果我们每次switch都选择default，其实就可以一直填充计数器，所以只需找一条路直达func1000就行，我们只能从传过来的16进制来分析call指令的地址，call指令占5个字节如<code>00000000000013BF                 call    function_541</code> 在 Hex View 中为<code>\x00\x01\xbd\x7b\xe8</code>(这里为大端序), <code>\xe8</code>可以理解为标志位,<code>\x00\x01\xbd\x7b</code>为地址到跳转函数的<code>00000000000013BF</code>偏移,而这里每一个函数的偏移为0xd3，这里就可以通过偏移来算出<code>call</code>指令所指向的函数,不会写交互脚本，所以只能借鉴出题师傅的脚本来写一遍：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">1447</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pass_proof</span>():</span><br><span class="line">    <span class="built_in">dir</span> = string.ascii_letters + string.digits</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;[+] sha256(XXXX+&#x27;</span>)</span><br><span class="line">    <span class="comment">#salt是已知的后面几位</span></span><br><span class="line">    salt = p.recv(<span class="number">16</span>).strip().decode()</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;) == &#x27;</span>)</span><br><span class="line">    <span class="comment">#hash就是要等于的值</span></span><br><span class="line">    <span class="built_in">hash</span> = p.recv(<span class="number">64</span>).strip().decode()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        rand_str = (<span class="string">&#x27;&#x27;</span>.join([random.choice(<span class="built_in">dir</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)])) + salt</span><br><span class="line">        <span class="keyword">if</span> sha256(rand_str.encode()).hexdigest() == <span class="built_in">hash</span>:</span><br><span class="line">            <span class="built_in">print</span>(rand_str[:<span class="number">4</span>])</span><br><span class="line">            p.sendlineafter(<span class="string">&#x27;[+] Plz Tell Me XXXX :&#x27;</span>, rand_str[:<span class="number">4</span>])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_elf</span>():</span><br><span class="line">    p.recvuntil(<span class="string">&quot;map :\n&quot;</span>)</span><br><span class="line">    data = p.recvuntil(<span class="string">&#x27;That\&#x27;s all\n&#x27;</span>,drop=<span class="literal">True</span>)[:-<span class="number">1</span>]</span><br><span class="line">    data = base64.b64decode(data)</span><br><span class="line">    fd = <span class="built_in">open</span>(<span class="string">&#x27;./1&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    fd.write(data)</span><br><span class="line">    fd.close()</span><br><span class="line"></span><br><span class="line">pass_proof()</span><br><span class="line">get_elf()</span><br><span class="line"></span><br><span class="line">fd = <span class="built_in">open</span>(<span class="string">&quot;./1&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line"><span class="comment">#fucn0地址</span></span><br><span class="line">offset = <span class="number">0x13c0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_map</span>(<span class="params">fd, offset</span>):</span><br><span class="line">    Map = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        addr = offset</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            fd.seek(addr)</span><br><span class="line">            fc = u64(fd.read(<span class="number">4</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">            <span class="keyword">if</span> fc &lt;= <span class="number">0x33765</span>:</span><br><span class="line">                fc = fc // <span class="number">0xd3</span> + i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                fc = fc - <span class="number">0x100000000</span></span><br><span class="line">                <span class="keyword">if</span> fc &gt; -<span class="number">0xd3</span>:</span><br><span class="line">                    fc = i</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">if</span> addr + fc &lt; <span class="number">0x134a</span>:</span><br><span class="line">                        fc = <span class="number">1000</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        fc = fc // <span class="number">0xd3</span></span><br><span class="line">                        fc = fc + i + <span class="number">1</span></span><br><span class="line">            Map.append(fc)</span><br><span class="line">            addr += <span class="number">0xa</span></span><br><span class="line">        offset += <span class="number">0xd3</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> Map</span><br><span class="line">Map = get_map(fd, offset)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">do_bfs</span>(<span class="params">Map</span>):</span><br><span class="line">    values = []</span><br><span class="line">    keys = []</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">                values.append([])</span><br><span class="line">            values[y].append(Map[x + y * <span class="number">10</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        keys.append(i)</span><br><span class="line">    result = <span class="built_in">dict</span>(<span class="built_in">zip</span>(keys, values))</span><br><span class="line">    result[<span class="number">1000</span>] = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment">#print(result)</span></span><br><span class="line">    result1 = <span class="literal">None</span></span><br><span class="line">    q = [(<span class="number">0</span>, <span class="string">&quot;&quot;</span>)]</span><br><span class="line">    check_map = &#123;&#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(q):</span><br><span class="line">        f = q[<span class="number">0</span>]</span><br><span class="line">        q = q[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">if</span>(f[<span class="number">0</span>] == <span class="number">1000</span>):</span><br><span class="line">            result1 = f[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> f[<span class="number">0</span>] <span class="keyword">not</span> <span class="keyword">in</span> check_map:</span><br><span class="line">            check_map[f[<span class="number">0</span>]] = f[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">                <span class="keyword">if</span> result[f[<span class="number">0</span>]][i] <span class="keyword">not</span> <span class="keyword">in</span> check_map:</span><br><span class="line">                    q.append((result[f[<span class="number">0</span>]][i],f[<span class="number">1</span>]+<span class="built_in">str</span>(i)))</span><br><span class="line">    <span class="keyword">return</span> result1</span><br><span class="line"></span><br><span class="line">result = do_bfs(Map)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line">result = <span class="built_in">str</span>(result)</span><br><span class="line">times = <span class="number">999</span> - <span class="built_in">len</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment">#default</span></span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(times):</span><br><span class="line">    p.sendline(<span class="string">&quot;11&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="built_in">int</span>(result[i])+<span class="number">1</span>))</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/18/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%AD%E7%9A%84%E6%B5%AE%E7%82%B9%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/18/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%AD%E7%9A%84%E6%B5%AE%E7%82%B9%E6%95%B0/" class="post-title-link" itemprop="url">深入理解计算机中的浮点数</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-07-18 00:15:09" itemprop="dateCreated datePublished" datetime="2022-07-18T00:15:09+08:00">2022-07-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/18/VNCTF2022/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/18/VNCTF2022/" class="post-title-link" itemprop="url">VNCTF2022</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-07-18 00:14:18" itemprop="dateCreated datePublished" datetime="2022-07-18T00:14:18+08:00">2022-07-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/18/SUSCTF2022/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/18/SUSCTF2022/" class="post-title-link" itemprop="url">SUSCTF2022</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-07-18 00:13:43 / 修改时间：00:54:54" itemprop="dateCreated datePublished" datetime="2022-07-18T00:13:43+08:00">2022-07-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SUSCTF2022"><a href="#SUSCTF2022" class="headerlink" title="SUSCTF2022"></a>SUSCTF2022</h1><p>简述：应该是第一次和syclover的师傅们一块参与到比赛中（tql就出一道签到，不算），本次做出了4道题，两道逆向，两道misc，只交了两道misc，逆向师傅太强了！！！</p>
<p><img src="/2022/07/18/SUSCTF2022/11.png"></p>
<p>师傅们都太强了！！！！！</p>
<h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="DigitalCircuits"><a href="#DigitalCircuits" class="headerlink" title="DigitalCircuits"></a><strong>DigitalCircuits</strong></h3><p>给了一个exe的包，包上图片是python。在极客大挑战中就遇到过这种问题，我们首先将exe转成pyc文件：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python</span> pyinstxtractor.<span class="keyword">py</span> DigitalCircuits.<span class="keyword">exe</span></span><br></pre></td></tr></table></figure>

<p>然后取出生成文件夹的struct和同名pyc文件，将struct文件前16字节覆盖到pyc文件上，然后反编译pyc文件。</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uncompyle6 <span class="module-access"><span class="module"><span class="identifier">DigitalCircuits</span>.</span></span>pyc &gt; <span class="module-access"><span class="module"><span class="identifier">DigitalCircuits</span>.</span></span>py</span><br></pre></td></tr></table></figure>

<p>得到源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f1</span>(<span class="params">a, b</span>):</span><br><span class="line">  <span class="keyword">if</span> a == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> b == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f2</span>(<span class="params">a, b</span>):</span><br><span class="line">  <span class="keyword">if</span> a == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> b == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f3</span>(<span class="params">a</span>):</span><br><span class="line">  <span class="keyword">if</span> a == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> a == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f4</span>(<span class="params">a, b</span>):</span><br><span class="line">  <span class="keyword">return</span> f2(f1(a, f3(b)), f1(f3(a), b))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f5</span>(<span class="params">x, y, z</span>):</span><br><span class="line">  s = f4(f4(x, y), z)</span><br><span class="line">  c = f2(f1(x, y), f1(z, f2(x, y)))</span><br><span class="line">  <span class="keyword">return</span> (s, c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f6</span>(<span class="params">a, b</span>):</span><br><span class="line">  ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  z = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">  a = a[::-<span class="number">1</span>]</span><br><span class="line">  b = b[::-<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    ans += f5(a[i], b[i], z)[<span class="number">0</span>]</span><br><span class="line">    z = f5(a[i], b[i], z)[<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">return</span> ans[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f7</span>(<span class="params">a, n</span>):</span><br><span class="line">  <span class="keyword">return</span> a[n:] + <span class="string">&#x27;0&#x27;</span> * n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f8</span>(<span class="params">a, n</span>):</span><br><span class="line">  <span class="keyword">return</span> n * <span class="string">&#x27;0&#x27;</span> + a[:-n]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f9</span>(<span class="params">a, b</span>):</span><br><span class="line">  ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    ans += f4(a[i], b[i])</span><br><span class="line">  <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f10</span>(<span class="params">v0, v1, k0, k1, k2, k3</span>):</span><br><span class="line">  s = <span class="string">&#x27;00000000000000000000000000000000&#x27;</span></span><br><span class="line">  d = <span class="string">&#x27;10011110001101110111100110111001&#x27;</span><span class="comment">#这是delta的值，老朋友了</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    s = f6(s, d)</span><br><span class="line">    v0 = f6(v0, f9(f9(f6(f7(v1, <span class="number">4</span>), k0), f6(v1, s)), f6(f8(v1, <span class="number">5</span>), k1))) <span class="comment">#从常数猜测是tea加密，并没有&amp;3，不是xtea</span></span><br><span class="line">    v1 = f6(v1, f9(f9(f6(f7(v0, <span class="number">4</span>), k2), f6(v0, s)), f6(f8(v0, <span class="number">5</span>), k3)))</span><br><span class="line">  <span class="keyword">return</span> v0 + v1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k0 = <span class="string">&#x27;0100010001000101&#x27;</span>.zfill(<span class="number">32</span>)  <span class="comment">#密钥，zfill是将前面的数补成后面长度，前面加0</span></span><br><span class="line">k1 = <span class="string">&#x27;0100000101000100&#x27;</span>.zfill(<span class="number">32</span>)  <span class="comment">#密钥</span></span><br><span class="line">k2 = <span class="string">&#x27;0100001001000101&#x27;</span>.zfill(<span class="number">32</span>)  <span class="comment">#密钥</span></span><br><span class="line">k3 = <span class="string">&#x27;0100010101000110&#x27;</span>.zfill(<span class="number">32</span>)  <span class="comment">#密钥</span></span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&#x27;please input flag:&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> flag[<span class="number">0</span>:<span class="number">7</span>] != <span class="string">&#x27;SUSCTF&#123;&#x27;</span> <span class="keyword">or</span> flag[(-<span class="number">1</span>)] != <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Error!!!The formate of flag is SUSCTF&#123;XXX&#125;&#x27;</span>)</span><br><span class="line">  time.sleep(<span class="number">5</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line">flagstr = flag[<span class="number">7</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(flagstr) != <span class="number">24</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Error!!!The length of flag 24&#x27;</span>)</span><br><span class="line">  time.sleep(<span class="number">5</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flagstr), <span class="number">8</span>):</span><br><span class="line">    v0 = flagstr[i:i + <span class="number">4</span>]</span><br><span class="line">    v0 = <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[i]))[<span class="number">2</span>:].zfill(<span class="number">8</span>) + <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">1</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>) + <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">2</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>) + <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">3</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line">    v1 = <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">4</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>) + <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">5</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>) + <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">6</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>) + <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">7</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line">    res += f10(v0, v1, k0, k1, k2, k3)</span><br><span class="line">  <span class="keyword">if</span> res == <span class="string">&#x27;00111110100010010100011111001011 11001100100101000100011000111001 00110001001101011000001110001000 00111011000010110110100010010011 11011010011000100111001101100001 00111011001011100110010000100111&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;True&#x27;</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;False&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line"><span class="comment"># okay decompiling DigitalCircuits.pyc</span></span><br></pre></td></tr></table></figure>

<p>很显然从f10能看出这就是个tea加密，并且没有魔改：</p>
<p>但从res能看出是3组数组，不是4组，所以给出脚本：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">btea</span> <span class="params">(<span class="type">uint32_t</span>* v,<span class="type">int</span> n, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">  <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0xC6EF3720</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">  <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;           <span class="comment">/* a key schedule constant */</span></span><br><span class="line">  <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];  <span class="comment">/* cache key */</span></span><br><span class="line">  <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;             <span class="comment">/* basic cycle start */</span></span><br><span class="line">    v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">    v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">    sum -= delta;</span><br><span class="line">  &#125;                        <span class="comment">/* end cycle */</span></span><br><span class="line">  v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">uint32_t</span> v[<span class="number">2</span>]= &#123;<span class="number">0x3e8947cb</span>,<span class="number">0xcc944639</span>&#125;;</span><br><span class="line">  <span class="type">uint32_t</span> w[<span class="number">2</span>]= &#123;<span class="number">0x31358388</span>,<span class="number">0x3b0b6893</span>&#125;;</span><br><span class="line">  <span class="type">uint32_t</span> x[<span class="number">2</span>]= &#123;<span class="number">0xda627361</span>,<span class="number">0x3b2e6427</span>&#125;;</span><br><span class="line">  <span class="type">uint32_t</span> k[<span class="number">4</span>]= &#123;<span class="number">17477</span>,<span class="number">16708</span>,<span class="number">16965</span>,<span class="number">17734</span>&#125;;</span><br><span class="line">  <span class="type">int</span> n = <span class="number">2</span>; <span class="comment">//n的绝对值表示v的长度，取正表示加密，取负表示解密</span></span><br><span class="line">  <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">  <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">  btea(v, -n, k);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%x %x &quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">  btea(w, -n, k);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%x %x &quot;</span>,w[<span class="number">0</span>],w[<span class="number">1</span>]);</span><br><span class="line">  btea(x, -n, k);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%x %x&quot;</span>,x[<span class="number">0</span>],x[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>解出来，转换成字符串，然后套上壳。</p>
<p><strong>hell_world</strong></p>
<p>这个题听师傅说与西湖论剑的题是一样的。怪不得出那么快，我们来好好看一下这个题，有点像hgame里面那道虚拟机的题</p>
<p>这个题运行顺序是：0 – 1 – 2 – 3，在3出进行一次字符串判断，长度是44才能到4去，如果不是到5，然后输出wrong。</p>
<p>看内存发现输入数据存入了a1数组</p>
<p><img src="/2022/07/18/SUSCTF2022/../../blog/source/_posts/SUSCTF2022/image-20220301155721448.png"></p>
<p>然后转到9 – 10 – 11</p>
<p>其中case9是将输入转化为二进制，只是0和1使用2和3来替换，接着执行的case10是使用异或数组与输入进行异或操作且转化为二进制。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">       v17 = sub_7FF6554DEB56();</span><br><span class="line">       v41 = *(_QWORD *)(a1 + <span class="number">344</span>);</span><br><span class="line">       v42 = <span class="number">0</span>;</span><br><span class="line">       sub_7FF6554A3F60((__int64)&amp;v41);</span><br><span class="line">       *(_QWORD *)(a1 + <span class="number">344</span>) = v41;</span><br><span class="line">       *(_BYTE *)(a1 + <span class="number">368</span>) = v42;</span><br><span class="line">       sub_7FF6554DEBD4(v17);</span><br><span class="line">       *(_DWORD *)(a1 + <span class="number">372</span>) = *(<span class="type">unsigned</span> __int8 *)(a1 + <span class="number">368</span>);</span><br><span class="line">       v18 = sub_7FF6554DEB56();</span><br><span class="line">       v19 = *(_DWORD *)(a1 + <span class="number">372</span>);</span><br><span class="line">       <span class="keyword">if</span> ( v19 &lt; <span class="number">0</span> )</span><br><span class="line">         sub_7FF6554F88D2(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">48</span>i64);</span><br><span class="line">       sub_7FF6554D0180(&amp;v77, (<span class="type">unsigned</span> <span class="type">int</span>)v19, <span class="number">8</span>i64);</span><br><span class="line">       v55 = v77;</span><br><span class="line">       v56 = v38;</span><br><span class="line">       v38[<span class="number">0</span>] = *(_DWORD *)v78;</span><br><span class="line">       v38[<span class="number">1</span>] = *(_DWORD *)(v78 + <span class="number">4</span>);</span><br><span class="line">       v39 = *(_BYTE *)(v78 + <span class="number">8</span>);</span><br><span class="line">       v40 = *(_DWORD *)(v78 + <span class="number">12</span>);</span><br><span class="line">       <span class="keyword">if</span> ( v40 != <span class="number">8</span> )</span><br><span class="line">         sub_7FF6554F88D2(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">48</span>i64);</span><br><span class="line">       v23 = v55;</span><br><span class="line">       <span class="keyword">for</span> ( i = <span class="number">0</span>i64; (<span class="type">unsigned</span> <span class="type">int</span>)i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">       &#123;</span><br><span class="line">         v25 = *(_BYTE **)(a1 + <span class="number">8</span> * i + <span class="number">16</span>);</span><br><span class="line">         *(_BYTE *)(a1 + i + <span class="number">392</span>) = *(_BYTE *)(v23 + i);</span><br><span class="line">         v26 = <span class="number">1</span>;</span><br><span class="line">         <span class="keyword">if</span> ( !v25[<span class="number">42</span>] )</span><br><span class="line">           v26 = *v25 != *(_BYTE *)(a1 + i + <span class="number">392</span>);</span><br><span class="line">         <span class="keyword">if</span> ( v26 )</span><br><span class="line">           sub_7FF6554E5B00();</span><br><span class="line">       &#125;</span><br><span class="line">       sub_7FF6554DEBD4(v18);</span><br><span class="line">       result = sub_7FF6554DF80C(<span class="number">1000000</span>i64, (__int64)<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">0x31</span>u);</span><br><span class="line">       *(_DWORD *)(a1 + <span class="number">380</span>) = <span class="number">10</span>;</span><br><span class="line">       <span class="keyword">return</span> result;</span><br></pre></td></tr></table></figure>

<p>我们看到case11处，我们能动调出比较函数，那么一定存在加密后的值，v71–》v6，所以找到了密文，我们输入经过加密就跟密文对比。</p>
<p><img src="/2022/07/18/SUSCTF2022/../../blog/source/_posts/SUSCTF2022/image-20220301164512915.png"></p>
<p>那么我们很容易就写出脚本了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">data1 = [<span class="number">86</span>,</span><br><span class="line"> <span class="number">218</span>,</span><br><span class="line"> <span class="number">205</span>,</span><br><span class="line"> <span class="number">58</span>,</span><br><span class="line"> <span class="number">126</span>,</span><br><span class="line"> <span class="number">134</span>,</span><br><span class="line"> <span class="number">19</span>,</span><br><span class="line"> <span class="number">181</span>,</span><br><span class="line"> <span class="number">29</span>,</span><br><span class="line"> <span class="number">157</span>,</span><br><span class="line"> <span class="number">252</span>,</span><br><span class="line"> <span class="number">151</span>,</span><br><span class="line"> <span class="number">140</span>,</span><br><span class="line"> <span class="number">49</span>,</span><br><span class="line"> <span class="number">107</span>,</span><br><span class="line"> <span class="number">201</span>,</span><br><span class="line"> <span class="number">251</span>,</span><br><span class="line"> <span class="number">26</span>,</span><br><span class="line"> <span class="number">226</span>,</span><br><span class="line"> <span class="number">45</span>,</span><br><span class="line"> <span class="number">220</span>,</span><br><span class="line"> <span class="number">211</span>,</span><br><span class="line"> <span class="number">241</span>,</span><br><span class="line"> <span class="number">244</span>,</span><br><span class="line"> <span class="number">54</span>,</span><br><span class="line"> <span class="number">9</span>,</span><br><span class="line"> <span class="number">32</span>,</span><br><span class="line"> <span class="number">66</span>,</span><br><span class="line"> <span class="number">4</span>,</span><br><span class="line"> <span class="number">106</span>,</span><br><span class="line"> <span class="number">113</span>,</span><br><span class="line"> <span class="number">83</span>,</span><br><span class="line"> <span class="number">120</span>,</span><br><span class="line"> <span class="number">164</span>,</span><br><span class="line"> <span class="number">151</span>,</span><br><span class="line"> <span class="number">143</span>,</span><br><span class="line"> <span class="number">122</span>,</span><br><span class="line"> <span class="number">114</span>,</span><br><span class="line"> <span class="number">57</span>,</span><br><span class="line"> <span class="number">232</span>,</span><br><span class="line"> <span class="number">61</span>,</span><br><span class="line"> <span class="number">250</span>,</span><br><span class="line"> <span class="number">64</span>,</span><br><span class="line"> <span class="number">61</span>,</span><br><span class="line"> <span class="number">408</span>,</span><br><span class="line"> <span class="number">0</span>,</span><br><span class="line"> <span class="number">0</span>,</span><br><span class="line"> <span class="number">0</span>]</span><br><span class="line">data2 = [<span class="number">5</span>,</span><br><span class="line"> <span class="number">143</span>,</span><br><span class="line"> <span class="number">158</span>,</span><br><span class="line"> <span class="number">121</span>,</span><br><span class="line"> <span class="number">42</span>,</span><br><span class="line"> <span class="number">192</span>,</span><br><span class="line"> <span class="number">104</span>,</span><br><span class="line"> <span class="number">129</span>,</span><br><span class="line"> <span class="number">45</span>,</span><br><span class="line"> <span class="number">252</span>,</span><br><span class="line"> <span class="number">207</span>,</span><br><span class="line"> <span class="number">164</span>,</span><br><span class="line"> <span class="number">181</span>,</span><br><span class="line"> <span class="number">85</span>,</span><br><span class="line"> <span class="number">95</span>,</span><br><span class="line"> <span class="number">228</span>,</span><br><span class="line"> <span class="number">157</span>,</span><br><span class="line"> <span class="number">35</span>,</span><br><span class="line"> <span class="number">214</span>,</span><br><span class="line"> <span class="number">29</span>,</span><br><span class="line"> <span class="number">241</span>,</span><br><span class="line"> <span class="number">231</span>,</span><br><span class="line"> <span class="number">151</span>,</span><br><span class="line"> <span class="number">145</span>,</span><br><span class="line"> <span class="number">6</span>,</span><br><span class="line"> <span class="number">36</span>,</span><br><span class="line"> <span class="number">66</span>,</span><br><span class="line"> <span class="number">113</span>,</span><br><span class="line"> <span class="number">60</span>,</span><br><span class="line"> <span class="number">88</span>,</span><br><span class="line"> <span class="number">92</span>,</span><br><span class="line"> <span class="number">48</span>,</span><br><span class="line"> <span class="number">25</span>,</span><br><span class="line"> <span class="number">198</span>,</span><br><span class="line"> <span class="number">245</span>,</span><br><span class="line"> <span class="number">188</span>,</span><br><span class="line"> <span class="number">75</span>,</span><br><span class="line"> <span class="number">66</span>,</span><br><span class="line"> <span class="number">93</span>,</span><br><span class="line"> <span class="number">218</span>,</span><br><span class="line"> <span class="number">88</span>,</span><br><span class="line"> <span class="number">155</span>,</span><br><span class="line"> <span class="number">36</span>,</span><br><span class="line"> <span class="number">64</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data2)):</span><br><span class="line">  flag += <span class="built_in">chr</span>(data1[i] ^ data2[i])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#SUSCTF&#123;40a339d4-f940-4fe0-b382-cabb310d2ead&#125;</span></span><br></pre></td></tr></table></figure>

<p>K.O</p>
<h3 id="tttree"><a href="#tttree" class="headerlink" title="tttree"></a>tttree</h3><p>刚看的时候感觉是个二叉树，但无法反汇编，所以只能审代码。有点难度，复现一下：</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><p>本次misc出了很快，这种感觉很不错，但我很烦题目都是英文，翻译根本翻不了。。。</p>
<h3 id="ra2"><a href="#ra2" class="headerlink" title="ra2"></a>ra2</h3><p>红警游戏，让找旗子，说什么降落到了月球，设定是晚上很危险，白天安全，那直接把白天时间拉满不就行了。</p>
<p>找到目录\Romanovs-Vengeance\mods\rv\maps\ctf-01，找到ctf-01.lua文件，改几个数据</p>
<p><img src="/2022/07/18/SUSCTF2022/../../blog/source/_posts/SUSCTF2022/image-20220228161719337.png"></p>
<p>把时间无限延长，然后进去放几个狗，乱跑找flag</p>
<p><img src="/2022/07/18/SUSCTF2022/../../blog/source/_posts/SUSCTF2022/image-20220228161731827.png"></p>
<p>这个体验不错，就我在图书馆玩游戏，笑死。。</p>
<h3 id="Tanner"><a href="#Tanner" class="headerlink" title="Tanner"></a>Tanner</h3><p>这个题其实我第一天就有思路，而且差不多出来了，就是他这个英文翻译很不准确。。真服了，导致我虚拟机没写完呢，今天还要赶虚拟机。。</p>
<p><img src="/2022/07/18/SUSCTF2022/../../blog/source/_posts/SUSCTF2022/image-20220228161958465.png"></p>
<p>这个图，应该是lpdc的另一种表示，可以表示成矩阵，checknodes当成行，bitnodes当成列，得到（10，5）矩阵，题目给了这样一段提示</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">THE FLAG IS <span class="keyword">the</span> sha256 <span class="keyword">of</span> <span class="keyword">the</span> <span class="built_in">sum</span> ofthe proper codewords(binary plus)which satisfy <span class="keyword">the</span> condition.(note: <span class="keyword">with</span> no zeros front)</span><br></pre></td></tr></table></figure>

<p>我纯纯文盲，应该是让求码字，note的意思应该是最后sum的和前面不能加0，而不是不能用码字求和。。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">N=<span class="number">10</span></span><br><span class="line">K=<span class="number">5</span>   <span class="comment">#这个值是列数-行数，而不是行数！！！这题比较巧</span></span><br><span class="line"></span><br><span class="line">H=np.array([[ <span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line">b=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**N):</span><br><span class="line">    a=<span class="built_in">format</span>(i,<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">    b.append(<span class="string">&quot;&#123;:0&gt;10s&#125;&quot;</span>.<span class="built_in">format</span>(a))</span><br><span class="line"></span><br><span class="line">v=np.zeros((<span class="number">2</span>**N,N))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**N):</span><br><span class="line">    v[i]=b[i]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        v[i][j]=b[i][j] <span class="comment">#v是0000000~1111111</span></span><br><span class="line"></span><br><span class="line">w=np.zeros((<span class="number">1</span>,N-K))</span><br><span class="line"><span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**N):</span><br><span class="line">    <span class="keyword">if</span> np.<span class="built_in">all</span>(np.dot(v[o],H.T)%<span class="number">2</span>==w):</span><br><span class="line">        <span class="built_in">print</span>(v[o])</span><br></pre></td></tr></table></figure>

<p>得到许多二进制，我们求和</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a =</span><br><span class="line"><span class="number">0b0000000000</span>+<span class="number">0b0000000111</span>+<span class="number">0b0000011001</span>+<span class="number">0b0000011110</span>+<span class="number">0b0000101010</span>+<span class="number">0b0000101101</span>+<span class="number">0b0000110011</span>+<span class="number">0b0000110100</span>+<span class="number">0b0011000001</span>+<span class="number">0b0011000110</span>+<span class="number">0b0011011000</span>+<span class="number">0b0011011111</span>+<span class="number">0b0011101011</span>+<span class="number">0b0011101100</span>+<span class="number">0b0011110010</span>+<span class="number">0b0011110101</span>+<span class="number">0b0101000010</span>+<span class="number">0b0101000101</span>+<span class="number">0b0101011011</span>+<span class="number">0b0101011100</span>+<span class="number">0b0101101000</span>+<span class="number">0b0101101111</span>+<span class="number">0b0101110001</span>+<span class="number">0b0101110110</span>+<span class="number">0b0110000011</span>+<span class="number">0b0110000100</span>+<span class="number">0b0110011010</span>+<span class="number">0b0110011101</span>+<span class="number">0b0110101001</span>+<span class="number">0b0110101110</span>+<span class="number">0b0110110000</span>+<span class="number">0b0110110111</span>+<span class="number">0b1001001000</span>+<span class="number">0b1001001111</span>+<span class="number">0b1001010001</span>+<span class="number">0b1001010110</span>+<span class="number">0b1001100010</span>+<span class="number">0b1001100101</span>+<span class="number">0b1001111011</span>+<span class="number">0b1001111100</span>+<span class="number">0b1010001001</span>+<span class="number">0b1010001110</span>+<span class="number">0b1010010000</span>+<span class="number">0b1010010111</span>+<span class="number">0b1010100011</span>+<span class="number">0b1010100100</span>+<span class="number">0b1010111010</span>+<span class="number">0b1010111101</span>+<span class="number">0b1100001010</span>+<span class="number">0b1100001101</span>+<span class="number">0b1100010011</span>+<span class="number">0b1100010100</span>+<span class="number">0b1100100000</span>+<span class="number">0b1100100111</span>+<span class="number">0b1100111001</span>+<span class="number">0b1100111110</span>+<span class="number">0b1111001011</span>+<span class="number">0b1111001100</span>+<span class="number">0b1111010010</span>+<span class="number">0b1111010101</span>+<span class="number">0b1111100001</span>+<span class="number">0b1111100110</span>+<span class="number">0b1111111000</span>+<span class="number">0b1111111111</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment">#111111111100000</span></span><br><span class="line"><span class="comment">#c17019990bf57492cddf24f3cc3be588507b2d567934a101d4de2fa6d606b5c1</span></span><br></pre></td></tr></table></figure>

<p>求得的值再sha256，用小写形式交了！！大写不行！！！</p>
<h3 id="audio"><a href="#audio" class="headerlink" title="audio"></a>audio</h3><p>如果给出了原音频和加密过的音频，要进行音频相消！</p>
<p>把两段音频同时拖进audacity里面，然后分别对音频进行标准化，然后分别截去静音，然后对fromfriends.wav进行反相操作，而后把两段音频叠起来即可</p>
<p><img src="/2022/07/18/SUSCTF2022/image-20220301172357554.png" alt="image-20220301172357554"></p>
<p>读出摩斯密码！</p>
<h3 id="misound"><a href="#misound" class="headerlink" title="misound"></a>misound</h3><p>频谱图中有AnEWmuLTiPLyis_etimes_wiLLbEcomE_B，本以为是前一段flag，没想到是提示。</p>
<p>然后silenteye搞出来base64，翻出来是207 359 220 224 352 315 359 374 290 310 277 507 391 513 423 392 508 383 440 322 420 427 503 460 295 318 245 302 407 414 410 130 369 317</p>
<p>但这个最牛逼的是听起来像个摩斯密码，用sstv分析</p>
<p><img src="/2022/07/18/SUSCTF2022/image-20220301185258769.png" alt="image-20220301185258769"></p>
<p><img src="/2022/07/18/SUSCTF2022/image-20220301185427312.png" alt="image-20220301185427312"></p>
<p>用该网站<a target="_blank" rel="noopener" href="https://www.dcode.fr/dotsies-writing%E8%A7%A3%E5%87%BA%E6%9D%A5">https://www.dcode.fr/dotsies-writing解出来</a></p>
<p>我们用第一组数乘第二组数，然后除以26就基本确定flag长度了，26这个值可以试出来</p>
<p>或者我们观察第一组乘第二组除以第三组就是26的近似值！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/18/d3ctf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/18/d3ctf/" class="post-title-link" itemprop="url">d3ctf</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-07-18 00:08:16 / 修改时间：00:37:24" itemprop="dateCreated datePublished" datetime="2022-07-18T00:08:16+08:00">2022-07-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="D-3CTF"><a href="#D-3CTF" class="headerlink" title="D^3CTF"></a>D^3CTF</h1><p>本次CTF终极被虐，太难了，但始终参与进程中，这两天把逆向题复现一下，这次逆向题的”外壳”很难搞定，学到的东西很多，师傅们太强了！</p>
<p><img src="/2022/07/18/d3ctf/image-20220307141619512.png"></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a><strong>Reverse</strong></h2><h3 id="D3MUG"><a href="#D3MUG" class="headerlink" title="D3MUG"></a><strong>D3MUG</strong></h3><p>这个题是unity3d游戏，而且是一个音游，应该是拿到perfect就会给flag，但被人修改了，用连点器都没用的。</p>
<p>第一次接触unity3d逆向，首先我们要用IL2CPP，来对libil2cpp.so<code>与</code>global-metadata.dat进行操作</p>
<p>我们先把apk软件解压，找到下述文件，copy到Il2CppDumper.exe的文件夹下。</p>
<figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\lib\armeabi-v7a\libil2cpp.so`</span><br><span class="line">`\assets\bin\Data\Managed\Metadata\global-metadata.dat</span><br></pre></td></tr></table></figure>

<p>要新建两个文件夹，第一个是input，第二个是output</p>
<p><img src="/2022/07/18/d3ctf/image-20220307144718157.png"></p>
<p>将<code>libil2cpp.so</code>与<code>global-metadata.dat</code>拷贝到<code>input</code>目录中。再在记事本下输入：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..\Il2CppDumper<span class="selector-class">.exe</span> libil2cpp<span class="selector-class">.so</span> global-metadata<span class="selector-class">.dat</span> ..\output</span><br></pre></td></tr></table></figure>

<p>然后重命名成：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">il2cpp_decompilation.bat</span><br></pre></td></tr></table></figure>

<p>然后运行</p>
<p><img src="/2022/07/18/d3ctf/image-20220307144841622.png"></p>
<p>发现output文件夹生成</p>
<p><img src="/2022/07/18/d3ctf/image-20220307144915739.png"></p>
<p>在DummyDll中存在很多dll文件</p>
<p><img src="/2022/07/18/d3ctf/image-20220307145215194.png"></p>
<p>dump.cs这个文件会把<code>C#</code>的<code>dll</code>代码的类、方法、字段列出来</p>
<p><img src="/2022/07/18/d3ctf/image-20220307145153661.png"></p>
<p>il2cpp.h生成<code>cpp</code>的头文件，从头文件里我们也可以看到相关的数据结构。</p>
<p><img src="/2022/07/18/d3ctf/image-20220307145140712.png"></p>
<p>script.json以<code>json</code>格式显示类的方法信息：</p>
<p><img src="/2022/07/18/d3ctf/image-20220307145249152.png"></p>
<p>stringliteral.json以<code>json</code>的格式显示所有的字符串信息：</p>
<p><img src="/2022/07/18/d3ctf/image-20220307145310439.png"></p>
<p>我们在dump.cs文件中找到ScoreScene类，发现Start会check flag，</p>
<p><img src="/2022/07/18/d3ctf/image-20220307151020607.png"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">GameManager</span> :</span> MonoBehaviour <span class="comment">// TypeDefIndex: 4296</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// Fields</span></span><br><span class="line">	public <span class="type">static</span> GameManager instance; <span class="comment">// 0x0</span></span><br><span class="line">	public TMP_Text GoodText; <span class="comment">// 0xC</span></span><br><span class="line">	public TMP_Text PerfectText; <span class="comment">// 0x10</span></span><br><span class="line">	public TMP_Text MissText; <span class="comment">// 0x14</span></span><br><span class="line">	public BeatScroller beatScroller; <span class="comment">// 0x18</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Methods</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x42CD60 Offset: 0x42CD60 VA: 0x42CD60</span></span><br><span class="line">	public <span class="type">static</span> <span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">update</span><span class="params">(uint msecs)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x42CE00 Offset: 0x42CE00 VA: 0x42CE00</span></span><br><span class="line">	private <span class="type">void</span> <span class="title function_">Start</span><span class="params">()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x42CF24 Offset: 0x42CF24 VA: 0x42CF24</span></span><br><span class="line">	private <span class="type">void</span> <span class="title function_">Update</span><span class="params">()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	[IteratorStateMachine(typeof(GameManager.&lt;loadBeatmap&gt;d__8))]</span><br><span class="line">	<span class="comment">// RVA: 0x42CE7C Offset: 0x42CE7C VA: 0x42CE7C</span></span><br><span class="line">	private IEnumerator <span class="title function_">loadBeatmap</span><span class="params">()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x42CF50 Offset: 0x42CF50 VA: 0x42CF50</span></span><br><span class="line">	public <span class="type">void</span> <span class="title function_">NoteHit</span><span class="params">(<span class="type">float</span> preciseTime, <span class="type">int</span> level)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x42D0A0 Offset: 0x42D0A0 VA: 0x42D0A0</span></span><br><span class="line">	public <span class="type">void</span> <span class="title function_">NoteMissed</span><span class="params">()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x42D1B0 Offset: 0x42D1B0 VA: 0x42D1B0</span></span><br><span class="line">	public <span class="type">void</span> .ctor() &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>GameManager这个类中的update就是d3mug.so中的update函数</p>
<p>如何恢复libil2cpp.so的字符串和函数：</p>
<p>1.先在ida打开libil2cpp.so文件</p>
<p>2.用Script file打开我们下载文件夹中的ida_with_struct.py脚本</p>
<p><img src="/2022/07/18/d3ctf/image-20220307155201813.png"></p>
<p>3.然后会直接让选择下一个文件，我们找到output里的文件</p>
<p><img src="/2022/07/18/d3ctf/image-20220307155249001.png"></p>
<p>4.继续选文件，我们选择il2cpp.h头文件</p>
<p>等待加载就行，但我一加载就卡死，可能这个太大了吧，320mb果然大的离谱</p>
<p><img src="/2022/07/18/d3ctf/image-20220307155743870.png"></p>
<p>找到score_start函数，卡的要死。。。</p>
<p><img src="/2022/07/18/d3ctf/image-20220307155915866.png"></p>
<p><img src="/2022/07/18/d3ctf/image-20220307160824542.png"></p>
<p>在if函数中的就是要检测是否有D3CTF，如果没就会返回这句话,另一个重要的是这个</p>
<p><img src="/2022/07/18/d3ctf/image-20220307161326276.png"></p>
<p><img src="/2022/07/18/d3ctf/image-20220307161426572.png"></p>
<p>可知道这个是引用d3mug文件中的update函数</p>
<p>通过对GameManagerupdate进行交叉引用发现是GameManageNoteHit或GameManagerNoteMissed最后调用的GameManagerupdate，对GameManager__NoteHit进行交叉引用就可以得知是从MusicController上获取的时间，如下图</p>
<p><img src="/2022/07/18/d3ctf/image-20220307161617480.png"></p>
<p>总之，逻辑如下：</p>
<p>玩游戏点击方块后，GameManagerNoteHit之前会从MusicController上获取preciseTime，点击后，GameManagerNoteHit在函数最后调用GameManagerupdate，传入preciseTime，然后update。接下来update检测server：：instance，如果没有就初始化，初始化的值不变，若初始化，就再调用d3mug中server：：run函数，这个函数会更新instance，最后check的地方也是d3mug中的get文件，拿到最后的instance然后比较是否是D3CTF开头</p>
<p><img src="/2022/07/18/d3ctf/image-20220307162703379.png"></p>
<p>GameManagerloadBeatmap_d8__MoveNext函数中发现hintpoints很重要</p>
<p>使用AssetstdioGui来载入assets\bin\Data\data.unity3d</p>
<p>搜索hitpoints，发现有3个，通过运行可以得知总共会掉落1608个块，找到了恰好有1608个的hitpoints</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">hitpoints = <span class="string">&quot;&quot;&quot;4,0 </span></span><br><span class="line"><span class="string">3,0 </span></span><br><span class="line"><span class="string">1,0 </span></span><br><span class="line"><span class="string">3,146 </span></span><br><span class="line"><span class="string">...... </span></span><br><span class="line"><span class="string">2,140195 </span></span><br><span class="line"><span class="string">1,140195 </span></span><br><span class="line"><span class="string">4,140195 </span></span><br><span class="line"><span class="string">3,140195 </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span> </span><br><span class="line">arr = [] </span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> hitpoints.splitlines(): </span><br><span class="line">    arr.append(<span class="built_in">eval</span>(l[l.find(<span class="string">&#x27;,&#x27;</span>)+<span class="number">1</span>:]))</span><br></pre></td></tr></table></figure>

<p>提取逗号后面的数，后面的数就是参数</p>
<p>方法一：对函数复原</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Server::run</span><span class="params">(__int64 this, <span class="type">char</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// x9</span></span><br><span class="line">  __int64 v3; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// x13</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 *v5; <span class="comment">// x12</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// x14</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// x14</span></span><br><span class="line">  __int64 v8; <span class="comment">// x14</span></span><br><span class="line">  <span class="type">int</span> *v9; <span class="comment">// x12</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// w10</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// w13</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// w15</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v14; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v15; <span class="comment">// t2</span></span><br><span class="line"></span><br><span class="line">  v2 = *(_QWORD *)(this + <span class="number">5032</span>);</span><br><span class="line">  v3 = this + <span class="number">40</span>;</span><br><span class="line">  v4 = (v2 + <span class="number">1</span>) % <span class="number">0x270</span>uLL;</span><br><span class="line">  v5 = (<span class="type">unsigned</span> __int64 *)(this + <span class="number">40</span> + <span class="number">8</span> * v4);</span><br><span class="line">  *(_QWORD *)(this + <span class="number">40</span> + <span class="number">8</span> * v2) = (<span class="number">2567483615u</span> * (*v5 &amp; <span class="number">1</span>)) ^ *(_QWORD *)(this + <span class="number">40</span> + <span class="number">8</span> * ((v2 + <span class="number">397</span>) % <span class="number">0x270</span>uLL)) ^ ((*v5 &amp; <span class="number">0x7FFFFFFE</span> | *(_QWORD *)(this + <span class="number">40</span> + <span class="number">8</span> * v2) &amp; <span class="number">0xFFFFFFFF80000000</span>LL) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">  v6 = *(_QWORD *)(this + <span class="number">40</span> + <span class="number">8LL</span> * *(_QWORD *)(this + <span class="number">5032</span>));</span><br><span class="line">  *(_QWORD *)(this + <span class="number">5032</span>) = v4;</span><br><span class="line">  v7 = (((<span class="type">unsigned</span> <span class="type">int</span>)(v6 &gt;&gt; <span class="number">11</span>) ^ (<span class="type">unsigned</span> <span class="type">int</span>)v6) &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9D2C5680</span> ^ (<span class="type">unsigned</span> <span class="type">int</span>)(v6 &gt;&gt; <span class="number">11</span>) ^ v6;</span><br><span class="line">  <span class="keyword">if</span> ( (((_DWORD)v7 &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xEFC60000</span> ^ v7 ^ ((((_DWORD)v7 &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xEFC60000</span> ^ v7) &gt;&gt; <span class="number">18</span>)) % <span class="number">7</span> &gt;= <span class="number">3</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = (<span class="type">unsigned</span> __int16)(v4 + <span class="number">1</span>) % <span class="number">0x270</span>u;</span><br><span class="line">    *v5 = (<span class="number">2567483615u</span> * (*(_QWORD *)(v3 + <span class="number">8LL</span> * (<span class="type">unsigned</span> <span class="type">int</span>)v8) &amp; <span class="number">1LL</span>)) ^ *(_QWORD *)(v3</span><br><span class="line">                                                                                       + <span class="number">8LL</span></span><br><span class="line">                                                                                       * ((<span class="type">unsigned</span> __int16)(v4 + <span class="number">397</span>)</span><br><span class="line">                                                                                        % <span class="number">0x270</span>u)) ^ ((*(_QWORD *)(v3 + <span class="number">8LL</span> * (<span class="type">unsigned</span> <span class="type">int</span>)v8) &amp; <span class="number">0x7FFFFFFE</span>LL | *v5 &amp; <span class="number">0xFFFFFFFF80000000</span>LL) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    v9 = (<span class="type">int</span> *)(this + (a2 &amp; <span class="number">0xF</span>));</span><br><span class="line">    v10 = *(_QWORD *)(v3 + <span class="number">8LL</span> * *(_QWORD *)(this + <span class="number">5032</span>));</span><br><span class="line">    *(_QWORD *)(this + <span class="number">5032</span>) = v8;</span><br><span class="line">    v11 = *v9;</span><br><span class="line">    v12 = v9[<span class="number">1</span>];</span><br><span class="line">    LODWORD(v8) = v9[<span class="number">2</span>];</span><br><span class="line">    v13 = v9[<span class="number">3</span>];</span><br><span class="line">    *v9 = v8;</span><br><span class="line">    v9[<span class="number">1</span>] = v13;</span><br><span class="line">    v14 = (((((<span class="type">unsigned</span> <span class="type">int</span>)(v10 &gt;&gt; <span class="number">11</span>) ^ (<span class="type">unsigned</span> <span class="type">int</span>)v10) &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9D2C5680</span> ^ (<span class="type">unsigned</span> <span class="type">int</span>)(v10 &gt;&gt; <span class="number">11</span>) ^ (<span class="type">unsigned</span> <span class="type">int</span>)v10) &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xEFC60000</span> ^ (((<span class="type">unsigned</span> <span class="type">int</span>)(v10 &gt;&gt; <span class="number">11</span>) ^ (<span class="type">unsigned</span> <span class="type">int</span>)v10) &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9D2C5680</span> ^ (<span class="type">unsigned</span> <span class="type">int</span>)(v10 &gt;&gt; <span class="number">11</span>) ^ v10;</span><br><span class="line">    HIDWORD(v15) = v8 ^ (v14 &gt;&gt; <span class="number">18</span>) ^ v14;</span><br><span class="line">    LODWORD(v15) = HIDWORD(v15);</span><br><span class="line">    LODWORD(v14) = v15 &gt;&gt; <span class="number">19</span>;</span><br><span class="line">    v9[<span class="number">2</span>] = v14 ^ v11;</span><br><span class="line">    v9[<span class="number">3</span>] = v12 ^ __ROR4__(v13, <span class="number">18</span>) ^ v14;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> this;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面是要复原的函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> DWORD hitp[] = &#123; <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">146</span>,<span class="number">292</span>,<span class="number">292</span>,<span class="number">439</span>,<span class="number">512</span>,<span class="number">585</span>,<span class="number">585</span>,<span class="number">658</span>,<span class="number">731</span>,<span class="number">804</span>,<span class="number">878</span>,<span class="number">1024</span>,<span class="number">1170</span>,<span class="number">1170</span>,<span class="number">1317</span>,<span class="number">1463</span>,<span class="number">1463</span>,<span class="number">1609</span>,<span class="number">1682</span>,<span class="number">1756</span>,<span class="number">1756</span>,<span class="number">1902</span>,<span class="number">2048</span>,<span class="number">2195</span>,<span class="number">2341</span>,<span class="number">2341</span>,<span class="number">2487</span>,<span class="number">2634</span>,<span class="number">2634</span>,<span class="number">2780</span>,<span class="number">2853</span>,<span class="number">2926</span>,<span class="number">2926</span>,<span class="number">3073</span>,<span class="number">3146</span>,<span class="number">3219</span>,<span class="number">3219</span>,<span class="number">3365</span>,<span class="number">3439</span>,<span class="number">3512</span>,<span class="number">3512</span>,<span class="number">3658</span>,<span class="number">3804</span>,<span class="number">3878</span>,<span class="number">3951</span>,<span class="number">4024</span>,<span class="number">4097</span>,<span class="number">4097</span>,<span class="number">4243</span>,<span class="number">4390</span>,<span class="number">4682</span>,<span class="number">4682</span>,<span class="number">4682</span>,<span class="number">4829</span>,<span class="number">4975</span>,<span class="number">4975</span>,<span class="number">5121</span>,<span class="number">5195</span>,<span class="number">5268</span>,<span class="number">5341</span>,<span class="number">5414</span>,<span class="number">5487</span>,<span class="number">5560</span>,<span class="number">5560</span>,<span class="number">5853</span>,<span class="number">5853</span>,<span class="number">5999</span>,<span class="number">6146</span>,<span class="number">6146</span>,<span class="number">6292</span>,<span class="number">6365</span>,<span class="number">6439</span>,<span class="number">6439</span>,<span class="number">6585</span>,<span class="number">6731</span>,<span class="number">6731</span>,<span class="number">6731</span>,<span class="number">7024</span>,<span class="number">7024</span>,<span class="number">7170</span>,<span class="number">7317</span>,<span class="number">7317</span>,<span class="number">7463</span>,<span class="number">7536</span>,<span class="number">7609</span>,<span class="number">7609</span>,<span class="number">7682</span>,<span class="number">7756</span>,<span class="number">7829</span>,<span class="number">7902</span>,<span class="number">7902</span>,<span class="number">7975</span>,<span class="number">8048</span>,<span class="number">8121</span>,<span class="number">8195</span>,<span class="number">8341</span>,<span class="number">8487</span>,<span class="number">8634</span>,<span class="number">8780</span>,<span class="number">9073</span>,<span class="number">9073</span>,<span class="number">9073</span>,<span class="number">9219</span>,<span class="number">9365</span>,<span class="number">9365</span>,<span class="number">9512</span>,<span class="number">9658</span>,<span class="number">9658</span>,<span class="number">9804</span>,<span class="number">9878</span>,<span class="number">9951</span>,<span class="number">9951</span>,<span class="number">10097</span>,<span class="number">10243</span>,<span class="number">10243</span>,<span class="number">10243</span>,<span class="number">10390</span>,<span class="number">10463</span>,<span class="number">10536</span>,<span class="number">10536</span>,<span class="number">10682</span>,<span class="number">10829</span>,<span class="number">10829</span>,<span class="number">10975</span>,<span class="number">11121</span>,<span class="number">11121</span>,<span class="number">11268</span>,<span class="number">11414</span>,<span class="number">11414</span>,<span class="number">11560</span>,<span class="number">11707</span>,<span class="number">11707</span>,<span class="number">11853</span>,<span class="number">11999</span>,<span class="number">11999</span>,<span class="number">11999</span>,<span class="number">12146</span>,<span class="number">12292</span>,<span class="number">12292</span>,<span class="number">12439</span>,<span class="number">12439</span>,<span class="number">12585</span>,<span class="number">12585</span>,<span class="number">12585</span>,<span class="number">12731</span>,<span class="number">12878</span>,<span class="number">12951</span>,<span class="number">13024</span>,<span class="number">13097</span>,<span class="number">13170</span>,<span class="number">13170</span>,<span class="number">13317</span>,<span class="number">13463</span>,<span class="number">13463</span>,<span class="number">13463</span>,<span class="number">13609</span>,<span class="number">13756</span>,<span class="number">13756</span>,<span class="number">13756</span>,<span class="number">13902</span>,<span class="number">14048</span>,<span class="number">14048</span>,<span class="number">14195</span>,<span class="number">14341</span>,<span class="number">14487</span>,<span class="number">14634</span>,<span class="number">14634</span>,<span class="number">14926</span>,<span class="number">14926</span>,<span class="number">14926</span>,<span class="number">15219</span>,<span class="number">15219</span>,<span class="number">15219</span>,<span class="number">15365</span>,<span class="number">15365</span>,<span class="number">15512</span>,<span class="number">15512</span>,<span class="number">15658</span>,<span class="number">15804</span>,<span class="number">15804</span>,<span class="number">15951</span>,<span class="number">16024</span>,<span class="number">16097</span>,<span class="number">16097</span>,<span class="number">16170</span>,<span class="number">16243</span>,<span class="number">16317</span>,<span class="number">16390</span>,<span class="number">16390</span>,<span class="number">16536</span>,<span class="number">16682</span>,<span class="number">16682</span>,<span class="number">16829</span>,<span class="number">16902</span>,<span class="number">16975</span>,<span class="number">16975</span>,<span class="number">17121</span>,<span class="number">17268</span>,<span class="number">17268</span>,<span class="number">17268</span>,<span class="number">17414</span>,<span class="number">17560</span>,<span class="number">17634</span>,<span class="number">17707</span>,<span class="number">17780</span>,<span class="number">17853</span>,<span class="number">17926</span>,<span class="number">17999</span>,<span class="number">18073</span>,<span class="number">18146</span>,<span class="number">18146</span>,<span class="number">18292</span>,<span class="number">18439</span>,<span class="number">18439</span>,<span class="number">18731</span>,<span class="number">18731</span>,<span class="number">18731</span>,<span class="number">18878</span>,<span class="number">19024</span>,<span class="number">19024</span>,<span class="number">19024</span>,<span class="number">19170</span>,<span class="number">19243</span>,<span class="number">19317</span>,<span class="number">19463</span>,<span class="number">19609</span>,<span class="number">19609</span>,<span class="number">19609</span>,<span class="number">19756</span>,<span class="number">19829</span>,<span class="number">19902</span>,<span class="number">20048</span>,<span class="number">20195</span>,<span class="number">20195</span>,<span class="number">20341</span>,<span class="number">20487</span>,<span class="number">20487</span>,<span class="number">20634</span>,<span class="number">20780</span>,<span class="number">20780</span>,<span class="number">20926</span>,<span class="number">21073</span>,<span class="number">21073</span>,<span class="number">21219</span>,<span class="number">21365</span>,<span class="number">21365</span>,<span class="number">21365</span>,<span class="number">21512</span>,<span class="number">21585</span>,<span class="number">21658</span>,<span class="number">21658</span>,<span class="number">21804</span>,<span class="number">21951</span>,<span class="number">21951</span>,<span class="number">21951</span>,<span class="number">22097</span>,<span class="number">22243</span>,<span class="number">22317</span>,<span class="number">22390</span>,<span class="number">22463</span>,<span class="number">22536</span>,<span class="number">22536</span>,<span class="number">22609</span>,<span class="number">22682</span>,<span class="number">22756</span>,<span class="number">22829</span>,<span class="number">22829</span>,<span class="number">22975</span>,<span class="number">23121</span>,<span class="number">23121</span>,<span class="number">23268</span>,<span class="number">23414</span>,<span class="number">23560</span>,<span class="number">23707</span>,<span class="number">23780</span>,<span class="number">23853</span>,<span class="number">23926</span>,<span class="number">23999</span>,<span class="number">23999</span>,<span class="number">24073</span>,<span class="number">24146</span>,<span class="number">24219</span>,<span class="number">24292</span>,<span class="number">24365</span>,<span class="number">24439</span>,<span class="number">24512</span>,<span class="number">24585</span>,<span class="number">24585</span>,<span class="number">24731</span>,<span class="number">24731</span>,<span class="number">24878</span>,<span class="number">24878</span>,<span class="number">24878</span>,<span class="number">25024</span>,<span class="number">25170</span>,<span class="number">25170</span>,<span class="number">25317</span>,<span class="number">25390</span>,<span class="number">25463</span>,<span class="number">25463</span>,<span class="number">25609</span>,<span class="number">25756</span>,<span class="number">25756</span>,<span class="number">25756</span>,<span class="number">25902</span>,<span class="number">25902</span>,<span class="number">26048</span>,<span class="number">26048</span>,<span class="number">26195</span>,<span class="number">26195</span>,<span class="number">26341</span>,<span class="number">26341</span>,<span class="number">26414</span>,<span class="number">26487</span>,<span class="number">26487</span>,<span class="number">26560</span>,<span class="number">26634</span>,<span class="number">26634</span>,<span class="number">26780</span>,<span class="number">26780</span>,<span class="number">26926</span>,<span class="number">27219</span>,<span class="number">27512</span>,<span class="number">27585</span>,<span class="number">27658</span>,<span class="number">27731</span>,<span class="number">27804</span>,<span class="number">27804</span>,<span class="number">28097</span>,<span class="number">28097</span>,<span class="number">28390</span>,<span class="number">28682</span>,<span class="number">28682</span>,<span class="number">28975</span>,<span class="number">29268</span>,<span class="number">29268</span>,<span class="number">29560</span>,<span class="number">29560</span>,<span class="number">29853</span>,<span class="number">29853</span>,<span class="number">30146</span>,<span class="number">30439</span>,<span class="number">30439</span>,<span class="number">30731</span>,<span class="number">31024</span>,<span class="number">31024</span>,<span class="number">31317</span>,<span class="number">31609</span>,<span class="number">31609</span>,<span class="number">31902</span>,<span class="number">32195</span>,<span class="number">32195</span>,<span class="number">32487</span>,<span class="number">32780</span>,<span class="number">32780</span>,<span class="number">32780</span>,<span class="number">33365</span>,<span class="number">33365</span>,<span class="number">33365</span>,<span class="number">33951</span>,<span class="number">33951</span>,<span class="number">34243</span>,<span class="number">34536</span>,<span class="number">34536</span>,<span class="number">34829</span>,<span class="number">35121</span>,<span class="number">35121</span>,<span class="number">35414</span>,<span class="number">35707</span>,<span class="number">35707</span>,<span class="number">35707</span>,<span class="number">35999</span>,<span class="number">36292</span>,<span class="number">36585</span>,<span class="number">36878</span>,<span class="number">36878</span>,<span class="number">37024</span>,<span class="number">37024</span>,<span class="number">37170</span>,<span class="number">37170</span>,<span class="number">37463</span>,<span class="number">37463</span>,<span class="number">37463</span>,<span class="number">37609</span>,<span class="number">37756</span>,<span class="number">37756</span>,<span class="number">37902</span>,<span class="number">38048</span>,<span class="number">38048</span>,<span class="number">38195</span>,<span class="number">38341</span>,<span class="number">38341</span>,<span class="number">38487</span>,<span class="number">38634</span>,<span class="number">38634</span>,<span class="number">38780</span>,<span class="number">38926</span>,<span class="number">39073</span>,<span class="number">39219</span>,<span class="number">39365</span>,<span class="number">39512</span>,<span class="number">39658</span>,<span class="number">39804</span>,<span class="number">39804</span>,<span class="number">39951</span>,<span class="number">40097</span>,<span class="number">40097</span>,<span class="number">40243</span>,<span class="number">40390</span>,<span class="number">40390</span>,<span class="number">40536</span>,<span class="number">40682</span>,<span class="number">40829</span>,<span class="number">40975</span>,<span class="number">40975</span>,<span class="number">41121</span>,<span class="number">41268</span>,<span class="number">41414</span>,<span class="number">41560</span>,<span class="number">41707</span>,<span class="number">41853</span>,<span class="number">41999</span>,<span class="number">42146</span>,<span class="number">42146</span>,<span class="number">42292</span>,<span class="number">42292</span>,<span class="number">42439</span>,<span class="number">42585</span>,<span class="number">42731</span>,<span class="number">42731</span>,<span class="number">42878</span>,<span class="number">42878</span>,<span class="number">43024</span>,<span class="number">43170</span>,<span class="number">43317</span>,<span class="number">43317</span>,<span class="number">43463</span>,<span class="number">43463</span>,<span class="number">43609</span>,<span class="number">43609</span>,<span class="number">43682</span>,<span class="number">43756</span>,<span class="number">43756</span>,<span class="number">43829</span>,<span class="number">43902</span>,<span class="number">43902</span>,<span class="number">44048</span>,<span class="number">44048</span>,<span class="number">44195</span>,<span class="number">44195</span>,<span class="number">44341</span>,<span class="number">44341</span>,<span class="number">44487</span>,<span class="number">44560</span>,<span class="number">44634</span>,<span class="number">44707</span>,<span class="number">44780</span>,<span class="number">44853</span>,<span class="number">44926</span>,<span class="number">44999</span>,<span class="number">45073</span>,<span class="number">45146</span>,<span class="number">45219</span>,<span class="number">45292</span>,<span class="number">45365</span>,<span class="number">45439</span>,<span class="number">45512</span>,<span class="number">45585</span>,<span class="number">45658</span>,<span class="number">45658</span>,<span class="number">45804</span>,<span class="number">45951</span>,<span class="number">45951</span>,<span class="number">46097</span>,<span class="number">46243</span>,<span class="number">46243</span>,<span class="number">46536</span>,<span class="number">46536</span>,<span class="number">46536</span>,<span class="number">46829</span>,<span class="number">46829</span>,<span class="number">46902</span>,<span class="number">46975</span>,<span class="number">47121</span>,<span class="number">47121</span>,<span class="number">47268</span>,<span class="number">47414</span>,<span class="number">47414</span>,<span class="number">47560</span>,<span class="number">47634</span>,<span class="number">47707</span>,<span class="number">47707</span>,<span class="number">47853</span>,<span class="number">47926</span>,<span class="number">47999</span>,<span class="number">47999</span>,<span class="number">48146</span>,<span class="number">48292</span>,<span class="number">48292</span>,<span class="number">48439</span>,<span class="number">48585</span>,<span class="number">48585</span>,<span class="number">48731</span>,<span class="number">48878</span>,<span class="number">48878</span>,<span class="number">49024</span>,<span class="number">49170</span>,<span class="number">49170</span>,<span class="number">49243</span>,<span class="number">49317</span>,<span class="number">49463</span>,<span class="number">49463</span>,<span class="number">49609</span>,<span class="number">49756</span>,<span class="number">49756</span>,<span class="number">49902</span>,<span class="number">49975</span>,<span class="number">50048</span>,<span class="number">50048</span>,<span class="number">50121</span>,<span class="number">50195</span>,<span class="number">50268</span>,<span class="number">50341</span>,<span class="number">50341</span>,<span class="number">50487</span>,<span class="number">50487</span>,<span class="number">50707</span>,<span class="number">50707</span>,<span class="number">50926</span>,<span class="number">50926</span>,<span class="number">51073</span>,<span class="number">51219</span>,<span class="number">51365</span>,<span class="number">51512</span>,<span class="number">51512</span>,<span class="number">51585</span>,<span class="number">51658</span>,<span class="number">51804</span>,<span class="number">51804</span>,<span class="number">51951</span>,<span class="number">52097</span>,<span class="number">52097</span>,<span class="number">52170</span>,<span class="number">52243</span>,<span class="number">52317</span>,<span class="number">52390</span>,<span class="number">52390</span>,<span class="number">52536</span>,<span class="number">52609</span>,<span class="number">52682</span>,<span class="number">52682</span>,<span class="number">52829</span>,<span class="number">52975</span>,<span class="number">52975</span>,<span class="number">53121</span>,<span class="number">53268</span>,<span class="number">53268</span>,<span class="number">53414</span>,<span class="number">53560</span>,<span class="number">53560</span>,<span class="number">53707</span>,<span class="number">53853</span>,<span class="number">53853</span>,<span class="number">53926</span>,<span class="number">53999</span>,<span class="number">54073</span>,<span class="number">54146</span>,<span class="number">54146</span>,<span class="number">54219</span>,<span class="number">54292</span>,<span class="number">54365</span>,<span class="number">54439</span>,<span class="number">54439</span>,<span class="number">54512</span>,<span class="number">54585</span>,<span class="number">54658</span>,<span class="number">54731</span>,<span class="number">54731</span>,<span class="number">54878</span>,<span class="number">54878</span>,<span class="number">55024</span>,<span class="number">55024</span>,<span class="number">55024</span>,<span class="number">55317</span>,<span class="number">55317</span>,<span class="number">55317</span>,<span class="number">55609</span>,<span class="number">55609</span>,<span class="number">55609</span>,<span class="number">55902</span>,<span class="number">55902</span>,<span class="number">55902</span>,<span class="number">56195</span>,<span class="number">56268</span>,<span class="number">56341</span>,<span class="number">56487</span>,<span class="number">56487</span>,<span class="number">56634</span>,<span class="number">56780</span>,<span class="number">56780</span>,<span class="number">56926</span>,<span class="number">56999</span>,<span class="number">57073</span>,<span class="number">57073</span>,<span class="number">57219</span>,<span class="number">57292</span>,<span class="number">57365</span>,<span class="number">57365</span>,<span class="number">57512</span>,<span class="number">57658</span>,<span class="number">57658</span>,<span class="number">57804</span>,<span class="number">57951</span>,<span class="number">57951</span>,<span class="number">58097</span>,<span class="number">58243</span>,<span class="number">58243</span>,<span class="number">58390</span>,<span class="number">58536</span>,<span class="number">58536</span>,<span class="number">58609</span>,<span class="number">58682</span>,<span class="number">58829</span>,<span class="number">58829</span>,<span class="number">58975</span>,<span class="number">59121</span>,<span class="number">59121</span>,<span class="number">59268</span>,<span class="number">59341</span>,<span class="number">59414</span>,<span class="number">59414</span>,<span class="number">59560</span>,<span class="number">59634</span>,<span class="number">59707</span>,<span class="number">59707</span>,<span class="number">59853</span>,<span class="number">59926</span>,<span class="number">59999</span>,<span class="number">59999</span>,<span class="number">60073</span>,<span class="number">60292</span>,<span class="number">60292</span>,<span class="number">60439</span>,<span class="number">60585</span>,<span class="number">60585</span>,<span class="number">60731</span>,<span class="number">60878</span>,<span class="number">60878</span>,<span class="number">60951</span>,<span class="number">61024</span>,<span class="number">61024</span>,<span class="number">61170</span>,<span class="number">61170</span>,<span class="number">61317</span>,<span class="number">61317</span>,<span class="number">61463</span>,<span class="number">61463</span>,<span class="number">61463</span>,<span class="number">61536</span>,<span class="number">61609</span>,<span class="number">61609</span>,<span class="number">61756</span>,<span class="number">61756</span>,<span class="number">61902</span>,<span class="number">61902</span>,<span class="number">62048</span>,<span class="number">62048</span>,<span class="number">62048</span>,<span class="number">62121</span>,<span class="number">62195</span>,<span class="number">62195</span>,<span class="number">62341</span>,<span class="number">62341</span>,<span class="number">62414</span>,<span class="number">62487</span>,<span class="number">62560</span>,<span class="number">62634</span>,<span class="number">62634</span>,<span class="number">62780</span>,<span class="number">62780</span>,<span class="number">62926</span>,<span class="number">62926</span>,<span class="number">63073</span>,<span class="number">63073</span>,<span class="number">63219</span>,<span class="number">63219</span>,<span class="number">63292</span>,<span class="number">63365</span>,<span class="number">63439</span>,<span class="number">63512</span>,<span class="number">63512</span>,<span class="number">63585</span>,<span class="number">63658</span>,<span class="number">63731</span>,<span class="number">63804</span>,<span class="number">63804</span>,<span class="number">63878</span>,<span class="number">63951</span>,<span class="number">64024</span>,<span class="number">64097</span>,<span class="number">64097</span>,<span class="number">64170</span>,<span class="number">64243</span>,<span class="number">64317</span>,<span class="number">64390</span>,<span class="number">64390</span>,<span class="number">64536</span>,<span class="number">64536</span>,<span class="number">64609</span>,<span class="number">64682</span>,<span class="number">64829</span>,<span class="number">64975</span>,<span class="number">65121</span>,<span class="number">65268</span>,<span class="number">65414</span>,<span class="number">65560</span>,<span class="number">65560</span>,<span class="number">65707</span>,<span class="number">65853</span>,<span class="number">65999</span>,<span class="number">66146</span>,<span class="number">66146</span>,<span class="number">66439</span>,<span class="number">66585</span>,<span class="number">66878</span>,<span class="number">67170</span>,<span class="number">67317</span>,<span class="number">67317</span>,<span class="number">67609</span>,<span class="number">67902</span>,<span class="number">68048</span>,<span class="number">68195</span>,<span class="number">68341</span>,<span class="number">68487</span>,<span class="number">68487</span>,<span class="number">68780</span>,<span class="number">68926</span>,<span class="number">69073</span>,<span class="number">69219</span>,<span class="number">69365</span>,<span class="number">69512</span>,<span class="number">69658</span>,<span class="number">69658</span>,<span class="number">69804</span>,<span class="number">69951</span>,<span class="number">70243</span>,<span class="number">70390</span>,<span class="number">70536</span>,<span class="number">70682</span>,<span class="number">70829</span>,<span class="number">70829</span>,<span class="number">71121</span>,<span class="number">71268</span>,<span class="number">71560</span>,<span class="number">71853</span>,<span class="number">71999</span>,<span class="number">71999</span>,<span class="number">72292</span>,<span class="number">72585</span>,<span class="number">72731</span>,<span class="number">72878</span>,<span class="number">73024</span>,<span class="number">73170</span>,<span class="number">73317</span>,<span class="number">73463</span>,<span class="number">73609</span>,<span class="number">73609</span>,<span class="number">73756</span>,<span class="number">73975</span>,<span class="number">74195</span>,<span class="number">74341</span>,<span class="number">74341</span>,<span class="number">74634</span>,<span class="number">74707</span>,<span class="number">74780</span>,<span class="number">74926</span>,<span class="number">74926</span>,<span class="number">75073</span>,<span class="number">75073</span>,<span class="number">75219</span>,<span class="number">75219</span>,<span class="number">75219</span>,<span class="number">75365</span>,<span class="number">75512</span>,<span class="number">75512</span>,<span class="number">75658</span>,<span class="number">75658</span>,<span class="number">75804</span>,<span class="number">75804</span>,<span class="number">75804</span>,<span class="number">75951</span>,<span class="number">76097</span>,<span class="number">76097</span>,<span class="number">76390</span>,<span class="number">76390</span>,<span class="number">76390</span>,<span class="number">76536</span>,<span class="number">76682</span>,<span class="number">76682</span>,<span class="number">76829</span>,<span class="number">76829</span>,<span class="number">76975</span>,<span class="number">76975</span>,<span class="number">76975</span>,<span class="number">77268</span>,<span class="number">77268</span>,<span class="number">77414</span>,<span class="number">77560</span>,<span class="number">77560</span>,<span class="number">77561</span>,<span class="number">77707</span>,<span class="number">77853</span>,<span class="number">77853</span>,<span class="number">77999</span>,<span class="number">77999</span>,<span class="number">78146</span>,<span class="number">78146</span>,<span class="number">78146</span>,<span class="number">78292</span>,<span class="number">78439</span>,<span class="number">78439</span>,<span class="number">78731</span>,<span class="number">78732</span>,<span class="number">78732</span>,<span class="number">78878</span>,<span class="number">79024</span>,<span class="number">79024</span>,<span class="number">79170</span>,<span class="number">79171</span>,<span class="number">79317</span>,<span class="number">79317</span>,<span class="number">79463</span>,<span class="number">79609</span>,<span class="number">79609</span>,<span class="number">79756</span>,<span class="number">79902</span>,<span class="number">79902</span>,<span class="number">80048</span>,<span class="number">80195</span>,<span class="number">80341</span>,<span class="number">80341</span>,<span class="number">80487</span>,<span class="number">80487</span>,<span class="number">80634</span>,<span class="number">80780</span>,<span class="number">80780</span>,<span class="number">80926</span>,<span class="number">80926</span>,<span class="number">81073</span>,<span class="number">81073</span>,<span class="number">81073</span>,<span class="number">81219</span>,<span class="number">81365</span>,<span class="number">81512</span>,<span class="number">81512</span>,<span class="number">81658</span>,<span class="number">81658</span>,<span class="number">81658</span>,<span class="number">81951</span>,<span class="number">81951</span>,<span class="number">81951</span>,<span class="number">82097</span>,<span class="number">82243</span>,<span class="number">82243</span>,<span class="number">82390</span>,<span class="number">82536</span>,<span class="number">82682</span>,<span class="number">82682</span>,<span class="number">82829</span>,<span class="number">82829</span>,<span class="number">82829</span>,<span class="number">82975</span>,<span class="number">83121</span>,<span class="number">83121</span>,<span class="number">83268</span>,<span class="number">83414</span>,<span class="number">83414</span>,<span class="number">83560</span>,<span class="number">83707</span>,<span class="number">83853</span>,<span class="number">83853</span>,<span class="number">83999</span>,<span class="number">83999</span>,<span class="number">83999</span>,<span class="number">84292</span>,<span class="number">84292</span>,<span class="number">84365</span>,<span class="number">84439</span>,<span class="number">84512</span>,<span class="number">84585</span>,<span class="number">84585</span>,<span class="number">84731</span>,<span class="number">84804</span>,<span class="number">84878</span>,<span class="number">84878</span>,<span class="number">84951</span>,<span class="number">85024</span>,<span class="number">85097</span>,<span class="number">85170</span>,<span class="number">85170</span>,<span class="number">85317</span>,<span class="number">85390</span>,<span class="number">85463</span>,<span class="number">85463</span>,<span class="number">85536</span>,<span class="number">85609</span>,<span class="number">85682</span>,<span class="number">85756</span>,<span class="number">85756</span>,<span class="number">85829</span>,<span class="number">85902</span>,<span class="number">85975</span>,<span class="number">86048</span>,<span class="number">86048</span>,<span class="number">86121</span>,<span class="number">86195</span>,<span class="number">86268</span>,<span class="number">86341</span>,<span class="number">86341</span>,<span class="number">86487</span>,<span class="number">86634</span>,<span class="number">86634</span>,<span class="number">86707</span>,<span class="number">86780</span>,<span class="number">86853</span>,<span class="number">86926</span>,<span class="number">86926</span>,<span class="number">87073</span>,<span class="number">87146</span>,<span class="number">87219</span>,<span class="number">87219</span>,<span class="number">87292</span>,<span class="number">87365</span>,<span class="number">87439</span>,<span class="number">87512</span>,<span class="number">87512</span>,<span class="number">87658</span>,<span class="number">87804</span>,<span class="number">87804</span>,<span class="number">87878</span>,<span class="number">87951</span>,<span class="number">88024</span>,<span class="number">88097</span>,<span class="number">88097</span>,<span class="number">88170</span>,<span class="number">88243</span>,<span class="number">88317</span>,<span class="number">88390</span>,<span class="number">88390</span>,<span class="number">88536</span>,<span class="number">88609</span>,<span class="number">88682</span>,<span class="number">88682</span>,<span class="number">88829</span>,<span class="number">88975</span>,<span class="number">88975</span>,<span class="number">89121</span>,<span class="number">89121</span>,<span class="number">89268</span>,<span class="number">89268</span>,<span class="number">89414</span>,<span class="number">89414</span>,<span class="number">89560</span>,<span class="number">89560</span>,<span class="number">89707</span>,<span class="number">89707</span>,<span class="number">89853</span>,<span class="number">89853</span>,<span class="number">89999</span>,<span class="number">89999</span>,<span class="number">90146</span>,<span class="number">90146</span>,<span class="number">90292</span>,<span class="number">90292</span>,<span class="number">90439</span>,<span class="number">90439</span>,<span class="number">90585</span>,<span class="number">90585</span>,<span class="number">90731</span>,<span class="number">90731</span>,<span class="number">90878</span>,<span class="number">90878</span>,<span class="number">91024</span>,<span class="number">91024</span>,<span class="number">91170</span>,<span class="number">91170</span>,<span class="number">91317</span>,<span class="number">91317</span>,<span class="number">91390</span>,<span class="number">91463</span>,<span class="number">91536</span>,<span class="number">91609</span>,<span class="number">91682</span>,<span class="number">91756</span>,<span class="number">91829</span>,<span class="number">91902</span>,<span class="number">91975</span>,<span class="number">92048</span>,<span class="number">92121</span>,<span class="number">92195</span>,<span class="number">92268</span>,<span class="number">92341</span>,<span class="number">92634</span>,<span class="number">92780</span>,<span class="number">92926</span>,<span class="number">93219</span>,<span class="number">93365</span>,<span class="number">93365</span>,<span class="number">93365</span>,<span class="number">93365</span>,<span class="number">93658</span>,<span class="number">93658</span>,<span class="number">93804</span>,<span class="number">93878</span>,<span class="number">93951</span>,<span class="number">93951</span>,<span class="number">94097</span>,<span class="number">94243</span>,<span class="number">94317</span>,<span class="number">94390</span>,<span class="number">94463</span>,<span class="number">94536</span>,<span class="number">94536</span>,<span class="number">94682</span>,<span class="number">94829</span>,<span class="number">94829</span>,<span class="number">94975</span>,<span class="number">95121</span>,<span class="number">95121</span>,<span class="number">95268</span>,<span class="number">95414</span>,<span class="number">95487</span>,<span class="number">95560</span>,<span class="number">95634</span>,<span class="number">95707</span>,<span class="number">95707</span>,<span class="number">95853</span>,<span class="number">95853</span>,<span class="number">95999</span>,<span class="number">95999</span>,<span class="number">96146</span>,<span class="number">96292</span>,<span class="number">96292</span>,<span class="number">96292</span>,<span class="number">96439</span>,<span class="number">96585</span>,<span class="number">96585</span>,<span class="number">96658</span>,<span class="number">96731</span>,<span class="number">96804</span>,<span class="number">96878</span>,<span class="number">96878</span>,<span class="number">97024</span>,<span class="number">97170</span>,<span class="number">97170</span>,<span class="number">97317</span>,<span class="number">97390</span>,<span class="number">97463</span>,<span class="number">97463</span>,<span class="number">97609</span>,<span class="number">97756</span>,<span class="number">97756</span>,<span class="number">97829</span>,<span class="number">97902</span>,<span class="number">98048</span>,<span class="number">98048</span>,<span class="number">98048</span>,<span class="number">98195</span>,<span class="number">98341</span>,<span class="number">98341</span>,<span class="number">98487</span>,<span class="number">98560</span>,<span class="number">98634</span>,<span class="number">98634</span>,<span class="number">98780</span>,<span class="number">98926</span>,<span class="number">98926</span>,<span class="number">99073</span>,<span class="number">99219</span>,<span class="number">99219</span>,<span class="number">99365</span>,<span class="number">99512</span>,<span class="number">99512</span>,<span class="number">99658</span>,<span class="number">99804</span>,<span class="number">99804</span>,<span class="number">99951</span>,<span class="number">100097</span>,<span class="number">100170</span>,<span class="number">100243</span>,<span class="number">100317</span>,<span class="number">100390</span>,<span class="number">100390</span>,<span class="number">100536</span>,<span class="number">100682</span>,<span class="number">100682</span>,<span class="number">100829</span>,<span class="number">100975</span>,<span class="number">100975</span>,<span class="number">100975</span>,<span class="number">101121</span>,<span class="number">101268</span>,<span class="number">101268</span>,<span class="number">101341</span>,<span class="number">101414</span>,<span class="number">101487</span>,<span class="number">101560</span>,<span class="number">101560</span>,<span class="number">101707</span>,<span class="number">101853</span>,<span class="number">101853</span>,<span class="number">101926</span>,<span class="number">101999</span>,<span class="number">102073</span>,<span class="number">102146</span>,<span class="number">102146</span>,<span class="number">102292</span>,<span class="number">102439</span>,<span class="number">102439</span>,<span class="number">102439</span>,<span class="number">102585</span>,<span class="number">102658</span>,<span class="number">102731</span>,<span class="number">102731</span>,<span class="number">102878</span>,<span class="number">103024</span>,<span class="number">103024</span>,<span class="number">103024</span>,<span class="number">103170</span>,<span class="number">103243</span>,<span class="number">103317</span>,<span class="number">103317</span>,<span class="number">103317</span>,<span class="number">103463</span>,<span class="number">103609</span>,<span class="number">103682</span>,<span class="number">103756</span>,<span class="number">103829</span>,<span class="number">103902</span>,<span class="number">103902</span>,<span class="number">104048</span>,<span class="number">104195</span>,<span class="number">104195</span>,<span class="number">104341</span>,<span class="number">104487</span>,<span class="number">104487</span>,<span class="number">104487</span>,<span class="number">104634</span>,<span class="number">104780</span>,<span class="number">104853</span>,<span class="number">104926</span>,<span class="number">104999</span>,<span class="number">105073</span>,<span class="number">105073</span>,<span class="number">105219</span>,<span class="number">105365</span>,<span class="number">105365</span>,<span class="number">105512</span>,<span class="number">105658</span>,<span class="number">105658</span>,<span class="number">105658</span>,<span class="number">105804</span>,<span class="number">105951</span>,<span class="number">105951</span>,<span class="number">106097</span>,<span class="number">106170</span>,<span class="number">106243</span>,<span class="number">106243</span>,<span class="number">106317</span>,<span class="number">106390</span>,<span class="number">106536</span>,<span class="number">106536</span>,<span class="number">106682</span>,<span class="number">106756</span>,<span class="number">106829</span>,<span class="number">106829</span>,<span class="number">106829</span>,<span class="number">106975</span>,<span class="number">107121</span>,<span class="number">107121</span>,<span class="number">107268</span>,<span class="number">107268</span>,<span class="number">107414</span>,<span class="number">107414</span>,<span class="number">107414</span>,<span class="number">107560</span>,<span class="number">107707</span>,<span class="number">107707</span>,<span class="number">107707</span>,<span class="number">107853</span>,<span class="number">107999</span>,<span class="number">107999</span>,<span class="number">107999</span>,<span class="number">108146</span>,<span class="number">108292</span>,<span class="number">108292</span>,<span class="number">108439</span>,<span class="number">108585</span>,<span class="number">108585</span>,<span class="number">108731</span>,<span class="number">108878</span>,<span class="number">108878</span>,<span class="number">108878</span>,<span class="number">109024</span>,<span class="number">109170</span>,<span class="number">109170</span>,<span class="number">109317</span>,<span class="number">109463</span>,<span class="number">109463</span>,<span class="number">109536</span>,<span class="number">109609</span>,<span class="number">109682</span>,<span class="number">109756</span>,<span class="number">109756</span>,<span class="number">109902</span>,<span class="number">110048</span>,<span class="number">110048</span>,<span class="number">110048</span>,<span class="number">110195</span>,<span class="number">110195</span>,<span class="number">110341</span>,<span class="number">110341</span>,<span class="number">110341</span>,<span class="number">110487</span>,<span class="number">110487</span>,<span class="number">110634</span>,<span class="number">110634</span>,<span class="number">110634</span>,<span class="number">110780</span>,<span class="number">110780</span>,<span class="number">110926</span>,<span class="number">110926</span>,<span class="number">110926</span>,<span class="number">111073</span>,<span class="number">111073</span>,<span class="number">111219</span>,<span class="number">111219</span>,<span class="number">111219</span>,<span class="number">111365</span>,<span class="number">111512</span>,<span class="number">111658</span>,<span class="number">111731</span>,<span class="number">111804</span>,<span class="number">111878</span>,<span class="number">111951</span>,<span class="number">112024</span>,<span class="number">112097</span>,<span class="number">112097</span>,<span class="number">112097</span>,<span class="number">112390</span>,<span class="number">112390</span>,<span class="number">112536</span>,<span class="number">112682</span>,<span class="number">112682</span>,<span class="number">112682</span>,<span class="number">112829</span>,<span class="number">112975</span>,<span class="number">112975</span>,<span class="number">113121</span>,<span class="number">113268</span>,<span class="number">113268</span>,<span class="number">113414</span>,<span class="number">113560</span>,<span class="number">113560</span>,<span class="number">113707</span>,<span class="number">113853</span>,<span class="number">113853</span>,<span class="number">113999</span>,<span class="number">114146</span>,<span class="number">114219</span>,<span class="number">114292</span>,<span class="number">114365</span>,<span class="number">114439</span>,<span class="number">114439</span>,<span class="number">114585</span>,<span class="number">114731</span>,<span class="number">114731</span>,<span class="number">114878</span>,<span class="number">115024</span>,<span class="number">115024</span>,<span class="number">115024</span>,<span class="number">115170</span>,<span class="number">115317</span>,<span class="number">115317</span>,<span class="number">115463</span>,<span class="number">115536</span>,<span class="number">115609</span>,<span class="number">115609</span>,<span class="number">115756</span>,<span class="number">115902</span>,<span class="number">115902</span>,<span class="number">115975</span>,<span class="number">116048</span>,<span class="number">116121</span>,<span class="number">116195</span>,<span class="number">116195</span>,<span class="number">116268</span>,<span class="number">116341</span>,<span class="number">116414</span>,<span class="number">116487</span>,<span class="number">116487</span>,<span class="number">116560</span>,<span class="number">116634</span>,<span class="number">116707</span>,<span class="number">116780</span>,<span class="number">116780</span>,<span class="number">116926</span>,<span class="number">117073</span>,<span class="number">117073</span>,<span class="number">117219</span>,<span class="number">117365</span>,<span class="number">117365</span>,<span class="number">117512</span>,<span class="number">117658</span>,<span class="number">117658</span>,<span class="number">117804</span>,<span class="number">117878</span>,<span class="number">117951</span>,<span class="number">117951</span>,<span class="number">118097</span>,<span class="number">118243</span>,<span class="number">118243</span>,<span class="number">118390</span>,<span class="number">118536</span>,<span class="number">118536</span>,<span class="number">118682</span>,<span class="number">118829</span>,<span class="number">118902</span>,<span class="number">118975</span>,<span class="number">119048</span>,<span class="number">119121</span>,<span class="number">119121</span>,<span class="number">119268</span>,<span class="number">119414</span>,<span class="number">119414</span>,<span class="number">119560</span>,<span class="number">119707</span>,<span class="number">119707</span>,<span class="number">119853</span>,<span class="number">119999</span>,<span class="number">119999</span>,<span class="number">120146</span>,<span class="number">120292</span>,<span class="number">120292</span>,<span class="number">120439</span>,<span class="number">120439</span>,<span class="number">120731</span>,<span class="number">121024</span>,<span class="number">121170</span>,<span class="number">121463</span>,<span class="number">121536</span>,<span class="number">121609</span>,<span class="number">121682</span>,<span class="number">121756</span>,<span class="number">121756</span>,<span class="number">121756</span>,<span class="number">121902</span>,<span class="number">122048</span>,<span class="number">122048</span>,<span class="number">122048</span>,<span class="number">122195</span>,<span class="number">122341</span>,<span class="number">122341</span>,<span class="number">122341</span>,<span class="number">122487</span>,<span class="number">122560</span>,<span class="number">122634</span>,<span class="number">122634</span>,<span class="number">122634</span>,<span class="number">122780</span>,<span class="number">122926</span>,<span class="number">122926</span>,<span class="number">122926</span>,<span class="number">123073</span>,<span class="number">123219</span>,<span class="number">123219</span>,<span class="number">123219</span>,<span class="number">123365</span>,<span class="number">123512</span>,<span class="number">123512</span>,<span class="number">123512</span>,<span class="number">123585</span>,<span class="number">123658</span>,<span class="number">123731</span>,<span class="number">123804</span>,<span class="number">123804</span>,<span class="number">123804</span>,<span class="number">123951</span>,<span class="number">124097</span>,<span class="number">124097</span>,<span class="number">124097</span>,<span class="number">124243</span>,<span class="number">124390</span>,<span class="number">124390</span>,<span class="number">124390</span>,<span class="number">124536</span>,<span class="number">124682</span>,<span class="number">124682</span>,<span class="number">124682</span>,<span class="number">124829</span>,<span class="number">124975</span>,<span class="number">124975</span>,<span class="number">124975</span>,<span class="number">125121</span>,<span class="number">125268</span>,<span class="number">125268</span>,<span class="number">125268</span>,<span class="number">125414</span>,<span class="number">125487</span>,<span class="number">125560</span>,<span class="number">125560</span>,<span class="number">125560</span>,<span class="number">125707</span>,<span class="number">125853</span>,<span class="number">125853</span>,<span class="number">125853</span>,<span class="number">125999</span>,<span class="number">126146</span>,<span class="number">126146</span>,<span class="number">126146</span>,<span class="number">126292</span>,<span class="number">126439</span>,<span class="number">126439</span>,<span class="number">126439</span>,<span class="number">126585</span>,<span class="number">126585</span>,<span class="number">126731</span>,<span class="number">126731</span>,<span class="number">126878</span>,<span class="number">126878</span>,<span class="number">127024</span>,<span class="number">127024</span>,<span class="number">127024</span>,<span class="number">127170</span>,<span class="number">127170</span>,<span class="number">127317</span>,<span class="number">127317</span>,<span class="number">127463</span>,<span class="number">127463</span>,<span class="number">127609</span>,<span class="number">127609</span>,<span class="number">127609</span>,<span class="number">127756</span>,<span class="number">127756</span>,<span class="number">127902</span>,<span class="number">127902</span>,<span class="number">128048</span>,<span class="number">128048</span>,<span class="number">128195</span>,<span class="number">128195</span>,<span class="number">128268</span>,<span class="number">128341</span>,<span class="number">128341</span>,<span class="number">128414</span>,<span class="number">128487</span>,<span class="number">128487</span>,<span class="number">128560</span>,<span class="number">128634</span>,<span class="number">128707</span>,<span class="number">128780</span>,<span class="number">128780</span>,<span class="number">128853</span>,<span class="number">128926</span>,<span class="number">128999</span>,<span class="number">129073</span>,<span class="number">129146</span>,<span class="number">129219</span>,<span class="number">129292</span>,<span class="number">129365</span>,<span class="number">129365</span>,<span class="number">129439</span>,<span class="number">129512</span>,<span class="number">129585</span>,<span class="number">129658</span>,<span class="number">129731</span>,<span class="number">129804</span>,<span class="number">129878</span>,<span class="number">129951</span>,<span class="number">129951</span>,<span class="number">130024</span>,<span class="number">130097</span>,<span class="number">130170</span>,<span class="number">130243</span>,<span class="number">130243</span>,<span class="number">130317</span>,<span class="number">130390</span>,<span class="number">130463</span>,<span class="number">130536</span>,<span class="number">130536</span>,<span class="number">130682</span>,<span class="number">130756</span>,<span class="number">130829</span>,<span class="number">130829</span>,<span class="number">130829</span>,<span class="number">130975</span>,<span class="number">130975</span>,<span class="number">131121</span>,<span class="number">131195</span>,<span class="number">131268</span>,<span class="number">131341</span>,<span class="number">131560</span>,<span class="number">131707</span>,<span class="number">131707</span>,<span class="number">131780</span>,<span class="number">131853</span>,<span class="number">131926</span>,<span class="number">132146</span>,<span class="number">132292</span>,<span class="number">132365</span>,<span class="number">132439</span>,<span class="number">132512</span>,<span class="number">132731</span>,<span class="number">132878</span>,<span class="number">132878</span>,<span class="number">132951</span>,<span class="number">133024</span>,<span class="number">133097</span>,<span class="number">133463</span>,<span class="number">133463</span>,<span class="number">133756</span>,<span class="number">134048</span>,<span class="number">134048</span>,<span class="number">134048</span>,<span class="number">134341</span>,<span class="number">134634</span>,<span class="number">134634</span>,<span class="number">134926</span>,<span class="number">134926</span>,<span class="number">135219</span>,<span class="number">135219</span>,<span class="number">135219</span>,<span class="number">135512</span>,<span class="number">135512</span>,<span class="number">135658</span>,<span class="number">135658</span>,<span class="number">135804</span>,<span class="number">135804</span>,<span class="number">135951</span>,<span class="number">135951</span>,<span class="number">136097</span>,<span class="number">136097</span>,<span class="number">136243</span>,<span class="number">136243</span>,<span class="number">136390</span>,<span class="number">136390</span>,<span class="number">136536</span>,<span class="number">136536</span>,<span class="number">136609</span>,<span class="number">136682</span>,<span class="number">136682</span>,<span class="number">136829</span>,<span class="number">136829</span>,<span class="number">136902</span>,<span class="number">136975</span>,<span class="number">136975</span>,<span class="number">137121</span>,<span class="number">137121</span>,<span class="number">137268</span>,<span class="number">137268</span>,<span class="number">137414</span>,<span class="number">137414</span>,<span class="number">137560</span>,<span class="number">137560</span>,<span class="number">137707</span>,<span class="number">137707</span>,<span class="number">137780</span>,<span class="number">137853</span>,<span class="number">137926</span>,<span class="number">137999</span>,<span class="number">137999</span>,<span class="number">138073</span>,<span class="number">138146</span>,<span class="number">138146</span>,<span class="number">138219</span>,<span class="number">138292</span>,<span class="number">138365</span>,<span class="number">138439</span>,<span class="number">138439</span>,<span class="number">138512</span>,<span class="number">138585</span>,<span class="number">138658</span>,<span class="number">138731</span>,<span class="number">138731</span>,<span class="number">138804</span>,<span class="number">138878</span>,<span class="number">138951</span>,<span class="number">139024</span>,<span class="number">139024</span>,<span class="number">139097</span>,<span class="number">139170</span>,<span class="number">139243</span>,<span class="number">139317</span>,<span class="number">139317</span>,<span class="number">139463</span>,<span class="number">139463</span>,<span class="number">139609</span>,<span class="number">139609</span>,<span class="number">139756</span>,<span class="number">139756</span>,<span class="number">139902</span>,<span class="number">139902</span>,<span class="number">140195</span>,<span class="number">140195</span>,<span class="number">140195</span>,<span class="number">140195</span> &#125;;</span><br><span class="line"></span><br><span class="line">DWORD __ROR4__(DWORD a1, <span class="type">char</span> a2)</span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">return</span> (a1 &gt;&gt; a2) | (a1 &lt;&lt; (<span class="number">32</span> - a2));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">rounds</span><span class="params">(<span class="type">uint8_t</span>* bytes, <span class="type">unsigned</span> <span class="type">int</span> a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line"> DWORD* v3; <span class="comment">// r4</span></span><br><span class="line"> DWORD v4; <span class="comment">// r12</span></span><br><span class="line"> DWORD v5[<span class="number">2</span>]; <span class="comment">// r5</span></span><br><span class="line"> DWORD v6; <span class="comment">// r3</span></span><br><span class="line"> DWORD result; <span class="comment">// r0</span></span><br><span class="line"> </span><br><span class="line"> v3 = (DWORD*)((<span class="type">char</span>*)bytes + a3);</span><br><span class="line"> v4 = *(DWORD*)((<span class="type">char</span>*)bytes + a3);</span><br><span class="line"> *(DWORD64*)&amp;v5[<span class="number">0</span>] = *(DWORD64*)((<span class="type">char</span>*)bytes + a3 + <span class="number">4</span>);</span><br><span class="line"> v6 = *(DWORD*)((<span class="type">char</span>*)bytes + a3 + <span class="number">12</span>);</span><br><span class="line"> *(DWORD*)((<span class="type">char</span>*)bytes + a3) = *(&amp;v5[<span class="number">0</span>] + <span class="number">1</span>);</span><br><span class="line"> result = v4 ^ __ROR4__(*(&amp;v5[<span class="number">0</span>] + <span class="number">1</span>) ^ a2, <span class="number">19</span>);</span><br><span class="line"> v3[<span class="number">3</span>] = v5[<span class="number">0</span>] ^ __ROR4__(v6, <span class="number">18</span>) ^ __ROR4__(*(&amp;v5[<span class="number">0</span>] + <span class="number">1</span>) ^ a2, <span class="number">19</span>);</span><br><span class="line"> v3[<span class="number">1</span>] = v6;</span><br><span class="line"> v3[<span class="number">2</span>] = result;</span><br><span class="line"> <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="type">unsigned</span> <span class="type">char</span> enc_bytes[] =</span><br><span class="line"> &#123;</span><br><span class="line">  <span class="number">0x3C</span>, <span class="number">0xAC</span>, <span class="number">0x92</span>, <span class="number">0x6F</span>, <span class="number">0x44</span>, <span class="number">0xA1</span>, <span class="number">0xC1</span>, <span class="number">0x17</span>, <span class="number">0xFD</span>, <span class="number">0x62</span>,</span><br><span class="line">  <span class="number">0x60</span>, <span class="number">0xDD</span>, <span class="number">0x63</span>, <span class="number">0xF8</span>, <span class="number">0xE3</span>, <span class="number">0x2A</span>, <span class="number">0x5E</span>, <span class="number">0x75</span>, <span class="number">0x78</span>, <span class="number">0xBE</span>,</span><br><span class="line">  <span class="number">0x59</span>, <span class="number">0x46</span>, <span class="number">0x33</span>, <span class="number">0xF6</span>, <span class="number">0x2E</span>, <span class="number">0x64</span>, <span class="number">0x61</span>, <span class="number">0x8A</span>, <span class="number">0x27</span>, <span class="number">0x93</span>,</span><br><span class="line">  <span class="number">0x21</span>, <span class="number">0x7D</span>, <span class="number">0x00</span></span><br><span class="line"> &#125;;</span><br><span class="line"> mt19937 <span class="title function_">rng</span><span class="params">(<span class="number">-196167794</span>)</span>;</span><br><span class="line"> <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1608</span>; ++i)</span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">if</span> (rng() % <span class="number">7</span> &gt;= <span class="number">3</span>)</span><br><span class="line">  &#123;</span><br><span class="line">   rounds(enc_bytes, rng(), hitp[i] &amp; <span class="number">0xF</span>);</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, enc_bytes);</span><br><span class="line"> getchar();</span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//D3CTF&#123;Gb78e-7b04-4364-82d2-7f44&#125;</span></span><br></pre></td></tr></table></figure>

<p>我只能说写出这个脚本的人是神！</p>
<p>方法二：用frida</p>
<p>frida hook得到最后的server::instance，也就是flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function hooktest () &#123; </span><br><span class="line">    let i = <span class="number">0</span>; </span><br><span class="line">    var d3mug = Module.findBaseAddress(<span class="string">&quot;libd3mug.so&quot;</span>); </span><br><span class="line">    Interceptor.attach(d3mug.add(<span class="number">0x0000780</span>), &#123; </span><br><span class="line">        onEnter: function (args) &#123; </span><br><span class="line">            var real_time = arr[i++]; </span><br><span class="line">            args[<span class="number">0</span>] = new NativePointer(real_time); </span><br><span class="line">        &#125;,</span><br><span class="line">        onLeave: function (arg) &#123; </span><br><span class="line">            console.log(hexdump(d3mug.add(<span class="number">0x0000000000002D18</span>).readPointer())); </span><br><span class="line">            <span class="keyword">return</span> arg; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;); </span><br><span class="line">&#125;</span><br><span class="line">setImmediate(function () &#123; </span><br><span class="line">    setTimeout(hooktest, <span class="number">100</span>); </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>安卓机子到了再搞。</p>
<h3 id="d3arm"><a href="#d3arm" class="headerlink" title="d3arm"></a><strong>d3arm</strong></h3><p>这个题也是第一次见，给了一个bin文件，首先我们将bin转换成hex文件，然后用ida的arm小端来打开hex文件就行</p>
<p><img src="/2022/07/18/d3ctf/image-20220307182342150.png"></p>
<p><img src="/2022/07/18/d3ctf/image-20220308093225798.png"></p>
<p>上面是主函数</p>
<p><img src="/2022/07/18/d3ctf/image-20220308093822234.png"></p>
<p>这个函数选择难度，我们必须选择hard难度 这样这个MEMORY[0x200028E4] &#x3D;&#x3D; 450000才成立</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_5FA4</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  sub_75C2(<span class="number">536880148</span>);</span><br><span class="line">  sub_765E(<span class="number">536880148</span>, <span class="number">536871392</span>, <span class="number">6</span>);</span><br><span class="line">  sub_75D0(<span class="number">536880148</span>, (<span class="type">const</span> <span class="type">char</span> *)&amp;unk_6068);</span><br><span class="line">  sub_75D0(<span class="number">536880148</span>, <span class="string">&quot;  You get %2d points  &quot;</span>, MEMORY[<span class="number">0x2000326C</span>]);</span><br><span class="line">  sub_75D0(<span class="number">536880148</span>, <span class="string">&quot; Good! Try it again. &quot;</span>);</span><br><span class="line">  sub_75D0(<span class="number">536880148</span>, <span class="string">&quot;                     &quot;</span>);</span><br><span class="line">  sub_7610(<span class="number">536880148</span>);</span><br><span class="line">  <span class="keyword">if</span> ( MEMORY[<span class="number">0x2000326C</span>] == <span class="number">42</span> &amp;&amp; MEMORY[<span class="number">0x200028E4</span>] == <span class="number">450000</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_75C2(<span class="number">536880148</span>);</span><br><span class="line">    sub_765E(<span class="number">536880148</span>, <span class="number">536871392</span>, <span class="number">6</span>);</span><br><span class="line">    sub_75D0(<span class="number">536880148</span>, (<span class="type">const</span> <span class="type">char</span> *)<span class="number">0x800E094</span>);</span><br><span class="line">    sub_75D0(<span class="number">536880148</span>, <span class="string">&quot; flag is shown below &quot;</span>);</span><br><span class="line">    sub_75D0(<span class="number">536880148</span>, (<span class="type">const</span> <span class="type">char</span> *)<span class="number">0x200022C8</span>);</span><br><span class="line">    sub_7610(<span class="number">536880148</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sub_7F48(<span class="number">1000000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们通过字符串找到主函数</p>
<p>我们发现对比是内存中*（0x2000326C）&#x3D;&#x3D; 42 *（0x200028E4）&#x3D;&#x3D; 45000</p>
<p><img src="/2022/07/18/d3ctf/image-20220308094116490.png"></p>
<p>这个是对flag的生成</p>
<p>通过对异或的值交叉引用发现异或的值有一个生成过程</p>
<p><img src="/2022/07/18/d3ctf/image-20220308094853385.png"></p>
<p>找到异或后的值的生成位置</p>
<p>直接写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">xor_arr = [] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>): </span><br><span class="line">    v1 = i % <span class="number">3</span> </span><br><span class="line">    xor_arr.append((<span class="number">0x335E44</span> &gt;&gt; (<span class="number">8</span> * v1)) &amp; <span class="number">0xff</span>) </span><br><span class="line">cmp = [<span class="number">0x00000020</span>, <span class="number">0x0000006D</span>, <span class="number">0x00000050</span>, <span class="number">0x00000030</span>, <span class="number">0x00000038</span>, <span class="number">0x00000048</span>, </span><br><span class="line"><span class="number">0x00000020</span>, <span class="number">0x0000006C</span>, <span class="number">0x00000007</span>, <span class="number">0x0000007D</span>, <span class="number">0x0000006C</span>, <span class="number">0x00000055</span>, </span><br><span class="line"><span class="number">0x0000007D</span>, <span class="number">0x00000068</span>, <span class="number">0x00000003</span>, <span class="number">0x00000027</span>, <span class="number">0x00000066</span>, <span class="number">0x00000000</span>, </span><br><span class="line"><span class="number">0x00000022</span>, <span class="number">0x00000069</span>, <span class="number">0x00000002</span>, <span class="number">0x0000007D</span>, <span class="number">0x0000006D</span>, <span class="number">0x0000000B</span>, </span><br><span class="line"><span class="number">0x00000077</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000002</span>, <span class="number">0x00000027</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000050</span>, </span><br><span class="line"><span class="number">0x00000073</span>, <span class="number">0x00000038</span>, <span class="number">0x00000004</span>, <span class="number">0x00000071</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000050</span>, </span><br><span class="line"><span class="number">0x0000007D</span>, <span class="number">0x0000006A</span>, <span class="number">0x00000052</span>, <span class="number">0x00000075</span>, <span class="number">0x0000006D</span>, <span class="number">0x0000004E</span>] </span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cmp)): </span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(cmp[j] ^ xor_arr[j]), end=<span class="string">&#x27;&#x27;</span>) </span><br><span class="line"><span class="comment"># d3ctf&#123;d2492f960c83f719383e1cec7f75ec94a13&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="d3thon"><a href="#d3thon" class="headerlink" title="d3thon"></a><strong>d3thon</strong></h3><p>第一次见这种题，给了三种文件，从未见过lbc文件，剩下也不知道是做什么用的，师傅们说是pyd文件，然后可以用python3.1跑起来，lbc包含了指令的逻辑，so文件是类似解释器的东西</p>
<p><img src="/2022/07/18/d3ctf/image-20220308125453443.png"></p>
<p>这个lbc文件可用010打开</p>
<p><img src="/2022/07/18/d3ctf/image-20220308125754914.png"></p>
<p>那只能硬猜是什么意思了，在一些函数中添加输出，发现start中循环16次，所以我们能猜测出</p>
<p>FLNPsiCIvICFtzpUAR:cnt1:1表示cnt +&#x3D;1，那么FLNPsiCIvICFtzpUAR代表add</p>
<p>OuGFUKNGxNLeHOudCK:cnt1:0:1表示cnt1&gt;0时准备jmp到下面的函数</p>
<p>ZOAmcoLkGlAXXqf就是定义函数吧</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">kZslMZYnvPBwgdCz print </span><br><span class="line">oGwDokoxZgoeViFcAF 赋值(如果赋值为KezJKhCxGRZnfLCGT, 则为输入 </span><br><span class="line">RDDDZUiIKbxCubJEN jmp </span><br><span class="line">todeVDuRkYSIITaT 转为2进制 </span><br><span class="line">uPapnsSbmeJLjin 转为10进制 </span><br><span class="line">kuhisCvwaXWfqCs -flag - 1 </span><br><span class="line">IEKMEDdrPpzpdKy add </span><br><span class="line">OcKUQCYqhwHXfAgGZH xor </span><br><span class="line">FLNPsiCIvICFtzpUAR sub </span><br><span class="line">OuGFUKNGxNLeHOudCK cmp</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">fp = <span class="built_in">open</span>(<span class="string">&#x27;data.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">a = fp.read().strip().replace(<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">fpout = <span class="built_in">open</span>(<span class="string">&#x27;data2.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">out_list = []</span><br><span class="line">a = a[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> a:</span><br><span class="line">    l = l.split(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> l[<span class="number">0</span>] ==<span class="string">&#x27;kuhisCvwaXWfqCs&#x27;</span>:</span><br><span class="line">        fpout.write(<span class="string">&#x27;flag = -flag\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> l[<span class="number">0</span>] == <span class="string">&#x27;IEKMEDdrPpzpdKy&#x27;</span>:</span><br><span class="line">        fpout.write(<span class="string">&#x27;flag -= &#x27;</span> + l[<span class="number">2</span>] + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> l[<span class="number">0</span>] == <span class="string">&#x27;FLNPsiCIvICFtzpUAR&#x27;</span>:</span><br><span class="line">        fpout.write(<span class="string">&#x27;flag += &#x27;</span> + l[<span class="number">2</span>] + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> l[<span class="number">0</span>] == <span class="string">&#x27;OcKUQCYqhwHXfAgGZH&#x27;</span>:</span><br><span class="line">        fpout.write(<span class="string">&#x27;flag ^= &#x27;</span> + l[<span class="number">2</span>] + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们可以按上面的逻辑进行字符串的替换，得到一个新的脚本，这个脚本就是完全逆向的。</p>
<p>整理输出flag</p>
<h3 id="d3hotel"><a href="#d3hotel" class="headerlink" title="d3hotel"></a>d3hotel</h3><p>这个题哦其实没那么麻烦，我们在网站中点f12查看文件，这个网页上总共四个文件</p>
<p><img src="/2022/07/18/d3ctf/image-20220308190749396.png"></p>
<p>这有3个还有数据包在url中</p>
<p><img src="/2022/07/18/d3ctf/image-20220308190816476.png"></p>
<p>拿到数据包就导入assertstdiogui查看</p>
<p><img src="/2022/07/18/d3ctf/image-20220308190920416.png"></p>
<p>其中main.lua是重点，我们取下来，然后进行反编译</p>
<p>如何进行lua的反编译，首先将lua文件和unluac.jar文件放在一个文件夹中</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">java </span>-<span class="keyword">jar </span>unlua.<span class="keyword">jar </span>main.lua&gt;main1.lua</span><br></pre></td></tr></table></figure>

<p>main1.lua就是我们要的反编译后的程序</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line">local L0_1, L1_1, L2_1, L3_1, L4_1, L5_1, L6_1, L7_1, L8_1, L9_1, L10_1, L11_1</span><br><span class="line">L0_1 = require</span><br><span class="line">L1_1 = <span class="string">&quot;matrix&quot;</span></span><br><span class="line">L0_1 = L0_1(L1_1)</span><br><span class="line">matrix = L0_1</span><br><span class="line">L0_1 = matrix</span><br><span class="line">L1_1 = <span class="number">5</span></span><br><span class="line">L2_1 = <span class="number">5</span></span><br><span class="line">L3_1 = <span class="number">0</span></span><br><span class="line">L0_1 = L0_1(L1_1, L2_1, L3_1)</span><br><span class="line">m = L0_1</span><br><span class="line">L0_1 = matrix</span><br><span class="line">L1_1 = &#123;&#125;</span><br><span class="line">L2_1 = &#123;&#125;</span><br><span class="line">L3_1 = <span class="number">6422944</span></span><br><span class="line">L4_1 = <span class="number">-7719232</span></span><br><span class="line">L5_1 = <span class="number">41640292</span></span><br><span class="line">L6_1 = <span class="number">-1428488</span></span><br><span class="line">L7_1 = <span class="number">-36954388</span></span><br><span class="line">L2_1[<span class="number">1</span>] = L3_1</span><br><span class="line">L2_1[<span class="number">2</span>] = L4_1</span><br><span class="line">L2_1[<span class="number">3</span>] = L5_1</span><br><span class="line">L2_1[<span class="number">4</span>] = L6_1</span><br><span class="line">L2_1[<span class="number">5</span>] = L7_1</span><br><span class="line">L3_1 = &#123;&#125;</span><br><span class="line">L4_1 = <span class="number">43676120</span></span><br><span class="line">L5_1 = <span class="number">-26534136</span></span><br><span class="line">L6_1 = <span class="number">-31608964</span></span><br><span class="line">L7_1 = <span class="number">-20570796</span></span><br><span class="line">L8_1 = <span class="number">22753040</span></span><br><span class="line">L3_1[<span class="number">1</span>] = L4_1</span><br><span class="line">L3_1[<span class="number">2</span>] = L5_1</span><br><span class="line">L3_1[<span class="number">3</span>] = L6_1</span><br><span class="line">L3_1[<span class="number">4</span>] = L7_1</span><br><span class="line">L3_1[<span class="number">5</span>] = L8_1</span><br><span class="line">L4_1 = &#123;&#125;</span><br><span class="line">L5_1 = <span class="number">-6066184</span></span><br><span class="line">L6_1 = <span class="number">30440152</span></span><br><span class="line">L7_1 = <span class="number">5229916</span></span><br><span class="line">L8_1 = <span class="number">-16857572</span></span><br><span class="line">L9_1 = <span class="number">-16335464</span></span><br><span class="line">L4_1[<span class="number">1</span>] = L5_1</span><br><span class="line">L4_1[<span class="number">2</span>] = L6_1</span><br><span class="line">L4_1[<span class="number">3</span>] = L7_1</span><br><span class="line">L4_1[<span class="number">4</span>] = L8_1</span><br><span class="line">L4_1[<span class="number">5</span>] = L9_1</span><br><span class="line">L5_1 = &#123;&#125;</span><br><span class="line">L6_1 = <span class="number">-8185648</span></span><br><span class="line">L7_1 = <span class="number">-17254720</span></span><br><span class="line">L8_1 = <span class="number">-22800152</span></span><br><span class="line">L9_1 = <span class="number">-8484728</span></span><br><span class="line">L10_1 = <span class="number">44642816</span></span><br><span class="line">L5_1[<span class="number">1</span>] = L6_1</span><br><span class="line">L5_1[<span class="number">2</span>] = L7_1</span><br><span class="line">L5_1[<span class="number">3</span>] = L8_1</span><br><span class="line">L5_1[<span class="number">4</span>] = L9_1</span><br><span class="line">L5_1[<span class="number">5</span>] = L10_1</span><br><span class="line">L6_1 = &#123;&#125;</span><br><span class="line">L7_1 = <span class="number">-35858512</span></span><br><span class="line">L8_1 = <span class="number">10913104</span></span><br><span class="line">L9_1 = <span class="number">-4165844</span></span><br><span class="line">L10_1 = <span class="number">37696936</span></span><br><span class="line">L11_1 = <span class="number">-10061980</span></span><br><span class="line">L6_1[<span class="number">1</span>] = L7_1</span><br><span class="line">L6_1[<span class="number">2</span>] = L8_1</span><br><span class="line">L6_1[<span class="number">3</span>] = L9_1</span><br><span class="line">L6_1[<span class="number">4</span>] = L10_1</span><br><span class="line">L6_1[<span class="number">5</span>] = L11_1</span><br><span class="line">L1_1[<span class="number">1</span>] = L2_1</span><br><span class="line">L1_1[<span class="number">2</span>] = L3_1</span><br><span class="line">L1_1[<span class="number">3</span>] = L4_1</span><br><span class="line">L1_1[<span class="number">4</span>] = L5_1</span><br><span class="line">L1_1[<span class="number">5</span>] = L6_1</span><br><span class="line">L0_1 = L0_1(L1_1)</span><br><span class="line">n = L0_1</span><br><span class="line">function L0_1(A0_2)</span><br><span class="line">  local L1_2, L2_2, L3_2, L4_2, L5_2, L6_2, L7_2, L8_2, L9_2, L10_2, L11_2, L12_2</span><br><span class="line">  L1_2 = #A0_2</span><br><span class="line">  <span class="keyword">if</span> L1_2 ~= <span class="number">25</span> then<span class="comment">//矩阵长度25</span></span><br><span class="line">    L1_2 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> L1_2</span><br><span class="line">  end</span><br><span class="line">  L1_2 = <span class="number">1</span></span><br><span class="line">  L2_2 = <span class="number">5</span></span><br><span class="line">  L3_2 = <span class="number">1</span></span><br><span class="line">  <span class="keyword">for</span> L4_2 = L1_2, L2_2, L3_2 <span class="keyword">do</span></span><br><span class="line">    L5_2 = <span class="number">1</span></span><br><span class="line">    L6_2 = <span class="number">5</span></span><br><span class="line">    L7_2 = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> L8_2 = L5_2, L6_2, L7_2 <span class="keyword">do</span></span><br><span class="line">      L9_2 = m</span><br><span class="line">      L9_2 = L9_2[L4_2]</span><br><span class="line">      L10_2 = <span class="built_in">string</span></span><br><span class="line">      L10_2 = L10_2.byte</span><br><span class="line">      L11_2 = A0_2</span><br><span class="line">      L12_2 = L4_2 - <span class="number">1</span></span><br><span class="line">      L12_2 = L12_2 * <span class="number">5</span></span><br><span class="line">      L12_2 = L12_2 + L8_2</span><br><span class="line">      L10_2 = L10_2(L11_2, L12_2)</span><br><span class="line">      L9_2[L8_2] = L10_2</span><br><span class="line">    end</span><br><span class="line">  end</span><br><span class="line">  L1_2 = tonumber</span><br><span class="line">  L2_2 = <span class="built_in">string</span></span><br><span class="line">  L2_2 = L2_2.format</span><br><span class="line">  L3_2 = <span class="string">&quot;%.5f&quot;</span></span><br><span class="line">  L4_2 = matrix</span><br><span class="line">  L4_2 = L4_2.det</span><br><span class="line">  L5_2 = m</span><br><span class="line">  L4_2, L5_2, L6_2, L7_2, L8_2, L9_2, L10_2, L11_2, L12_2 = L4_2(L5_2)</span><br><span class="line">  L2_2, L3_2, L4_2, L5_2, L6_2, L7_2, L8_2, L9_2, L10_2, L11_2, L12_2 = L2_2(L3_2, L4_2, L5_2, L6_2, L7_2, L8_2, L9_2, L10_2, L11_2, L12_2)</span><br><span class="line">  L1_2 = L1_2(L2_2, L3_2, L4_2, L5_2, L6_2, L7_2, L8_2, L9_2, L10_2, L11_2, L12_2)</span><br><span class="line">  det = L1_2</span><br><span class="line">  L1_2 = matrix</span><br><span class="line">  L2_2 = <span class="number">5</span></span><br><span class="line">  L3_2 = <span class="string">&quot;I&quot;</span></span><br><span class="line">  L1_2 = L1_2(L2_2, L3_2)</span><br><span class="line">  L2_2 = det</span><br><span class="line">  L1_2 = L1_2 * L2_2</span><br><span class="line">  L2_2 = m</span><br><span class="line">  L3_2 = n</span><br><span class="line">  L2_2 = L2_2 * L3_2</span><br><span class="line">  <span class="keyword">if</span> L1_2 == L2_2 then<span class="comment">//matrix(5, &quot;I&quot;) * tonumber(L2_2, L3_2, L4_2, L5_2, L6_2, L7_2, L8_2, L9_2, L10_2, L11_2, L12_2) == m * n</span></span><br><span class="line">    L1_2 = <span class="number">1</span></span><br><span class="line">    L1_2 = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> L1_2</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    L1_2 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> L1_2</span><br><span class="line">  end</span><br><span class="line">end</span><br><span class="line">f = L0_1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/davidm/lua-matrix/blob/master/lua/matrix.lua%E6%BA%90%E7%A0%81">https://github.com/davidm/lua-matrix/blob/master/lua/matrix.lua源码</a></p>
<p>我们可以推出单位矩阵x<em>det（m）&#x3D;&#x3D; n</em>m</p>
<p>所以只需要求m就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line">det_n = np.linalg.det(n) </span><br><span class="line">sq2 = np.sqrt(det_n) </span><br><span class="line">sq4 = np.sqrt(sq2) </span><br><span class="line">m = n.I * sq4 </span><br><span class="line"><span class="built_in">print</span>(m)  </span><br><span class="line">[[-<span class="number">100.</span> -<span class="number">51.</span> -<span class="number">99.</span> -<span class="number">116.</span> -<span class="number">102.</span>] </span><br><span class="line">[-<span class="number">123.</span> -<span class="number">87.</span> -<span class="number">51.</span> -<span class="number">98.</span> -<span class="number">97.</span>] </span><br><span class="line">[ -<span class="number">53.</span> -<span class="number">109.</span> -<span class="number">95.</span> -<span class="number">49.</span> -<span class="number">115.</span>] </span><br><span class="line">[ -<span class="number">95.</span> -<span class="number">65.</span> -<span class="number">119.</span> -<span class="number">101.</span> -<span class="number">53.</span>]</span><br><span class="line">[-<span class="number">111.</span> -<span class="number">111.</span> -<span class="number">109.</span> -<span class="number">51.</span> -<span class="number">125.</span>]]</span><br><span class="line">m = [[-<span class="number">100</span>, -<span class="number">51</span>, -<span class="number">99</span>, -<span class="number">116</span>, -<span class="number">102</span>],</span><br><span class="line">[-<span class="number">123</span>, -<span class="number">87</span>, -<span class="number">51</span>, -<span class="number">98</span>, -<span class="number">97</span>], </span><br><span class="line">[ -<span class="number">53</span>, -<span class="number">109</span>, -<span class="number">95</span>, -<span class="number">49</span>, -<span class="number">115</span>], </span><br><span class="line">[ -<span class="number">95</span>, -<span class="number">65</span>, -<span class="number">119</span>, -<span class="number">101</span>, -<span class="number">53</span>], </span><br><span class="line">[-<span class="number">111</span>, -<span class="number">111</span>, -<span class="number">109</span>, -<span class="number">51</span>, -<span class="number">125</span>]] </span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> m: </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> l: </span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(-x),end=<span class="string">&#x27;&#x27;</span>) </span><br><span class="line">d3ctf&#123;W3ba5m_1s_Awe5oom3&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>交上去不对，然后找了许多地方，找到验证处</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">unnamed_function_39846</span><span class="params">(<span class="type">int</span> param1,undefined4 param2)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  undefined4 uVar2;</span><br><span class="line">  <span class="type">int</span> param1_00;</span><br><span class="line">  <span class="type">int</span> param2_00;</span><br><span class="line">  undefined4 *puVar3;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (cRam002f65f4 == <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">    unnamed_function_432(<span class="number">0x24b40c</span>);</span><br><span class="line">    unnamed_function_432(<span class="number">0x24b8dc</span>);</span><br><span class="line">    unnamed_function_432(<span class="number">0x252bd4</span>);</span><br><span class="line">    unnamed_function_432(<span class="number">0x251d78</span>);</span><br><span class="line">    unnamed_function_432(<span class="number">0x24fac4</span>);</span><br><span class="line">    cRam002f65f4 = <span class="string">&#x27;\x01&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  iVar1 = unnamed_function_1598</span><br><span class="line">                    (*(undefined4 *)(*(<span class="type">int</span> *)(param1 + <span class="number">0xc</span>) + <span class="number">0xc</span>),uRam00252bd4,uRam0024b8dc);</span><br><span class="line">  uVar2 = unnamed_function_670(param1,<span class="number">0</span>);</span><br><span class="line">  param1_00 = unnamed_function_702(uVar2,uRam0024b40c);</span><br><span class="line">  param2_00 = unnamed_function_4566(*(undefined4 *)(param1_00 + <span class="number">0x110</span>),<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> (*(<span class="type">int</span> *)(param2_00 + <span class="number">0xc</span>) == <span class="number">0x19</span>) &#123;     <span class="comment">//长度比较</span></span><br><span class="line">    *(<span class="type">short</span> *)(param2_00 + <span class="number">0x22</span>) = *(<span class="type">short</span> *)(param2_00 + <span class="number">0x22</span>) + <span class="number">0x21</span>;</span><br><span class="line">		<span class="comment">//这里对输入的某个字符进行了+0x21的操作</span></span><br><span class="line">  &#125;</span><br><span class="line">  uVar2 = unnamed_function_4565(<span class="number">0</span>,param2_00,<span class="number">0</span>);</span><br><span class="line">  puVar3 = (undefined4 *)<span class="number">0x24fac4</span>;</span><br><span class="line">  iVar1 = (**(code **)((longlong)*(<span class="type">int</span> *)(iVar1 + <span class="number">0xc</span>) * <span class="number">8</span>))</span><br><span class="line">                    (*(undefined4 *)(iVar1 + <span class="number">0x20</span>),uVar2,*(undefined4 *)(iVar1 + <span class="number">0x14</span>));</span><br><span class="line">  <span class="keyword">if</span> (iVar1 != <span class="number">1</span>) &#123;   <span class="comment">//1</span></span><br><span class="line">    puVar3 = (undefined4 *)<span class="number">0x251d78</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  unnamed_function_6086(param1_00,*puVar3,<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也就是说我们在验证长度后，又对某个字符进行+33的操作，那么直接爆破试试就行了！</p>
<p>d3ctf{W3b@5m_1s_Awe5oom3} </p>
<h3 id="d3wow"><a href="#d3wow" class="headerlink" title="d3wow"></a>d3wow</h3><p>这个题是一道迷宫题，给了两个函数，第一个函数是要求输入1，2，3，4但都不能超范围，通过动调发现这个函数还在验证前几个字符是否是d3ctf{2，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_401000</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [esp+0h] [ebp-10h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+8h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp+Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="number">6</span>;</span><br><span class="line">  <span class="keyword">if</span> ( *(_DWORD *)a1 != <span class="number">1952658276</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( *(_WORD *)(a1 + <span class="number">4</span>) != <span class="number">31590</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( *(_BYTE *)(a1 + <span class="number">6</span>) != <span class="number">50</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( *(_BYTE *)(v3 + a1) != <span class="number">125</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">switch</span> ( *(_BYTE *)(v3 + a1) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * v5 + <span class="number">4</span> * v4) |= <span class="number">8u</span>;</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * --v5 + <span class="number">4</span> * v4) |= <span class="number">2u</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * v5 + <span class="number">4</span> * v4) |= <span class="number">2u</span>;</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * ++v5 + <span class="number">4</span> * v4) |= <span class="number">8u</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * v5 + <span class="number">4</span> * v4) |= <span class="number">4u</span>;</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * v5 + <span class="number">4</span> * v4-- - <span class="number">4</span>) |= <span class="number">1u</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * v5 + <span class="number">4</span> * v4) |= <span class="number">1u</span>;</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * v5 + <span class="number">4</span> * v4++ + <span class="number">4</span>) |= <span class="number">4u</span>;</span><br><span class="line">LABEL_14:</span><br><span class="line">        <span class="keyword">if</span> ( v5 &lt; <span class="number">0</span> || v4 &lt; <span class="number">0</span> || v5 &gt; <span class="number">5</span> || v4 &gt; <span class="number">5</span> )</span><br><span class="line">          <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        ++v3;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个函数很好理解，下一个函数明显是64位的，但被嵌在32位中了，我们通过dump进行提取：</p>
<p>在32位里打开找到函数地址</p>
<p><img src="/2022/07/18/d3ctf/image-20220311162653245.png"></p>
<p><img src="/2022/07/18/d3ctf/image-20220311162718329.png"></p>
<p>dump出来再用64 位打开，进行创建函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line">int64 <span class="title function_">sub_0</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *v0; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+0h] [rbp-A8h]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+0h] [rbp-A8h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+0h] [rbp-A8h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+4h] [rbp-A4h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+4h] [rbp-A4h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+4h] [rbp-A4h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+8h] [rbp-A0h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+Ch] [rbp-9Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+10h] [rbp-98h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+14h] [rbp-94h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+18h] [rbp-90h]</span></span><br><span class="line">  <span class="type">int</span> m; <span class="comment">// [rsp+1Ch] [rbp-8Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v14; <span class="comment">// [rsp+20h] [rbp-88h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v15; <span class="comment">// [rsp+24h] [rbp-84h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v16; <span class="comment">// [rsp+28h] [rbp-80h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v17; <span class="comment">// [rsp+2Ch] [rbp-7Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v18; <span class="comment">// [rsp+30h] [rbp-78h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v19; <span class="comment">// [rsp+34h] [rbp-74h]</span></span><br><span class="line">  <span class="type">int</span> v20[<span class="number">4</span>]; <span class="comment">// [rsp+38h] [rbp-70h]</span></span><br><span class="line">  <span class="type">int</span> v21[<span class="number">10</span>]; <span class="comment">// [rsp+48h] [rbp-60h]</span></span><br><span class="line">  __int64 v22; <span class="comment">// [rsp+70h] [rbp-38h]</span></span><br><span class="line">  __int64 v23; <span class="comment">// [rsp+78h] [rbp-30h]</span></span><br><span class="line">  __int64 v24; <span class="comment">// [rsp+80h] [rbp-28h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+88h] [rbp-20h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+90h] [rbp-18h]</span></span><br><span class="line">  __int64 v27; <span class="comment">// [rsp+98h] [rbp-10h]</span></span><br><span class="line">  _DWORD *retaddr; <span class="comment">// [rsp+B0h] [rbp+8h]</span></span><br><span class="line"></span><br><span class="line">  MEMORY[<span class="number">0x12F0</span>]((<span class="type">unsigned</span> <span class="type">int</span>)retaddr);</span><br><span class="line">  retaddr = v0;</span><br><span class="line">  v20[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v20[<span class="number">1</span>] = <span class="number">14</span>;</span><br><span class="line">  v20[<span class="number">2</span>] = <span class="number">20</span>;</span><br><span class="line">  v21[<span class="number">0</span>] = <span class="number">4</span>;</span><br><span class="line">  v21[<span class="number">1</span>] = <span class="number">13</span>;</span><br><span class="line">  v21[<span class="number">2</span>] = <span class="number">15</span>;</span><br><span class="line">  v21[<span class="number">3</span>] = <span class="number">21</span>;</span><br><span class="line">  v21[<span class="number">4</span>] = <span class="number">24</span>;</span><br><span class="line">  v21[<span class="number">5</span>] = <span class="number">31</span>;</span><br><span class="line">  v21[<span class="number">6</span>] = <span class="number">32</span>;</span><br><span class="line">  v21[<span class="number">7</span>] = <span class="number">41</span>;</span><br><span class="line">  v21[<span class="number">8</span>] = <span class="number">45</span>;</span><br><span class="line">  v21[<span class="number">9</span>] = <span class="number">53</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">6</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * i + j] &gt; <span class="number">0xF</span>u )</span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">      v14 = retaddr[<span class="number">6</span> * i + j] % <span class="number">0x10</span>u / <span class="number">8</span>;<span class="comment">//得到的结果是0，1</span></span><br><span class="line">      v22 = j;</span><br><span class="line">      v15 = retaddr[<span class="number">6</span> * i + j] % <span class="number">8u</span> / <span class="number">4</span> + v14;</span><br><span class="line">      v23 = j;</span><br><span class="line">      v16 = retaddr[<span class="number">6</span> * i + j] % <span class="number">4u</span> / <span class="number">2</span> + v15;<span class="comment">//这个加起来最大是4，代表4条路</span></span><br><span class="line">      v24 = j;</span><br><span class="line">      <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * i + j] % <span class="number">2u</span> + v16 &gt; <span class="number">2</span> || !j &amp;&amp; retaddr[<span class="number">6</span> * i] % <span class="number">8u</span> / <span class="number">4</span> )<span class="comment">//前面代表路径不能超过2</span></span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">      <span class="keyword">if</span> ( j == <span class="number">5</span> &amp;&amp; retaddr[<span class="number">6</span> * i + <span class="number">5</span>] % <span class="number">2u</span> || !i &amp;&amp; retaddr[j] % <span class="number">0x10</span>u / <span class="number">8</span> || i == <span class="number">5</span> &amp;&amp; retaddr[j + <span class="number">30</span>] % <span class="number">4u</span> / <span class="number">2</span> )<span class="comment">//能推出1，3是下或者2，3是右，直接猜出上下左右是3142</span></span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();<span class="comment">//上述是检测是否到达边界</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="comment">//特殊点1</span></span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; (<span class="type">unsigned</span> __int64)k &lt; <span class="number">3</span>; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = v20[k] / <span class="number">10</span>;<span class="comment">//分别是0，1，2，代表列</span></span><br><span class="line">    v5 = v20[k] % <span class="number">10</span>;<span class="comment">//分别是0，4，0，代表行</span></span><br><span class="line">    <span class="comment">//平行的方向不能同时出现，也就是方向必须垂直</span></span><br><span class="line">    <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">0x10</span>u / <span class="number">8</span> &amp;&amp; retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">4u</span> / <span class="number">2</span> )</span><br><span class="line">      <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">8u</span> / <span class="number">4</span> &amp;&amp; retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">2u</span> )</span><br><span class="line">      <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    v17 = retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">0x10</span>u / <span class="number">8</span>;</span><br><span class="line">    v25 = v5;</span><br><span class="line">    v18 = retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">4u</span> / <span class="number">2</span> + v17;</span><br><span class="line">    v26 = v5;</span><br><span class="line">    v19 = retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">2u</span> + v18;</span><br><span class="line">    v27 = v5;</span><br><span class="line">    <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">8u</span> / <span class="number">4</span> + v19 != <span class="number">2</span> )<span class="comment">//该点通道必须等于2</span></span><br><span class="line">      <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    <span class="comment">//下个点与该点方向相同</span></span><br><span class="line">    <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">0x10</span>u / <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v2 - <span class="number">6</span> + v5] % <span class="number">0x10</span>u / <span class="number">8</span>) )</span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">4u</span> / <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v2 + <span class="number">6</span> + v5] % <span class="number">4u</span> / <span class="number">2</span>) )</span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">8u</span> / <span class="number">4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v2 - <span class="number">1</span> + v5] % <span class="number">8u</span> / <span class="number">4</span>) )</span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">2u</span> &amp;&amp; !(retaddr[<span class="number">6</span> * v2 + <span class="number">1</span> + v5] % <span class="number">2u</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//特殊点2</span></span><br><span class="line">  <span class="keyword">for</span> ( m = <span class="number">0</span>; (<span class="type">unsigned</span> __int64)m &lt; <span class="number">0xA</span>; ++m )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = v21[m] / <span class="number">10</span>;<span class="comment">//0,1,1,2,2,3,3,4,4,5列</span></span><br><span class="line">    v6 = v21[m] % <span class="number">10</span>;<span class="comment">//4,3,5,1,4,1,2,1,5,3行</span></span><br><span class="line">    <span class="comment">//方向平行</span></span><br><span class="line">    <span class="keyword">if</span> ( (!(retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">0x10</span>u / <span class="number">8</span>) || !(retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">4u</span> / <span class="number">2</span>))</span><br><span class="line">      &amp;&amp; (!(retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">8u</span> / <span class="number">4</span>) || !(retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">2u</span>))</span><br><span class="line">      || retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">0x10</span>u / <span class="number">8</span><span class="comment">//必须有垂直该点的通道</span></span><br><span class="line">      &amp;&amp; retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">4u</span> / <span class="number">2</span></span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 - <span class="number">6</span> + v6] % <span class="number">8u</span> / <span class="number">4</span>)</span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 - <span class="number">6</span> + v6] % <span class="number">2u</span>)</span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 + <span class="number">6</span> + v6] % <span class="number">8u</span> / <span class="number">4</span>)</span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 + <span class="number">6</span> + v6] % <span class="number">2u</span>)</span><br><span class="line">      || retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">8u</span> / <span class="number">4</span></span><br><span class="line">      &amp;&amp; retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">2u</span></span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 + <span class="number">1</span> + v6] % <span class="number">0x10</span>u / <span class="number">8</span>)</span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 + <span class="number">1</span> + v6] % <span class="number">4u</span> / <span class="number">2</span>)</span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 - <span class="number">1</span> + v6] % <span class="number">0x10</span>u / <span class="number">8</span>)</span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 - <span class="number">1</span> + v6] % <span class="number">4u</span> / <span class="number">2</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">//自动寻路</span></span><br><span class="line">  <span class="keyword">if</span> ( *retaddr % <span class="number">0x10</span>u / <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_67:</span><br><span class="line">      <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v4 + v7] % <span class="number">0x10</span>u / <span class="number">8</span>) || v4 - <span class="number">1</span> == v10 &amp;&amp; v7 == v11 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v4 + v7] % <span class="number">4u</span> / <span class="number">2</span>) || v4 + <span class="number">1</span> == v10 &amp;&amp; v7 == v11 )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v4 + v7] % <span class="number">8u</span> / <span class="number">4</span>) || v4 == v10 &amp;&amp; v7 - <span class="number">1</span> == v11 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v4 + v7] % <span class="number">2u</span>) || v4 == v10 &amp;&amp; v7 + <span class="number">1</span> == v11 )</span><br><span class="line">              <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">            v10 = v4;</span><br><span class="line">            v11 = v7++;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            v10 = v4;</span><br><span class="line">            v11 = v7--;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          v10 = v4;</span><br><span class="line">          v11 = v7;</span><br><span class="line">          ++v4;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v10 = v4;</span><br><span class="line">        v11 = v7;</span><br><span class="line">        --v4;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( !v4 &amp;&amp; !v7 )</span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *retaddr % <span class="number">4u</span> / <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_67;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *retaddr % <span class="number">8u</span> / <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_67;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *retaddr % <span class="number">2u</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_67;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到图：</p>
<p><img src="/2022/07/18/d3ctf/image-20220311173934317.png"></p>
<p>实心图是特殊点1，空心是特殊点2，左上角出发！</p>
<p>d3ctf{22441442223133324424441111133333}</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a><strong>Misc</strong></h2><h3 id="BadW3ter"><a href="#BadW3ter" class="headerlink" title="BadW3ter"></a><strong>BadW3ter</strong></h3><p><img src="/2022/07/18/d3ctf/image-20220314141125696.png" alt="image-20220314141125696"></p>
<p>改一下<img src="/2022/07/18/d3ctf/image-20220314141139098.png" alt="image-20220314141139098"></p>
<p>猜想CUY1nw31lai为deepsound的密码，然后解出一个图片，但图片是tif文件，我们用ps打开，发现该图片是叠加的</p>
<p><img src="/2022/07/18/d3ctf/image-20220314141343566.png" alt="image-20220314141343566"></p>
<p>我们使用油漆桶吧背景搞黑，二维码就变了</p>
<p><img src="/2022/07/18/d3ctf/image-20220314141319681.png" alt="image-20220314141319681"></p>
<p>D3CTF{M1r@9e_T@nK_1s_Om0sh1roiii1111!!!!!Isn’t_1t?} </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="bj777"
      src="/images/bitbug_favicon.ico">
  <p class="site-author-name" itemprop="name">bj777</p>
  <div class="site-description" itemprop="description">一位逆向菜狗</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">41</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/jonathanbest7" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jonathanbest7" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/506611735@qq.com" title="E-Mail → 506611735@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/bang-ji-1" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;bang-ji-1" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>知乎</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">bj777</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  
		<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
		<script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
		<script type="text/javascript" src="/js/src/fireworks.js"></script>
  
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":300,"height":600},"mobile":{"show":false},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
