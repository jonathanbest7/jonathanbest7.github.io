<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/bitbug_favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/bitbug_favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jonathanbest7.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="一位逆向菜狗">
<meta property="og:type" content="website">
<meta property="og:title" content="bj777的blog">
<meta property="og:url" content="https://jonathanbest7.github.io/index.html">
<meta property="og:site_name" content="bj777的blog">
<meta property="og:description" content="一位逆向菜狗">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="bj777">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://jonathanbest7.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>bj777的blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">bj777的blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">记录学习每一瞬间</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">1</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">35</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/11/08/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/08/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/" class="post-title-link" itemprop="url">强网拟态</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-11-08 13:28:48 / 修改时间：19:36:46" itemprop="dateCreated datePublished" datetime="2022-11-08T13:28:48+08:00">2022-11-08</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="强网拟态"><a href="#强网拟态" class="headerlink" title="强网拟态"></a>强网拟态</h1><h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><p>本次出了三道逆向题，是有史以来最多的一次，两个题都是第7个做出来的。</p>
<h3 id="comeongo"><a href="#comeongo" class="headerlink" title="comeongo"></a>comeongo</h3><p>go语言逆向，main_main里两个地方，主要加密再greetingscheck（）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v19 = fmt_Scan(v6, v12, v16);</span><br><span class="line">v21 = main_Greetingscheck(v7, v13, v17, v19);</span><br><span class="line">fmt_Printf(v8, v14, v18, v20, v21);</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v8 = main_check1();</span><br><span class="line">v10 = v6;</span><br><span class="line"><span class="keyword">if</span> ( v6 )</span><br><span class="line">&#123;</span><br><span class="line">  main_check2(v8);</span><br><span class="line">  v10 = v7;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> v10 != <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>两个check函数，前16字节都是在check1</p>
<p>check1很好过，是一个base58</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __golang <span class="title function_">main_runtime_Encoding</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  __int64 v1; <span class="comment">// r14</span></span><br><span class="line">  __int128 v2; <span class="comment">// xmm15</span></span><br><span class="line">  __int64 v3; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  __int64 v7; <span class="comment">// rax</span></span><br><span class="line">  __int64 v8; <span class="comment">// rax</span></span><br><span class="line">  __int64 v9; <span class="comment">// rax</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  __int64 v11; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// rax</span></span><br><span class="line">  __int64 v13; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v14; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v15; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v16; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v17; <span class="comment">// rax</span></span><br><span class="line">  __int64 v18; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v19; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v20; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v21; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v22; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v23; <span class="comment">// rax</span></span><br><span class="line">  __int64 v24; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v25; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v26; <span class="comment">// rax</span></span><br><span class="line">  __int64 v27; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v28; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v29; <span class="comment">// rax</span></span><br><span class="line">  __int64 v30; <span class="comment">// [rsp-46h] [rbp-128h]</span></span><br><span class="line">  __int64 v31; <span class="comment">// [rsp-46h] [rbp-128h]</span></span><br><span class="line">  __int64 v32; <span class="comment">// [rsp-46h] [rbp-128h]</span></span><br><span class="line">  __int64 v33; <span class="comment">// [rsp-46h] [rbp-128h]</span></span><br><span class="line">  __int64 v34; <span class="comment">// [rsp-46h] [rbp-128h]</span></span><br><span class="line">  __int64 v35; <span class="comment">// [rsp-46h] [rbp-128h]</span></span><br><span class="line">  __int64 v36; <span class="comment">// [rsp-46h] [rbp-128h]</span></span><br><span class="line">  __int64 v37; <span class="comment">// [rsp-46h] [rbp-128h]</span></span><br><span class="line">  __int64 v38; <span class="comment">// [rsp-3Eh] [rbp-120h]</span></span><br><span class="line">  __int64 v39; <span class="comment">// [rsp-3Eh] [rbp-120h]</span></span><br><span class="line">  __int64 v40; <span class="comment">// [rsp-3Eh] [rbp-120h]</span></span><br><span class="line">  __int64 v41; <span class="comment">// [rsp-3Eh] [rbp-120h]</span></span><br><span class="line">  __int64 v42; <span class="comment">// [rsp-3Eh] [rbp-120h]</span></span><br><span class="line">  __int64 v43; <span class="comment">// [rsp-3Eh] [rbp-120h]</span></span><br><span class="line">  __int64 v44; <span class="comment">// [rsp-36h] [rbp-118h]</span></span><br><span class="line">  __int64 v45; <span class="comment">// [rsp-36h] [rbp-118h]</span></span><br><span class="line">  __int64 v46; <span class="comment">// [rsp-2Eh] [rbp-110h]</span></span><br><span class="line">  <span class="type">char</span> v47; <span class="comment">// [rsp+1h] [rbp-E1h]</span></span><br><span class="line">  __int64 v48; <span class="comment">// [rsp+2h] [rbp-E0h]</span></span><br><span class="line">  __int64 v49; <span class="comment">// [rsp+2h] [rbp-E0h]</span></span><br><span class="line">  __int64 v50; <span class="comment">// [rsp+Ah] [rbp-D8h]</span></span><br><span class="line">  __int64 v51; <span class="comment">// [rsp+12h] [rbp-D0h]</span></span><br><span class="line">  <span class="type">char</span> v52; <span class="comment">// [rsp+3Ah] [rbp-A8h] BYREF</span></span><br><span class="line">  __int64 v53; <span class="comment">// [rsp+4Ah] [rbp-98h]</span></span><br><span class="line">  __int64 v54; <span class="comment">// [rsp+52h] [rbp-90h]</span></span><br><span class="line">  __int64 v55; <span class="comment">// [rsp+5Ah] [rbp-88h]</span></span><br><span class="line">  __int64 v56; <span class="comment">// [rsp+62h] [rbp-80h]</span></span><br><span class="line">  __int128 v57; <span class="comment">// [rsp+6Ah] [rbp-78h]</span></span><br><span class="line">  __int64 v58; <span class="comment">// [rsp+7Ah] [rbp-68h]</span></span><br><span class="line">  __int64 v59; <span class="comment">// [rsp+82h] [rbp-60h]</span></span><br><span class="line">  __int64 v60; <span class="comment">// [rsp+8Ah] [rbp-58h]</span></span><br><span class="line">  __int64 v61; <span class="comment">// [rsp+92h] [rbp-50h]</span></span><br><span class="line">  __int64 v62; <span class="comment">// [rsp+9Ah] [rbp-48h]</span></span><br><span class="line">  __int64 v63; <span class="comment">// [rsp+A2h] [rbp-40h]</span></span><br><span class="line">  __int64 v64; <span class="comment">// [rsp+AAh] [rbp-38h]</span></span><br><span class="line">  __int128 i; <span class="comment">// [rsp+B2h] [rbp-30h]</span></span><br><span class="line">  __int64 v66; <span class="comment">// [rsp+C2h] [rbp-20h]</span></span><br><span class="line">  __int64 v67; <span class="comment">// [rsp+CAh] [rbp-18h]</span></span><br><span class="line">  __int64 v68; <span class="comment">// [rsp+D2h] [rbp-10h]</span></span><br><span class="line">  __int64 v70; <span class="comment">// [rsp+EAh] [rbp+8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int64)&amp;v52 &lt;= *(_QWORD *)(v1 + <span class="number">16</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v70 = v0;</span><br><span class="line">    runtime_morestack_noctxt();</span><br><span class="line">    v0 = v70;</span><br><span class="line">  &#125;</span><br><span class="line">  v57 = v2;</span><br><span class="line">  v3 = v0;</span><br><span class="line">  v30 = runtime_stringtoslicebyte();</span><br><span class="line">  v58 = v4;</span><br><span class="line">  v59 = v3;</span><br><span class="line">  v60 = v5;</span><br><span class="line">  v38 = math_big_NewInt(v30);</span><br><span class="line">  v56 = v6;</span><br><span class="line">  math_big___ptr_Int__SetBytes(v31, v38);</span><br><span class="line">  v55 = v7;</span><br><span class="line">  v64 = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = v2; ; *((_QWORD *)&amp;i + <span class="number">1</span>) = v14 )</span><br><span class="line">  &#123;</span><br><span class="line">    v39 = math_big_NewInt(v32);</span><br><span class="line">    v56 = v8;</span><br><span class="line">    v44 = math_big___ptr_Int__Cmp(v33, v39);</span><br><span class="line">    <span class="keyword">if</span> ( v9 &lt;= <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    math_big_NewInt(v34);</span><br><span class="line">    v53 = v10;</span><br><span class="line">    v41 = math_big_NewInt(v35);</span><br><span class="line">    v54 = v11;</span><br><span class="line">    math_big___ptr_Int__DivMod(v36, v41, v44, v46);</span><br><span class="line">    v12 = math_big___ptr_Int__Int64();</span><br><span class="line">    <span class="keyword">if</span> ( v12 &gt;= qword_54A6B8 )</span><br><span class="line">      runtime_panicIndex();</span><br><span class="line">    v47 = off_54A6B0[v12];</span><br><span class="line">    v14 = *((_QWORD *)&amp;i + <span class="number">1</span>);</span><br><span class="line">    v13 = i;</span><br><span class="line">    v15 = v64;</span><br><span class="line">    v16 = i + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( *((_QWORD *)&amp;i + <span class="number">1</span>) &lt; (<span class="type">unsigned</span> __int64)(i + <span class="number">1</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      v48 = i;</span><br><span class="line">      runtime_growslice(v32, v42);</span><br><span class="line">      v16 = v15 + <span class="number">1</span>;</span><br><span class="line">      v15 = v17;</span><br><span class="line">      v14 = v18;</span><br><span class="line">      v13 = v48;</span><br><span class="line">    &#125;</span><br><span class="line">    *(_BYTE *)(v15 + v13) = v47;</span><br><span class="line">    v64 = v15;</span><br><span class="line">    *(_QWORD *)&amp;i = v16;</span><br><span class="line">  &#125;</span><br><span class="line">  v66 = v58;</span><br><span class="line">  v67 = v59;</span><br><span class="line">  v68 = v60;</span><br><span class="line">  v51 = <span class="number">0LL</span>;</span><br><span class="line">  v50 = v59;</span><br><span class="line">  <span class="keyword">while</span> ( v50 &gt; v51 &amp;&amp; !*(_BYTE *)(v51 + v66) )</span><br><span class="line">  &#123;</span><br><span class="line">    v19 = i;</span><br><span class="line">    v20 = i + <span class="number">1</span>;</span><br><span class="line">    v21 = *((_QWORD *)&amp;i + <span class="number">1</span>);</span><br><span class="line">    v22 = v64;</span><br><span class="line">    <span class="keyword">if</span> ( *((_QWORD *)&amp;i + <span class="number">1</span>) &lt; (<span class="type">unsigned</span> __int64)(i + <span class="number">1</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      v49 = i;</span><br><span class="line">      v44 = runtime_growslice(v34, v40);</span><br><span class="line">      v20 = v22 + <span class="number">1</span>;</span><br><span class="line">      v22 = v23;</span><br><span class="line">      v21 = v24;</span><br><span class="line">      v19 = v49;</span><br><span class="line">    &#125;</span><br><span class="line">    *(_BYTE *)(v22 + v19) = <span class="number">49</span>;</span><br><span class="line">    v64 = v22;</span><br><span class="line">    *(_QWORD *)&amp;i = v20;</span><br><span class="line">    *((_QWORD *)&amp;i + <span class="number">1</span>) = v21;</span><br><span class="line">    ++v51;</span><br><span class="line">  &#125;</span><br><span class="line">  v25 = i;</span><br><span class="line">  main_ReverseByteArr(v34, v40, v44);</span><br><span class="line">  v61 = v26;</span><br><span class="line">  v62 = v25;</span><br><span class="line">  v63 = v27;</span><br><span class="line">  v28 = v26;</span><br><span class="line">  runtime_slicebytetostring(v37, v43, v45);</span><br><span class="line">  *(_QWORD *)&amp;v57 = v29;</span><br><span class="line">  *((_QWORD *)&amp;v57 + <span class="number">1</span>) = v28;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>base58解密出来的就是账号和密码前8位，然后看check2，里面首先是对账号的密码的4位进行了字母表12的位移，然后进行base64加密，所以到目前为止已经推出了</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">账号：Go<span class="name">M0</span>bi<span class="number">13</span>_Bi<span class="symbol">n4567</span></span><br><span class="line"></span><br><span class="line">密码：<span class="name">G3</span>tItEzForReEFGH</span><br></pre></td></tr></table></figure>

<p>现在只剩账号和密码的后四位，而且经过动调发现真正的算法是在main_runtime_other函数中</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if ( v54 )</span><br><span class="line"> &#123;</span><br><span class="line">   main_runtime_other(v36, v41, v46, v50, v52, v53);</span><br><span class="line">  <span class="built_in"> return </span>v28;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>可以采用爆破求解，因为该处是通过密码来爆破账号的，且密码已经给出两位，所以只用爆破最后两位</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">zhanghaohousiwei = [<span class="number">0xDD</span>, <span class="number">0x8F</span>, <span class="number">0xA1</span>, <span class="number">0x64</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">code = &#x27;</span>vGGH<span class="number">&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i in range(<span class="number">4</span>):</span><br><span class="line">    flag+=chr(zhanghaohousiwei[i] - ord(code[i]) - i)</span><br><span class="line">print(flag)</span><br><span class="line">#账号：GoM0bi13_BingGo@</span><br><span class="line">#密码：G3tItEzForRevG0!</span><br><span class="line"><span class="keyword">for</span> i in range(<span class="number">27</span>,<span class="number">127</span>):</span><br><span class="line">    <span class="keyword">for</span> j in range(<span class="number">27</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">if</span> i + j + <span class="number">3</span> == <span class="number">0x64</span> and i-j == <span class="number">0x1f</span>:<span class="comment">//还有一个是64</span></span><br><span class="line">            print(i)</span><br><span class="line">            print(j)</span><br></pre></td></tr></table></figure>

<p>得到flag：flag{GoM0bi13_BingGo@G3tItEzForRevG0!}</p>
<h3 id="mcmc"><a href="#mcmc" class="headerlink" title="mcmc"></a>mcmc</h3><p>这个题纯纯的做了10个小时</p>
<p>用d810搞一下看的会比较清楚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+1Ch] [rbp-104h]</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">4</span>]; <span class="comment">// [rsp+20h] [rbp-100h] BYREF</span></span><br><span class="line">  _BYTE v6[<span class="number">3</span>]; <span class="comment">// [rsp+24h] [rbp-FCh] BYREF</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// [rsp+27h] [rbp-F9h]</span></span><br><span class="line">  _BYTE v8[<span class="number">4</span>]; <span class="comment">// [rsp+28h] [rbp-F8h] BYREF</span></span><br><span class="line">  _BYTE v9[<span class="number">3</span>]; <span class="comment">// [rsp+2Ch] [rbp-F4h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v10; <span class="comment">// [rsp+2Fh] [rbp-F1h]</span></span><br><span class="line">  _BYTE v11[<span class="number">4</span>]; <span class="comment">// [rsp+30h] [rbp-F0h] BYREF</span></span><br><span class="line">  _BYTE v12[<span class="number">3</span>]; <span class="comment">// [rsp+34h] [rbp-ECh] BYREF</span></span><br><span class="line">  <span class="type">char</span> v13; <span class="comment">// [rsp+37h] [rbp-E9h]</span></span><br><span class="line">  _BYTE v14[<span class="number">4</span>]; <span class="comment">// [rsp+38h] [rbp-E8h] BYREF</span></span><br><span class="line">  _BYTE v15[<span class="number">3</span>]; <span class="comment">// [rsp+3Ch] [rbp-E4h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [rsp+3Fh] [rbp-E1h]</span></span><br><span class="line">  <span class="type">char</span> v17[<span class="number">192</span>]; <span class="comment">// [rsp+50h] [rbp-D0h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v18; <span class="comment">// [rsp+110h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v19; <span class="comment">// [rsp+114h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">char</span> v20; <span class="comment">// [rsp+11Bh] [rbp-5h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+11Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v18 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x21</span>uLL);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x21</span>uLL);</span><br><span class="line">  __isoc99_scanf(&amp;unk_408004, s);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  v19 = v4;</span><br><span class="line">  i = <span class="number">-1341394107</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v19 != <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">-1901734900</span>; ; i = <span class="number">-1901734900</span> )</span><br><span class="line">      ;</span><br><span class="line">  &#125;</span><br><span class="line">  i = <span class="number">944589829</span>;</span><br><span class="line">  <span class="keyword">if</span> ( unk_40A0F8 &gt;= <span class="number">10</span> || unk_40A0F8 &lt; <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    i = <span class="number">-2083856703</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_8;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">-984240755</span>; ; i = <span class="number">-984240755</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 ^= <span class="number">0x44</span>u;</span><br><span class="line">    v10 ^= <span class="number">0x23</span>u;</span><br><span class="line">    v13 ^= <span class="number">0x5B</span>u;</span><br><span class="line">    v16 ^= <span class="number">0x5A</span>u;</span><br><span class="line">    sub_405480(s, v6, v8, v9);</span><br><span class="line">    sub_405480(v11, v12, v14, v15);</span><br><span class="line">    sub_4011A0(v17, &amp;byte_40A0A0, &amp;byte_40A0C0, <span class="number">1LL</span>);</span><br><span class="line">    sub_401820((__int64)v17, (__int64)s, v4);</span><br><span class="line">    i = <span class="number">-2083856703</span>;</span><br><span class="line">LABEL_8:</span><br><span class="line">    v7 ^= <span class="number">0x44</span>u;</span><br><span class="line">    v10 ^= <span class="number">0x23</span>u;</span><br><span class="line">    v13 ^= <span class="number">0x5B</span>u;</span><br><span class="line">    v16 ^= <span class="number">0x5A</span>u;</span><br><span class="line">    sub_405480(s, v6, v8, v9);</span><br><span class="line">    sub_405480(v11, v12, v14, v15);</span><br><span class="line">    sub_4011A0(v17, &amp;byte_40A0A0, &amp;byte_40A0C0, <span class="number">1LL</span>);</span><br><span class="line">    sub_401820((__int64)v17, (__int64)s, v4);</span><br><span class="line">    <span class="keyword">if</span> ( unk_40A0F8 &lt; <span class="number">10</span> || unk_40A0F8 &gt;= <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">269145055</span>; ; i = <span class="number">215820177</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( i &gt;= <span class="number">269145055</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      i = <span class="number">1215238956</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v4 &gt; <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        i = <span class="number">1341239842</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_15;</span><br><span class="line">      &#125;</span><br><span class="line">      i = <span class="number">-504198</span>;</span><br><span class="line">      <span class="keyword">if</span> ( unk_40A0F8 &lt; <span class="number">10</span> &amp;&amp; unk_40A0F8 &gt;= <span class="number">10</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        i = <span class="number">1576878451</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_17;</span><br><span class="line">      &#125;</span><br><span class="line">      i = <span class="number">215820177</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v20 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( unk_40A0F8 &gt;= <span class="number">10</span> || unk_40A0F8 &lt; <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    i = <span class="number">1576878451</span>;</span><br><span class="line">LABEL_17:</span><br><span class="line">    ;</span><br><span class="line">  &#125;</span><br><span class="line">  i = <span class="number">1408947266</span>;</span><br><span class="line">LABEL_15:</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Nice! flag:flag&#123;(your input)&#125;\n&quot;</span>);</span><br><span class="line">  i = <span class="number">-198005779</span>;</span><br><span class="line">  <span class="keyword">return</span> v18;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>好看多了，但是编译的不是很准确，可以看到最开始先对输入进行每8个字节异或，然后异或后的值传到sub_405480函数进行抽象的处理，接下来的函数就比较逆天了</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sub<span class="constructor">_405480(<span class="params">v11</span>, <span class="params">v12</span>, <span class="params">v14</span>, <span class="params">v15</span>)</span>;</span><br><span class="line">sub<span class="constructor">_4011A0(<span class="params">v17</span>, &amp;<span class="params">byte_40A0A0</span>, &amp;<span class="params">byte_40A0C0</span>, 1LL)</span>;</span><br><span class="line">sub<span class="constructor">_401820((<span class="params">__int64</span>)</span>v17, (__int64)s, v4);</span><br></pre></td></tr></table></figure>

<p>本来以为是chacha20加密，但是发现不对，怎么解都不对，由于chacha是对称加密，所以进行了验证发现并不是对称的。最后还是超人发现真正的加密是在sub_401820，直接看汇编，如下图：</p>
<p><img src="/2022/11/08/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/image-20221108152758147.png" alt="image-20221108152758147"></p>
<p>进行正向算法的一个逆，然后缩减了一下算法：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span> &#123;</span><br><span class="line">	<span class="type">uint32_t</span> en_data[] = &#123;<span class="number">0x93</span>, <span class="number">0x93</span>, <span class="number">0x93</span>, <span class="number">0xB8</span>, <span class="number">0x62</span>, <span class="number">0x62</span>, <span class="number">0x62</span>, <span class="number">0xC5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xDB</span>, <span class="number">0xC4</span>, <span class="number">0xC4</span>, <span class="number">0xC4</span>, <span class="number">0x0E</span>, <span class="number">0x93</span>, <span class="number">0x93</span>, <span class="number">0x93</span>, <span class="number">0x06</span>, <span class="number">0x62</span>, <span class="number">0x62</span>, <span class="number">0x62</span>, <span class="number">0x61</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x8D</span>, <span class="number">0xC4</span>, <span class="number">0xC4</span>, <span class="number">0xC4</span>, <span class="number">0xAA</span>&#125;;</span><br><span class="line">	<span class="type">uint32_t</span> en[] = &#123; <span class="number">0x17</span>, <span class="number">0x40</span>, <span class="number">0x2B</span>, <span class="number">0xDD</span>, <span class="number">0x11</span>, <span class="number">0xC8</span>, <span class="number">0xBD</span>, <span class="number">0xA7</span>, <span class="number">0x1B</span>, <span class="number">0x05</span>, <span class="number">0xF9</span>, <span class="number">0x58</span>, <span class="number">0x60</span>, <span class="number">0x6C</span>, <span class="number">0x64</span>, <span class="number">0xB7</span>, <span class="number">0x17</span>, <span class="number">0x40</span>, <span class="number">0x2B</span>, <span class="number">0x37</span>, <span class="number">0x11</span>, <span class="number">0xC8</span>, <span class="number">0xBD</span>, <span class="number">0x6F</span>, <span class="number">0x1B</span>, <span class="number">0x05</span>, <span class="number">0xF9</span>, <span class="number">0xFE</span>, <span class="number">0x60</span>, <span class="number">0x6C</span>, <span class="number">0x64</span>, <span class="number">0x6B</span> &#125;;</span><br><span class="line">	<span class="type">uint32_t</span> table[] = &#123; <span class="number">0xD3</span>, <span class="number">0x1B</span>, <span class="number">0xCC</span>, <span class="number">0x7D</span>, <span class="number">0xEF</span>, <span class="number">0xB9</span>, <span class="number">0x0D</span>, <span class="number">0xC6</span>, <span class="number">0xA0</span>, <span class="number">0xDB</span>, <span class="number">0xE2</span>, <span class="number">0x07</span>, <span class="number">0xFB</span>, <span class="number">0x0F</span>, <span class="number">0xB7</span>, <span class="number">0x0E</span>, <span class="number">0xCB</span>, <span class="number">0x73</span>, <span class="number">0x3A</span>, <span class="number">0x8A</span>, <span class="number">0xC5</span>, <span class="number">0x4E</span>, <span class="number">0x3E</span>, <span class="number">0xEC</span>, <span class="number">0x0C</span>, <span class="number">0xF0</span>, <span class="number">0xA2</span>, <span class="number">0x48</span>, <span class="number">0x94</span>, <span class="number">0x70</span>, <span class="number">0x27</span>, <span class="number">0x1B</span>, <span class="number">0xA4</span>, <span class="number">0x1C</span>, <span class="number">0x17</span>, <span class="number">0x1C</span>, <span class="number">0x0D</span>, <span class="number">0x71</span>, <span class="number">0xC8</span>, <span class="number">0xF2</span>, <span class="number">0x28</span>, <span class="number">0x2B</span>, <span class="number">0x9A</span>, <span class="number">0xA7</span>, <span class="number">0x3A</span>, <span class="number">0x5F</span>, <span class="number">0xB8</span>, <span class="number">0x6E</span>, <span class="number">0x81</span>, <span class="number">0x80</span>, <span class="number">0x54</span>, <span class="number">0x3B</span>, <span class="number">0x9D</span>, <span class="number">0x51</span>, <span class="number">0x0E</span>, <span class="number">0xC6</span>, <span class="number">0x21</span>, <span class="number">0x03</span>, <span class="number">0x49</span>, <span class="number">0xD4</span>, <span class="number">0xB6</span>, <span class="number">0x36</span>, <span class="number">0x31</span>, <span class="number">0x7B</span> &#125;;</span><br><span class="line">	<span class="type">uint32_t</span> k1 = <span class="number">0</span>;</span><br><span class="line">	<span class="type">uint32_t</span> k2 = <span class="number">0</span>;</span><br><span class="line">	<span class="type">uint32_t</span> k3 = <span class="number">0</span>;</span><br><span class="line">	<span class="type">uint32_t</span> k4 = <span class="number">0</span>;</span><br><span class="line">	<span class="type">uint32_t</span> k6 = <span class="number">0</span>;</span><br><span class="line">	<span class="type">uint32_t</span> k7 = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> i, k;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">		<span class="type">uint64_t</span> temp= <span class="number">0xfffffffffffffffe</span>;</span><br><span class="line">		temp ^= i;</span><br><span class="line">		temp &amp;= i;</span><br><span class="line">		<span class="keyword">if</span> (temp) &#123;</span><br><span class="line">			k2 = en[i - <span class="number">1</span>];</span><br><span class="line">			<span class="keyword">if</span> (k2 &gt; <span class="number">0xff</span>)</span><br><span class="line">				k2 = en[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			k2 = en[i + <span class="number">1</span>];</span><br><span class="line">		<span class="comment">//k2 = en[(i)%32];</span></span><br><span class="line">		<span class="comment">// en_data[i] = k4;</span></span><br><span class="line">		en[i] = (en[i] ^ <span class="number">0x7deeb3f5</span> | en[i] ^ <span class="number">0x7deeb3f5</span>) ^ (table[i] + k2) &amp; <span class="number">0xff</span> ^ <span class="number">0x7deeb3f5</span>;</span><br><span class="line">		<span class="comment">// k2 = k4;</span></span><br><span class="line">		<span class="comment">//k2 = en[(i + 1) % 32];</span></span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; hex &lt;&lt; en[i] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[0x93, 0x62, 0xB8, 0x19, 0x45, 0x20, 0x25, 0x25, 0x22, 0xFE, 0x7F, 0x00, 0x00, 0x16, 0x6D, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>发现真正加密其实也就一个，但是不太好爆，考虑采用z3，又发现前面的判断条件其实有些抽象，直接舍去就好</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">from z3 import*</span><br><span class="line">s=Solver()</span><br><span class="line">flag = [BitVec(<span class="string">&quot;flag%d&quot;</span> % i,<span class="number">8</span>) for i <span class="keyword">in</span> range(<span class="number">32</span>)]</span><br><span class="line"><span class="keyword">cmp</span> = [<span class="number">0x06</span>, <span class="number">0x08</span>, <span class="number">0x65</span>, <span class="number">0x04</span>, <span class="number">0x60</span>, <span class="number">0x03</span>, <span class="number">0x08</span>, <span class="number">0x01</span>, <span class="number">0x4A</span>, <span class="number">0x10</span>, <span class="number">0x32</span>, <span class="number">0x58</span>, <span class="number">0xEE</span>, <span class="number">0x97</span>, <span class="number">0x65</span>, <span class="number">0x84</span>, <span class="number">0x44</span>, <span class="number">0xF2</span>, <span class="number">0x10</span>, <span class="number">0x6B</span>, <span class="number">0xE8</span>, <span class="number">0x50</span>, <span class="number">0x24</span>, <span class="number">0x99</span>, <span class="number">0xF6</span>, <span class="number">0xE3</span>, <span class="number">0x21</span>, <span class="number">0x51</span>, <span class="number">0xC2</span>, <span class="number">0x5D</span>, <span class="number">0xBF</span>, <span class="number">0x32</span>]</span><br><span class="line">table = [<span class="number">0xD3</span>, <span class="number">0x1B</span>, <span class="number">0xCC</span>, <span class="number">0x7D</span>, <span class="number">0xEF</span>, <span class="number">0xB9</span>, <span class="number">0x0D</span>, <span class="number">0xC6</span>, <span class="number">0xA0</span>, <span class="number">0xDB</span>, <span class="number">0xE2</span>, <span class="number">0x07</span>, <span class="number">0xFB</span>, <span class="number">0x0F</span>, <span class="number">0xB7</span>, <span class="number">0x0E</span>, <span class="number">0xCB</span>, <span class="number">0x73</span>, <span class="number">0x3A</span>, <span class="number">0x8A</span>, <span class="number">0xC5</span>, <span class="number">0x4E</span>, <span class="number">0x3E</span>, <span class="number">0xEC</span>, <span class="number">0x0C</span>, <span class="number">0xF0</span>, <span class="number">0xA2</span>, <span class="number">0x48</span>, <span class="number">0x94</span>, <span class="number">0x70</span>, <span class="number">0x27</span>, <span class="number">0x1B</span>, <span class="number">0xA4</span>, <span class="number">0x1C</span>, <span class="number">0x17</span>, <span class="number">0x1C</span>, <span class="number">0x0D</span>, <span class="number">0x71</span>, <span class="number">0xC8</span>, <span class="number">0xF2</span>, <span class="number">0x28</span>, <span class="number">0x2B</span>, <span class="number">0x9A</span>, <span class="number">0xA7</span>, <span class="number">0x3A</span>, <span class="number">0x5F</span>, <span class="number">0xB8</span>, <span class="number">0x6E</span>, <span class="number">0x81</span>, <span class="number">0x80</span>, <span class="number">0x54</span>, <span class="number">0x3B</span>, <span class="number">0x9D</span>, <span class="number">0x51</span>, <span class="number">0x0E</span>, <span class="number">0xC6</span>, <span class="number">0x21</span>, <span class="number">0x03</span>, <span class="number">0x49</span>, <span class="number">0xD4</span>, <span class="number">0xB6</span>, <span class="number">0x36</span>, <span class="number">0x31</span>, <span class="number">0x7B</span>]</span><br><span class="line">for i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">    tmp = <span class="number">0xfffffffffffffffe</span></span><br><span class="line">    tmp = tmp^i</span><br><span class="line">    tmp = tmp&amp;i</span><br><span class="line">    if(tmp):</span><br><span class="line">        <span class="built_in">k2</span> = flag[i-<span class="number">1</span>]</span><br><span class="line"><span class="symbol">    else:</span></span><br><span class="line">        <span class="built_in">k2</span> = flag[i+<span class="number">1</span>]</span><br><span class="line">    flag[i] = (flag[i] ^ <span class="number">0x7deeb3f5</span> | flag[i] ^ <span class="number">0x7deeb3f5</span>) ^ (table[i] + <span class="built_in">k2</span>) &amp; <span class="number">0xff</span> ^ <span class="number">0x7deeb3f5</span></span><br><span class="line">for i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">    s<span class="number">.</span><span class="keyword">add</span>(flag[i] == <span class="keyword">cmp</span>[i])</span><br><span class="line">if s<span class="number">.</span>check() == sat:</span><br><span class="line">    model = s<span class="number">.</span>model()</span><br><span class="line">    print(model)</span><br><span class="line"><span class="symbol">else:</span></span><br><span class="line">    print(<span class="string">&quot;unsat&quot;</span>)</span><br><span class="line">#[<span class="number">250</span>,<span class="number">41</span>,<span class="number">215</span>,<span class="number">230</span>,<span class="number">105</span>,<span class="number">26</span>,<span class="number">212</span>,<span class="number">207</span>,<span class="number">159</span>,<span class="number">53</span>,<span class="number">113</span>,<span class="number">97</span>,<span class="number">139</span>,<span class="number">106</span>,<span class="number">203</span>,<span class="number">247</span>,<span class="number">84</span>,<span class="number">69</span>,<span class="number">59</span>,<span class="number">241</span>,<span class="number">195</span>,<span class="number">102</span>,<span class="number">227</span>,<span class="number">137</span>,<span class="number">231</span>,<span class="number">5</span>,<span class="number">251</span>,<span class="number">56</span>,<span class="number">193</span>,<span class="number">111</span>,<span class="number">176</span>,<span class="number">232</span>]</span><br><span class="line"></span><br><span class="line">#<span class="number">0xe6d729fa</span>, <span class="number">0xcfd41a69</span>, <span class="number">0x6171359f</span>, <span class="number">0xf7cb6a8b</span>, <span class="number">0xf13b4554</span>, <span class="number">0x89e366c3</span>, <span class="number">0x38fb05e7</span>, <span class="number">0xe8b06fc1</span></span><br></pre></td></tr></table></figure>

<p>得到的flag，每4个字节组合，并逆序</p>
<p>最抽象的是sub_405480函数</p>
<p><img src="/2022/11/08/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/image-20221108160739412.png" alt="image-20221108160739412"></p>
<p>我们的flag还要经过这个地方进行加密才能到达下一步，所以还要逆这个地方的汇编，明显是每4个字符进行加密，撸汇编然后z3解就行</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from z3 import*</span><br><span class="line">s=Solver()</span><br><span class="line">flag = [BitVec(<span class="string">&quot;flag%d&quot;</span> % i,<span class="number">32</span>) <span class="keyword">for</span> i in range(<span class="number">4</span>)]</span><br><span class="line">cmp = [<span class="number">0xe6d729fa</span>, <span class="number">0xcfd41a69</span>, <span class="number">0x6171359f</span>, <span class="number">0xf7cb6a8b</span>, <span class="number">0xf13b4554</span>, <span class="number">0x89e366c3</span>, <span class="number">0x38fb05e7</span>, <span class="number">0xe8b06fc1</span>]</span><br><span class="line">s.add(((flag[<span class="number">0</span>] &lt;&lt; <span class="number">1</span>) - ((<span class="number">0</span> - flag[<span class="number">1</span>]) &amp; <span class="number">0xffffffff</span>) - flag[<span class="number">2</span>] + flag[<span class="number">3</span>]) &amp; <span class="number">0xffffffff</span> == cmp[<span class="number">0</span>])</span><br><span class="line">s.add(((flag[<span class="number">0</span>] - flag[<span class="number">1</span>] + flag[<span class="number">2</span>]) + (<span class="number">0</span> - flag[<span class="number">3</span>]) &amp; <span class="number">0xffffffff</span>) &amp; <span class="number">0xffffffff</span> == cmp[<span class="number">2</span>])</span><br><span class="line">s.add((flag[<span class="number">0</span>] + flag[<span class="number">1</span>] + flag[<span class="number">2</span>] -flag[<span class="number">3</span>])&amp;<span class="number">0xffffffff</span> == cmp[<span class="number">1</span>])</span><br><span class="line">s.add((flag[<span class="number">3</span>] * <span class="number">2</span> + flag[<span class="number">0</span>] + flag[<span class="number">1</span>] * <span class="number">2</span> - flag[<span class="number">2</span>])&amp;<span class="number">0xffffffff</span> == cmp[<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    model = s.model()</span><br><span class="line">    print(model)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&quot;unsat&quot;</span>)</span><br><span class="line">flag3 = <span class="number">1194345311</span>,</span><br><span class="line">flag0 = <span class="number">1835889971</span>,</span><br><span class="line">flag2 = <span class="number">1919252016</span>,</span><br><span class="line">flag1 = <span class="number">925987429</span></span><br><span class="line">flag4 = <span class="number">0x63676e69</span></span><br><span class="line">flag5 = <span class="number">0x2874306e</span></span><br><span class="line">flag6 = <span class="number">0x30703054</span></span><br><span class="line">flag7 = <span class="number">0x32686868</span></span><br></pre></td></tr></table></figure>

<p>那四个字节也需要异或回去，得到flag</p>
<p>3ummer1s0ver_C0dingcn0tsT0p0hhhh</p>
<h3 id="windows-call"><a href="#windows-call" class="headerlink" title="windows_call"></a>windows_call</h3><p>这个题是aes题,看起来是个混淆，但混的不多</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_402613(v26, <span class="number">1</span>, <span class="number">16</span>, v38, v0 + <span class="number">1028</span>, v42);</span><br></pre></td></tr></table></figure>

<p>这个函数是aes函数，经过动态调试发现key和iv做运算</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">	v29 = v38[v27] ^ (v27 - <span class="number">64</span>);</span><br><span class="line">	v37[v27] = v29;</span><br><span class="line">	v28 += v29;</span><br><span class="line">	++v27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用z3找出前几个字节然后解aes就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">s = Solver()</span><br><span class="line">flag = [BitVec(<span class="string">&quot;flag%d&quot;</span> % i,<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">s.add((flag[<span class="number">0</span>]+<span class="number">0x3800</span>-<span class="number">0x10000</span>)&lt;=<span class="number">0x800</span>)</span><br><span class="line">s.add((flag[<span class="number">0</span>]+<span class="number">0x3800</span>)&gt;<span class="number">0x10000</span>)</span><br><span class="line">s.add((flag[<span class="number">1</span>]+<span class="number">0x3500</span>-<span class="number">0x10000</span>)&lt;=<span class="number">0x500</span>)</span><br><span class="line">s.add((flag[<span class="number">1</span>]+<span class="number">0x3500</span>)&gt;<span class="number">0x10000</span>)</span><br><span class="line">s.add(flag[<span class="number">0</span>]&amp;<span class="number">0xff00</span>&lt;<span class="number">0xca00</span>)</span><br><span class="line">s.add(flag[<span class="number">1</span>]&amp;<span class="number">0xff</span>==<span class="number">0xa0</span>)</span><br><span class="line">s.add(flag[<span class="number">1</span>]-flag[<span class="number">0</span>]==<span class="number">0x2B8</span>)</span><br><span class="line">v25=(flag[<span class="number">0</span>]^flag[<span class="number">1</span>])&amp;<span class="number">0xff</span></span><br><span class="line">v55=(flag[<span class="number">0</span>]^flag[<span class="number">1</span>])&gt;&gt;<span class="number">8</span></span><br><span class="line">iv=[]</span><br><span class="line"><span class="keyword">for</span> v23 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    iv.append((v55+v23)^(v25+v23))</span><br><span class="line">v57=<span class="number">0</span></span><br><span class="line">v37=[]</span><br><span class="line">v28=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> v27 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    v29=iv[v27]^(v27-<span class="number">64</span>+<span class="number">0x100</span>)</span><br><span class="line">    v37.append(v29)</span><br><span class="line">    v28+=v29</span><br><span class="line">s.add(v28==<span class="number">0x8a8</span>)</span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    model = s.model()</span><br><span class="line">    <span class="built_in">print</span>(model)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;unsat&quot;</span>)</span><br><span class="line"><span class="comment">#[flag0 = 51688, flag1 = 52384]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后求出key和iv</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">flag=[<span class="number">51688</span>,<span class="number">52384</span>]</span><br><span class="line">v25=(flag[<span class="number">0</span>]^flag[<span class="number">1</span>])&amp;<span class="number">0xff</span></span><br><span class="line">v55=(flag[<span class="number">0</span>]^flag[<span class="number">1</span>])&gt;&gt;<span class="number">8</span></span><br><span class="line">iv=[]</span><br><span class="line"><span class="keyword">for</span> v23 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    iv.append((v55+v23)^(v25+v23))</span><br><span class="line">v57=<span class="number">0</span></span><br><span class="line">key=[]</span><br><span class="line">v28=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> v27 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    v29=iv[v27]^(v27-<span class="number">64</span>+<span class="number">0x100</span>)</span><br><span class="line">    key.append(v29)</span><br><span class="line">    v28+=v29</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后解aes就行了</p>
<h3 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h3><p>动调发现过不去，猜测tls里有反调试</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __stdcall <span class="title function_">TlsCallback_0_0</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  HANDLE CurrentProcess; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> ProcessInformation; <span class="comment">// [esp+E8h] [ebp-Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(byte_2470F4);</span><br><span class="line">  ProcessInformation = <span class="number">0</span>;</span><br><span class="line">  AddVectoredExceptionHandler(<span class="number">0</span>, Handler);<span class="comment">//sbox加密</span></span><br><span class="line">  AddVectoredContinueHandler(<span class="number">0</span>, sub_231041);</span><br><span class="line">  SetUnhandledExceptionFilter(TopLevelExceptionFilter);</span><br><span class="line">  result = j_NtQueryInformationProcess((HANDLE)<span class="number">0xFFFFFFFF</span>, ProcessDebugPort, &amp;ProcessInformation, <span class="number">4u</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( ！result )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ProcessInformation != <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      CurrentProcess = GetCurrentProcess();</span><br><span class="line">      TerminateProcess(CurrentProcess, <span class="number">1u</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">9</span> / <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看汇编把result判断的jnz改成jz就能跳过去，最牛的是这个tls里有一个veh，当我们主程序出现除0异常的时候，会跳到handle这个地方</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_239050</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v0; <span class="comment">// al</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v1; <span class="comment">// al</span></span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v3; <span class="comment">// al</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v4; <span class="comment">// al</span></span><br><span class="line">  __int64 v5; <span class="comment">// [esp-8h] [ebp-11Ch]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp+10h] [ebp-104h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+1Ch] [ebp-F8h]</span></span><br><span class="line">  <span class="type">char</span> v8[<span class="number">12</span>]; <span class="comment">// [esp+28h] [ebp-ECh] BYREF</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [esp+34h] [ebp-E0h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 j; <span class="comment">// [esp+103h] [ebp-11h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 i; <span class="comment">// [esp+10Fh] [ebp-5h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(byte_2470F4);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">0x10</span>u; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">0x10</span>u; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = (j &amp; <span class="number">0xF</span>) + (<span class="type">unsigned</span> __int8)(<span class="number">16</span> * i);</span><br><span class="line">      sub_231442(v5, SHIDWORD(v5));</span><br><span class="line">      dword_244000[<span class="number">16</span> * i + j] = v9;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">0x10</span>u; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">0x10</span>u; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_231442(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)sub_2313AC((<span class="type">int</span>)v8) )</span><br><span class="line">      &#123;</span><br><span class="line">        v0 = sub_2312E4(&amp;dword_244000[<span class="number">16</span> * i + j]);</span><br><span class="line">        v1 = sub_2315BE(v0, <span class="number">283</span>);</span><br><span class="line">        sub_231442(v1, <span class="number">0</span>);</span><br><span class="line">        dword_244000[<span class="number">16</span> * i + j] = v7;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= <span class="number">0x10</span>u )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">0x10</span>u; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = sub_2312E4(&amp;dword_244000[<span class="number">16</span> * i + j]);</span><br><span class="line">      v4 = sub_231299(v3, <span class="number">119</span>);</span><br><span class="line">      sub_231442(v4, <span class="number">0</span>);</span><br><span class="line">      dword_244000[<span class="number">16</span> * i + j] = v6;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个地方是对sbox进行的魔改，通过动调可以知道，他将逆sbox和sbox行列颠倒了，这是第一次魔改，再看主函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [esp+D0h] [ebp-1D8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+DCh] [ebp-1CCh]</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">184</span>]; <span class="comment">// [esp+E8h] [ebp-1C0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v8[<span class="number">4</span>]; <span class="comment">// [esp+1A0h] [ebp-108h] BYREF</span></span><br><span class="line">  _DWORD v9[<span class="number">16</span>]; <span class="comment">// [esp+1E8h] [ebp-C0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+228h] [ebp-80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">52</span>]; <span class="comment">// [esp+270h] [ebp-38h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(byte_2470F4);</span><br><span class="line">  j_memset(Str, <span class="number">0</span>, <span class="number">0x30</span>u);</span><br><span class="line">  sub_2310AF((<span class="type">int</span>)v9, <span class="number">4</span>, <span class="number">32</span>, (<span class="type">int</span>)sub_23116D);</span><br><span class="line">  sub_2310F5(<span class="built_in">std</span>::<span class="built_in">cin</span>, Str);</span><br><span class="line">  <span class="keyword">if</span> ( j_strlen(Str) != <span class="number">32</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  sub_231442(<span class="number">23</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">147</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">56</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">12</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">17</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">167</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">247</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">84</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">247</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">137</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">200</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">32</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">212</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">26</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">250</span>, <span class="number">0</span>);</span><br><span class="line">  sub_231442(<span class="number">37</span>, <span class="number">0</span>);</span><br><span class="line">  sub_23124E(Str, v9, <span class="number">32</span>);</span><br><span class="line">  sub_2310AF((<span class="type">int</span>)v7, <span class="number">4</span>, <span class="number">44</span>, (<span class="type">int</span>)sub_2313D4);</span><br><span class="line">  sub_231483((<span class="type">int</span>)v8, (<span class="type">int</span>)v7);<span class="comment">//初始化</span></span><br><span class="line">  sub_2315FF((<span class="type">int</span>)v9, (<span class="type">int</span>)v7);<span class="comment">//主要加密</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i )</span><br><span class="line">    sub_23164A(&amp;v9[i]);<span class="comment">//对key进行异或</span></span><br><span class="line">  sub_231483((<span class="type">int</span>)v8, (<span class="type">int</span>)v7);<span class="comment">//初始化</span></span><br><span class="line">  sub_2315FF((<span class="type">int</span>)&amp;v10, (<span class="type">int</span>)v7);<span class="comment">//主要加密</span></span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">32</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)sub_2313AC((<span class="type">int</span>)&amp;v9[j]) )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v3 = sub_2312BC(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;Congratulations! Your flag is: flag&#123;(your input)&#125;&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::ostream::operator&lt;&lt;(v3, sub_23105A);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个加密是将32位的字符串先进行前16位aes加密，然后得到加密后的16位再与之前的key进行异或，然后得到后16位的key</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">	AES_CYPHER_128,</span><br><span class="line">	AES_CYPHER_192,</span><br><span class="line">	AES_CYPHER_256,</span><br><span class="line">&#125; AES_CYPHER_T;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Encryption Rounds</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> g_aes_key_bits[] = &#123;</span><br><span class="line">	<span class="comment">/* AES_CYPHER_128 */</span> <span class="number">128</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_192 */</span> <span class="number">192</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_256 */</span> <span class="number">256</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> g_aes_rounds[] = &#123;</span><br><span class="line">	<span class="comment">/* AES_CYPHER_128 */</span>  <span class="number">10</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_192 */</span>  <span class="number">12</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_256 */</span>  <span class="number">14</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> g_aes_nk[] = &#123;</span><br><span class="line">	<span class="comment">/* AES_CYPHER_128 */</span>  <span class="number">4</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_192 */</span>  <span class="number">6</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_256 */</span>  <span class="number">8</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> g_aes_nb[] = &#123;</span><br><span class="line">	<span class="comment">/* AES_CYPHER_128 */</span>  <span class="number">4</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_192 */</span>  <span class="number">4</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_256 */</span>  <span class="number">4</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* aes Rcon:</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* WARNING: Rcon is designed starting from 1 to 15, not 0 to 14.</span></span><br><span class="line"><span class="comment">*          FIPS-197 Page 9: &quot;note that i starts at 1, not 0&quot;</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* i    |   0     1     2     3     4     5     6     7     8     9    10    11    12    13    14</span></span><br><span class="line"><span class="comment">* -----+------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*      | [01]  [02]  [04]  [08]  [10]  [20]  [40]  [80]  [1b]  [36]  [6c]  [d8]  [ab]  [4d]  [9a]</span></span><br><span class="line"><span class="comment">* RCON | [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]</span></span><br><span class="line"><span class="comment">*      | [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]</span></span><br><span class="line"><span class="comment">*      | [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> g_aes_rcon[] = &#123;</span><br><span class="line">	<span class="number">0x01000000</span>, <span class="number">0x02000000</span>, <span class="number">0x04000000</span>, <span class="number">0x08000000</span>, <span class="number">0x10000000</span>, <span class="number">0x20000000</span>, <span class="number">0x40000000</span>, <span class="number">0x80000000</span>,</span><br><span class="line">	<span class="number">0x1b000000</span>, <span class="number">0x36000000</span>, <span class="number">0x6c000000</span>, <span class="number">0xd8000000</span>, <span class="number">0xab000000</span>, <span class="number">0xed000000</span>, <span class="number">0x9a000000</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* aes sbox and invert-sbox</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint8_t</span> g_aes_sbox[<span class="number">256</span>] = &#123;</span><br><span class="line">	<span class="comment">/* 0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F  */</span></span><br><span class="line">	<span class="number">0x77</span>,<span class="number">0x68</span>,<span class="number">0x63</span>,<span class="number">0x6f</span>,<span class="number">0xe6</span>,<span class="number">0x7f</span>,<span class="number">0x7b</span>,<span class="number">0xd1</span>,<span class="number">0x24</span>,<span class="number">0x15</span>,<span class="number">0x73</span>,<span class="number">0x3f</span>,<span class="number">0xea</span>,<span class="number">0xc3</span>,<span class="number">0xbf</span>,<span class="number">0x62</span>,<span class="number">0xde</span>,<span class="number">0x96</span>,<span class="number">0xdd</span>,<span class="number">0x69</span>,<span class="number">0xee</span>,<span class="number">0x4d</span>,<span class="number">0x53</span>,<span class="number">0xe4</span>,<span class="number">0xb9</span>,<span class="number">0xc0</span>,<span class="number">0xb6</span>,<span class="number">0xbb</span>,<span class="number">0x88</span>,<span class="number">0xb0</span>,<span class="number">0x66</span>,<span class="number">0xd4</span>,<span class="number">0xa3</span>,<span class="number">0xe9</span>,<span class="number">0x87</span>,<span class="number">0x32</span>,<span class="number">0x22</span>,<span class="number">0x2b</span>,<span class="number">0xe3</span>,<span class="number">0xd8</span>,<span class="number">0x20</span>,<span class="number">0xb1</span>,<span class="number">0xf1</span>,<span class="number">0xe5</span>,<span class="number">0x65</span>,<span class="number">0xcc</span>,<span class="number">0x25</span>,<span class="number">0x1</span>,<span class="number">0x10</span>,<span class="number">0xd3</span>,<span class="number">0x37</span>,</span><br><span class="line"><span class="number">0xd7</span>,<span class="number">0xc</span>,<span class="number">0x82</span>,<span class="number">0x11</span>,<span class="number">0x8e</span>,<span class="number">0x13</span>,<span class="number">0x6</span>,<span class="number">0x94</span>,<span class="number">0xf6</span>,<span class="number">0xff</span>,<span class="number">0x33</span>,<span class="number">0xa6</span>,<span class="number">0x61</span>,<span class="number">0x1d</span>,<span class="number">0x97</span>,<span class="number">0x38</span>,<span class="number">0xe</span>,<span class="number">0xf</span>,<span class="number">0x7a</span>,<span class="number">0x4e</span>,<span class="number">0xb4</span>,<span class="number">0x46</span>,<span class="number">0x2f</span>,<span class="number">0xc2</span>,<span class="number">0xa7</span>,<span class="number">0x3d</span>,<span class="number">0xf7</span>,<span class="number">0x3b</span>,<span class="number">0x90</span>,<span class="number">0x47</span>,<span class="number">0xc5</span>,<span class="number">0x14</span>,<span class="number">0xf9</span>,<span class="number">0x34</span>,<span class="number">0xe8</span>,<span class="number">0xa5</span></span><br><span class="line">,<span class="number">0x4f</span>,<span class="number">0x7e</span>,<span class="number">0xdf</span>,<span class="number">0xaa</span>,<span class="number">0x2d</span>,<span class="number">0x5e</span>,<span class="number">0x58</span>,<span class="number">0x4c</span>,<span class="number">0xdb</span>,<span class="number">0xc4</span>,<span class="number">0xfb</span>,<span class="number">0xbe</span>,<span class="number">0xef</span>,<span class="number">0x57</span>,<span class="number">0x59</span>,<span class="number">0x27</span>,<span class="number">0x91</span>,<span class="number">0x51</span>,<span class="number">0xed</span>,<span class="number">0x16</span>,<span class="number">0x6b</span>,<span class="number">0x44</span>,<span class="number">0x28</span>,<span class="number">0x8b</span>,<span class="number">0xbc</span>,<span class="number">0x45</span>,<span class="number">0xb7</span>,<span class="number">0x54</span>,<span class="number">0x9b</span>,<span class="number">0x86</span>,<span class="number">0x89</span>,<span class="number">0x2c</span>,<span class="number">0xe1</span>,<span class="number">0xa8</span>,<span class="number">0xa2</span>,<span class="number">0xce</span>,<span class="number">0x35</span>,<span class="number">0x4</span>,<span class="number">0xeb</span>,<span class="number">0xe7</span>,<span class="number">0xc6</span>,<span class="number">0xd9</span>,<span class="number">0x18</span>,<span class="number">0x7</span>,<span class="number">0xf8</span>,<span class="number">0x4b</span>,<span class="number">0x83</span>,<span class="number">0x50</span>,<span class="number">0x3</span>,<span class="number">0xd0</span>,<span class="number">0xb3</span>,<span class="number">0x6a</span>,<span class="number">0x29</span>,<span class="number">0x70</span>,<span class="number">0x49</span>,<span class="number">0xd</span>,<span class="number">0x67</span>,<span class="number">0x74</span>,<span class="number">0x95</span>,<span class="number">0x5b</span>,<span class="number">0xc8</span>,<span class="number">0x36</span>,<span class="number">0x3e</span>,<span class="number">0x84</span>,<span class="number">0x9c</span>,<span class="number">0x52</span>,<span class="number">0xfa</span>,<span class="number">0xac</span>,<span class="number">0x0</span>,<span class="number">0xca</span>,</span><br><span class="line"><span class="number">0x4a</span>,<span class="number">0x1f</span>,<span class="number">0xcf</span>,<span class="number">0xf4</span>,<span class="number">0x26</span>,<span class="number">0x2e</span>,<span class="number">0x1e</span>,<span class="number">0x5d</span>,<span class="number">0x12</span>,<span class="number">0x30</span>,<span class="number">0x48</span>,<span class="number">0xd6</span>,<span class="number">0xc7</span>,<span class="number">0xb8</span>,<span class="number">0x76</span>,<span class="number">0x85</span>,<span class="number">0x81</span>,<span class="number">0xf0</span>,<span class="number">0x6d</span>,<span class="number">0xf3</span>,<span class="number">0xdc</span>,<span class="number">0x23</span>,<span class="number">0x79</span>,<span class="number">0x99</span>,<span class="number">0xc1</span>,<span class="number">0x5a</span>,<span class="number">0xbd</span>,<span class="number">0x78</span>,<span class="number">0x42</span>,<span class="number">0xe0</span>,<span class="number">0xfe</span>,<span class="number">0x71</span>,<span class="number">0x6e</span>,<span class="number">0xba</span>,<span class="number">0x1c</span></span><br><span class="line">,<span class="number">0xae</span>,<span class="number">0x6c</span>,<span class="number">0x31</span>,<span class="number">0x3a</span>,<span class="number">0x8</span>,<span class="number">0xb2</span>,<span class="number">0xa0</span>,<span class="number">0xd2</span>,<span class="number">0xfc</span>,<span class="number">0xc9</span>,<span class="number">0x60</span>,<span class="number">0xb</span>,<span class="number">0x5f</span>,<span class="number">0xa9</span>,<span class="number">0x9f</span>,<span class="number">0x9e</span>,<span class="number">0x64</span>,<span class="number">0x2a</span></span><br><span class="line">,<span class="number">0xa1</span>,<span class="number">0x72</span>,<span class="number">0x5c</span>,<span class="number">0x17</span>,<span class="number">0xe2</span>,<span class="number">0x1a</span>,<span class="number">0x75</span>,<span class="number">0x21</span>,<span class="number">0x43</span>,<span class="number">0xad</span>,<span class="number">0x92</span>,<span class="number">0xd5</span>,<span class="number">0x9</span>,<span class="number">0x8a</span>,<span class="number">0xf5</span>,<span class="number">0xec</span>,<span class="number">0x8c</span>,<span class="number">0x5</span>,<span class="number">0x7d</span>,<span class="number">0xcd</span>,<span class="number">0x9a</span>,<span class="number">0x80</span>,<span class="number">0x8f</span>,<span class="number">0xa</span>,<span class="number">0x93</span>,<span class="number">0xfd</span>,<span class="number">0xda</span>,<span class="number">0x41</span>,<span class="number">0x3c</span>,<span class="number">0xcb</span>,<span class="number">0x98</span>,<span class="number">0xb5</span>,<span class="number">0x9d</span>,<span class="number">0x19</span>,<span class="number">0xab</span>,<span class="number">0xf2</span>,<span class="number">0x56</span>,<span class="number">0x7c</span>,<span class="number">0x55</span>,<span class="number">0x8d</span>,<span class="number">0x39</span>,<span class="number">0x1b</span>,<span class="number">0xa4</span>,<span class="number">0x40</span>,<span class="number">0xaf</span>,<span class="number">0x2</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint8_t</span> g_inv_sbox[<span class="number">256</span>] = &#123;</span><br><span class="line">	<span class="comment">/* 0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F  */</span></span><br><span class="line">	<span class="number">0x9B</span>,<span class="number">0x2F</span>,<span class="number">0xFF</span>,<span class="number">0x87</span>,<span class="number">0x7C</span>,<span class="number">0xE3</span>,<span class="number">0x39</span>,<span class="number">0x82</span>,<span class="number">0xC4</span>,<span class="number">0xDE</span>,<span class="number">0xE9</span>,<span class="number">0xCB</span>,<span class="number">0x34</span>,<span class="number">0x8E</span>,<span class="number">0x43</span>,<span class="number">0x44</span>,</span><br><span class="line"><span class="number">0x30</span>,<span class="number">0x36</span>,<span class="number">0xA5</span>,<span class="number">0x38</span>,<span class="number">0x52</span>,<span class="number">0x09</span>,<span class="number">0x6A</span>,<span class="number">0xD5</span>,<span class="number">0x81</span>,<span class="number">0xF3</span>,<span class="number">0xD7</span>,<span class="number">0xFB</span>,<span class="number">0xBF</span>,<span class="number">0x40</span>,<span class="number">0xA3</span>,<span class="number">0x9E</span>,<span class="number">0x28</span></span><br><span class="line">,<span class="number">0xD9</span>,<span class="number">0x24</span>,<span class="number">0xB2</span>,<span class="number">0x08</span>,<span class="number">0x2E</span>,<span class="number">0xA1</span>,<span class="number">0x66</span>,<span class="number">0x6D</span>,<span class="number">0x8B</span>,<span class="number">0xD1</span>,<span class="number">0x25</span>,<span class="number">0x76</span>,<span class="number">0x5B</span>,<span class="number">0xA2</span>,<span class="number">0x49</span>,<span class="number">0xA6</span>,<span class="number">0xC2</span>,<span class="number">0x23</span>,<span class="number">0x3D</span>,<span class="number">0x54</span>,<span class="number">0x7B</span>,<span class="number">0x94</span>,<span class="number">0x32</span>,<span class="number">0x42</span>,<span class="number">0xFA</span>,<span class="number">0xC3</span>,<span class="number">0x4E</span>,<span class="number">0xEE</span>,<span class="number">0x4C</span>,<span class="number">0x95</span>,<span class="number">0x0B</span>,<span class="number">0xFD</span>,<span class="number">0xED</span>,<span class="number">0xB9</span>,<span class="number">0xDA</span>,<span class="number">0x6C</span>,<span class="number">0x70</span>,<span class="number">0x48</span>,<span class="number">0x50</span>,<span class="number">0xA7</span>,<span class="number">0x8D</span>,<span class="number">0x9D</span>,<span class="number">0x84</span>,<span class="number">0x5E</span>,<span class="number">0x15</span>,<span class="number">0x46</span>,<span class="number">0x57</span>,<span class="number">0x86</span>,<span class="number">0x68</span>,<span class="number">0x98</span>,<span class="number">0x16</span>,<span class="number">0x72</span>,<span class="number">0xF8</span>,<span class="number">0xF6</span>,<span class="number">0x64</span>,<span class="number">0x5D</span>,<span class="number">0x65</span>,<span class="number">0xB6</span>,<span class="number">0x92</span>,<span class="number">0xD4</span>,<span class="number">0xA4</span>,<span class="number">0x5C</span>,<span class="number">0xCC</span>,<span class="number">0xCA</span>,<span class="number">0x3F</span>,<span class="number">0x0F</span>,<span class="number">0x02</span>,<span class="number">0xD0</span>,<span class="number">0x2C</span>,<span class="number">0x1E</span>,<span class="number">0x8F</span>,<span class="number">0x01</span>,<span class="number">0x13</span>,<span class="number">0x8A</span>,<span class="number">0x6B</span>,<span class="number">0xC1</span>,<span class="number">0xAF</span>,<span class="number">0xBD</span>,<span class="number">0x03</span>,<span class="number">0x8C</span>,<span class="number">0xBC</span>,<span class="number">0xD3</span>,<span class="number">0x0A</span>,<span class="number">0x90</span>,<span class="number">0xD8</span>,<span class="number">0xAB</span>,<span class="number">0x00</span>,<span class="number">0xB8</span>,<span class="number">0xB3</span>,<span class="number">0x45</span>,<span class="number">0x06</span>,<span class="number">0xF7</span>,<span class="number">0xE4</span>,<span class="number">0x58</span>,<span class="number">0x05</span>,<span class="number">0xE7</span>,<span class="number">0xAD</span>,<span class="number">0x35</span>,<span class="number">0x85</span>,<span class="number">0x96</span>,</span><br><span class="line"><span class="number">0xAC</span>,<span class="number">0x74</span>,<span class="number">0x22</span>,<span class="number">0x1C</span>,<span class="number">0x75</span>,<span class="number">0xDF</span>,<span class="number">0x6E</span>,<span class="number">0xE2</span>,<span class="number">0xF9</span>,<span class="number">0x37</span>,<span class="number">0xE8</span>,<span class="number">0x4F</span>,<span class="number">0x67</span>,<span class="number">0xDC</span>,<span class="number">0xEA</span>,<span class="number">0x3A</span>,<span class="number">0x91</span>,<span class="number">0x11</span>,<span class="number">0x41</span>,<span class="number">0xF0</span>,<span class="number">0xB4</span>,<span class="number">0xE6</span>,<span class="number">0x73</span>,<span class="number">0x97</span>,<span class="number">0xF2</span>,<span class="number">0xCF</span>,<span class="number">0xCE</span>,<span class="number">0xC6</span>,<span class="number">0xD2</span>,<span class="number">0x79</span>,<span class="number">0x20</span>,<span class="number">0xFC</span>,<span class="number">0x56</span>,<span class="number">0x3E</span>,<span class="number">0x4B</span>,<span class="number">0x78</span>,<span class="number">0xCD</span>,<span class="number">0x5A</span>,<span class="number">0xF4</span>,<span class="number">0x9A</span>,<span class="number">0xDB</span>,<span class="number">0xC0</span>,<span class="number">0xFE</span>,<span class="number">0x1D</span>,<span class="number">0x29</span>,<span class="number">0xC5</span>,<span class="number">0x89</span>,<span class="number">0x47</span>,<span class="number">0xF1</span>,<span class="number">0x1A</span>,<span class="number">0x71</span>,<span class="number">0xAA</span>,<span class="number">0x18</span>,<span class="number">0xBE</span>,<span class="number">0x1B</span>,<span class="number">0x6F</span>,<span class="number">0xB7</span>,<span class="number">0x62</span>,<span class="number">0x0E</span>,<span class="number">0x19</span>,<span class="number">0xB5</span>,<span class="number">0x4A</span>,<span class="number">0x0D</span>,<span class="number">0x60</span>,<span class="number">0x51</span>,<span class="number">0x7F</span>,<span class="number">0xA9</span>,</span><br><span class="line"><span class="number">0x93</span>,<span class="number">0xC9</span>,<span class="number">0x9C</span>,<span class="number">0xEF</span>,<span class="number">0x2D</span>,<span class="number">0xE5</span>,<span class="number">0x7A</span>,<span class="number">0x9F</span>,<span class="number">0x88</span>,<span class="number">0x07</span>,<span class="number">0xC7</span>,<span class="number">0x31</span>,<span class="number">0x1F</span>,<span class="number">0xDD</span>,<span class="number">0xA8</span>,<span class="number">0x33</span>,<span class="number">0x27</span>,<span class="number">0x80</span>,<span class="number">0xEC</span>,<span class="number">0x5F</span>,<span class="number">0xB1</span>,<span class="number">0x12</span>,<span class="number">0x10</span>,<span class="number">0x59</span>,<span class="number">0xBA</span>,<span class="number">0x77</span>,<span class="number">0xD6</span>,<span class="number">0x26</span>,<span class="number">0x17</span>,<span class="number">0x2B</span>,<span class="number">0x04</span>,<span class="number">0x7E</span>,<span class="number">0x55</span>,<span class="number">0x21</span>,<span class="number">0x0C</span>,<span class="number">0x7D</span>,<span class="number">0xE1</span>,<span class="number">0x69</span>,<span class="number">0x14</span>,<span class="number">0x63</span>,<span class="number">0xAE</span>,<span class="number">0x2A</span>,<span class="number">0xF5</span>,<span class="number">0xB0</span>,<span class="number">0xA0</span>,<span class="number">0xE0</span>,<span class="number">0x3B</span>,<span class="number">0x4D</span>,<span class="number">0x83</span>,<span class="number">0x53</span>,<span class="number">0x99</span>,<span class="number">0x61</span>,<span class="number">0xC8</span>,<span class="number">0xEB</span>,<span class="number">0xBB</span>,<span class="number">0x3C</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">aes_sub_sbox</span><span class="params">(<span class="type">uint8_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> g_aes_sbox[val];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">aes_sub_dword</span><span class="params">(<span class="type">uint32_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span> tmp = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	tmp |= ((<span class="type">uint32_t</span>)aes_sub_sbox((<span class="type">uint8_t</span>)((val &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>))) &lt;&lt; <span class="number">0</span>;</span><br><span class="line">	tmp |= ((<span class="type">uint32_t</span>)aes_sub_sbox((<span class="type">uint8_t</span>)((val &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>))) &lt;&lt; <span class="number">8</span>;</span><br><span class="line">	tmp |= ((<span class="type">uint32_t</span>)aes_sub_sbox((<span class="type">uint8_t</span>)((val &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>))) &lt;&lt; <span class="number">16</span>;</span><br><span class="line">	tmp |= ((<span class="type">uint32_t</span>)aes_sub_sbox((<span class="type">uint8_t</span>)((val &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>))) &lt;&lt; <span class="number">24</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">aes_rot_dword</span><span class="params">(<span class="type">uint32_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span> tmp = val;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> (val &gt;&gt; <span class="number">8</span>) | ((tmp &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">24</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">aes_swap_dword</span><span class="params">(<span class="type">uint32_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> (((val &amp; <span class="number">0x000000FF</span>) &lt;&lt; <span class="number">24</span>) |</span><br><span class="line">		((val &amp; <span class="number">0x0000FF00</span>) &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">		((val &amp; <span class="number">0x00FF0000</span>) &gt;&gt; <span class="number">8</span>) |</span><br><span class="line">		((val &amp; <span class="number">0xFF000000</span>) &gt;&gt; <span class="number">24</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* nr: number of rounds</span></span><br><span class="line"><span class="comment">* nb: number of columns comprising the state, nb = 4 dwords (16 bytes)</span></span><br><span class="line"><span class="comment">* nk: number of 32-bit words comprising cipher key, nk = 4, 6, 8 (KeyLength/(4*8))</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_key_expansion</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *key, <span class="type">uint8_t</span> *round)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span> *w = (<span class="type">uint32_t</span> *)round;</span><br><span class="line">	<span class="type">uint32_t</span>  t;</span><br><span class="line">	<span class="type">int</span>      i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		w[i] = *((<span class="type">uint32_t</span> *)&amp;key[i * <span class="number">4</span> + <span class="number">0</span>]);</span><br><span class="line">	&#125; <span class="keyword">while</span> (++i &lt; g_aes_nk[mode]);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> ((i % g_aes_nk[mode]) == <span class="number">0</span>) &#123;</span><br><span class="line">			t = aes_rot_dword(w[i - <span class="number">1</span>]);</span><br><span class="line">			t = aes_sub_dword(t);</span><br><span class="line">			t = t ^ aes_swap_dword(g_aes_rcon[i / g_aes_nk[mode] - <span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (g_aes_nk[mode] &gt; <span class="number">6</span> &amp;&amp; (i % g_aes_nk[mode]) == <span class="number">4</span>) &#123;</span><br><span class="line">			t = aes_sub_dword(w[i - <span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			t = w[i - <span class="number">1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		w[i] = w[i - g_aes_nk[mode]] ^ t;</span><br><span class="line">	&#125; <span class="keyword">while</span> (++i &lt; g_aes_nb[mode] * (g_aes_rounds[mode] + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_add_round_key</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state,</span></span><br><span class="line"><span class="params">	<span class="type">uint8_t</span> *round, <span class="type">int</span> nr)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span> *w = (<span class="type">uint32_t</span> *)round;</span><br><span class="line">	<span class="type">uint32_t</span> *s = (<span class="type">uint32_t</span> *)state;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		s[i] ^= w[nr * g_aes_nb[mode] + i];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_sub_bytes</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i, j;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">			state[i * <span class="number">4</span> + j] = aes_sub_sbox(state[i * <span class="number">4</span> + j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_shift_rows</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> *s = (<span class="type">uint8_t</span> *)state;</span><br><span class="line">	<span class="type">int</span> i, j, r;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">			<span class="type">uint8_t</span> tmp = s[i];</span><br><span class="line">			<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; g_aes_nb[mode]; r++) &#123;</span><br><span class="line">				s[i + r * <span class="number">4</span>] = s[i + (r + <span class="number">1</span>) * <span class="number">4</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			s[i + (g_aes_nb[mode] - <span class="number">1</span>) * <span class="number">4</span>] = tmp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">aes_xtime</span><span class="params">(<span class="type">uint8_t</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> ((x &lt;&lt; <span class="number">1</span>) ^ (((x &gt;&gt; <span class="number">7</span>) &amp; <span class="number">1</span>) * <span class="number">0x1b</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">aes_xtimes</span><span class="params">(<span class="type">uint8_t</span> x, <span class="type">int</span> ts)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span> (ts-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		x = aes_xtime(x);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">aes_mul</span><span class="params">(<span class="type">uint8_t</span> x, <span class="type">uint8_t</span> y)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	* encrypt: y has only 2 bits: can be 1, 2 or 3</span></span><br><span class="line"><span class="comment">	* decrypt: y could be any value of 9, b, d, or e</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ((((y &gt;&gt; <span class="number">0</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">0</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">1</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">2</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">2</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">3</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">3</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">4</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">4</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">5</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">5</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">6</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">6</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">7</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">7</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_mix_columns</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> y[<span class="number">16</span>] = &#123; <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>,  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>,  <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>,  <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span>];</span><br><span class="line">	<span class="type">int</span> i, j, r;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">			s[r] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">				s[r] = s[r] ^ aes_mul(state[i * <span class="number">4</span> + j], y[r * <span class="number">4</span> + j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">			state[i * <span class="number">4</span> + r] = s[r];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_encrypt</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> w[<span class="number">4</span> * <span class="number">4</span> * <span class="number">15</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* round key */</span></span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* state */</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nr, i, j;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* key expansion */</span></span><br><span class="line">	aes_key_expansion(mode, key, w);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* start data cypher loop over input buffer */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span> * g_aes_nb[mode]) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* init state from user buffer (plaintext) */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			s[j] = data[i + j];</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* start AES cypher loop over all AES rounds */</span></span><br><span class="line">		<span class="keyword">for</span> (nr = <span class="number">0</span>; nr &lt;= g_aes_rounds[mode]; nr++) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (nr &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do SubBytes */</span></span><br><span class="line">				aes_sub_bytes(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do ShiftRows */</span></span><br><span class="line">				aes_shift_rows(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (nr &lt; g_aes_rounds[mode]) &#123;</span><br><span class="line">					<span class="comment">/* do MixColumns */</span></span><br><span class="line">					aes_mix_columns(mode, s);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* do AddRoundKey */</span></span><br><span class="line">			aes_add_round_key(mode, s, w, nr);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* save state (cypher) to user buffer */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			data[i + j] = s[j];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_encrypt_ecb</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> aes_encrypt(mode, data, len, key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_encrypt_cbc</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key, <span class="type">uint8_t</span> *iv)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> w[<span class="number">4</span> * <span class="number">4</span> * <span class="number">15</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* round key */</span></span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* state */</span></span><br><span class="line">	<span class="type">uint8_t</span> v[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* iv */</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nr, i, j;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">/* key expansion */</span></span><br><span class="line">	aes_key_expansion(mode, key, w);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memcpy</span>(v, iv, <span class="keyword">sizeof</span>(v));</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* start data cypher loop over input buffer */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span> * g_aes_nb[mode]) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* init state from user buffer (plaintext) */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			s[j] = data[i + j] ^ v[j];</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* start AES cypher loop over all AES rounds */</span></span><br><span class="line">		<span class="keyword">for</span> (nr = <span class="number">0</span>; nr &lt;= g_aes_rounds[mode]; nr++) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (nr &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do SubBytes */</span></span><br><span class="line">				aes_sub_bytes(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do ShiftRows */</span></span><br><span class="line">				aes_shift_rows(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (nr &lt; g_aes_rounds[mode]) &#123;</span><br><span class="line">					<span class="comment">/* do MixColumns */</span></span><br><span class="line">					aes_mix_columns(mode, s);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* do AddRoundKey */</span></span><br><span class="line">			aes_add_round_key(mode, s, w, nr);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* save state (cypher) to user buffer */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			data[i + j] = v[j] = s[j];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">inv_shift_rows</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> *s = (<span class="type">uint8_t</span> *)state;</span><br><span class="line">	<span class="type">int</span> i, j, r;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; g_aes_nb[mode] - i; j++) &#123;</span><br><span class="line">			<span class="type">uint8_t</span> tmp = s[i];</span><br><span class="line">			<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; g_aes_nb[mode]; r++) &#123;</span><br><span class="line">				s[i + r * <span class="number">4</span>] = s[i + (r + <span class="number">1</span>) * <span class="number">4</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			s[i + (g_aes_nb[mode] - <span class="number">1</span>) * <span class="number">4</span>] = tmp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">inv_sub_sbox</span><span class="params">(<span class="type">uint8_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> g_inv_sbox[val];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">inv_sub_bytes</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i, j;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">			state[i * <span class="number">4</span> + j] = inv_sub_sbox(state[i * <span class="number">4</span> + j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">inv_mix_columns</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> y[<span class="number">16</span>] = &#123; <span class="number">0x0e</span>, <span class="number">0x0b</span>, <span class="number">0x0d</span>, <span class="number">0x09</span>,  <span class="number">0x09</span>, <span class="number">0x0e</span>, <span class="number">0x0b</span>, <span class="number">0x0d</span>,</span><br><span class="line">		<span class="number">0x0d</span>, <span class="number">0x09</span>, <span class="number">0x0e</span>, <span class="number">0x0b</span>,  <span class="number">0x0b</span>, <span class="number">0x0d</span>, <span class="number">0x09</span>, <span class="number">0x0e</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span>];</span><br><span class="line">	<span class="type">int</span> i, j, r;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">			s[r] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">				s[r] = s[r] ^ aes_mul(state[i * <span class="number">4</span> + j], y[r * <span class="number">4</span> + j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">			state[i * <span class="number">4</span> + r] = s[r];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_decrypt</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> w[<span class="number">4</span> * <span class="number">4</span> * <span class="number">15</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* round key */</span></span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* state */</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nr, i, j;</span><br><span class="line">    <span class="comment">//魔改</span></span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line"> 		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)&#123;</span><br><span class="line">			s[i+j*<span class="number">4</span>]=data[i*<span class="number">4</span>+j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/* key expansion */</span></span><br><span class="line">	aes_key_expansion(mode, key, w);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* start data cypher loop over input buffer */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span> * g_aes_nb[mode]) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* init state from user buffer (cyphertext) */</span></span><br><span class="line">		<span class="comment">//for (j = 0; j &lt; 4 * g_aes_nb[mode]; j++)</span></span><br><span class="line">			<span class="comment">//s[j] = data[i + j];</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">/* start AES cypher loop over all AES rounds */</span></span><br><span class="line">		<span class="keyword">for</span> (nr = g_aes_rounds[mode]; nr &gt;= <span class="number">0</span>; nr--) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* do AddRoundKey */</span></span><br><span class="line">			aes_add_round_key(mode, s, w, nr);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (nr &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (nr &lt; g_aes_rounds[mode]) &#123;</span><br><span class="line">					<span class="comment">/* do MixColumns */</span></span><br><span class="line">					inv_mix_columns(mode, s);</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do ShiftRows */</span></span><br><span class="line">				inv_shift_rows(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do SubBytes */</span></span><br><span class="line">				inv_sub_bytes(mode, s);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* save state (cypher) to user buffer */</span></span><br><span class="line">		<span class="comment">//for (j = 0; j &lt; 4 * g_aes_nb[mode]; j++)</span></span><br><span class="line">			<span class="comment">//data[i + j] = s[j];</span></span><br><span class="line">     <span class="comment">//魔改</span></span><br><span class="line">	 <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)&#123;</span><br><span class="line">			data[i*<span class="number">4</span>+j]=s[i+j*<span class="number">4</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_decrypt_ecb</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> aes_decrypt(mode, data, len, key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_decrypt_cbc</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key, <span class="type">uint8_t</span> *iv)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> w[<span class="number">4</span> * <span class="number">4</span> * <span class="number">15</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* round key */</span></span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* state */</span></span><br><span class="line">	<span class="type">uint8_t</span> v[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* iv */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nr, i, j;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* key expansion */</span></span><br><span class="line">	aes_key_expansion(mode, key, w);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memcpy</span>(v, iv, <span class="keyword">sizeof</span>(v));</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* start data cypher loop over input buffer */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span> * g_aes_nb[mode]) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">/* init state from user buffer (cyphertext) */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			s[j] = data[i + j];</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* start AES cypher loop over all AES rounds */</span></span><br><span class="line">		<span class="keyword">for</span> (nr = g_aes_rounds[mode]; nr &gt;= <span class="number">0</span>; nr--) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* do AddRoundKey */</span></span><br><span class="line">			aes_add_round_key(mode, s, w, nr);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (nr &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (nr &lt; g_aes_rounds[mode]) &#123;</span><br><span class="line">					<span class="comment">/* do MixColumns */</span></span><br><span class="line">					inv_mix_columns(mode, s);</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do ShiftRows */</span></span><br><span class="line">				inv_shift_rows(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do SubBytes */</span></span><br><span class="line">				inv_sub_bytes(mode, s);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* save state (cypher) to user buffer */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++) &#123;</span><br><span class="line">			<span class="type">uint8_t</span> p = s[j] ^ v[j];</span><br><span class="line">			v[j] = data[i + j];</span><br><span class="line">			data[i + j] = p;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_cypher_128_test</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 1</span></span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x00</span>, <span class="number">0x11</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x55</span>, <span class="number">0x66</span>, <span class="number">0x77</span>,</span><br><span class="line">		<span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0xaa</span>, <span class="number">0xbb</span>, <span class="number">0xcc</span>, <span class="number">0xdd</span>, <span class="number">0xee</span>, <span class="number">0xff</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>,</span><br><span class="line">		<span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span> &#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x32</span>, <span class="number">0x43</span>, <span class="number">0xf6</span>, <span class="number">0xa8</span>, <span class="number">0x88</span>, <span class="number">0x5a</span>, <span class="number">0x30</span>, <span class="number">0x8d</span>,</span><br><span class="line">		<span class="number">0x31</span>, <span class="number">0x31</span>, <span class="number">0x98</span>, <span class="number">0xa2</span>, <span class="number">0xe0</span>, <span class="number">0x37</span>, <span class="number">0x07</span>, <span class="number">0x34</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x2b</span>, <span class="number">0x7e</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x28</span>, <span class="number">0xae</span>, <span class="number">0xd2</span>, <span class="number">0xa6</span>,</span><br><span class="line">		<span class="number">0xab</span>, <span class="number">0xf7</span>, <span class="number">0x15</span>, <span class="number">0x88</span>, <span class="number">0x09</span>, <span class="number">0xcf</span>, <span class="number">0x4f</span>, <span class="number">0x3c</span> &#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	aes_encrypt(AES_CYPHER_128, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line"></span><br><span class="line">	aes_decrypt(AES_CYPHER_128, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_cypher_192_test</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x00</span>, <span class="number">0x11</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x55</span>, <span class="number">0x66</span>, <span class="number">0x77</span>,</span><br><span class="line">		<span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0xaa</span>, <span class="number">0xbb</span>, <span class="number">0xcc</span>, <span class="number">0xdd</span>, <span class="number">0xee</span>, <span class="number">0xff</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>,</span><br><span class="line">		<span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span>,</span><br><span class="line">		<span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span> &#125;;</span><br><span class="line"></span><br><span class="line">	aes_encrypt(AES_CYPHER_192, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line"></span><br><span class="line">	aes_decrypt(AES_CYPHER_192, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_cypher_256_test</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x00</span>, <span class="number">0x11</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x55</span>, <span class="number">0x66</span>, <span class="number">0x77</span>,</span><br><span class="line">		<span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0xaa</span>, <span class="number">0xbb</span>, <span class="number">0xcc</span>, <span class="number">0xdd</span>, <span class="number">0xee</span>, <span class="number">0xff</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>,</span><br><span class="line">		<span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span>,</span><br><span class="line">		<span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>,</span><br><span class="line">		<span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x1c</span>, <span class="number">0x1d</span>, <span class="number">0x1e</span>, <span class="number">0x1f</span> &#125;;</span><br><span class="line"></span><br><span class="line">	aes_encrypt(AES_CYPHER_256, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line"></span><br><span class="line">	aes_decrypt(AES_CYPHER_256, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;	</span><br><span class="line">	<span class="comment">//数据</span></span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">216</span>, <span class="number">87</span>, <span class="number">202</span>, <span class="number">196</span>, <span class="number">68</span>, <span class="number">68</span>, <span class="number">17</span>, <span class="number">110</span>, <span class="number">131</span>, <span class="number">11</span>, <span class="number">223</span>, <span class="number">113</span>, <span class="number">103</span>, <span class="number">120</span>, <span class="number">149</span>, </span><br><span class="line"><span class="number">125</span>&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//密钥</span></span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123;<span class="number">23</span>, <span class="number">147</span>, <span class="number">56</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">167</span>, <span class="number">247</span>, <span class="number">84</span>, <span class="number">247</span>, <span class="number">137</span>, <span class="number">200</span>, <span class="number">32</span>, <span class="number">212</span>, <span class="number">26</span>, <span class="number">250</span>, <span class="number">37</span>&#125;;</span><br><span class="line">	<span class="comment">//向量</span></span><br><span class="line">	<span class="type">uint8_t</span> iv[] = &#123;<span class="number">0x4d</span>,<span class="number">0x4f</span>,<span class="number">0x4d</span>,<span class="number">0x43</span>,<span class="number">0x45</span>,<span class="number">0x47</span>,<span class="number">0x45</span>,<span class="number">0x43</span>,<span class="number">0x5d</span>,<span class="number">0x5f</span>,<span class="number">0x5d</span>,<span class="number">0x43</span>,<span class="number">0x45</span>,<span class="number">0x47</span>,<span class="number">0x45</span>,<span class="number">0x43</span>&#125;;</span><br><span class="line">	<span class="keyword">switch</span> (<span class="keyword">sizeof</span>(key))</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="comment">//ECB</span></span><br><span class="line">	<span class="keyword">case</span> <span class="number">16</span>:aes_decrypt(AES_CYPHER_128, buf, <span class="keyword">sizeof</span>(buf), key); <span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">24</span>:aes_decrypt(AES_CYPHER_192, buf, <span class="keyword">sizeof</span>(buf), key); <span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">32</span>:aes_decrypt(AES_CYPHER_256, buf, <span class="keyword">sizeof</span>(buf), key); <span class="keyword">break</span>;</span><br><span class="line">	<span class="comment">//CBC</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	case 16:aes_decrypt_cbc(AES_CYPHER_128, buf, sizeof(buf), key, iv); break;</span></span><br><span class="line"><span class="comment">	case 24:aes_decrypt_cbc(AES_CYPHER_192, buf, sizeof(buf), key, iv); break;</span></span><br><span class="line"><span class="comment">	case 32:aes_decrypt_cbc(AES_CYPHER_256, buf, sizeof(buf), key, iv); break;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(buf); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, buf[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 数据</span></span><br><span class="line"><span class="type">uint8_t</span> buf[] = &#123; <span class="number">180</span>, <span class="number">252</span>, <span class="number">42</span>, <span class="number">112</span>, <span class="number">54</span>, <span class="number">254</span>, <span class="number">140</span>, <span class="number">77</span>, <span class="number">50</span>, <span class="number">8</span>, <span class="number">226</span>, <span class="number">68</span>, <span class="number">27</span>, <span class="number">196</span>, <span class="number">57</span>, <span class="number">3</span> &#125;;</span><br><span class="line"><span class="comment">// 密钥</span></span><br><span class="line"><span class="type">uint8_t</span> key[] = &#123; <span class="number">207</span>, <span class="number">196</span>, <span class="number">242</span>, <span class="number">200</span>, <span class="number">85</span>, <span class="number">227</span>, <span class="number">230</span>, <span class="number">58</span>, <span class="number">116</span>, <span class="number">130</span>, <span class="number">23</span>, <span class="number">81</span>, <span class="number">179</span>, <span class="number">98</span>, <span class="number">111</span>, <span class="number">88</span> &#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到flag</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/11/01/%E7%A5%A5%E4%BA%91%E6%9D%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/01/%E7%A5%A5%E4%BA%91%E6%9D%AF/" class="post-title-link" itemprop="url">祥云杯</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-11-01 10:37:26" itemprop="dateCreated datePublished" datetime="2022-11-01T10:37:26+08:00">2022-11-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-08 19:14:24" itemprop="dateModified" datetime="2022-11-08T19:14:24+08:00">2022-11-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="祥云杯"><a href="#祥云杯" class="headerlink" title="祥云杯"></a>祥云杯</h1><p>这次比赛我觉得打的很有意义，有很多值得学习的地方，虽然在最后一分钟被py嘛了，但是还是可以的。</p>
<p><img src="/2022/11/01/%E7%A5%A5%E4%BA%91%E6%9D%AF/image-20221101103957337.png" alt="image-20221101103957337"></p>
<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><p>本次re题前两题都是第十个做出来的，但遇到后面的ollvm这种题就寄了，所以跟着其他大佬来复现。</p>
<p><strong>rocket</strong></p>
<p>是⼀个⽤racket写的程序，通过动调发现，应该是程序内部有东⻄可以运⾏某些指令，但运⾏时后⾯参数要填对。⽽且动调发现，输⼊之后会产⽣输出⽂件，通过输出⽂件进⾏对⽐。可以说是当成了黑盒来做</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">117649</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">125000</span></span><br><span class="line"><span class="number">111</span></span><br><span class="line"><span class="number">33506364520275803793</span></span><br><span class="line"><span class="number">121</span></span><br><span class="line"><span class="number">33514347173167210897</span></span><br><span class="line"><span class="number">123456</span></span><br><span class="line"><span class="number">158267354350243993992524262083318636839704</span></span><br><span class="line"><span class="number">1234567</span></span><br><span class="line"><span class="number">2655285589682614779062545959380794422209298811879</span></span><br></pre></td></tr></table></figure>

<p>发现规律，猜测整个加密是将字符串ascii连接起来转成⼤数，然后进⾏⽴⽅，所以解密也就很简单了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="built_in">print</span>(gmpy2.iroot(<span class="number">72122728040135433910084218324574182235447654897640421711359825692113776202902748285267445589769500040520888384194950935232</span></span><br><span class="line">m = <span class="number">193207530030250486323082807418528242300453594901698934812368796575822264198418283118461</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m).decode())</span><br><span class="line"><span class="comment">#得到flag：ctf&#123;th1s_is_re4lly_beaut1fly_r1ght?&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>engtom</strong></p>
<p>通过strings查询字符串可以看出是JS相关的程序，搜索Js引擎和⽂件头可以认出是JerryScript引擎的快照。</p>
<p>启⽤—show-opcodes和—snapshot-exec编译后，执⾏jerry</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/jerry --show-opcodes --exec-snapshot /m</span>nt<span class="regexp">/d/</span>ctf<span class="regexp">/祥云杯/</span>engtom<span class="regexp">/engtom/</span>chall.snapshot</span><br></pre></td></tr></table></figure>

<p>得到以下结果</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">0</span> : CBC_CHECK_VAR ident:<span class="number">5</span>-&gt;string(SboxTable)</span><br><span class="line">   <span class="attribute">2</span> : CBC_CHECK_VAR ident:<span class="number">6</span>-&gt;string(CK)</span><br><span class="line">   <span class="attribute">4</span> : CBC_CHECK_VAR ident:<span class="number">7</span>-&gt;string(FK)</span><br><span class="line">   <span class="attribute">6</span> : CBC_CHECK_VAR ident:<span class="number">8</span>-&gt;string(bigxor)</span><br><span class="line">   <span class="attribute">8</span> : CBC_CHECK_VAR ident:<span class="number">9</span>-&gt;string(leftshift)</span><br><span class="line">  <span class="attribute">10</span> : CBC_CHECK_VAR ident:<span class="number">10</span>-&gt;string(prefixInteger)</span><br><span class="line">  <span class="attribute">12</span> : CBC_CHECK_VAR ident:<span class="number">11</span>-&gt;string(sm4Sbox)</span><br><span class="line">  <span class="attribute">14</span> : CBC_CHECK_VAR ident:<span class="number">12</span>-&gt;string(GET_ULONG_BE)</span><br><span class="line">  <span class="attribute">16</span> : CBC_CHECK_VAR ident:<span class="number">13</span>-&gt;string(PUT_ULONG_BE)</span><br><span class="line">  <span class="attribute">18</span> : CBC_CHECK_VAR ident:<span class="number">14</span>-&gt;string(sm4_getkey)</span><br><span class="line">  <span class="attribute">20</span> : CBC_CHECK_VAR ident:<span class="number">15</span>-&gt;string(encrypt)</span><br><span class="line">  <span class="attribute">22</span> : CBC_CHECK_VAR ident:<span class="number">16</span>-&gt;string(decrypt_sm4)</span><br><span class="line">  <span class="attribute">24</span> : CBC_CHECK_VAR ident:<span class="number">17</span>-&gt;string(compare_array)</span><br><span class="line">  <span class="attribute">26</span> : CBC_CHECK_VAR ident:<span class="number">18</span>-&gt;string(input)</span><br><span class="line">  <span class="attribute">28</span> : CBC_CHECK_VAR ident:<span class="number">19</span>-&gt;string(num)</span><br><span class="line">  <span class="attribute">30</span> : CBC_CHECK_VAR ident:<span class="number">20</span>-&gt;string(message)</span><br><span class="line">  <span class="attribute">32</span> : CBC_CHECK_VAR ident:<span class="number">21</span>-&gt;string(count)</span><br><span class="line">  <span class="attribute">34</span> : CBC_CHECK_VAR ident:<span class="number">22</span>-&gt;string(pad_len)</span><br><span class="line">  <span class="attribute">36</span> : CBC_CREATE_VAR_EVAL ident:<span class="number">5</span>-&gt;string(SboxTable)</span><br><span class="line">  <span class="attribute">38</span> : CBC_CREATE_VAR_EVAL ident:<span class="number">6</span>-&gt;string(CK)</span><br><span class="line">  <span class="attribute">40</span> : CBC_CREATE_VAR_EVAL ident:<span class="number">7</span>-&gt;string(FK)</span><br><span class="line">  <span class="attribute">42</span> : CBC_CREATE_VAR_FUNC_EVAL lit:<span class="number">91</span> ident:<span class="number">8</span>-&gt;string(bigxor)</span><br><span class="line">  <span class="attribute">45</span> : CBC_CREATE_VAR_FUNC_EVAL lit:<span class="number">92</span> ident:<span class="number">9</span>-&gt;string(leftshift)</span><br><span class="line">  <span class="attribute">48</span> : CBC_CREATE_VAR_FUNC_EVAL lit:<span class="number">93</span> ident:<span class="number">10</span>-&gt;string(prefixInteger)</span><br><span class="line">  <span class="attribute">51</span> : CBC_CREATE_VAR_FUNC_EVAL lit:<span class="number">94</span> ident:<span class="number">11</span>-&gt;string(sm4Sbox)</span><br><span class="line">  <span class="attribute">54</span> : CBC_CREATE_VAR_FUNC_EVAL lit:<span class="number">95</span> ident:<span class="number">12</span>-&gt;string(GET_ULONG_BE)</span><br><span class="line">  <span class="attribute">57</span> : CBC_CREATE_VAR_FUNC_EVAL lit:<span class="number">96</span> ident:<span class="number">13</span>-&gt;string(PUT_ULONG_BE)</span><br><span class="line">  <span class="attribute">60</span> : CBC_CREATE_VAR_FUNC_EVAL lit:<span class="number">97</span> ident:<span class="number">14</span>-&gt;string(sm4_getkey)</span><br><span class="line">  <span class="attribute">63</span> : CBC_CREATE_VAR_FUNC_EVAL lit:<span class="number">98</span> ident:<span class="number">15</span>-&gt;string(encrypt)</span><br><span class="line">  <span class="attribute">66</span> : CBC_CREATE_VAR_FUNC_EVAL lit:<span class="number">99</span> ident:<span class="number">16</span>-&gt;string(decrypt_sm4)</span><br><span class="line">  <span class="attribute">69</span> : CBC_CREATE_VAR_FUNC_EVAL lit:<span class="number">100</span> ident:<span class="number">17</span>-&gt;string(compare_array)</span><br><span class="line">  <span class="attribute">72</span> : CBC_CREATE_VAR_EVAL ident:<span class="number">18</span>-&gt;string(input)</span><br><span class="line">  <span class="attribute">74</span> : CBC_CREATE_VAR_EVAL ident:<span class="number">19</span>-&gt;string(num)</span><br><span class="line">  <span class="attribute">76</span> : CBC_CREATE_VAR_EVAL ident:<span class="number">20</span>-&gt;string(message)</span><br><span class="line">  <span class="attribute">78</span> : CBC_CREATE_VAR_EVAL ident:<span class="number">21</span>-&gt;string(count)</span><br><span class="line">  <span class="attribute">80</span> : CBC_CREATE_VAR_EVAL ident:<span class="number">22</span>-&gt;string(pad_len)</span><br><span class="line">  <span class="attribute">82</span> : CBC_PUSH_LITERAL ident:<span class="number">23</span>-&gt;string(Array)</span><br><span class="line">  <span class="attribute">84</span> : CBC_NEW0</span><br><span class="line">  <span class="attribute">85</span> : CBC_ASSIGN_SET_IDENT ident:<span class="number">5</span>-&gt;string(SboxTable)</span><br><span class="line">  <span class="attribute">87</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_0 ident:<span class="number">5</span>-&gt;string(SboxTable)</span><br><span class="line">  <span class="attribute">89</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">214</span></span><br><span class="line">  <span class="attribute">92</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">144</span></span><br><span class="line">  <span class="attribute">94</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">233</span></span><br><span class="line">  <span class="attribute">96</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">254</span></span><br><span class="line">  <span class="attribute">98</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">204</span></span><br><span class="line"> <span class="attribute">100</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">225</span></span><br><span class="line"> <span class="attribute">102</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">61</span></span><br><span class="line"> <span class="attribute">104</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">183</span></span><br><span class="line"> <span class="attribute">106</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">22</span></span><br><span class="line"> <span class="attribute">108</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">182</span></span><br><span class="line"> <span class="attribute">110</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">20</span></span><br><span class="line"> <span class="attribute">112</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">194</span></span><br><span class="line"> <span class="attribute">114</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">40</span></span><br><span class="line"> <span class="attribute">116</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">251</span></span><br><span class="line"> <span class="attribute">118</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">44</span></span><br><span class="line"> <span class="attribute">120</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">5</span></span><br><span class="line"> <span class="attribute">122</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">124</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">125</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">1</span></span><br><span class="line"> <span class="attribute">128</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">43</span></span><br><span class="line"> <span class="attribute">131</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">103</span></span><br><span class="line"> <span class="attribute">133</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">154</span></span><br><span class="line"> <span class="attribute">135</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">118</span></span><br><span class="line"> <span class="attribute">137</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">42</span></span><br><span class="line"> <span class="attribute">139</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">190</span></span><br><span class="line"> <span class="attribute">141</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">4</span></span><br><span class="line"> <span class="attribute">143</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">195</span></span><br><span class="line"> <span class="attribute">145</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">170</span></span><br><span class="line"> <span class="attribute">147</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">68</span></span><br><span class="line"> <span class="attribute">149</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">19</span></span><br><span class="line"> <span class="attribute">151</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">38</span></span><br><span class="line"> <span class="attribute">153</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">73</span></span><br><span class="line"> <span class="attribute">155</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">134</span></span><br><span class="line"> <span class="attribute">157</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">6</span></span><br><span class="line"> <span class="attribute">159</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">153</span></span><br><span class="line"> <span class="attribute">161</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">163</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">164</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">2</span></span><br><span class="line"> <span class="attribute">167</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">156</span></span><br><span class="line"> <span class="attribute">170</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">66</span></span><br><span class="line"> <span class="attribute">172</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">80</span></span><br><span class="line"> <span class="attribute">174</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">244</span></span><br><span class="line"> <span class="attribute">176</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">145</span></span><br><span class="line"> <span class="attribute">178</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">239</span></span><br><span class="line"> <span class="attribute">180</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">152</span></span><br><span class="line"> <span class="attribute">182</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">122</span></span><br><span class="line"> <span class="attribute">184</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">51</span></span><br><span class="line"> <span class="attribute">186</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">84</span></span><br><span class="line"> <span class="attribute">188</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">11</span></span><br><span class="line"> <span class="attribute">190</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">67</span></span><br><span class="line"> <span class="attribute">192</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">237</span></span><br><span class="line"> <span class="attribute">194</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">207</span></span><br><span class="line"> <span class="attribute">196</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">172</span></span><br><span class="line"> <span class="attribute">198</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">98</span></span><br><span class="line"> <span class="attribute">200</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">202</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">203</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">3</span></span><br><span class="line"> <span class="attribute">206</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">228</span></span><br><span class="line"> <span class="attribute">209</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">179</span></span><br><span class="line"> <span class="attribute">211</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">28</span></span><br><span class="line"> <span class="attribute">213</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">169</span></span><br><span class="line"> <span class="attribute">215</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">201</span></span><br><span class="line"> <span class="attribute">217</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">8</span></span><br><span class="line"> <span class="attribute">219</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">232</span></span><br><span class="line"> <span class="attribute">221</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">149</span></span><br><span class="line"> <span class="attribute">223</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">128</span></span><br><span class="line"> <span class="attribute">225</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">223</span></span><br><span class="line"> <span class="attribute">227</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">148</span></span><br><span class="line"> <span class="attribute">229</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">250</span></span><br><span class="line"> <span class="attribute">231</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">117</span></span><br><span class="line"> <span class="attribute">233</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">143</span></span><br><span class="line"> <span class="attribute">235</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">63</span></span><br><span class="line"> <span class="attribute">237</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">166</span></span><br><span class="line"> <span class="attribute">239</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">241</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">242</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">4</span></span><br><span class="line"> <span class="attribute">245</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">71</span></span><br><span class="line"> <span class="attribute">248</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">7</span></span><br><span class="line"> <span class="attribute">250</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">167</span></span><br><span class="line"> <span class="attribute">252</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">252</span></span><br><span class="line"> <span class="attribute">254</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">243</span></span><br><span class="line"> <span class="attribute">256</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">115</span></span><br><span class="line"> <span class="attribute">258</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">23</span></span><br><span class="line"> <span class="attribute">260</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">186</span></span><br><span class="line"> <span class="attribute">262</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">131</span></span><br><span class="line"> <span class="attribute">264</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">89</span></span><br><span class="line"> <span class="attribute">266</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">60</span></span><br><span class="line"> <span class="attribute">268</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">25</span></span><br><span class="line"> <span class="attribute">270</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">230</span></span><br><span class="line"> <span class="attribute">272</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">133</span></span><br><span class="line"> <span class="attribute">274</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">79</span></span><br><span class="line"> <span class="attribute">276</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">168</span></span><br><span class="line"> <span class="attribute">278</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">280</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">281</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">5</span></span><br><span class="line"> <span class="attribute">284</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">104</span></span><br><span class="line"> <span class="attribute">287</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">107</span></span><br><span class="line"> <span class="attribute">289</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">129</span></span><br><span class="line"> <span class="attribute">291</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">178</span></span><br><span class="line"> <span class="attribute">293</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">113</span></span><br><span class="line"> <span class="attribute">295</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">100</span></span><br><span class="line"> <span class="attribute">297</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">218</span></span><br><span class="line"> <span class="attribute">299</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">139</span></span><br><span class="line"> <span class="attribute">301</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">248</span></span><br><span class="line"> <span class="attribute">303</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">235</span></span><br><span class="line"> <span class="attribute">305</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">15</span></span><br><span class="line"> <span class="attribute">307</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">75</span></span><br><span class="line"> <span class="attribute">309</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">112</span></span><br><span class="line"> <span class="attribute">311</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">86</span></span><br><span class="line"> <span class="attribute">313</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">157</span></span><br><span class="line"> <span class="attribute">315</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">53</span></span><br><span class="line"> <span class="attribute">317</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">319</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">320</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">6</span></span><br><span class="line"> <span class="attribute">323</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">30</span></span><br><span class="line"> <span class="attribute">326</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">36</span></span><br><span class="line"> <span class="attribute">328</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">14</span></span><br><span class="line"> <span class="attribute">330</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">94</span></span><br><span class="line"> <span class="attribute">332</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">99</span></span><br><span class="line"> <span class="attribute">334</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">88</span></span><br><span class="line"> <span class="attribute">336</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">209</span></span><br><span class="line"> <span class="attribute">338</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">162</span></span><br><span class="line"> <span class="attribute">340</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">37</span></span><br><span class="line"> <span class="attribute">342</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">34</span></span><br><span class="line"> <span class="attribute">344</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">124</span></span><br><span class="line"> <span class="attribute">346</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">59</span></span><br><span class="line"> <span class="attribute">348</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">1</span></span><br><span class="line"> <span class="attribute">350</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">33</span></span><br><span class="line"> <span class="attribute">352</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">120</span></span><br><span class="line"> <span class="attribute">354</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">135</span></span><br><span class="line"> <span class="attribute">356</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">358</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">359</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">7</span></span><br><span class="line"> <span class="attribute">362</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">212</span></span><br><span class="line"> <span class="attribute">365</span> : CBC_PUSH_NUMBER_0</span><br><span class="line"> <span class="attribute">366</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">70</span></span><br><span class="line"> <span class="attribute">368</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">87</span></span><br><span class="line"> <span class="attribute">370</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">159</span></span><br><span class="line"> <span class="attribute">372</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">211</span></span><br><span class="line"> <span class="attribute">374</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">39</span></span><br><span class="line"> <span class="attribute">376</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">82</span></span><br><span class="line"> <span class="attribute">378</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">76</span></span><br><span class="line"> <span class="attribute">380</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">54</span></span><br><span class="line"> <span class="attribute">382</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">2</span></span><br><span class="line"> <span class="attribute">384</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">231</span></span><br><span class="line"> <span class="attribute">386</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">160</span></span><br><span class="line"> <span class="attribute">388</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">196</span></span><br><span class="line"> <span class="attribute">390</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">200</span></span><br><span class="line"> <span class="attribute">392</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">158</span></span><br><span class="line"> <span class="attribute">394</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">396</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">397</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">8</span></span><br><span class="line"> <span class="attribute">400</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">234</span></span><br><span class="line"> <span class="attribute">403</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">191</span></span><br><span class="line"> <span class="attribute">405</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">138</span></span><br><span class="line"> <span class="attribute">407</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">210</span></span><br><span class="line"> <span class="attribute">409</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">64</span></span><br><span class="line"> <span class="attribute">411</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">199</span></span><br><span class="line"> <span class="attribute">413</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">56</span></span><br><span class="line"> <span class="attribute">415</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">181</span></span><br><span class="line"> <span class="attribute">417</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">163</span></span><br><span class="line"> <span class="attribute">419</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">247</span></span><br><span class="line"> <span class="attribute">421</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">242</span></span><br><span class="line"> <span class="attribute">423</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">206</span></span><br><span class="line"> <span class="attribute">425</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">249</span></span><br><span class="line"> <span class="attribute">427</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">97</span></span><br><span class="line"> <span class="attribute">429</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">21</span></span><br><span class="line"> <span class="attribute">431</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">161</span></span><br><span class="line"> <span class="attribute">433</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">435</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">436</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">9</span></span><br><span class="line"> <span class="attribute">439</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">224</span></span><br><span class="line"> <span class="attribute">442</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">174</span></span><br><span class="line"> <span class="attribute">444</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">93</span></span><br><span class="line"> <span class="attribute">446</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">164</span></span><br><span class="line"> <span class="attribute">448</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">155</span></span><br><span class="line"> <span class="attribute">450</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">52</span></span><br><span class="line"> <span class="attribute">452</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">26</span></span><br><span class="line"> <span class="attribute">454</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">85</span></span><br><span class="line"> <span class="attribute">456</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">173</span></span><br><span class="line"> <span class="attribute">458</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">147</span></span><br><span class="line"> <span class="attribute">460</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">50</span></span><br><span class="line"> <span class="attribute">462</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">48</span></span><br><span class="line"> <span class="attribute">464</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">245</span></span><br><span class="line"> <span class="attribute">466</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">140</span></span><br><span class="line"> <span class="attribute">468</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">177</span></span><br><span class="line"> <span class="attribute">470</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">227</span></span><br><span class="line"> <span class="attribute">472</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">474</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">475</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">10</span></span><br><span class="line"> <span class="attribute">478</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">29</span></span><br><span class="line"> <span class="attribute">481</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">246</span></span><br><span class="line"> <span class="attribute">483</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">226</span></span><br><span class="line"> <span class="attribute">485</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">46</span></span><br><span class="line"> <span class="attribute">487</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">130</span></span><br><span class="line"> <span class="attribute">489</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">102</span></span><br><span class="line"> <span class="attribute">491</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">202</span></span><br><span class="line"> <span class="attribute">493</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">96</span></span><br><span class="line"> <span class="attribute">495</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">192</span></span><br><span class="line"> <span class="attribute">497</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">41</span></span><br><span class="line"> <span class="attribute">499</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">35</span></span><br><span class="line"> <span class="attribute">501</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">171</span></span><br><span class="line"> <span class="attribute">503</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">13</span></span><br><span class="line"> <span class="attribute">505</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">83</span></span><br><span class="line"> <span class="attribute">507</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">78</span></span><br><span class="line"> <span class="attribute">509</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">111</span></span><br><span class="line"> <span class="attribute">511</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">513</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">514</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">11</span></span><br><span class="line"> <span class="attribute">517</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">213</span></span><br><span class="line"> <span class="attribute">520</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">219</span></span><br><span class="line"> <span class="attribute">522</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">55</span></span><br><span class="line"> <span class="attribute">524</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">69</span></span><br><span class="line"> <span class="attribute">526</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">222</span></span><br><span class="line"> <span class="attribute">528</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">253</span></span><br><span class="line"> <span class="attribute">530</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">142</span></span><br><span class="line"> <span class="attribute">532</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">47</span></span><br><span class="line"> <span class="attribute">534</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">3</span></span><br><span class="line"> <span class="attribute">536</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">255</span></span><br><span class="line"> <span class="attribute">538</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">106</span></span><br><span class="line"> <span class="attribute">540</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">114</span></span><br><span class="line"> <span class="attribute">542</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">109</span></span><br><span class="line"> <span class="attribute">544</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">108</span></span><br><span class="line"> <span class="attribute">546</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">91</span></span><br><span class="line"> <span class="attribute">548</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">81</span></span><br><span class="line"> <span class="attribute">550</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">552</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">553</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">12</span></span><br><span class="line"> <span class="attribute">556</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">141</span></span><br><span class="line"> <span class="attribute">559</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">27</span></span><br><span class="line"> <span class="attribute">561</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">175</span></span><br><span class="line"> <span class="attribute">563</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">146</span></span><br><span class="line"> <span class="attribute">565</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">187</span></span><br><span class="line"> <span class="attribute">567</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">221</span></span><br><span class="line"> <span class="attribute">569</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">188</span></span><br><span class="line"> <span class="attribute">571</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">127</span></span><br><span class="line"> <span class="attribute">573</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">17</span></span><br><span class="line"> <span class="attribute">575</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">217</span></span><br><span class="line"> <span class="attribute">577</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">92</span></span><br><span class="line"> <span class="attribute">579</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">65</span></span><br><span class="line"> <span class="attribute">581</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">31</span></span><br><span class="line"> <span class="attribute">583</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">16</span></span><br><span class="line"> <span class="attribute">585</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">90</span></span><br><span class="line"> <span class="attribute">587</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">216</span></span><br><span class="line"> <span class="attribute">589</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">591</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">592</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">13</span></span><br><span class="line"> <span class="attribute">595</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">10</span></span><br><span class="line"> <span class="attribute">598</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">193</span></span><br><span class="line"> <span class="attribute">600</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">49</span></span><br><span class="line"> <span class="attribute">602</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">136</span></span><br><span class="line"> <span class="attribute">604</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">165</span></span><br><span class="line"> <span class="attribute">606</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">205</span></span><br><span class="line"> <span class="attribute">608</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">123</span></span><br><span class="line"> <span class="attribute">610</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">189</span></span><br><span class="line"> <span class="attribute">612</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">45</span></span><br><span class="line"> <span class="attribute">614</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">116</span></span><br><span class="line"> <span class="attribute">616</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">208</span></span><br><span class="line"> <span class="attribute">618</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">18</span></span><br><span class="line"> <span class="attribute">620</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">184</span></span><br><span class="line"> <span class="attribute">622</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">229</span></span><br><span class="line"> <span class="attribute">624</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">180</span></span><br><span class="line"> <span class="attribute">626</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">176</span></span><br><span class="line"> <span class="attribute">628</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">630</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">631</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">14</span></span><br><span class="line"> <span class="attribute">634</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">137</span></span><br><span class="line"> <span class="attribute">637</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">105</span></span><br><span class="line"> <span class="attribute">639</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">151</span></span><br><span class="line"> <span class="attribute">641</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">74</span></span><br><span class="line"> <span class="attribute">643</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">12</span></span><br><span class="line"> <span class="attribute">645</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">150</span></span><br><span class="line"> <span class="attribute">647</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">119</span></span><br><span class="line"> <span class="attribute">649</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">126</span></span><br><span class="line"> <span class="attribute">651</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">101</span></span><br><span class="line"> <span class="attribute">653</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">185</span></span><br><span class="line"> <span class="attribute">655</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">241</span></span><br><span class="line"> <span class="attribute">657</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">9</span></span><br><span class="line"> <span class="attribute">659</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">197</span></span><br><span class="line"> <span class="attribute">661</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">110</span></span><br><span class="line"> <span class="attribute">663</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">198</span></span><br><span class="line"> <span class="attribute">665</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">132</span></span><br><span class="line"> <span class="attribute">667</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">669</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">670</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">5</span>-&gt;string(SboxTable) number:<span class="number">15</span></span><br><span class="line"> <span class="attribute">673</span> : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:<span class="number">23</span>-&gt;string(Array) number:<span class="number">24</span></span><br><span class="line"> <span class="attribute">676</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">240</span></span><br><span class="line"> <span class="attribute">678</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">125</span></span><br><span class="line"> <span class="attribute">680</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">236</span></span><br><span class="line"> <span class="attribute">682</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">58</span></span><br><span class="line"> <span class="attribute">684</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">220</span></span><br><span class="line"> <span class="attribute">686</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">77</span></span><br><span class="line"> <span class="attribute">688</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">32</span></span><br><span class="line"> <span class="attribute">690</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">121</span></span><br><span class="line"> <span class="attribute">692</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">238</span></span><br><span class="line"> <span class="attribute">694</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">95</span></span><br><span class="line"> <span class="attribute">696</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">62</span></span><br><span class="line"> <span class="attribute">698</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">215</span></span><br><span class="line"> <span class="attribute">700</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">203</span></span><br><span class="line"> <span class="attribute">702</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">57</span></span><br><span class="line"> <span class="attribute">704</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">72</span></span><br><span class="line"> <span class="attribute">706</span> : CBC_NEW byte_arg:<span class="number">16</span></span><br><span class="line"> <span class="attribute">708</span> : CBC_ASSIGN_BLOCK</span><br><span class="line"> <span class="attribute">709</span> : CBC_PUSH_THREE_LITERALS ident:<span class="number">23</span>-&gt;string(Array) const:<span class="number">30</span>-&gt;number(<span class="number">462357</span>) const:<span class="number">31</span>-&gt;number(<span class="number">472066609</span>)</span><br><span class="line"> <span class="attribute">713</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">32</span>-&gt;number(<span class="number">943670861</span>) const:<span class="number">33</span>-&gt;number(<span class="number">1415275113</span>) const:<span class="number">34</span>-&gt;number(<span class="number">1886879365</span>)</span><br><span class="line"> <span class="attribute">717</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">35</span>-&gt;number(<span class="number">2358483617</span>) const:<span class="number">36</span>-&gt;number(<span class="number">2830087869</span>) const:<span class="number">37</span>-&gt;number(<span class="number">3301692121</span>)</span><br><span class="line"> <span class="attribute">721</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">38</span>-&gt;number(<span class="number">3773296373</span>) const:<span class="number">39</span>-&gt;number(<span class="number">4228057617</span>) const:<span class="number">40</span>-&gt;number(<span class="number">404694573</span>)</span><br><span class="line"> <span class="attribute">725</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">41</span>-&gt;number(<span class="number">876298825</span>) const:<span class="number">42</span>-&gt;number(<span class="number">1347903077</span>) const:<span class="number">43</span>-&gt;number(<span class="number">1819507329</span>)</span><br><span class="line"> <span class="attribute">729</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">44</span>-&gt;number(<span class="number">2291111581</span>) const:<span class="number">45</span>-&gt;number(<span class="number">2762715833</span>) const:<span class="number">46</span>-&gt;number(<span class="number">3234320085</span>)</span><br><span class="line"> <span class="attribute">733</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">47</span>-&gt;number(<span class="number">3705924337</span>) const:<span class="number">48</span>-&gt;number(<span class="number">4177462797</span>) const:<span class="number">49</span>-&gt;number(<span class="number">337322537</span>)</span><br><span class="line"> <span class="attribute">737</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">50</span>-&gt;number(<span class="number">808926789</span>) const:<span class="number">51</span>-&gt;number(<span class="number">1280531041</span>) const:<span class="number">52</span>-&gt;number(<span class="number">1752135293</span>)</span><br><span class="line"> <span class="attribute">741</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">53</span>-&gt;number(<span class="number">2223739545</span>) const:<span class="number">54</span>-&gt;number(<span class="number">2695343797</span>) const:<span class="number">55</span>-&gt;number(<span class="number">3166948049</span>)</span><br><span class="line"> <span class="attribute">745</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">56</span>-&gt;number(<span class="number">3638552301</span>) const:<span class="number">57</span>-&gt;number(<span class="number">4110090761</span>) const:<span class="number">58</span>-&gt;number(<span class="number">269950501</span>)</span><br><span class="line"> <span class="attribute">749</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">59</span>-&gt;number(<span class="number">741554753</span>) const:<span class="number">60</span>-&gt;number(<span class="number">1213159005</span>) const:<span class="number">61</span>-&gt;number(<span class="number">1684763257</span>)</span><br><span class="line"> <span class="attribute">753</span> : CBC_NEW byte_arg:<span class="number">32</span></span><br><span class="line"> <span class="attribute">755</span> : CBC_ASSIGN_SET_IDENT ident:<span class="number">6</span>-&gt;string(CK)</span><br><span class="line"> <span class="attribute">757</span> : CBC_PUSH_THREE_LITERALS ident:<span class="number">23</span>-&gt;string(Array) const:<span class="number">62</span>-&gt;number(<span class="number">2746333894</span>) const:<span class="number">63</span>-&gt;number(<span class="number">1453994832</span>)</span><br><span class="line"> <span class="attribute">761</span> : CBC_PUSH_TWO_LITERALS const:<span class="number">64</span>-&gt;number(<span class="number">1736282519</span>) const:<span class="number">65</span>-&gt;number(<span class="number">2993693404</span>)</span><br><span class="line"> <span class="attribute">764</span> : CBC_NEW byte_arg:<span class="number">4</span></span><br><span class="line"> <span class="attribute">766</span> : CBC_ASSIGN_SET_IDENT ident:<span class="number">7</span>-&gt;string(FK)</span><br><span class="line"> <span class="attribute">768</span> : CBC_PUSH_LITERAL const:<span class="number">66</span>-&gt;string(ctf&#123;this_is_an_example&#125;)</span><br><span class="line"> <span class="attribute">770</span> : CBC_ASSIGN_SET_IDENT ident:<span class="number">18</span>-&gt;string(input)</span><br><span class="line"> <span class="attribute">772</span> : CBC_PUSH_NUMBER_0</span><br><span class="line"> <span class="attribute">773</span> : CBC_ASSIGN_SET_IDENT ident:<span class="number">19</span>-&gt;string(num)</span><br><span class="line"> <span class="attribute">775</span> : CBC_PUSH_LITERAL ident:<span class="number">23</span>-&gt;string(Array)</span><br><span class="line"> <span class="attribute">777</span> : CBC_NEW0</span><br><span class="line"> <span class="attribute">778</span> : CBC_ASSIGN_SET_IDENT ident:<span class="number">20</span>-&gt;string(message)</span><br><span class="line"> <span class="attribute">780</span> : CBC_PUSH_NUMBER_0</span><br><span class="line"> <span class="attribute">781</span> : CBC_MOV_IDENT reg:<span class="number">1</span></span><br><span class="line"> <span class="attribute">783</span> : CBC_JUMP_FORWARD offset:<span class="number">32</span>(-&gt;<span class="number">815</span>)</span><br><span class="line"> <span class="attribute">785</span> : CBC_MULTIPLY_TWO_LITERALS ident:<span class="number">19</span>-&gt;string(num) const:<span class="number">67</span>-&gt;number(<span class="number">256</span>)</span><br><span class="line"> <span class="attribute">788</span> : CBC_PUSH_PROP_LITERAL_LITERAL_REFERENCE ident:<span class="number">18</span>-&gt;string(input) const:<span class="number">68</span>-&gt;string(charCodeAt)</span><br><span class="line"> <span class="attribute">791</span> : CBC_PUSH_LITERAL reg:<span class="number">1</span></span><br><span class="line"> <span class="attribute">793</span> : CBC_CALL1_PROP_PUSH_RESULT</span><br><span class="line"> <span class="attribute">794</span> : CBC_ADD</span><br><span class="line"> <span class="attribute">795</span> : CBC_ASSIGN_SET_IDENT_BLOCK ident:<span class="number">19</span>-&gt;string(num)</span><br><span class="line"> <span class="attribute">797</span> : CBC_MODULO_TWO_LITERALS reg:<span class="number">1</span> const:<span class="number">69</span>-&gt;number(<span class="number">4</span>)</span><br><span class="line"> <span class="attribute">800</span> : CBC_EQUAL_RIGHT_LITERAL const:<span class="number">70</span>-&gt;number(<span class="number">3</span>)</span><br><span class="line"> <span class="attribute">802</span> : CBC_BRANCH_IF_FALSE_FORWARD offset:<span class="number">11</span>(-&gt;<span class="number">813</span>)</span><br><span class="line"> <span class="attribute">804</span> : CBC_PUSH_PROP_LITERAL_LITERAL_REFERENCE ident:<span class="number">20</span>-&gt;string(message) const:<span class="number">71</span>-&gt;string(push)</span><br><span class="line"> <span class="attribute">807</span> : CBC_PUSH_LITERAL ident:<span class="number">19</span>-&gt;string(num)</span><br><span class="line"> <span class="attribute">809</span> : CBC_CALL1_PROP_BLOCK</span><br><span class="line"> <span class="attribute">810</span> : CBC_PUSH_NUMBER_0</span><br><span class="line"> <span class="attribute">811</span> : CBC_ASSIGN_SET_IDENT_BLOCK ident:<span class="number">19</span>-&gt;string(num)</span><br><span class="line"> <span class="attribute">813</span> : CBC_PRE_INCR_IDENT reg:<span class="number">1</span></span><br><span class="line"> <span class="attribute">815</span> : CBC_PUSH_TWO_LITERALS reg:<span class="number">1</span> ident:<span class="number">18</span>-&gt;string(input)</span><br><span class="line"> <span class="attribute">818</span> : CBC_PUSH_PROP_LITERAL const:<span class="number">72</span>-&gt;string(length)</span><br><span class="line"> <span class="attribute">820</span> : CBC_LESS</span><br><span class="line"> <span class="attribute">821</span> : CBC_BRANCH_IF_TRUE_BACKWARD offset:<span class="number">36</span>(-&gt;<span class="number">785</span>)</span><br><span class="line"> <span class="attribute">823</span> : CBC_PUSH_PROP_LITERAL_LITERAL_REFERENCE ident:<span class="number">24</span>-&gt;string(Math) const:<span class="number">73</span>-&gt;string(ceil)</span><br><span class="line"> <span class="attribute">826</span> : CBC_PUSH_PROP_LITERAL_LITERAL ident:<span class="number">20</span>-&gt;string(message) const:<span class="number">72</span>-&gt;string(length)</span><br><span class="line"> <span class="attribute">829</span> : CBC_DIVIDE_RIGHT_LITERAL const:<span class="number">69</span>-&gt;number(<span class="number">4</span>)</span><br><span class="line"> <span class="attribute">831</span> : CBC_CALL1_PROP_PUSH_RESULT</span><br><span class="line"> <span class="attribute">832</span> : CBC_ASSIGN_SET_IDENT ident:<span class="number">21</span>-&gt;string(count)</span><br><span class="line"> <span class="attribute">834</span> : CBC_MULTIPLY_TWO_LITERALS ident:<span class="number">21</span>-&gt;string(count) const:<span class="number">69</span>-&gt;number(<span class="number">4</span>)</span><br><span class="line"> <span class="attribute">837</span> : CBC_ASSIGN_SET_IDENT ident:<span class="number">22</span>-&gt;string(pad_len)</span><br><span class="line"> <span class="attribute">839</span> : CBC_JUMP_FORWARD offset:<span class="number">7</span>(-&gt;<span class="number">846</span>)</span><br><span class="line"> <span class="attribute">841</span> : CBC_PUSH_PROP_LITERAL_LITERAL_REFERENCE ident:<span class="number">20</span>-&gt;string(message) const:<span class="number">71</span>-&gt;string(push)</span><br><span class="line"> <span class="attribute">844</span> : CBC_PUSH_NUMBER_0</span><br><span class="line"> <span class="attribute">845</span> : CBC_CALL1_PROP_BLOCK</span><br><span class="line"> <span class="attribute">846</span> : CBC_PUSH_PROP_LITERAL_LITERAL ident:<span class="number">20</span>-&gt;string(message) const:<span class="number">72</span>-&gt;string(length)</span><br><span class="line"> <span class="attribute">849</span> : CBC_LESS_RIGHT_LITERAL ident:<span class="number">22</span>-&gt;string(pad_len)</span><br><span class="line"> <span class="attribute">851</span> : CBC_BRANCH_IF_TRUE_BACKWARD offset:<span class="number">10</span>(-&gt;<span class="number">841</span>)</span><br><span class="line"> <span class="attribute">853</span> : CBC_PUSH_THREE_LITERALS ident:<span class="number">23</span>-&gt;string(Array) const:<span class="number">74</span>-&gt;number(<span class="number">19088743</span>) const:<span class="number">75</span>-&gt;number(<span class="number">2309737967</span>)</span><br><span class="line"> <span class="attribute">857</span> : CBC_PUSH_TWO_LITERALS const:<span class="number">76</span>-&gt;number(<span class="number">4275878552</span>) const:<span class="number">77</span>-&gt;number(<span class="number">1985229328</span>)</span><br><span class="line"> <span class="attribute">860</span> : CBC_NEW byte_arg:<span class="number">4</span></span><br><span class="line"> <span class="attribute">862</span> : CBC_ASSIGN_SET_IDENT_BLOCK ident:<span class="number">25</span>-&gt;string(key)</span><br><span class="line"> <span class="attribute">864</span> : CBC_PUSH_THREE_LITERALS ident:<span class="number">23</span>-&gt;string(Array) const:<span class="number">78</span>-&gt;number(<span class="number">1605062385</span>) const:<span class="number">79</span>-&gt;number(-<span class="number">642825121</span>)</span><br><span class="line"> <span class="attribute">868</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">80</span>-&gt;number(<span class="number">2061445208</span>) const:<span class="number">81</span>-&gt;number(<span class="number">1405610911</span>) const:<span class="number">82</span>-&gt;number(<span class="number">1713399267</span>)</span><br><span class="line"> <span class="attribute">872</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">83</span>-&gt;number(<span class="number">1396669315</span>) const:<span class="number">84</span>-&gt;number(<span class="number">1081797168</span>) const:<span class="number">85</span>-&gt;number(<span class="number">605181189</span>)</span><br><span class="line"> <span class="attribute">876</span> : CBC_PUSH_THREE_LITERALS const:<span class="number">86</span>-&gt;number(<span class="number">1824766525</span>) const:<span class="number">87</span>-&gt;number(<span class="number">1196148725</span>) const:<span class="number">88</span>-&gt;number(<span class="number">763423307</span>)</span><br><span class="line"> <span class="attribute">880</span> : CBC_PUSH_LITERAL const:<span class="number">89</span>-&gt;number(<span class="number">1125925868</span>)</span><br><span class="line"> <span class="attribute">882</span> : CBC_NEW byte_arg:<span class="number">12</span></span><br><span class="line"> <span class="attribute">884</span> : CBC_ASSIGN_SET_IDENT_BLOCK ident:<span class="number">26</span>-&gt;string(ans)</span><br><span class="line"> <span class="attribute">886</span> : CBC_PUSH_LITERAL ident:<span class="number">23</span>-&gt;string(Array)</span><br><span class="line"> <span class="attribute">888</span> : CBC_NEW0</span><br><span class="line"> <span class="attribute">889</span> : CBC_ASSIGN_SET_IDENT_BLOCK ident:<span class="number">27</span>-&gt;string(message_c)</span><br><span class="line"> <span class="attribute">891</span> : CBC_PUSH_NUMBER_0</span><br><span class="line"> <span class="attribute">892</span> : CBC_MOV_IDENT reg:<span class="number">1</span></span><br><span class="line"> <span class="attribute">894</span> : CBC_JUMP_FORWARD offset:<span class="number">47</span>(-&gt;<span class="number">941</span>)</span><br><span class="line"> <span class="attribute">896</span> : CBC_PUSH_PROP_LITERAL_LITERAL_REFERENCE ident:<span class="number">20</span>-&gt;string(message) const:<span class="number">90</span>-&gt;str <span class="number">900</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">4</span></span><br><span class="line"> <span class="attribute">902</span> : CBC_CALL2_PROP_PUSH_RESULT</span><br><span class="line"> <span class="attribute">903</span> : CBC_MOV_IDENT reg:<span class="number">2</span></span><br><span class="line"> <span class="attribute">905</span> : CBC_PUSH_THREE_LITERALS ident:<span class="number">15</span>-&gt;string(encrypt) reg:<span class="number">2</span> ident:<span class="number">25</span>-&gt;string(key)</span><br><span class="line"> <span class="attribute">909</span> : CBC_CALL2_PUSH_RESULT</span><br><span class="line"> <span class="attribute">910</span> : CBC_MOV_IDENT reg:<span class="number">3</span></span><br><span class="line"> <span class="attribute">912</span> : CBC_PUSH_NUMBER_0</span><br><span class="line"> <span class="attribute">913</span> : CBC_MOV_IDENT reg:<span class="number">4</span></span><br><span class="line"> <span class="attribute">915</span> : CBC_JUMP_FORWARD offset:<span class="number">16</span>(-&gt;<span class="number">931</span>)</span><br><span class="line"> <span class="attribute">917</span> : CBC_PUSH_PROP_LITERAL_LITERAL_REFERENCE ident:<span class="number">27</span>-&gt;string(message_c) const:<span class="number">71</span>-&gt;string(push)</span><br><span class="line"> <span class="attribute">920</span> : CBC_PUSH_THREE_LITERALS ident:<span class="number">28</span>-&gt;string(parseInt) reg:<span class="number">3</span> reg:<span class="number">4</span></span><br><span class="line"> <span class="attribute">924</span> : CBC_PUSH_PROP</span><br><span class="line"> <span class="attribute">925</span> : CBC_PUSH_NUMBER_POS_BYTE number:<span class="number">16</span></span><br><span class="line"> <span class="attribute">927</span> : CBC_CALL2_PUSH_RESULT</span><br><span class="line"> <span class="attribute">928</span> : CBC_CALL1_PROP_BLOCK</span><br><span class="line"> <span class="attribute">929</span> : CBC_PRE_INCR_IDENT reg:<span class="number">4</span></span><br><span class="line"> <span class="attribute">931</span> : CBC_PUSH_TWO_LITERALS reg:<span class="number">4</span> reg:<span class="number">3</span></span><br><span class="line"> <span class="attribute">934</span> : CBC_PUSH_PROP_LITERAL const:<span class="number">72</span>-&gt;string(length)</span><br><span class="line"> <span class="attribute">936</span> : CBC_LESS</span><br><span class="line"> <span class="attribute">937</span> : CBC_BRANCH_IF_TRUE_BACKWARD offset:<span class="number">20</span>(-&gt;<span class="number">917</span>)</span><br><span class="line"> <span class="attribute">939</span> : CBC_PRE_INCR_IDENT reg:<span class="number">1</span></span><br><span class="line"> <span class="attribute">941</span> : CBC_LESS_TWO_LITERALS reg:<span class="number">1</span> ident:<span class="number">21</span>-&gt;string(count)</span><br><span class="line"> <span class="attribute">944</span> : CBC_BRANCH_IF_TRUE_BACKWARD offset:<span class="number">48</span>(-&gt;<span class="number">896</span>)</span><br><span class="line"> <span class="attribute">946</span> : CBC_PUSH_LITERAL ident:<span class="number">27</span>-&gt;string(message_c)</span><br><span class="line"> <span class="attribute">948</span> : CBC_BRANCH_IF_FALSE_FORWARD offset:<span class="number">10</span>(-&gt;<span class="number">958</span>)</span><br><span class="line"> <span class="attribute">950</span> : CBC_PUSH_THREE_LITERALS ident:<span class="number">29</span>-&gt;string(print) ident:<span class="number">17</span>-&gt;string(compare_array) ident:<span class="number">27</span>-&gt;string(message_c)</span><br><span class="line"> <span class="attribute">954</span> : CBC_PUSH_LITERAL ident:<span class="number">26</span>-&gt;string(ans)</span><br><span class="line"> <span class="attribute">956</span> : CBC_CALL2_PUSH_RESULT</span><br><span class="line"> <span class="attribute">957</span> : CBC_CALL1_BLOCK</span><br><span class="line"> <span class="attribute">958</span> : CBC_RETURN_FUNCTION_END</span><br></pre></td></tr></table></figure>

<p>找在线解密⽹址可以直接求解</p>
<p><img src="/2022/11/01/%E7%A5%A5%E4%BA%91%E6%9D%AF/image-20221101104654095.png" alt="image-20221101104654095"></p>
<p>后⾯不可⻅字符换成 }， 即为flag： ctf{w3_f0und_1t_112ug31vjhe121f21fas}</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/10/17/WEIRD-VM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/17/WEIRD-VM/" class="post-title-link" itemprop="url">WEIRD_VM</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-10-17 18:33:18 / 修改时间：18:58:24" itemprop="dateCreated datePublished" datetime="2022-10-17T18:33:18+08:00">2022-10-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="WEIRD-VM"><a href="#WEIRD-VM" class="headerlink" title="WEIRD_VM"></a>WEIRD_VM</h1><p>看到空白出了一道vm题，就做了一下，感觉出的还是很好的，而且拿到了3血。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int16 *v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 *opcode; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  __int64 v7; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v8; <span class="comment">// r8</span></span><br><span class="line">  __int64 v9; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  __int64 v11; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v12; <span class="comment">// dx</span></span><br><span class="line"></span><br><span class="line">  v3 = (<span class="type">unsigned</span> __int16 *)VirtualAlloc(<span class="number">0</span>i64, <span class="number">0x20000</span>ui64, <span class="number">0x1000</span>u, <span class="number">4u</span>);</span><br><span class="line">  qword_140029990 = (__int64)v3;</span><br><span class="line">  opcode = v3;</span><br><span class="line">  <span class="keyword">if</span> ( v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_140002830(v3 + <span class="number">300</span>, &amp;unk_140024A40, <span class="number">15790</span>i64);</span><br><span class="line">    *opcode = <span class="number">300</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( opcode[<span class="number">4</span>] == <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v7 = opcode[<span class="number">3</span>];</span><br><span class="line">        opcode[<span class="number">4</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, v7);</span><br><span class="line">        opcode = (<span class="type">unsigned</span> __int16 *)qword_140029990;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( opcode[<span class="number">6</span>] == <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        opcode[<span class="number">6</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>, opcode + <span class="number">5</span>);</span><br><span class="line">        opcode = (<span class="type">unsigned</span> __int16 *)qword_140029990;</span><br><span class="line">      &#125;</span><br><span class="line">      v8 = *opcode;</span><br><span class="line">      v9 = opcode[v8 + <span class="number">1</span>];</span><br><span class="line">      v10 = opcode[v8];</span><br><span class="line">      v11 = opcode[v8 + <span class="number">2</span>];</span><br><span class="line">      *opcode = v8 + <span class="number">3</span>;</span><br><span class="line">      v12 = ~(opcode[v10] | opcode[v9]);</span><br><span class="line">      opcode[v11] = v12;</span><br><span class="line">      opcode[<span class="number">1</span>] = __ROL2__(v12, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( *opcode != <span class="number">0xFFFF</span> );</span><br><span class="line">    VirtualFree(opcode, <span class="number">0</span>i64, <span class="number">0x8000</span>u);</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">    qword_140029990 = <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Init vm failed\n&quot;</span>, v4);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这类的vm感觉设计非常巧妙，我们dump出来opcode，opcode很多，所以只挑一些重点在此分析：</p>
<p>先看明白一些重要的步骤：<br>如最后一位是7，下一行前两位是7，那么可以认为是传值，即0x1ff2的值传到opcode[3]中</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x1ff2</span> <span class="number">0x1ff2</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x3</span> <span class="comment">//a[3] 赋值a[7]P</span></span><br></pre></td></tr></table></figure>

<p>典型的跳转函数，最后一位是0，就代表要jmp了：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x0</span> </span><br><span class="line"><span class="number">0x773</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> </span><br></pre></td></tr></table></figure>

<p>接下来从头开始看：</p>
<p>这个板块就是printf输出，打印字符串，这个板块统一的模式就是下图：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x1ff2</span> <span class="number">0x1ff2</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x3</span> <span class="comment">//a[3] 赋值a[7]P</span></span><br><span class="line"><span class="number">0x138</span> <span class="number">0x138</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x0</span> A[<span class="number">0</span>] = <span class="number">0X13A</span>，jmp a[<span class="number">0</span>]</span><br><span class="line"><span class="number">0x13a</span> <span class="number">0x1</span> <span class="comment">//跳过</span></span><br><span class="line"><span class="number">0x139</span>,<span class="number">0x139</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span>,<span class="number">0x7</span> <span class="number">0x4</span> <span class="comment">//a[4] =1</span></span><br><span class="line"><span class="number">0x1fef</span>,<span class="number">0x1fef</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x3</span> <span class="comment">// l</span></span><br><span class="line"><span class="number">0x14c</span> <span class="number">0x14c</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x0</span><span class="comment">//jmp</span></span><br><span class="line"><span class="number">0x14e</span> <span class="number">0x1</span> <span class="comment">//跳过</span></span><br><span class="line"><span class="number">0x14d</span> <span class="number">0x14d</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x4</span> </span><br><span class="line"><span class="number">0x1ff0</span> <span class="number">0x1ff0</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x3</span> </span><br><span class="line"><span class="number">0x160</span> <span class="number">0x160</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x0</span> </span><br><span class="line"><span class="number">0x162</span> <span class="number">0x1</span> </span><br><span class="line"><span class="number">0x161</span> <span class="number">0x161</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x4</span></span><br></pre></td></tr></table></figure>

<p>略过printf后，接下来是scanf环节，scanf拥有字符后会传进0x1fc7：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//scanf</span></span><br><span class="line"><span class="number">0x2fe</span> <span class="number">0x2fe</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x0</span><span class="comment">//jmp</span></span><br><span class="line"><span class="number">0x300</span> <span class="number">0x307</span> <span class="comment">//跳过</span></span><br><span class="line"><span class="number">0x2ff</span> <span class="number">0x2ff</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x0</span> <span class="comment">//跳过</span></span><br><span class="line"><span class="number">0x0</span> </span><br><span class="line"><span class="number">0x30d</span> <span class="number">0x30d</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x0</span><span class="comment">//跳过</span></span><br><span class="line"><span class="number">0x30f</span> <span class="number">0x1</span> </span><br><span class="line"><span class="number">0x30e</span> <span class="number">0x30e</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x6</span> </span><br><span class="line"><span class="number">0x5</span> <span class="number">0x5</span> <span class="number">0x7</span> <span class="comment">//输入传到a[7]</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x1fc7</span> <span class="comment">//写入flag</span></span><br></pre></td></tr></table></figure>

<p>从这里面可以知道字符串长度，可是我们最关心的是字符串如何进行加密和对比，我们仔细观察后面对每一位的加密会发现总共有三种加密：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x1f99</span> <span class="number">0x1f99</span> <span class="number">0x6c0</span> <span class="comment">//flag运算后存入0x6c0</span></span><br><span class="line"><span class="number">0x1faa</span> <span class="number">0x1faa</span> <span class="number">0x6c1</span> <span class="comment">//这个值存入0x6c1</span></span><br><span class="line"><span class="number">0x6ce</span> <span class="number">0x6ce</span> <span class="number">0x7</span> <span class="comment">//跳转</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x0</span> </span><br><span class="line"><span class="number">0x6d1</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> </span><br><span class="line"><span class="number">0x1f99</span> <span class="number">0x1f99</span> <span class="number">0x6cf</span> <span class="comment">//flag运算后存入0x6cf</span></span><br><span class="line"><span class="number">0x6c1</span> <span class="number">0x6c1</span> <span class="number">0x6d0</span> <span class="comment">//固定的这个值要搞两下</span></span><br><span class="line"><span class="number">0x6cf</span> <span class="number">0x6d0</span> <span class="number">0x7</span> /<span class="number">0x6</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span> <span class="comment">//0xfff9</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x6c1</span> <span class="comment">//固定值被覆盖0x6</span></span><br><span class="line"><span class="number">0x6e6</span> <span class="number">0x6e6</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x0</span> </span><br><span class="line"><span class="number">0x6e9</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> </span><br><span class="line"><span class="number">0x1faa</span> <span class="number">0x1faa</span> <span class="number">0x6e7</span> <span class="comment">//固定值存在0x6e7</span></span><br><span class="line"><span class="number">0x6c0</span> <span class="number">0x6c0</span> <span class="number">0x6e8</span> <span class="comment">//flag运算后存入0x6c0的值再搞一下</span></span><br><span class="line"><span class="number">0x6e7</span> <span class="number">0x6e8</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x6c0</span> <span class="comment">//0x6c0存入0x6e7 0x6e8 0x7 值</span></span><br><span class="line"><span class="number">0x6c0</span> <span class="number">0x6c1</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x1f99</span> <span class="comment">//覆盖原flag加密后的值</span></span><br><span class="line"><span class="number">0x1f99</span> <span class="number">0x306</span> <span class="number">0x7</span> <span class="comment">//加密后的跟0搞</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x306</span> <span class="comment">//存入306</span></span><br></pre></td></tr></table></figure>

<p>上面是刚做题时候分析的，其实第一个加密还是很简单的，我们用简单表示一下，也就是经过15次ROL加密，然后对比：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">127</span>):</span><br><span class="line">    a[<span class="number">5</span>] = k</span><br><span class="line">    a[<span class="number">1</span>] = ROL(k,<span class="number">1</span>)</span><br><span class="line">    a[<span class="number">5</span>] = a[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>):</span><br><span class="line">        a[<span class="number">1</span>] = ROL(a[<span class="number">5</span>],<span class="number">1</span>)</span><br><span class="line">        a[<span class="number">5</span>] = a[<span class="number">1</span>]</span><br><span class="line">    <span class="comment">#print(hex(a[5]))</span></span><br><span class="line">    <span class="keyword">if</span>(a[<span class="number">5</span>] == <span class="number">0x22</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(k))</span><br></pre></td></tr></table></figure>

<p>第二个加密是很长也是最难分析的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x1fc9</span> <span class="number">0x1fc9</span> <span class="number">0x762</span> //<span class="number">0X53</span>-&gt;<span class="number">0XFFAC</span></span><br><span class="line"><span class="number">0x1fa2</span> <span class="number">0x1fa2</span> <span class="number">0x763</span> //<span class="number">0X12</span> -&gt;<span class="number">0XFFED</span></span><br><span class="line"><span class="number">0x770</span> <span class="number">0x770</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x0</span> </span><br><span class="line"><span class="number">0x773</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> </span><br><span class="line"><span class="number">0x1fc9</span> <span class="number">0x1fc9</span> <span class="number">0x771</span> //<span class="number">0X53</span> -&gt;<span class="number">0XFFAC</span>//////////////////////////X</span><br><span class="line"><span class="number">0x763</span> <span class="number">0x763</span> <span class="number">0x772</span>  //<span class="number">0xFFED</span>-&gt;<span class="number">0X12</span> ///////////////////////<span class="number">0X12</span></span><br><span class="line"><span class="number">0x771</span> <span class="number">0x772</span> <span class="number">0x7</span> //<span class="number">0X41</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x763</span> </span><br><span class="line"><span class="number">0x788</span> <span class="number">0x788</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x78b</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> </span><br><span class="line"><span class="number">0x1fa2</span> <span class="number">0x1fa2</span> <span class="number">0x789</span> //<span class="number">0X12</span>-&gt;&gt;<span class="number">0XFFED</span></span><br><span class="line"><span class="number">0x762</span> <span class="number">0x762</span> <span class="number">0x78a</span> //<span class="number">0XFFAC</span>-&gt;<span class="number">0X53</span></span><br><span class="line"><span class="number">0x789</span> <span class="number">0x78a</span> <span class="number">0x7</span> //<span class="number">0</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x762</span> </span><br><span class="line"><span class="number">0x762</span> <span class="number">0x763</span> <span class="number">0x7</span> //<span class="number">0</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x1f99</span> </span><br><span class="line"><span class="number">0x7a6</span> <span class="number">0x7a6</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x7a9</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> </span><br><span class="line"><span class="number">0x1f99</span> <span class="number">0x1f99</span></span><br><span class="line"><span class="number">0x7a7</span> <span class="number">0x1fb8</span> <span class="number">0x1fb8</span> /////////////第一等是答案 <span class="number">0x41</span></span><br><span class="line"><span class="number">0x7a8</span> <span class="number">0x7b5</span> <span class="number">0x7b5</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x7b8</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> </span><br><span class="line"><span class="number">0x1f99</span> <span class="number">0x1f99</span></span><br><span class="line"><span class="number">0x7b6</span> <span class="number">0x7a8</span> <span class="number">0x7a8</span> //////////////////第二个等式答案<span class="number">0</span></span><br><span class="line"><span class="number">0x7b7</span> <span class="number">0x7b6</span> <span class="number">0x7b7</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x7a8</span> <span class="number">0x7cd</span> <span class="number">0x7cd</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x7d0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> </span><br><span class="line"><span class="number">0x1fb8</span> <span class="number">0x1fb8</span>                /////////////第一等是答案 <span class="number">0x41</span></span><br><span class="line"><span class="number">0x7ce</span> <span class="number">0x7a7</span> <span class="number">0x7a7</span></span><br><span class="line"><span class="number">0x7cf</span> <span class="number">0x7ce</span> <span class="number">0x7cf</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> 0x7ROL(a[<span class="number">5</span>],<span class="number">1</span>)</span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x7a7</span> <span class="number">0x7a7</span> <span class="number">0x7a8</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x1f99</span> <span class="number">0x1f99</span> <span class="number">0x306</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x306</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看出来其实也比较简单，就是两组数分别做运算：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>,<span class="number">127</span>):</span><br><span class="line">    x = ~(i|i) &amp; <span class="number">0XFFFF</span></span><br><span class="line">    xx = ~(x|<span class="number">0X33</span>) &amp; <span class="number">0XFFFF</span></span><br><span class="line">    y = ~(<span class="number">0X33</span>|<span class="number">0X33</span>) &amp; <span class="number">0XFFFF</span></span><br><span class="line">    yy = ~(y|i) &amp; <span class="number">0XFFFF</span></span><br><span class="line">    p = ~(xx|yy)&amp;<span class="number">0xffff</span></span><br><span class="line">    <span class="keyword">if</span>((~(p|p)&amp;<span class="number">0xffff</span> == <span class="number">0x41</span>)):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(i))</span><br></pre></td></tr></table></figure>



<p>第三种是最简单的加密：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x1fec</span> <span class="number">0x1fec</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x1fec</span> <span class="number">0x1</span> <span class="number">0x1</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x1f99</span> <span class="number">0x1d03</span> <span class="number">0x1d03</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x1d06</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x1f99</span> <span class="number">0x1f99</span></span><br><span class="line"><span class="number">0x1d04</span> <span class="number">0x1fc4</span> <span class="number">0x1fc4</span></span><br><span class="line"><span class="number">0x1d05</span> <span class="number">0x1d12</span> <span class="number">0x1d12</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x1d15</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x1f99</span> <span class="number">0x1f99</span></span><br><span class="line"><span class="number">0x1d13</span> <span class="number">0x1d05</span> <span class="number">0x1d05</span></span><br><span class="line"><span class="number">0x1d14</span> <span class="number">0x1d13</span> <span class="number">0x1d14</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x1d05</span> <span class="number">0x1d2a</span> <span class="number">0x1d2a</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x1d2d</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x1fc4</span> <span class="number">0x1fc4</span></span><br><span class="line"><span class="number">0x1d2b</span> <span class="number">0x1d04</span> <span class="number">0x1d04</span></span><br><span class="line"><span class="number">0x1d2c</span> <span class="number">0x1d2b</span> <span class="number">0x1d2c</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x1d04</span> <span class="number">0x1d04</span> <span class="number">0x1d05</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x1f99</span> <span class="number">0x1f99</span> <span class="number">0x306</span></span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x7</span></span><br><span class="line"><span class="number">0x306</span> </span><br><span class="line"><span class="number">0x1d4e</span> <span class="number">0x1d4e</span> <span class="number">0x7</span> </span><br><span class="line"><span class="number">0x7</span> <span class="number">0x7</span> <span class="number">0x0</span> </span><br><span class="line"><span class="number">0x1d50</span> <span class="number">0x0</span> </span><br></pre></td></tr></table></figure>

<p>会发现加密比较明显，就是做了一次ROL：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>,<span class="number">127</span>):</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">0X60</span> == ROL(i,<span class="number">1</span>)):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(i))</span><br></pre></td></tr></table></figure>

<p>只要把这三种加密搞懂，就可以进行爆破来得出每一位的flag。</p>
<p>最后的地方存了变量：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//存在这个地方</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x1</span> <span class="number">0x86</span></span><br><span class="line"><span class="number">0x6</span> <span class="number">0x7</span> <span class="number">0x88</span></span><br><span class="line"><span class="number">0x8</span> <span class="number">0x8c</span> <span class="number">0xc</span></span><br><span class="line"><span class="number">0x12</span> <span class="number">0x1b</span> <span class="number">0x1c</span></span><br><span class="line"><span class="number">0xa0</span> <span class="number">0x8022</span> <span class="number">0x23</span></span><br><span class="line"><span class="number">0x22</span> <span class="number">0xa6</span> <span class="number">0x27</span></span><br><span class="line"><span class="number">0x29</span> <span class="number">0x2a</span> <span class="number">0x8029</span></span><br><span class="line"><span class="number">0xac</span> <span class="number">0x802f</span> <span class="number">0x32</span></span><br><span class="line"><span class="number">0x33</span> <span class="number">0x37</span> <span class="number">0x39</span></span><br><span class="line"><span class="number">0x3c</span> <span class="number">0x803d</span> <span class="number">0x3e</span></span><br><span class="line"><span class="number">0xbe</span> <span class="number">0x41</span> <span class="number">0x43</span></span><br><span class="line"><span class="number">0xca</span> <span class="number">0x4f</span> <span class="number">0x53</span></span><br><span class="line"><span class="number">0x5e</span> <span class="number">0x5f</span> <span class="number">0x60</span></span><br><span class="line"><span class="number">0x62</span> <span class="number">0xe4</span> <span class="number">0x6e</span></span><br><span class="line"><span class="number">0x6f</span> <span class="number">0xfa</span> <span class="number">0x7b</span></span><br><span class="line"><span class="number">0x7e</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">//写flag进去</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x0</span> <span class="number">0x0</span> <span class="number">0x0</span></span><br><span class="line"><span class="number">0x72</span> <span class="number">0x6f</span> <span class="number">0x6c</span></span><br><span class="line"><span class="number">0x65</span> <span class="number">0x61</span> <span class="number">0x50</span></span><br><span class="line"><span class="number">0x73</span> <span class="number">0x57</span> <span class="number">0x64</span></span><br><span class="line"><span class="number">0x74</span> <span class="number">0x67</span> <span class="number">0x3a</span></span><br><span class="line"><span class="number">0x20</span> <span class="number">0x43</span> <span class="number">0x66</span></span><br><span class="line"><span class="number">0x6e</span> <span class="number">0x52</span> <span class="number">0x69</span></span><br><span class="line"><span class="number">0x70</span> <span class="number">0x75</span> <span class="number">0x79</span></span><br></pre></td></tr></table></figure>

<p>他这个rol加密跟平常见的好像还不太一样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ROL</span>(<span class="params">i,index</span>):</span><br><span class="line">    tmp = <span class="built_in">bin</span>(i)[<span class="number">2</span>:].rjust(<span class="number">16</span>, <span class="string">&quot;0&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(index):</span><br><span class="line">        tmp = tmp[<span class="number">1</span>:] + tmp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(tmp, <span class="number">2</span>) &amp;<span class="number">0xffff</span></span><br></pre></td></tr></table></figure>

<p>得到flag：NSSCTF{Pr0_ReVEr3Er_F1n1SHeD_We1RD_Vm}</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/10/04/Inflated/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/04/Inflated/" class="post-title-link" itemprop="url">Inflated</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-10-04 19:33:35 / 修改时间：20:25:51" itemprop="dateCreated datePublished" datetime="2022-10-04T19:33:35+08:00">2022-10-04</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Inflated"><a href="#Inflated" class="headerlink" title="Inflated"></a>Inflated</h1><p>这个题是很久以前ACTF的一道题了，但由于最近打ctf经常遇到混淆，所以先从简单的ollvm搞起，顺便仔细学习一下异常类。</p>
<h2 id="Exception"><a href="#Exception" class="headerlink" title="Exception"></a>Exception</h2><p>首先是异常，c++异常我们基本上是通过手动patch块来找到catch块，如何分辩可以通过rdx的值。</p>
<p>当前函数抛出异常后，如果在该函数没有找到catch块，那么就继续向上找catch块，出现两种情况</p>
<p>第一：找到catch块</p>
<p>第二：没有找到catch块，调用std::terminal（），即把程序abort掉</p>
<p>当找到catch块后，会执行对应操作。</p>
<p>程序中代码块有个专有名词：landing pad，从抛异常到开始，再到执行landing pad代码，这整个过程叫做Stack unwind</p>
<p>Stack unwind主要作用是：沿着链向上找catch块，且清理调用链上栈中的局部变量</p>
<p>其中 stack unwind库在intel平台上，属于Itanium ABI接口中的一部分，由系统实现，跟语言无关，任何上层语言都能通过接口的基础实现各自异常处理</p>
<p>Itanium ABI定义了数据结构来建立异常处理流程和框架</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">_Unwind_RaiseException</span>,<span class="comment">//用于stack unwind</span></span><br><span class="line"><span class="variable">_Unwind_Resume</span>,</span><br><span class="line"><span class="variable">_Unwind_DeleteException</span>,</span><br><span class="line"><span class="variable">_Unwind_GetGR</span>,</span><br><span class="line"><span class="variable">_Unwind_SetGR</span>,</span><br><span class="line"><span class="variable">_Unwind_GetIP</span>,</span><br><span class="line"><span class="variable">_Unwind_SetIP</span>,</span><br><span class="line"><span class="variable">_Unwind_GetRegionStart</span>,</span><br><span class="line"><span class="variable">_Unwind_GetLanguageSpecificData</span>,</span><br><span class="line"><span class="variable">_Unwind_ForcedUnwind</span></span><br></pre></td></tr></table></figure>

<p>_Unwind_RaiseException（）函数用于进行stack unwind，它在用户执行throw时候被调用，主要功能就是从当前函数开始，对调用链上的每个函数都调用一个personality routine函数</p>
<p>当我们在代码中写下throw xxx，编译器会分配一个数据结构**__cxa_exception**来表示该异常，异常头部：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> __<span class="title">cxa_exception</span> </span></span><br><span class="line"><span class="class">&#123;</span> </span><br><span class="line">  <span class="built_in">std</span>::type_info *    exceptionType;</span><br><span class="line">  <span class="type">void</span> (*exceptionDestructor) (<span class="type">void</span> *); </span><br><span class="line">  unexpected_handler    unexpectedHandler;</span><br><span class="line">  terminate_handler    terminateHandler;</span><br><span class="line">  __cxa_exception *    nextException;</span><br><span class="line"></span><br><span class="line">  <span class="type">int</span>     handlerCount;</span><br><span class="line">  <span class="type">int</span>     handlerSwitchValue;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *     actionRecord;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *     languageSpecificData;</span><br><span class="line">  <span class="type">void</span> *     catchTemp;</span><br><span class="line">  <span class="type">void</span> *     adjustedPtr;</span><br><span class="line"></span><br><span class="line">  _Unwind_Exception    unwindHeader;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>整个头部下面才是exception obj。</p>
<p>所以当我们在程序里执行了抛出异常的操作，编译器为我们做了如下的事情：</p>
<ol>
<li>调用 __cxa_allocate_exception 函数，分配一个异常对象（__cxa_exception，数据结构如上）</li>
<li>调用 __cxa_throw 函数，这个函数会将异常对象做一些初始化</li>
<li>__cxa_throw() 调用 Itanium ABI 里的 _Unwind_RaiseException() 从而开始 unwind</li>
<li>_Unwind_RaiseException() 对调用链上的函数进行 unwind 时，调用 personality routine()</li>
<li>该异常如能被处理(有相应的 catch)，则 personality routine 会依次对调用链上的函数进行清理</li>
<li><strong>_Unwind_RaiseException() 将控制权转到相应的catch代码</strong></li>
<li>unwind 完成，用户代码继续执行</li>
</ol>
<p>这个题最骚的是把exception源码给改了，我们找到__gxx_personality_v0，点Y修改其函数类型</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">_Unwind_Reason_Code __fastcall _gxx_personality_v0(</span><br><span class="line">        <span class="type">int</span> Version,</span><br><span class="line">        _Unwind_Action actions,</span><br><span class="line">        __int64 exceptionClass,</span><br><span class="line">        _Unwind_Exception *exceptionObject,</span><br><span class="line">        _Unwind_Context *context)</span><br></pre></td></tr></table></figure>

<p>然后看scan_eh_tab()，这里面有两个关键值被魔改了，先shift+F1存入参数结构体，然后点Y修改scan_eh_tab</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">scan_results</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="type">int64_t</span> ttypeIndex; </span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span>* actionRecord; </span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span>* languageSpecificData; </span><br><span class="line"><span class="type">uintptr_t</span> landingPad; </span><br><span class="line"><span class="type">void</span>* adjustedPtr; </span><br><span class="line">_Unwind_Reason_Code reason; </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">scan_eh_tab</span><span class="params">(scan_results *results, _Unwind_Action actions, <span class="type">bool</span> native_exception, _Unwind_Exception *unwind_exception, _Unwind_Context *context)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v33 &lt;= (<span class="type">unsigned</span> __int64)v22 )</span><br><span class="line">      call_terminate(native_exception, unwind_exception);</span><br><span class="line">    v35 = readEncodedPointer(&amp;v22, v19);</span><br><span class="line">    v36 = readEncodedPointer(&amp;v22, v19);</span><br><span class="line">    v10 = readEncodedPointer(&amp;v22, v19);</span><br><span class="line">    v37 = (<span class="number">13</span> * (_BYTE)v22 + <span class="number">95</span>) &amp; <span class="number">0x3F</span> ^ <span class="number">0x33</span>u ^ (<span class="type">unsigned</span> __int64)v10;<span class="comment">//landing pad</span></span><br><span class="line">    v38 = readULEB128(&amp;v22);</span><br><span class="line">    <span class="keyword">if</span> ( v35 &lt;= v30 &amp;&amp; v30 &lt; v35 + v36 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v30 &lt; v35 )</span><br><span class="line">      call_terminate(native_exception, unwind_exception);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>此处landing pad被修改，所以catch分发处的地址已经被魔改了</p>
<p>第二处</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v47 == &amp;`typeinfo <span class="keyword">for</span><span class="number">&#x27;</span>StdObfException )</span><br><span class="line">          &#123;</span><br><span class="line">            v48 = thrown_object_ptr;</span><br><span class="line">            v27 = <span class="number">27</span> * (<span class="number">42</span> * (<span class="type">char</span>)*thrown_object_ptr + (<span class="type">int</span>)v27) % <span class="number">0x61</span>u;</span><br><span class="line">          &#125;</span><br><span class="line">          results-&gt;ttypeIndex = v27;</span><br><span class="line">          results-&gt;actionRecord = v39;</span><br><span class="line">          results-&gt;adjustedPtr = thrown_object_ptr;</span><br><span class="line">          results-&gt;reason = _URC_HANDLER_FOUND;</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_54;</span><br></pre></td></tr></table></figure>

<p><strong>v27是ttypeindex，最后的ttypeIndex由 thrown_object_ptr（由我们的第一段输入所决定的thrown_object_ptr） 和 原始固定固定typeIndex 决定</strong></p>
<h2 id="OLLVM"><a href="#OLLVM" class="headerlink" title="OLLVM"></a>OLLVM</h2><p>这篇文章写的还是不错的：<a target="_blank" rel="noopener" href="https://bluesadi.github.io/0x401RevTrain-Tools/angr/10_%E5%88%A9%E7%94%A8angr%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E5%8E%BB%E9%99%A4%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96/">https://bluesadi.github.io/0x401RevTrain-Tools/angr/10_%E5%88%A9%E7%94%A8angr%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E5%8E%BB%E9%99%A4%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/10/01/Bytectf2022/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/01/Bytectf2022/" class="post-title-link" itemprop="url">Bytectf2022</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-10-01 10:01:26 / 修改时间：16:51:15" itemprop="dateCreated datePublished" datetime="2022-10-01T10:01:26+08:00">2022-10-01</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Bytectf2022"><a href="#Bytectf2022" class="headerlink" title="Bytectf2022"></a>Bytectf2022</h1><p>题的质量都很高，而且绝大部分知识点都是我不会的，所以接下来一个月，抽时间就来复现。</p>
<h2 id="OhMySolidity"><a href="#OhMySolidity" class="headerlink" title="OhMySolidity"></a>OhMySolidity</h2><p>这个题是一个智能合约题，第一次接触这种类型的题，发现反编译出来的东西很抽象。</p>
<p>给了一个txt文件</p>
<p>我们将第一段input输入<a target="_blank" rel="noopener" href="https://ethervm.io/%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E5%B0%B1%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%88%B0%E5%8F%8D%E7%BC%96%E8%AF%91%E5%90%8E%E7%9A%84%E6%A0%B7%E5%AD%90%EF%BC%9A">https://ethervm.io/这个网站就可以得到反编译后的样子：</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br></pre></td><td class="code"><pre><span class="line">contract Contract &#123;</span><br><span class="line">    function main() &#123;</span><br><span class="line">        memory[0x40:0x60] = 0x80;</span><br><span class="line">        var var0 = msg.value;</span><br><span class="line">    </span><br><span class="line">        if (var0) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    </span><br><span class="line">        if (msg.data.length &lt; 0x04) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    </span><br><span class="line">        var0 = msg.data[0x00:0x20] &gt;&gt; 0xe0;</span><br><span class="line">    </span><br><span class="line">        if (var0 == 0x14edb54d) &#123;</span><br><span class="line">            // Dispatch table entry for k1()</span><br><span class="line">            var var1 = 0x006f;</span><br><span class="line">            var var2 = k1();</span><br><span class="line">            var temp0 = memory[0x40:0x60];</span><br><span class="line">            memory[temp0:temp0 + 0x20] = var2 &amp; 0xffffffff;</span><br><span class="line">            var temp1 = memory[0x40:0x60];</span><br><span class="line">            return memory[temp1:temp1 + (temp0 + 0x20) - temp1];</span><br><span class="line">        &#125; else if (var0 == 0x58f5382e) &#123;</span><br><span class="line">            // Dispatch table entry for challenge(string)</span><br><span class="line">            var1 = 0x014a;</span><br><span class="line">            var2 = 0x04;</span><br><span class="line">            var var3 = msg.data.length - var2;</span><br><span class="line">        </span><br><span class="line">            if (var3 &lt; 0x20) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">        </span><br><span class="line">            var1 = challenge(var2, var3);</span><br><span class="line">            var temp2 = memory[0x40:0x60];</span><br><span class="line">            var2 = temp2;</span><br><span class="line">            var3 = var2;</span><br><span class="line">            var temp3 = var3 + 0x20;</span><br><span class="line">            memory[var3:var3 + 0x20] = temp3 - var3;</span><br><span class="line">            var temp4 = var1;</span><br><span class="line">            memory[temp3:temp3 + 0x20] = memory[temp4:temp4 + 0x20];</span><br><span class="line">            var var4 = temp3 + 0x20;</span><br><span class="line">            var var6 = memory[temp4:temp4 + 0x20];</span><br><span class="line">            var var5 = temp4 + 0x20;</span><br><span class="line">            var var7 = var6;</span><br><span class="line">            var var8 = var4;</span><br><span class="line">            var var9 = var5;</span><br><span class="line">            var var10 = 0x00;</span><br><span class="line">        </span><br><span class="line">            if (var10 &gt;= var7) &#123;</span><br><span class="line">            label_018A:</span><br><span class="line">                var temp5 = var6;</span><br><span class="line">                var4 = temp5 + var4;</span><br><span class="line">                var5 = temp5 &amp; 0x1f;</span><br><span class="line">            </span><br><span class="line">                if (!var5) &#123;</span><br><span class="line">                    var temp6 = memory[0x40:0x60];</span><br><span class="line">                    return memory[temp6:temp6 + var4 - temp6];</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    var temp7 = var5;</span><br><span class="line">                    var temp8 = var4 - temp7;</span><br><span class="line">                    memory[temp8:temp8 + 0x20] = ~(0x0100 ** (0x20 - temp7) - 0x01) &amp; memory[temp8:temp8 + 0x20];</span><br><span class="line">                    var temp9 = memory[0x40:0x60];</span><br><span class="line">                    return memory[temp9:temp9 + (temp8 + 0x20) - temp9];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">            label_0178:</span><br><span class="line">                var temp10 = var10;</span><br><span class="line">                memory[var8 + temp10:var8 + temp10 + 0x20] = memory[var9 + temp10:var9 + temp10 + 0x20];</span><br><span class="line">                var10 = temp10 + 0x20;</span><br><span class="line">            </span><br><span class="line">                if (var10 &gt;= var7) &#123; goto label_018A; &#125;</span><br><span class="line">                else &#123; goto label_0178; &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (var0 == 0x93eed093) &#123;</span><br><span class="line">            // Dispatch table entry for 0x93eed093 (unknown)</span><br><span class="line">            var1 = 0x01cd;</span><br><span class="line">            var2 = func_056F();</span><br><span class="line">            var temp11 = memory[0x40:0x60];</span><br><span class="line">            memory[temp11:temp11 + 0x20] = var2 &amp; 0xffffffff;</span><br><span class="line">            var temp12 = memory[0x40:0x60];</span><br><span class="line">            return memory[temp12:temp12 + (temp11 + 0x20) - temp12];</span><br><span class="line">        &#125; else if (var0 == 0x9577a145) &#123;</span><br><span class="line">            // Dispatch table entry for 0x9577a145 (unknown)</span><br><span class="line">            var1 = 0x0251;</span><br><span class="line">            var2 = 0x04;</span><br><span class="line">            var3 = msg.data.length - var2;</span><br><span class="line">        </span><br><span class="line">            if (var3 &lt; 0x80) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">        </span><br><span class="line">            func_0205(var2, var3);</span><br><span class="line">            stop();</span><br><span class="line">        &#125; else if (var0 == 0xa7f81e6a) &#123;</span><br><span class="line">            // Dispatch table entry for k2()</span><br><span class="line">            var1 = 0x025b;</span><br><span class="line">            var2 = k2();</span><br><span class="line">            var temp13 = memory[0x40:0x60];</span><br><span class="line">            memory[temp13:temp13 + 0x20] = var2 &amp; 0xffffffff;</span><br><span class="line">            var temp14 = memory[0x40:0x60];</span><br><span class="line">            return memory[temp14:temp14 + (temp13 + 0x20) - temp14];</span><br><span class="line">        &#125; else if (var0 == 0xf0407ca7) &#123;</span><br><span class="line">            // Dispatch table entry for 0xf0407ca7 (unknown)</span><br><span class="line">            var1 = 0x0285;</span><br><span class="line">            var2 = func_0623();</span><br><span class="line">            var temp15 = memory[0x40:0x60];</span><br><span class="line">            memory[temp15:temp15 + 0x20] = var2 &amp; 0xffffffff;</span><br><span class="line">            var temp16 = memory[0x40:0x60];</span><br><span class="line">            return memory[temp16:temp16 + (temp15 + 0x20) - temp16];</span><br><span class="line">        &#125; else &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function challenge(var arg0, var arg1) returns (var r0) &#123;</span><br><span class="line">        var temp0 = arg0;</span><br><span class="line">        arg0 = temp0 + arg1;</span><br><span class="line">        arg1 = temp0;</span><br><span class="line">        var var1 = msg.data[arg1:arg1 + 0x20];</span><br><span class="line">        var var0 = arg1 + 0x20;</span><br><span class="line">    </span><br><span class="line">        if (var1 &gt; 0x0100000000) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    </span><br><span class="line">        var temp1 = arg1 + var1;</span><br><span class="line">        var1 = temp1;</span><br><span class="line">    </span><br><span class="line">        if (var1 + 0x20 &gt; arg0) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    </span><br><span class="line">        var temp2 = var1;</span><br><span class="line">        var temp3 = msg.data[temp2:temp2 + 0x20];</span><br><span class="line">        var1 = temp3;</span><br><span class="line">        var temp4 = var0;</span><br><span class="line">        var0 = temp2 + 0x20;</span><br><span class="line">        var var2 = temp4;</span><br><span class="line">    </span><br><span class="line">        if ((var1 &gt; 0x0100000000) | (var0 + var1 &gt; arg0)) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    </span><br><span class="line">        var temp5 = var1;</span><br><span class="line">        var temp6 = memory[0x40:0x60];</span><br><span class="line">        memory[0x40:0x60] = temp6 + (temp5 + 0x1f) / 0x20 * 0x20 + 0x20;</span><br><span class="line">        memory[temp6:temp6 + 0x20] = temp5;</span><br><span class="line">        var temp7 = temp6 + 0x20;</span><br><span class="line">        memory[temp7:temp7 + temp5] = msg.data[var0:var0 + temp5];</span><br><span class="line">        memory[temp7 + temp5:temp7 + temp5 + 0x20] = 0x00;</span><br><span class="line">        arg0 = temp6;</span><br><span class="line">        arg1 = 0x60;</span><br><span class="line">        var0 = arg0;</span><br><span class="line">        var1 = 0x00;</span><br><span class="line">        var2 = 0x08;</span><br><span class="line">        var var3 = memory[var0:var0 + 0x20];</span><br><span class="line">    </span><br><span class="line">        if (!var2) &#123; assert(); &#125;</span><br><span class="line">    </span><br><span class="line">        if (var3 % var2 != var1) &#123; revert(memory[0x00:0x00]); &#125;</span><br><span class="line">    </span><br><span class="line">        var1 = 0x60;</span><br><span class="line">        var temp8 = memory[var0:var0 + 0x20];</span><br><span class="line">        var temp9 = memory[0x40:0x60];</span><br><span class="line">        var2 = temp9;</span><br><span class="line">        var3 = temp8;</span><br><span class="line">        memory[var2:var2 + 0x20] = var3;</span><br><span class="line">        memory[0x40:0x60] = var2 + (var3 + 0x1f &amp; ~0x1f) + 0x20;</span><br><span class="line">    </span><br><span class="line">        if (!var3) &#123;</span><br><span class="line">            var1 = var2;</span><br><span class="line">            var2 = 0xdeadbeef;</span><br><span class="line">            var3 = 0x00;</span><br><span class="line">        </span><br><span class="line">            if (var3 &gt;= memory[var0:var0 + 0x20]) &#123;</span><br><span class="line">            label_0563:</span><br><span class="line">                return var1;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">            label_032D:</span><br><span class="line">                var var4 = 0x00;</span><br><span class="line">                var var5 = 0x00;</span><br><span class="line">                var var6 = 0x00;</span><br><span class="line">                var var7 = 0x00;</span><br><span class="line">            </span><br><span class="line">                if (var7 &amp; 0xff &gt;= 0x04) &#123;</span><br><span class="line">                label_03CD:</span><br><span class="line">                    var7 = 0x00;</span><br><span class="line">                </span><br><span class="line">                    if (var7 &amp; 0xff &gt;= 0x20) &#123;</span><br><span class="line">                    label_047F:</span><br><span class="line">                        var7 = 0x00;</span><br><span class="line">                    </span><br><span class="line">                        if (var7 &amp; 0xff &gt;= 0x04) &#123;</span><br><span class="line">                        label_0554:</span><br><span class="line">                            var3 = var3 + 0x08;</span><br><span class="line">                        </span><br><span class="line">                            if (var3 &gt;= memory[var0:var0 + 0x20]) &#123; goto label_0563; &#125;</span><br><span class="line">                            else &#123; goto label_032D; &#125;</span><br><span class="line">                        &#125; else &#123;</span><br><span class="line">                        label_0493:</span><br><span class="line">                            var temp10 = var7;</span><br><span class="line">                            var var8 = (((var5 &amp; 0xffffffff) &gt;&gt; (0x03 - temp10 * 0x08 &amp; 0xff)) &amp; 0xff) &lt;&lt; 0xf8;</span><br><span class="line">                            var var9 = var1;</span><br><span class="line">                            var var10 = var3 + (temp10 &amp; 0xff);</span><br><span class="line">                        </span><br><span class="line">                            if (var10 &gt;= memory[var9:var9 + 0x20]) &#123; assert(); &#125;</span><br><span class="line">                        </span><br><span class="line">                            memory[var10 + 0x20 + var9:var10 + 0x20 + var9 + 0x01] = byte(var8 &amp; ~0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff, 0x00);</span><br><span class="line">                            var temp11 = var7;</span><br><span class="line">                            var8 = (((var6 &amp; 0xffffffff) &gt;&gt; (0x03 - temp11 * 0x08 &amp; 0xff)) &amp; 0xff) &lt;&lt; 0xf8;</span><br><span class="line">                            var9 = var1;</span><br><span class="line">                            var10 = var3 + (temp11 &amp; 0xff) + 0x04;</span><br><span class="line">                        </span><br><span class="line">                            if (var10 &gt;= memory[var9:var9 + 0x20]) &#123; assert(); &#125;</span><br><span class="line">                        </span><br><span class="line">                            memory[var10 + 0x20 + var9:var10 + 0x20 + var9 + 0x01] = byte(var8 &amp; ~0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff, 0x00);</span><br><span class="line">                            var7 = var7 + 0x01;</span><br><span class="line">                        </span><br><span class="line">                            if (var7 &amp; 0xff &gt;= 0x04) &#123; goto label_0554; &#125;</span><br><span class="line">                            else &#123; goto label_0493; &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                    label_03E1:</span><br><span class="line">                        var temp12 = var4 + var2;</span><br><span class="line">                        var4 = temp12;</span><br><span class="line">                        var temp13 = var6;</span><br><span class="line">                        var temp14 = var5 + (((temp13 &amp; 0xffffffff) &lt;&lt; 0x04) + (storage[0x00] &amp; 0xffffffff) ~ temp13 + var4 ~ ((temp13 &amp; 0xffffffff) &gt;&gt; 0x05) + (storage[0x00] / 0x0100 ** 0x04 &amp; 0xffffffff));</span><br><span class="line">                        var5 = temp14;</span><br><span class="line">                        var6 = temp13 + (((var5 &amp; 0xffffffff) &lt;&lt; 0x04) + (storage[0x00] / 0x0100 ** 0x08 &amp; 0xffffffff) ~ var5 + var4 ~ ((var5 &amp; 0xffffffff) &gt;&gt; 0x05) + (storage[0x00] / 0x0100 ** 0x0c &amp; 0xffffffff));</span><br><span class="line">                        var7 = var7 + 0x01;</span><br><span class="line">                    </span><br><span class="line">                        if (var7 &amp; 0xff &gt;= 0x20) &#123; goto label_047F; &#125;</span><br><span class="line">                        else &#123; goto label_03E1; &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                label_034E:</span><br><span class="line">                    var temp15 = var7;</span><br><span class="line">                    var8 = 0x03 - temp15 * 0x08 &amp; 0xff;</span><br><span class="line">                    var9 = var0;</span><br><span class="line">                    var10 = var3 + (temp15 &amp; 0xff);</span><br><span class="line">                </span><br><span class="line">                    if (var10 &gt;= memory[var9:var9 + 0x20]) &#123; assert(); &#125;</span><br><span class="line">                </span><br><span class="line">                    var5 = var5 + (((((memory[var10 + 0x20 + var9:var10 + 0x20 + var9 + 0x20] &gt;&gt; 0xf8) &lt;&lt; 0xf8) &gt;&gt; 0xf8) &amp; 0xff) &lt;&lt; var8);</span><br><span class="line">                    var temp16 = var7;</span><br><span class="line">                    var8 = 0x03 - temp16 * 0x08 &amp; 0xff;</span><br><span class="line">                    var9 = var0;</span><br><span class="line">                    var10 = var3 + (temp16 &amp; 0xff) + 0x04;</span><br><span class="line">                </span><br><span class="line">                    if (var10 &gt;= memory[var9:var9 + 0x20]) &#123; assert(); &#125;</span><br><span class="line">                </span><br><span class="line">                    var6 = var6 + (((((memory[var10 + 0x20 + var9:var10 + 0x20 + var9 + 0x20] &gt;&gt; 0xf8) &lt;&lt; 0xf8) &gt;&gt; 0xf8) &amp; 0xff) &lt;&lt; var8);</span><br><span class="line">                    var7 = var7 + 0x01;</span><br><span class="line">                </span><br><span class="line">                    if (var7 &amp; 0xff &gt;= 0x04) &#123; goto label_03CD; &#125;</span><br><span class="line">                    else &#123; goto label_034E; &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            var temp17 = var3;</span><br><span class="line">            memory[var2 + 0x20:var2 + 0x20 + temp17] = code[code.length:code.length + temp17];</span><br><span class="line">            var1 = var2;</span><br><span class="line">            var2 = 0xdeadbeef;</span><br><span class="line">            var3 = 0x00;</span><br><span class="line">        </span><br><span class="line">            if (var3 &gt;= memory[var0:var0 + 0x20]) &#123; goto label_0563; &#125;</span><br><span class="line">            else &#123; goto label_032D; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function func_0205(var arg0, var arg1) &#123;</span><br><span class="line">        var temp0 = arg0;</span><br><span class="line">        var temp1 = temp0 + 0x20;</span><br><span class="line">        arg0 = msg.data[temp0:temp0 + 0x20] &amp; 0xffffffff;</span><br><span class="line">        var temp2 = temp1 + 0x20;</span><br><span class="line">        arg1 = msg.data[temp1:temp1 + 0x20] &amp; 0xffffffff;</span><br><span class="line">        var var0 = msg.data[temp2:temp2 + 0x20] &amp; 0xffffffff;</span><br><span class="line">        var var1 = msg.data[temp2 + 0x20:temp2 + 0x20 + 0x20] &amp; 0xffffffff;</span><br><span class="line">        storage[0x00] = (arg0 &amp; 0xffffffff) | (storage[0x00] &amp; ~0xffffffff);</span><br><span class="line">        storage[0x00] = (arg1 &amp; 0xffffffff) * 0x0100 ** 0x04 | (storage[0x00] &amp; ~(0xffffffff * 0x0100 ** 0x04));</span><br><span class="line">        storage[0x00] = (var0 &amp; 0xffffffff) * 0x0100 ** 0x08 | (storage[0x00] &amp; ~(0xffffffff * 0x0100 ** 0x08));</span><br><span class="line">        storage[0x00] = (var1 &amp; 0xffffffff) * 0x0100 ** 0x0c | (storage[0x00] &amp; ~(0xffffffff * 0x0100 ** 0x0c));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function k1() returns (var r0) &#123; return storage[0x00] / 0x0100 ** 0x04 &amp; 0xffffffff; &#125;</span><br><span class="line">    </span><br><span class="line">    function func_056F() returns (var r0) &#123; return storage[0x00] &amp; 0xffffffff; &#125;</span><br><span class="line">    </span><br><span class="line">    function k2() returns (var r0) &#123; return storage[0x00] / 0x0100 ** 0x08 &amp; 0xffffffff; &#125;</span><br><span class="line">    </span><br><span class="line">    function func_0623() returns (var r0) &#123; return storage[0x00] / 0x0100 ** 0x0c &amp; 0xffffffff; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看这个东西，要看if中的语句，比如下面，当输入0x93eed093时，会调用func_056F函数</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20221001101445496.png" alt="image-20221001101445496"></p>
<p>我们的第二段输入</p>
<p>0x9577a1450000000000000000000000000000000000000000000000000000000010000000000000000000000000000876543210000000000000002345678000000000000000000000000000000000000000000000000000000000000000000000aabbccdd0000000000000000000000000000000000000000000000000000000044332211</p>
<p>我们直接看func_0205函数</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20221001101725520.png" alt="image-20221001101725520"></p>
<p>这就要猜了，能看出是赋值了4个值到storage，四个值分别对应0x12345678、0x87654321、0xaabbccdd、0x44332211</p>
<p>第三次输入时challenge方法：输入0x59f5382e，并输出了0xa625e97482f83d2b7fc5125763dcbbffd8115b208c4754eee8711bdfac9e3377622bbf0cbb785e612b82c7f5143d5333</p>
<p>challeng函数是一个魔改的tea</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//加密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//解密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0xdeadbeef</span>*<span class="number">32</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0xdeadbeef</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">12</span>]=&#123;<span class="number">0xa625e974</span>,<span class="number">0x82f83d2b</span>,<span class="number">0x7fc51257</span>,<span class="number">0x63dcbbff</span>,<span class="number">0xd8115b20</span>,<span class="number">0x8c4754ee</span>,<span class="number">0xe8711bdf</span>,<span class="number">0xac9e3377</span>,<span class="number">0x622bbf0c</span>,<span class="number">0xbb785e61</span>,<span class="number">0x2b82c7f5</span>,<span class="number">0x143d5333</span>&#125;,k[<span class="number">4</span>]=&#123;<span class="number">0x12345678</span>,<span class="number">0x87654321</span>,<span class="number">0xaabbccdd</span>,<span class="number">0x44332211</span>&#125;;</span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i+=<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        decrypt(v + i, k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[i],v[i + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">bytectf</span>&#123;f2d9e0b6-<span class="number">274</span>d-<span class="number">47</span>e0-bc4c-<span class="number">40967015</span>ba79273&#125;</span><br></pre></td></tr></table></figure>

<h2 id="maze6d"><a href="#maze6d" class="headerlink" title="maze6d"></a>maze6d</h2><p>这个混淆看了一天，里面涉及到好多不清楚的地方，还有很多之前没搞明白的地方。</p>
<p>第一个点是GOT和PLT表：</p>
<p>GOT表是一个存储外部函数地址的表，PLT表是一个代码片段组成的表，每一个都能跳到GOT表项。众所周知，链接时要进行一个重定位，链接做的事情：对同名section进行合并，对代码段和数据段进行地址分配，进行重定位。</p>
<p>重定位是这样的：如果时在中间文件中定义好的函数，连接时直接可以重定位到函数地址，如果是动态链接库中的函数，只能生成额外的小段代码，就是PLT表，然后重定位到该代码片段。</p>
<p>运行时重定位：运行后加载动态库，把动态库中的相应函数地址填入GOT表</p>
<p>延迟重定位：只有动态库被调用时才会进行地址解析和重定位工作，这时候动态库函数地址被写到GOT表项中。</p>
<p>第一步由函数跳到PLT表中，第二步PLT表跳到GOT表（jmp），第三步GOT跳到PLT(push)，并进行压栈，把代表函数的id压栈，第四步跳到公共PLT表项中（jmp），第五步进入GOT表，然后_dl_runtime_resolve对动态函数进行地址解析和重定位，第七步把动态函数真实的地址写入GOT表项，然后执行函数并retn。</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20221001142814162.png" alt="image-20221001142814162"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/09/18/%E6%9F%8F%E9%B9%AD%E3%80%81MT%E3%80%81DASCTF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/09/18/%E6%9F%8F%E9%B9%AD%E3%80%81MT%E3%80%81DASCTF/" class="post-title-link" itemprop="url">柏鹭、MT、DASCTF</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-09-18 18:38:32" itemprop="dateCreated datePublished" datetime="2022-09-18T18:38:32+08:00">2022-09-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-10-01 17:08:57" itemprop="dateModified" datetime="2022-10-01T17:08:57+08:00">2022-10-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="柏鹭、MT、DASCTF"><a href="#柏鹭、MT、DASCTF" class="headerlink" title="柏鹭、MT、DASCTF"></a>柏鹭、MT、DASCTF</h1><p>这三天打了许多比赛，题目质量我不好说，但自己还是很菜，继续加油吧！</p>
<h2 id="柏鹭杯"><a href="#柏鹭杯" class="headerlink" title="柏鹭杯"></a>柏鹭杯</h2><p>他这个比赛的逆向，咋不直接改成密码呢？</p>
<h3 id="walk"><a href="#walk" class="headerlink" title="walk"></a>walk</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __noreturn <span class="title function_">sub_231280</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">const</span> <span class="class"><span class="keyword">struct</span> _<span class="title">s_FuncInfo</span> *<span class="title">v1</span>;</span> <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// al</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> *v5; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v8; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v9; <span class="comment">// bl</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v12; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v13; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v19; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// [esp-20h] [ebp-8Ch]</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// [esp-1Ch] [ebp-88h]</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// [esp-18h] [ebp-84h]</span></span><br><span class="line">  <span class="type">int</span> v23; <span class="comment">// [esp-14h] [ebp-80h]</span></span><br><span class="line">  <span class="type">int</span> v24; <span class="comment">// [esp-10h] [ebp-7Ch] BYREF</span></span><br><span class="line">  <span class="type">const</span> _ThrowInfo *v25; <span class="comment">// [esp-Ch] [ebp-78h]</span></span><br><span class="line">  <span class="type">int</span> v26; <span class="comment">// [esp-8h] [ebp-74h] BYREF</span></span><br><span class="line">  <span class="type">const</span> _ThrowInfo *v27; <span class="comment">// [esp-4h] [ebp-70h]</span></span><br><span class="line">  <span class="type">int</span> v28; <span class="comment">// [esp+0h] [ebp-6Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> v29[<span class="number">4</span>]; <span class="comment">// [esp+Ch] [ebp-60h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v30[<span class="number">3</span>]; <span class="comment">// [esp+1Ch] [ebp-50h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v31[<span class="number">3</span>]; <span class="comment">// [esp+28h] [ebp-44h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v32[<span class="number">8</span>]; <span class="comment">// [esp+34h] [ebp-38h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> *v33; <span class="comment">// [esp+40h] [ebp-2Ch]</span></span><br><span class="line">  _DWORD *v34; <span class="comment">// [esp+44h] [ebp-28h]</span></span><br><span class="line">  <span class="type">int</span> *v35; <span class="comment">// [esp+48h] [ebp-24h]</span></span><br><span class="line">  <span class="type">int</span> v36; <span class="comment">// [esp+4Ch] [ebp-20h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v37; <span class="comment">// [esp+50h] [ebp-1Ch]</span></span><br><span class="line">  <span class="type">const</span> <span class="class"><span class="keyword">struct</span> _<span class="title">s_FuncInfo</span> *<span class="title">v38</span>;</span> <span class="comment">// [esp+54h] [ebp-18h]</span></span><br><span class="line">  <span class="type">int</span> v39; <span class="comment">// [esp+58h] [ebp-14h]</span></span><br><span class="line">  <span class="type">int</span> *v40; <span class="comment">// [esp+5Ch] [ebp-10h]</span></span><br><span class="line">  <span class="type">int</span> v41; <span class="comment">// [esp+68h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v40 = &amp;v28;</span><br><span class="line">  v41 = <span class="number">0</span>;</span><br><span class="line">  sub_2311F0(v31, (<span class="type">int</span>)v25, v26, (<span class="type">int</span>)v27);</span><br><span class="line">  v27 = &amp;_TI1_AUTI__;</span><br><span class="line">  v26 = v0;</span><br><span class="line">  v40 = &amp;v26;</span><br><span class="line">  v1 = (<span class="type">const</span> <span class="keyword">struct</span> _s_FuncInfo *)v35[<span class="number">1</span>];</span><br><span class="line">  v2 = v35[<span class="number">2</span>];</span><br><span class="line">  v3 = *v35;</span><br><span class="line">  v39 = *v35;</span><br><span class="line">  v38 = v1;</span><br><span class="line">  v36 = v2;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)v1 &lt; v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = *((_BYTE *)v1 + v3);</span><br><span class="line">    <span class="keyword">if</span> ( v4 == <span class="string">&#x27;c&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      LOBYTE(v41) = <span class="number">2</span>;</span><br><span class="line">      __FrameHandler3::TryBlockMap::TryBlockMap((__FrameHandler3::TryBlockMap *)v32, v1, v2);</span><br><span class="line">      v25 = &amp;_TI1_AUTC1__;</span><br><span class="line">      v24 = v18;</span><br><span class="line">      v40 = &amp;v24;</span><br><span class="line">      <span class="keyword">if</span> ( *v34 + <span class="number">6</span> &lt;= v34[<span class="number">1</span>] )</span><br><span class="line">      &#123;</span><br><span class="line">        LOBYTE(v41) = <span class="number">4</span>;</span><br><span class="line">        sub_231230(v29, v20, v21, v22, v23);</span><br><span class="line">        v5 = v33;</span><br><span class="line">        <span class="keyword">if</span> ( sub_231150(*v33, v33[<span class="number">1</span>]) )</span><br><span class="line">        &#123;</span><br><span class="line">          v6 = v5[<span class="number">1</span>];</span><br><span class="line">          v7 = <span class="number">10</span> * *v5;</span><br><span class="line">          v8 = (<span class="type">unsigned</span> __int8 *)(v6 + v7 + v5[<span class="number">3</span>]);</span><br><span class="line">          v37 = v8;</span><br><span class="line">          v9 = *v8;</span><br><span class="line">          v10 = *v8;</span><br><span class="line">          <span class="keyword">if</span> ( *v8 )</span><br><span class="line">          &#123;</span><br><span class="line">            v11 = v7 + v6;</span><br><span class="line">            v12 = (<span class="type">unsigned</span> __int8 *)v38 + v39;</span><br><span class="line">            v13 = (<span class="type">unsigned</span> __int8 *)(<span class="number">5</span> * v11 + v5[<span class="number">2</span>]);</span><br><span class="line">            <span class="keyword">if</span> ( (v10 ^ *v13) != *((<span class="type">unsigned</span> __int8 *)v38 + v39 + <span class="number">1</span>)</span><br><span class="line">              || (v10 ^ v13[<span class="number">1</span>]) != v12[<span class="number">2</span>]</span><br><span class="line">              || (v10 ^ v13[<span class="number">2</span>]) != v12[<span class="number">3</span>]</span><br><span class="line">              || (v10 ^ v13[<span class="number">3</span>]) != v12[<span class="number">4</span>]</span><br><span class="line">              || (v10 ^ v13[<span class="number">4</span>]) != v12[<span class="number">5</span>] )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            v8 = v37;</span><br><span class="line">          &#125;</span><br><span class="line">          ++dword_2525DC;</span><br><span class="line">          dword_2525E4 += <span class="number">6</span>;</span><br><span class="line">          *v8 = v9 &amp; <span class="number">0xFE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v4 == <span class="string">&#x27;w&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( sub_2310B0(x - <span class="number">1</span>, y) )</span><br><span class="line">      &#123;</span><br><span class="line">        v14 = x;</span><br><span class="line">        v15 = <span class="number">5</span> * x;</span><br><span class="line">        byte_2518B0[<span class="number">10</span> * x + y] |= <span class="number">0x80</span>u;</span><br><span class="line">        x = v14 - <span class="number">1</span>;</span><br><span class="line">LABEL_33:</span><br><span class="line">        ++dword_2525E4;</span><br><span class="line">        LOBYTE(v41) = <span class="number">6</span>;</span><br><span class="line">        sub_231260(v30, v15, v2, v15);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v4 != <span class="string">&#x27;s&#x27;</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v4 == <span class="string">&#x27;a&#x27;</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( !sub_2310B0(x, y - <span class="number">1</span>) )</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">          v17 = y;</span><br><span class="line">          byte_2518B0[<span class="number">10</span> * x + y] |= <span class="number">0x80</span>u;</span><br><span class="line">          v15 = v17 - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( v4 != <span class="string">&#x27;d&#x27;</span> || !sub_2310B0(x, y + <span class="number">1</span>) )</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">          v19 = y;</span><br><span class="line">          byte_2518B0[<span class="number">10</span> * x + y] |= <span class="number">0x80</span>u;</span><br><span class="line">          v15 = v19 + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        y = v15;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_33;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( sub_2310B0(x + <span class="number">1</span>, y) )</span><br><span class="line">      &#123;</span><br><span class="line">        v16 = x;</span><br><span class="line">        v15 = <span class="number">5</span> * x;</span><br><span class="line">        byte_2518B0[<span class="number">10</span> * x + y] |= <span class="number">0x80</span>u;</span><br><span class="line">        x = v16 + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_33;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个题先是很多try_catch块，对应恢复后，是个迷宫。有五个字符，首先c字符，当当前位置在map中是奇数，后面的5个字符将要进行运算与对比，接下来就是wasd，走迷宫，要求是走的时候map中的值小于0x80</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> TMP_MAX</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span> = [<span class="number">0x61</span>, <span class="number">0x18</span>, <span class="number">0x60</span>, <span class="number">0x54</span>, <span class="number">0x52</span>, <span class="number">0x06</span>, <span class="number">0xD0</span>, <span class="number">0xA8</span>, <span class="number">0x9C</span>, <span class="number">0xCB</span>, <span class="number">0xDA</span>, <span class="number">0xF3</span>, <span class="number">0xE0</span>, <span class="number">0xA6</span>, <span class="number">0xE7</span>, <span class="number">0x60</span>, <span class="number">0xEC</span>, <span class="number">0xDD</span>, <span class="number">0x81</span>, <span class="number">0xE7</span>, <span class="number">0xFD</span>, <span class="number">0xB7</span>, <span class="number">0x71</span>, <span class="number">0x56</span>, <span class="number">0x50</span>, <span class="number">0x30</span>, <span class="number">0xE7</span>, <span class="number">0xD4</span>, <span class="number">0xA0</span>, <span class="number">0xAA</span>, <span class="number">0x88</span>, <span class="number">0xEC</span>, <span class="number">0x62</span>, <span class="number">0xC5</span>, <span class="number">0xE7</span>, <span class="number">0xEE</span>, <span class="number">0xD4</span>, <span class="number">0xF0</span>, <span class="number">0xCC</span>, <span class="number">0xA1</span>, <span class="number">0x94</span>, <span class="number">0x86</span>, <span class="number">0x08</span>, <span class="number">0x50</span>, <span class="number">0x74</span>, <span class="number">0x58</span>, <span class="number">0xA5</span>, <span class="number">0x88</span>, <span class="number">0xE9</span>, <span class="number">0xA7</span>, <span class="number">0x81</span>, <span class="number">0xC0</span>, <span class="number">0x8A</span>, <span class="number">0xE0</span>, <span class="number">0xFC</span>, <span class="number">0x04</span>, <span class="number">0xCF</span>, <span class="number">0xFE</span>, <span class="number">0xBC</span>, <span class="number">0x9A</span>, <span class="number">0xD1</span>, <span class="number">0x85</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x6C</span>, <span class="number">0xC0</span>, <span class="number">0xE6</span>, <span class="number">0xD5</span>, <span class="number">0xCB</span>, <span class="number">0xF3</span>, <span class="number">0xF0</span>, <span class="number">0x8A</span>, <span class="number">0x2C</span>, <span class="number">0xE1</span>, <span class="number">0xF5</span>, <span class="number">0xF7</span>, <span class="number">0xF7</span>, <span class="number">0x97</span>, <span class="number">0xC6</span>, <span class="number">0x9D</span>, <span class="number">0xEA</span>, <span class="number">0xC7</span>, <span class="number">0x40</span>, <span class="number">0x66</span>, <span class="number">0x0A</span>, <span class="number">0x44</span>, <span class="number">0x52</span>, <span class="number">0xD6</span>, <span class="number">0xAD</span>, <span class="number">0xCA</span>, <span class="number">0xBC</span>, <span class="number">0xE5</span>, <span class="number">0xAD</span>, <span class="number">0x84</span>, <span class="number">0x9E</span>, <span class="number">0xF2</span>, <span class="number">0x2A</span>, <span class="number">0x2D</span>, <span class="number">0xDD</span>]</span><br><span class="line">arr = [<span class="number">0x11</span>, <span class="number">0x0B</span>, <span class="number">0x15</span>, <span class="number">0x1B</span>, <span class="number">0x00</span>, <span class="number">0x7C</span>, <span class="number">0x6E</span>, <span class="number">0x69</span>, <span class="number">0x7B</span>, <span class="number">0x77</span>, <span class="number">0x0B</span>, <span class="number">0x16</span>, <span class="number">0x14</span>, <span class="number">0x0E</span>, <span class="number">0x01</span>, <span class="number">0x24</span>, <span class="number">0x22</span>, <span class="number">0x25</span>, <span class="number">0x3A</span>, <span class="number">0x35</span>, <span class="number">0x3F</span>, <span class="number">0x34</span>, <span class="number">0x22</span>, <span class="number">0x2B</span>, <span class="number">0x31</span>, <span class="number">0x6A</span>, <span class="number">0x67</span>, <span class="number">0x72</span>, <span class="number">0x61</span>, <span class="number">0x69</span>, <span class="number">0xB4</span>, <span class="number">0xA1</span>, <span class="number">0xBF</span>, <span class="number">0xA0</span>, <span class="number">0xA8</span>, <span class="number">0xDB</span>, <span class="number">0xDE</span>, <span class="number">0xC1</span>, <span class="number">0xC1</span>, <span class="number">0xD2</span>, <span class="number">0xFD</span>, <span class="number">0xFD</span>, <span class="number">0xEE</span>, <span class="number">0xE5</span>, <span class="number">0xF7</span>, <span class="number">0xAE</span>, <span class="number">0xA1</span>, <span class="number">0xA6</span>, <span class="number">0xBE</span>, <span class="number">0xAA</span>, <span class="number">0xAD</span>, <span class="number">0xA9</span>, <span class="number">0xB0</span>, <span class="number">0xA2</span>, <span class="number">0xB4</span>, <span class="number">0x84</span>, <span class="number">0x98</span>, <span class="number">0x92</span>, <span class="number">0x80</span>, <span class="number">0x9A</span>, <span class="number">0x8E</span>, <span class="number">0x8F</span>, <span class="number">0x82</span>, <span class="number">0x96</span>, <span class="number">0x84</span>, <span class="number">0xC9</span>, <span class="number">0xD5</span>, <span class="number">0xD3</span>, <span class="number">0xD5</span>, <span class="number">0xD5</span>, <span class="number">0x88</span>, <span class="number">0x9D</span>, <span class="number">0x80</span>, <span class="number">0x81</span>, <span class="number">0x92</span>, <span class="number">0x05</span>, <span class="number">0x07</span>, <span class="number">0x19</span>, <span class="number">0x04</span>, <span class="number">0x1A</span>, <span class="number">0x8D</span>, <span class="number">0x98</span>, <span class="number">0x9D</span>, <span class="number">0x98</span>, <span class="number">0x96</span>, <span class="number">0xB6</span>, <span class="number">0xB8</span>, <span class="number">0xAB</span>, <span class="number">0xB9</span>, <span class="number">0xB1</span>, <span class="number">0xE0</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0xE3</span>, <span class="number">0xF8</span>, <span class="number">0x8C</span>, <span class="number">0x8B</span>, <span class="number">0x9F</span>, <span class="number">0x9D</span>, <span class="number">0x96</span>, <span class="number">0x88</span>, <span class="number">0x9E</span>, <span class="number">0x8D</span>, <span class="number">0x96</span>, <span class="number">0x98</span>, <span class="number">0xDB</span>, <span class="number">0xC7</span>, <span class="number">0xD8</span>, <span class="number">0xDD</span>, <span class="number">0xCE</span>, <span class="number">0x15</span>, <span class="number">0x17</span>, <span class="number">0x08</span>, <span class="number">0x1E</span>, <span class="number">0x05</span>, <span class="number">0x34</span>, <span class="number">0x2C</span>, <span class="number">0x24</span>, <span class="number">0x3B</span>, <span class="number">0x3D</span>, <span class="number">0x31</span>, <span class="number">0x38</span>, <span class="number">0x21</span>, <span class="number">0x24</span>, <span class="number">0x21</span>, <span class="number">0x5E</span>, <span class="number">0x56</span>, <span class="number">0x52</span>, <span class="number">0x40</span>, <span class="number">0x58</span>, <span class="number">0x91</span>, <span class="number">0x9E</span>, <span class="number">0x83</span>, <span class="number">0x9E</span>, <span class="number">0x8A</span>, <span class="number">0xA1</span>, <span class="number">0xAC</span>, <span class="number">0xA6</span>, <span class="number">0xAD</span>, <span class="number">0xA7</span>, <span class="number">0xD4</span>, <span class="number">0xC3</span>, <span class="number">0xD2</span>, <span class="number">0xD4</span>, <span class="number">0xD5</span>, <span class="number">0xDC</span>, <span class="number">0xDF</span>, <span class="number">0xC4</span>, <span class="number">0xC2</span>, <span class="number">0xCC</span>, <span class="number">0xEB</span>, <span class="number">0xEC</span>, <span class="number">0xE4</span>, <span class="number">0xEA</span>, <span class="number">0xFC</span>, <span class="number">0x88</span>, <span class="number">0x98</span>, <span class="number">0x8D</span>, <span class="number">0x80</span>, <span class="number">0x9B</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x14</span>, <span class="number">0x11</span>, <span class="number">0xA2</span>, <span class="number">0xA1</span>, <span class="number">0xAE</span>, <span class="number">0xB2</span>, <span class="number">0xA6</span>, <span class="number">0x97</span>, <span class="number">0x84</span>, <span class="number">0x85</span>, <span class="number">0x86</span>, <span class="number">0x9F</span>, <span class="number">0x8A</span>, <span class="number">0x84</span>, <span class="number">0x89</span>, <span class="number">0x8D</span>, <span class="number">0x9E</span>, <span class="number">0xBF</span>, <span class="number">0xBD</span>, <span class="number">0xB8</span>, <span class="number">0xA4</span>, <span class="number">0xB6</span>, <span class="number">0x87</span>, <span class="number">0x98</span>, <span class="number">0x9E</span>, <span class="number">0x9A</span>, <span class="number">0x95</span>, <span class="number">0xB9</span>, <span class="number">0xAD</span>, <span class="number">0xA5</span>, <span class="number">0xB6</span>, <span class="number">0xBD</span>, <span class="number">0xC2</span>, <span class="number">0xC4</span>, <span class="number">0xD7</span>, <span class="number">0xD8</span>, <span class="number">0xC8</span>, <span class="number">0xED</span>, <span class="number">0xE2</span>, <span class="number">0xE3</span>, <span class="number">0xF2</span>, <span class="number">0xF8</span>, <span class="number">0xE5</span>, <span class="number">0xE1</span>, <span class="number">0xFF</span>, <span class="number">0xF7</span>, <span class="number">0xF6</span>, <span class="number">0x71</span>, <span class="number">0x6F</span>, <span class="number">0x6F</span>, <span class="number">0x7E</span>, <span class="number">0x7D</span>, <span class="number">0x3D</span>, <span class="number">0x29</span>, <span class="number">0x26</span>, <span class="number">0x3C</span>, <span class="number">0x27</span>, <span class="number">0x10</span>, <span class="number">0x07</span>, <span class="number">0x1E</span>, <span class="number">0x1D</span>, <span class="number">0x01</span>, <span class="number">0x20</span>, <span class="number">0x29</span>, <span class="number">0x3F</span>, <span class="number">0x2E</span>, <span class="number">0x2D</span>, <span class="number">0xC4</span>, <span class="number">0xDF</span>, <span class="number">0xCC</span>, <span class="number">0xD0</span>, <span class="number">0xDD</span>, <span class="number">0xFE</span>, <span class="number">0xF8</span>, <span class="number">0xEA</span>, <span class="number">0xF2</span>, <span class="number">0xEE</span>, <span class="number">0x81</span>, <span class="number">0x8B</span>, <span class="number">0x88</span>, <span class="number">0x84</span>, <span class="number">0x8E</span>, <span class="number">0xC3</span>, <span class="number">0xCA</span>, <span class="number">0xCE</span>, <span class="number">0xD6</span>, <span class="number">0xC5</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0xE3</span>, <span class="number">0xE9</span>, <span class="number">0xE6</span>, <span class="number">0xAC</span>, <span class="number">0xA7</span>, <span class="number">0xA9</span>, <span class="number">0xB1</span>, <span class="number">0xB0</span>, <span class="number">0xE5</span>, <span class="number">0xFB</span>, <span class="number">0xEB</span>, <span class="number">0xF2</span>, <span class="number">0xE9</span>, <span class="number">0x8C</span>, <span class="number">0x93</span>, <span class="number">0x93</span>, <span class="number">0x88</span>, <span class="number">0x9A</span>, <span class="number">0x8A</span>, <span class="number">0x97</span>, <span class="number">0x9F</span>, <span class="number">0x9A</span>, <span class="number">0x98</span>, <span class="number">0x73</span>, <span class="number">0x67</span>, <span class="number">0x62</span>, <span class="number">0x6C</span>, <span class="number">0x72</span>, <span class="number">0xBF</span>, <span class="number">0xBA</span>, <span class="number">0xBA</span>, <span class="number">0xAD</span>, <span class="number">0xBB</span>, <span class="number">0x9B</span>, <span class="number">0x8E</span>, <span class="number">0x93</span>, <span class="number">0x91</span>, <span class="number">0x96</span>, <span class="number">0xC4</span>, <span class="number">0xCB</span>, <span class="number">0xC6</span>, <span class="number">0xDD</span>, <span class="number">0xD3</span>, <span class="number">0xEE</span>, <span class="number">0xF6</span>, <span class="number">0xFB</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xBD</span>, <span class="number">0xB8</span>, <span class="number">0xBB</span>, <span class="number">0xB4</span>, <span class="number">0xBA</span>, <span class="number">0xE6</span>, <span class="number">0xF5</span>, <span class="number">0xED</span>, <span class="number">0xE0</span>, <span class="number">0xE2</span>, <span class="number">0xEE</span>, <span class="number">0xE3</span>, <span class="number">0xE8</span>, <span class="number">0xF2</span>, <span class="number">0xF2</span>, <span class="number">0x77</span>, <span class="number">0x79</span>, <span class="number">0x62</span>, <span class="number">0x69</span>, <span class="number">0x67</span>, <span class="number">0x79</span>, <span class="number">0x6E</span>, <span class="number">0x60</span>, <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x1E</span>, <span class="number">0x15</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0xAA</span>, <span class="number">0xA9</span>, <span class="number">0xB0</span>, <span class="number">0xAB</span>, <span class="number">0xAD</span>, <span class="number">0x88</span>, <span class="number">0x8E</span>, <span class="number">0x89</span>, <span class="number">0x8F</span>, <span class="number">0x94</span>, <span class="number">0xB1</span>, <span class="number">0xB3</span>, <span class="number">0xA2</span>, <span class="number">0xB7</span>, <span class="number">0xAC</span>, <span class="number">0xA1</span>, <span class="number">0xA0</span>, <span class="number">0xBC</span>, <span class="number">0xB8</span>, <span class="number">0xA5</span>, <span class="number">0x92</span>, <span class="number">0x9B</span>, <span class="number">0x86</span>, <span class="number">0x87</span>, <span class="number">0x89</span>, <span class="number">0x91</span>, <span class="number">0x8A</span>, <span class="number">0x95</span>, <span class="number">0x9E</span>, <span class="number">0x86</span>, <span class="number">0xE2</span>, <span class="number">0xED</span>, <span class="number">0xF3</span>, <span class="number">0xEE</span>, <span class="number">0xFF</span>, <span class="number">0x46</span>, <span class="number">0x46</span>, <span class="number">0x55</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0x8C</span>, <span class="number">0x88</span>, <span class="number">0x82</span>, <span class="number">0x87</span>, <span class="number">0x95</span>, <span class="number">0x93</span>, <span class="number">0x96</span>, <span class="number">0x9E</span>, <span class="number">0x92</span>, <span class="number">0x82</span>, <span class="number">0x95</span>, <span class="number">0x9C</span>, <span class="number">0x83</span>, <span class="number">0x98</span>, <span class="number">0x90</span>, <span class="number">0x9E</span>, <span class="number">0x81</span>, <span class="number">0x87</span>, <span class="number">0x92</span>, <span class="number">0x8E</span>, <span class="number">0xFA</span>, <span class="number">0xE3</span>, <span class="number">0xF5</span>, <span class="number">0xFD</span>, <span class="number">0xE1</span>, <span class="number">0xA1</span>, <span class="number">0xAB</span>, <span class="number">0xAA</span>, <span class="number">0xA4</span>, <span class="number">0xBF</span>, <span class="number">0xEB</span>, <span class="number">0xE4</span>, <span class="number">0xF7</span>, <span class="number">0xF7</span>, <span class="number">0xFC</span>, <span class="number">0x9C</span>, <span class="number">0x89</span>, <span class="number">0x80</span>, <span class="number">0x83</span>, <span class="number">0x9B</span>, <span class="number">0xA2</span>, <span class="number">0xB0</span>, <span class="number">0xB5</span>, <span class="number">0xB4</span>, <span class="number">0xA4</span>, <span class="number">0x35</span>, <span class="number">0x32</span>, <span class="number">0x38</span>, <span class="number">0x23</span>, <span class="number">0x35</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x1F</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x64</span>, <span class="number">0x70</span>, <span class="number">0x64</span>, <span class="number">0x7F</span>, <span class="number">0x65</span>, <span class="number">0x34</span>, <span class="number">0x20</span>, <span class="number">0x28</span>, <span class="number">0x29</span>, <span class="number">0x2B</span>, <span class="number">0x3A</span>, <span class="number">0x27</span>, <span class="number">0x3E</span>, <span class="number">0x27</span>, <span class="number">0x31</span>, <span class="number">0xA4</span>, <span class="number">0xB1</span>, <span class="number">0xBC</span>, <span class="number">0xB4</span>, <span class="number">0xAE</span>, <span class="number">0xCF</span>, <span class="number">0xCF</span>, <span class="number">0xCE</span>, <span class="number">0xDE</span>, <span class="number">0xDF</span>, <span class="number">0xA8</span>, <span class="number">0xB8</span>, <span class="number">0xBD</span>, <span class="number">0xB3</span>, <span class="number">0xB9</span>, <span class="number">0xC5</span>, <span class="number">0xCA</span>, <span class="number">0xD4</span>, <span class="number">0xD8</span>, <span class="number">0xDF</span>, <span class="number">0x87</span>, <span class="number">0x97</span>, <span class="number">0x86</span>, <span class="number">0x80</span>, <span class="number">0x93</span>, <span class="number">0xDC</span>, <span class="number">0xCB</span>, <span class="number">0xDA</span>, <span class="number">0xC2</span>, <span class="number">0xD4</span>, <span class="number">0xF2</span>, <span class="number">0xE7</span>, <span class="number">0xFD</span>, <span class="number">0xEA</span>, <span class="number">0xEE</span>, <span class="number">0xE6</span>, <span class="number">0xE6</span>, <span class="number">0xF9</span>, <span class="number">0xEC</span>, <span class="number">0xFA</span>, <span class="number">0x97</span>, <span class="number">0x9F</span>, <span class="number">0x95</span>, <span class="number">0x93</span>, <span class="number">0x95</span>, <span class="number">0x4B</span>, <span class="number">0x45</span>, <span class="number">0x5B</span>, <span class="number">0x4F</span>, <span class="number">0x45</span>, <span class="number">0x4C</span>, <span class="number">0x48</span>, <span class="number">0x55</span>, <span class="number">0x59</span>, <span class="number">0x5F</span>, <span class="number">0xBF</span>, <span class="number">0xAB</span>, <span class="number">0xBE</span>, <span class="number">0xA8</span>, <span class="number">0xA5</span>]</span><br><span class="line">tmp = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">map</span>)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">map</span>[i] &lt; <span class="number">0x80</span>:</span><br><span class="line">        tmp.append(<span class="built_in">map</span>[i])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">map</span>[i] = <span class="number">0xff</span></span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">map</span>[i*<span class="number">10</span>+j])[<span class="number">2</span>:].zfill(<span class="number">2</span>),end=<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; &quot;</span>)</span><br><span class="line">stra = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">map</span>)):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">map</span>[i]!=<span class="number">0xff</span>):</span><br><span class="line">        tmp=i*<span class="number">5</span></span><br><span class="line">        tmp_str = <span class="string">&quot;c&quot;</span> </span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            tmp_str+=<span class="built_in">chr</span>(<span class="built_in">map</span>[i]^arr[tmp+j])</span><br><span class="line">        stra.append(tmp_str)</span><br><span class="line"><span class="built_in">print</span>(stra)</span><br></pre></td></tr></table></figure>

<p>生成地图和c开头的字符串，只考虑地图<strong>dddddssaaassdddssaassddddsd</strong>，c开头的要筛选，当tmp中是奇数，就是要找的，得到路线<strong>cpjtzadddddssaaacdfyotssdddssacxoahkassddddsdcaextr</strong>，输入得flag。</p>
<h2 id="MTCTF"><a href="#MTCTF" class="headerlink" title="MTCTF"></a>MTCTF</h2><h3 id="small"><a href="#small" class="headerlink" title="small"></a>small</h3><p>直接审汇编，发现不能反汇编，其实将0xea处改为retn就行，该处本来就是exit，所以没问题</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220920155829547.png" alt="image-20220920155829547"></p>
<p>得到返汇编后，发现是一个tea加密</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall sub_67(__int64 a1,<span class="built_in"> int </span>a2)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned<span class="built_in"> int </span>v2; // eax</span><br><span class="line"> <span class="built_in"> int </span>v3; // ebx</span><br><span class="line"> <span class="built_in"> int </span>v4; // ebp</span><br><span class="line"> <span class="built_in"> int </span>v5; // edi</span><br><span class="line">  _BYTE *v6; // rsi</span><br><span class="line">  unsigned<span class="built_in"> int </span>v7; // ebp</span><br><span class="line"> <span class="built_in"> int </span>v8; // edi</span><br><span class="line">  _BYTE *result; // rax</span><br><span class="line"> <span class="built_in"> int </span>v10; // esi</span><br><span class="line"> <span class="built_in"> int </span>v11; // [rsp+10h] [rbp+10h]</span><br><span class="line"></span><br><span class="line">  *(_BYTE *)(a1 + 1159922115) += v2;</span><br><span class="line">  v7 = ((v3 + v5) ^ ((v2 &gt;&gt; 5) + 35) ^ (16 * a1 + 1)) + v4;</span><br><span class="line">  v8 = ((v3 + v7) ^ (16 * v7 + 69) ^ ((v7 &gt;&gt; 5) + 103)) + v5;</span><br><span class="line"> <span class="built_in"> if </span>( a2 + 1 &lt; 35 )</span><br><span class="line">    JUMPOUT(0x52i64);</span><br><span class="line">  *((_DWORD *)v6 - 2) = v7;</span><br><span class="line">  *((_DWORD *)v6 - 1) = v8;</span><br><span class="line"> <span class="built_in"> if </span>( (int)v6 &lt; v11 + 32 )</span><br><span class="line">    JUMPOUT(0x1Ci64);</span><br><span class="line">  result = v6;</span><br><span class="line">  v10 = 32;</span><br><span class="line">  while ( *(_BYTE *)(unsigned int)(v10 + 65783) == *result )</span><br><span class="line">  &#123;</span><br><span class="line">    --v10;</span><br><span class="line">    --result;</span><br><span class="line">   <span class="built_in"> if </span>( !v10 )</span><br><span class="line">    &#123;</span><br><span class="line">      result = (_BYTE *)(&amp;loc_0 + 1);</span><br><span class="line">      __asm &#123; syscall; Low latency<span class="keyword"> system</span> call &#125;</span><br><span class="line">     <span class="built_in"> return </span>result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="built_in"> return </span>result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//加密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//解密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0x67452301</span>*<span class="number">35</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x67452301</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">35</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[]=&#123;<span class="number">0xDE087143</span>, <span class="number">0xC4F91BD2</span>, <span class="number">0xDAF6DADC</span>, <span class="number">0x6D9ED54C</span>, <span class="number">0x75EB4EE7</span>, <span class="number">0x5D1DDC04</span>, <span class="number">0x511B0FD9</span>, <span class="number">0x51DC88FB</span>&#125;,k[<span class="number">4</span>]=&#123;<span class="number">0x01</span>,<span class="number">0x23</span>,<span class="number">0x45</span>,<span class="number">0x67</span>&#125;;</span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i+=<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        decrypt(v+i, k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[i],v[<span class="number">1</span>+i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag&#123;327a6c4304ad5938eaf0efb6cc3e53dc&#125;</span></span><br></pre></td></tr></table></figure>

<p>delta是0x67452301，很简单。</p>
<h2 id="DASCTF"><a href="#DASCTF" class="headerlink" title="DASCTF"></a>DASCTF</h2><h3 id="landing"><a href="#landing" class="headerlink" title="landing"></a>landing</h3><p>这题还是很简单的，就是try、catch</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">std</span>::ostream *v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="built_in">std</span>::ostream *v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">32</span>]; <span class="comment">// [rsp+450h] [rbp+3D0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+48Ch] [rbp+40Ch]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  v3 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;Input something.&quot;</span>);</span><br><span class="line">  refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_(v3);</span><br><span class="line">  <span class="built_in">std</span>::operator&gt;&gt;&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt3cin, Str);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(Str) == <span class="number">28</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">27</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      Str[i] ^= <span class="number">0x22</span>u;</span><br><span class="line">      ++Str[i];</span><br><span class="line">    &#125;</span><br><span class="line">    func1(Str);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;nono&quot;</span>);</span><br><span class="line">    refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_(v4);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主程序是这样的，func1里是一个base64加密不过是骗人的，发现func1处有一个try块，找到对应catch块，然后patch一下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">std</span>::ostream *v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  <span class="built_in">std</span>::ostream *v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">size_t</span> v7; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">void</span> *v8; <span class="comment">// rsp</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">size_t</span> v10; <span class="comment">// rax</span></span><br><span class="line">  <span class="built_in">std</span>::ostream *v11; <span class="comment">// rax</span></span><br><span class="line">  <span class="built_in">std</span>::ostream *v12; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v13[<span class="number">15</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v14[<span class="number">25</span>]; <span class="comment">// [rsp+2Fh] [rbp-51h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str1[<span class="number">1024</span>]; <span class="comment">// [rsp+50h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">32</span>]; <span class="comment">// [rsp+450h] [rbp+3D0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *Str2; <span class="comment">// [rsp+470h] [rbp+3F0h]</span></span><br><span class="line">  <span class="type">size_t</span> v18; <span class="comment">// [rsp+478h] [rbp+3F8h]</span></span><br><span class="line">  <span class="type">void</span> *v19; <span class="comment">// [rsp+480h] [rbp+400h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+488h] [rbp+408h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+48Ch] [rbp+40Ch]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  v3 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;Input something.&quot;</span>);</span><br><span class="line">  refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_(v3);</span><br><span class="line">  <span class="built_in">std</span>::operator&gt;&gt;&lt;<span class="type">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt3cin, Str);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(Str) == <span class="number">28</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">27</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      Str[i] ^= <span class="number">0x22</span>u;</span><br><span class="line">      v4 = (<span class="type">unsigned</span> <span class="type">int</span>)(<span class="type">unsigned</span> __int8)Str[i]++ + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v4 == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v19 = _cxa_begin_catch(Str);</span><br><span class="line">      qmemcpy(v13, <span class="string">&quot;GUw\\D~UHG#kYG~&quot;</span>, <span class="number">14</span>);</span><br><span class="line">      v13[<span class="number">14</span>] = <span class="number">127</span>;</span><br><span class="line">      qmemcpy(v14, <span class="string">&quot;BA#&#123;QJT(\\A &#123;BG~$BG~$BGz//&quot;</span>, <span class="keyword">sizeof</span>(v14));</span><br><span class="line">      v7 = <span class="built_in">strlen</span>(v13);</span><br><span class="line">      v18 = v7 - <span class="number">1</span>;</span><br><span class="line">      v8 = alloca(<span class="number">16</span> * ((v7 + <span class="number">15</span>) &gt;&gt; <span class="number">4</span>));</span><br><span class="line">      Str2 = v13;</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(v13); ++j )</span><br><span class="line">        Str2[j] = v13[j] ^ <span class="number">0x12</span>;</span><br><span class="line">      v9 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">      nothing(Str1, Str, v9);</span><br><span class="line">      v10 = <span class="built_in">strlen</span>(Str2);</span><br><span class="line">      <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(Str1, Str2, v10) )</span><br><span class="line">        v11 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(</span><br><span class="line">                                refptr__ZSt4cout,</span><br><span class="line">                                <span class="string">&quot;Goodgood!\n...Please packed the flag with\&quot;DASCTF&#123;&#125;\&quot;&quot;</span>);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        v11 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;nono&quot;</span>);</span><br><span class="line">      refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_(v11);</span><br><span class="line">      system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">      _cxa_end_catch();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      _cxa_begin_catch(Str);</span><br><span class="line">      v12 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;nono&quot;</span>);</span><br><span class="line">      refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_(v12);</span><br><span class="line">      system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">      _cxa_end_catch();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5 = (<span class="built_in">std</span>::ostream *)<span class="built_in">std</span>::operator&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="type">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="string">&quot;nono&quot;</span>);</span><br><span class="line">    refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_(v5);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这时主加密其实很清楚就是对一个初始化的对比密文的操作，而对我们输入进行操作的是在nothing里，nothing这个函数点个U就可以看了，发现是个base64，一眼魔改。</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">void __fastcall nothing(char *a1,<span class="built_in"> const </span>char *a2,<span class="built_in"> int </span>a3)</span><br><span class="line">&#123;</span><br><span class="line">  char *v3; // rax</span><br><span class="line">  char *v4; // rax</span><br><span class="line">  char *v5; // rax</span><br><span class="line">  char *v6; // rax</span><br><span class="line">  unsigned __int64 i; // [rsp+8h] [rbp-18h]</span><br><span class="line"> <span class="built_in"> int </span>v8; // [rsp+14h] [rbp-Ch]</span><br><span class="line"> <span class="built_in"> int </span>v9; // [rsp+18h] [rbp-8h]</span><br><span class="line"> <span class="built_in"> int </span>v10; // [rsp+1Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  v10 = 0;</span><br><span class="line">  v9 = 2;</span><br><span class="line">  for ( i = 0i64; a3 &gt; i; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    switch ( v9 )</span><br><span class="line">    &#123;</span><br><span class="line">      case 2:</span><br><span class="line">        v8 = (*a2 &gt;&gt; 2) &amp; 0x3F;</span><br><span class="line">        break;</span><br><span class="line">      case 4:</span><br><span class="line">        v8 = (*a2 &gt;&gt; 4) &amp; 0xF;</span><br><span class="line">        break;</span><br><span class="line">      case 6:</span><br><span class="line">        v8 = (*a2 &gt;&gt; 6) &amp; 3;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    v8 += v10;</span><br><span class="line">    v3 = a1++;</span><br><span class="line">    *v3 = nothing(char *,char const*,int)::aaa[v8] + 1;</span><br><span class="line">    v10 = (*a2 &lt;&lt; (6 - v9)) &amp; 0x3F;</span><br><span class="line">    v9 += 2;</span><br><span class="line">   <span class="built_in"> if </span>( v9 == 8 )</span><br><span class="line">    &#123;</span><br><span class="line">      v8 = *a2 &amp; 0x3F;</span><br><span class="line">      v4 = a1++;</span><br><span class="line">      *v4 = nothing(char *,char const*,int)::aaa[*a2 &amp; 0x3F] + 1;</span><br><span class="line">      v10 = 0;</span><br><span class="line">      v9 = 2;</span><br><span class="line">    &#125;</span><br><span class="line">    ++a2;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="built_in"> if </span>( v10 )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = a1++;</span><br><span class="line">    *v5 = nothing(char *,char const*,int)::aaa[v10] + 1;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="built_in"> if </span>( a3 % 3 == 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = a1++;</span><br><span class="line">    *v6 = 61;</span><br><span class="line">    *a1 = 61;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="built_in"> if </span>( a3 % 3 == 2 )</span><br><span class="line">    *a1 = 61;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很明显在赋值的时候给每个base64后的数加了1，那么我们就很清楚加密流程了。输入-&gt;异或-&gt;加1-&gt;base64-&gt;加1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&#x27;UGeNVlGZU1yKUlmPS1iCXF:NS2iPUl6PUl6PUh&#x27;</span></span><br><span class="line">flag11 = <span class="string">&quot;&quot;</span></span><br><span class="line">flag=[<span class="number">0</span>]*<span class="number">28</span></span><br><span class="line">flag1=<span class="string">&#x27;LWLRAXOLININGHAXOLGXNNNNNNNN&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(a[i]) - <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">28</span>):</span><br><span class="line">    flag[i] = <span class="built_in">ord</span>(flag1[i]) - <span class="number">1</span></span><br><span class="line">    flag[i] ^=<span class="number">0x22</span></span><br><span class="line">    flag11+=<span class="built_in">chr</span>(flag[i])</span><br><span class="line"><span class="built_in">print</span>(flag11)</span><br></pre></td></tr></table></figure>

<h3 id="cbNET"><a href="#cbNET" class="headerlink" title="cbNET"></a>cbNET</h3><p>c#逆向</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">method_3</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">string</span> text = <span class="keyword">this</span>.vmethod_0().Text;</span><br><span class="line">	<span class="built_in">string</span>[] array = <span class="keyword">new</span> <span class="built_in">string</span>[<span class="number">24</span>];</span><br><span class="line">	<span class="built_in">int</span>[] array2 = <span class="keyword">new</span> <span class="built_in">int</span>[]</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="number">309</span>,</span><br><span class="line">		<span class="number">1981</span>,</span><br><span class="line">		<span class="number">2823</span>,</span><br><span class="line">		<span class="number">6979</span>,</span><br><span class="line">		<span class="number">28339</span>,</span><br><span class="line">		<span class="number">39487</span>,</span><br><span class="line">		<span class="number">33035</span>,</span><br><span class="line">		<span class="number">283711</span>,</span><br><span class="line">		<span class="number">623</span>,</span><br><span class="line">		<span class="number">4109</span>,</span><br><span class="line">		<span class="number">23551</span>,</span><br><span class="line">		<span class="number">54761</span>,</span><br><span class="line">		<span class="number">67985</span>,</span><br><span class="line">		<span class="number">231149</span>,</span><br><span class="line">		<span class="number">499603</span>,</span><br><span class="line">		<span class="number">1354567</span>,</span><br><span class="line">		<span class="number">213</span>,</span><br><span class="line">		<span class="number">2651</span>,</span><br><span class="line">		<span class="number">22559</span>,</span><br><span class="line">		<span class="number">52549</span>,</span><br><span class="line">		<span class="number">484663</span>,</span><br><span class="line">		<span class="number">290793</span>,</span><br><span class="line">		<span class="number">532213</span>,</span><br><span class="line">		<span class="number">1746643</span></span><br><span class="line">	&#125;;</span><br><span class="line">	checked</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (text.Length != array2.Length + <span class="number">7</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>.vmethod_2().Content = <span class="string">&quot;wrong&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (Operators.CompareString(Strings.Mid(text, <span class="number">1</span>, <span class="number">6</span>), <span class="string">&quot;CBCTF&#123;&quot;</span>, <span class="literal">false</span>) != <span class="number">0</span> | Operators.CompareString(Strings.Mid(text, array2.Length + <span class="number">7</span>, <span class="number">1</span>), <span class="string">&quot;&#125;&quot;</span>, <span class="literal">false</span>) != <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>.vmethod_2().Content = <span class="string">&quot;wrong&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>.method_0(<span class="keyword">ref</span> array, text);</span><br><span class="line">			<span class="keyword">this</span>.method_2(<span class="keyword">ref</span> array);</span><br><span class="line">			<span class="built_in">int</span> num = array2.Length - <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt;= num; i++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (Conversions.ToDouble(array[i]) != (<span class="built_in">double</span>)array2[i])</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">this</span>.vmethod_2().Content = <span class="string">&quot;wrong&quot;</span>;</span><br><span class="line">					<span class="keyword">return</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">this</span>.vmethod_2().Content = <span class="string">&quot;correct&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">object</span> <span class="title">method_2</span>(<span class="params"><span class="keyword">ref</span> <span class="built_in">string</span>[] string_0</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">int</span> num = checked(string_0.Length - <span class="number">1</span>);</span><br><span class="line">		<span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (i &lt;= num)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">try</span></span><br><span class="line">			&#123;</span><br><span class="line">				string_0[i] = Conversions.ToString((<span class="built_in">double</span>)(Conversions.ToLong(string_0[i]) ^ Conversions.ToLong(string_0[checked(i - <span class="number">1</span>)]) / (<span class="built_in">long</span>)(i % <span class="number">8</span>)) + Conversions.ToDouble(string_0[checked(i - <span class="number">1</span>)]) % (<span class="built_in">double</span>)(i % <span class="number">8</span>));</span><br><span class="line">				<span class="keyword">goto</span> IL_F3;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">catch</span> (Exception ex)</span><br><span class="line">			&#123;</span><br><span class="line">				string_0[i] = Conversions.ToString((<span class="built_in">double</span>)(Conversions.ToLong(string_0[i]) ^ Conversions.ToLong(string_0[checked(i + <span class="number">7</span>)]) / <span class="number">8L</span>) + Conversions.ToDouble(string_0[checked(i + <span class="number">7</span>)]) % <span class="number">8.0</span>);</span><br><span class="line">				<span class="keyword">goto</span> IL_F3;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">goto</span> IL_98;</span><br><span class="line">			IL_EA:</span><br><span class="line">			<span class="built_in">double</span> num2;</span><br><span class="line">			<span class="built_in">double</span> num3;</span><br><span class="line">			checked</span><br><span class="line">			&#123;</span><br><span class="line">				i++;</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">				IL_CE:</span><br><span class="line">				<span class="keyword">if</span> (num2 &gt; num3)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">goto</span> IL_EA;</span><br><span class="line">				&#125;</span><br><span class="line">				IL_98:;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (checked(<span class="keyword">this</span>.method_1((<span class="built_in">int</span>)Math.Round(num2)) &amp; <span class="keyword">this</span>.method_1((<span class="built_in">int</span>)Math.Round(<span class="keyword">unchecked</span>(Conversions.ToDouble(string_0[i]) - num2)))) == <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				num2 += <span class="number">1.0</span>;</span><br><span class="line">				<span class="keyword">goto</span> IL_CE;</span><br><span class="line">			&#125;</span><br><span class="line">			string_0[i] = Conversions.ToString(num2 * (Conversions.ToDouble(string_0[i]) - num2));</span><br><span class="line">			<span class="keyword">goto</span> IL_EA;</span><br><span class="line">			IL_F3:</span><br><span class="line">			string_0[i] = Conversions.ToString(Conversions.ToDouble(string_0[i]) - <span class="number">2.0</span> - Conversions.ToDouble(string_0[i]) % <span class="number">2.0</span>);</span><br><span class="line">			num3 = Conversions.ToDouble(string_0[i]) - <span class="number">2.0</span>;</span><br><span class="line">			num2 = <span class="number">2.0</span>;</span><br><span class="line">			<span class="keyword">goto</span> IL_CE;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">int</span> <span class="title">method_1</span>(<span class="params"><span class="built_in">int</span> int_0</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		checked</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">int</span> result;</span><br><span class="line">			<span class="keyword">if</span> (int_0 &lt; <span class="number">2</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				result = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">int</span> num = int_0 - <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">2</span>; i &lt;= num; i++)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">if</span> (int_0 % i == <span class="number">0</span>)</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				result = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> result;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">object</span> <span class="title">method_0</span>(<span class="params"><span class="keyword">ref</span> <span class="built_in">string</span>[] string_0, <span class="built_in">string</span> string_1</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">string</span> text = <span class="string">&quot;0rays&quot;</span>;</span><br><span class="line">		<span class="built_in">int</span> num = <span class="number">0</span>;</span><br><span class="line">		checked</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">int</span> num2 = string_1.Length - <span class="number">2</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">6</span>; i &lt;= num2; i++)</span><br><span class="line">			&#123;</span><br><span class="line">				string_0[i - <span class="number">6</span>] = Conversions.ToString(string_1[i]);</span><br><span class="line">				string_0[i - <span class="number">6</span>] = Conversions.ToString(Strings.Asc(string_0[i - <span class="number">6</span>]) ^ Strings.Asc(text[num]));</span><br><span class="line">				num = (num + <span class="number">1</span> ^ <span class="number">5</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>这个题是真坐牢啊，脚本跑不对，真的难受</p>
<p>学习一下官方wp，如何爆破这种类型题目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isPrime</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n % i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xordecrypt</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&quot;0rays&quot;</span></span><br><span class="line">    circle = <span class="number">0</span></span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">        flag = flag + <span class="built_in">chr</span>(key[i] ^ <span class="built_in">ord</span>(<span class="built_in">str</span>[circle]))</span><br><span class="line">        circle = (circle + <span class="number">1</span>) ^ <span class="number">5</span></span><br><span class="line">    flag = <span class="string">&quot;CBCTF&#123;&quot;</span> + flag + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">    t = hashlib.sha256()</span><br><span class="line">    t.update(flag.encode())</span><br><span class="line">    finalflag = t.hexdigest()</span><br><span class="line">    <span class="keyword">if</span> finalflag == <span class="string">&quot;15c4ac7645546a1ef8141441b48e1824954fdbb159bf96400061b17db1af9edf&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recursion</span>(<span class="params">key2, i</span>):</span><br><span class="line">    key = key2.copy()</span><br><span class="line">    <span class="keyword">if</span> (i % <span class="number">8</span>) != <span class="number">0</span>:</span><br><span class="line">        key[i] = (key[i] - key[i - <span class="number">1</span>] % (i % <span class="number">8</span>)) ^ (key[i - <span class="number">1</span>] // (i % <span class="number">8</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        key[i] = (key[i] - key[i + <span class="number">7</span>] % <span class="number">8</span>) ^ (key[i + <span class="number">7</span>] // <span class="number">8</span>)</span><br><span class="line">    <span class="keyword">if</span> i != <span class="number">0</span>:</span><br><span class="line">        decrypt(key, i - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        xordecrypt(key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">key1, i</span>):</span><br><span class="line">    key = key1.copy()</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, key[i] - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> key[i] % j == <span class="number">0</span> <span class="keyword">and</span> isPrime(j) <span class="keyword">and</span> isPrime(key[i] // j): <span class="comment"># key[i] % j == 0 因为指数相乘所以是肯定余数为0</span></span><br><span class="line">            key[i] = j + key[i] // j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    key[i] = key[i] + <span class="number">2</span> <span class="comment">#+2或者+1都进行测试</span></span><br><span class="line">    recursion(key, i)</span><br><span class="line">    key[i] = key[i] + <span class="number">1</span> </span><br><span class="line">    recursion(key, i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = [<span class="number">309</span>, <span class="number">1981</span>, <span class="number">2823</span>, <span class="number">6979</span>, <span class="number">28339</span>, <span class="number">39487</span>, <span class="number">33035</span>, <span class="number">283711</span>, <span class="number">623</span>, <span class="number">4109</span>, <span class="number">23551</span>, <span class="number">54761</span>, <span class="number">67985</span>, <span class="number">231149</span>, <span class="number">499603</span>, <span class="number">1354567</span>, <span class="number">213</span>, <span class="number">2651</span>, <span class="number">22559</span>, <span class="number">52549</span>, <span class="number">484663</span>, <span class="number">290793</span>, <span class="number">532213</span>, <span class="number">1746643</span>]</span><br><span class="line">decrypt(key, <span class="number">23</span>) </span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/09/11/%E7%BD%91%E9%BC%8E%E6%9D%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/09/11/%E7%BD%91%E9%BC%8E%E6%9D%AF/" class="post-title-link" itemprop="url">网鼎杯</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-09-11 16:25:05 / 修改时间：16:34:41" itemprop="dateCreated datePublished" datetime="2022-09-11T16:25:05+08:00">2022-09-11</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="网鼎杯"><a href="#网鼎杯" class="headerlink" title="网鼎杯"></a>网鼎杯</h1><p>这次网鼎杯总共3道re，出了两道，第三道出了一半卡在了写脚本，总之还是不错的。</p>
<h2 id="fakeshell"><a href="#fakeshell" class="headerlink" title="fakeshell"></a>fakeshell</h2><p>很简单的一道题，主要是setjmp和longjmp这个知识点，已经做了三次这种题了，经过调试发现是一个加法和一个异或然后进行对比，直接给出脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cmp = [<span class="number">0x0000004B</span>, <span class="number">0x00000048</span>, <span class="number">0x00000079</span>, <span class="number">0x00000013</span>, <span class="number">0x00000045</span>, <span class="number">0x00000030</span>, <span class="number">0x0000005C</span>, <span class="number">0x00000049</span>, <span class="number">0x0000005A</span>, <span class="number">0x00000079</span>, <span class="number">0x00000013</span>, <span class="number">0x00000070</span>, <span class="number">0x0000006D</span>, <span class="number">0x00000078</span>, <span class="number">0x00000013</span>, <span class="number">0x0000006F</span>, <span class="number">0x00000048</span>, <span class="number">0x0000005D</span>, <span class="number">0x00000064</span>, <span class="number">0x00000064</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cmp)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(((cmp[i]^<span class="number">0x50</span>)-<span class="number">10</span>)^<span class="number">0x66</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="handmake"><a href="#handmake" class="headerlink" title="handmake"></a>handmake</h2><p>纯纯动脑子题，一眼看出是个go语言，本来想着慢慢找，但发现他们都做的很快，其实可以直接改几处源码就行，15k行只用改main就行，将要得到的值输出就行。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> nFAzj, CuSkl <span class="type">string</span></span><br><span class="line">	jjxXf := []<span class="type">byte</span>&#123;</span><br><span class="line">		<span class="number">37</span>, <span class="number">73</span>, <span class="number">151</span>, <span class="number">135</span>, <span class="number">65</span>, <span class="number">58</span>, <span class="number">241</span>, <span class="number">90</span>, <span class="number">33</span>, <span class="number">86</span>, <span class="number">71</span>, <span class="number">41</span>, <span class="number">102</span>, <span class="number">241</span>, <span class="number">213</span>, <span class="number">234</span>, <span class="number">67</span>, <span class="number">144</span>, <span class="number">139</span>, <span class="number">20</span>, <span class="number">112</span>, <span class="number">150</span>, <span class="number">41</span>, <span class="number">7</span>, <span class="number">158</span>, <span class="number">251</span>, <span class="number">167</span>, <span class="number">249</span>, <span class="number">24</span>, <span class="number">129</span>, <span class="number">72</span>, <span class="number">64</span>, <span class="number">83</span>, <span class="number">142</span>, <span class="number">166</span>, <span class="number">236</span>, <span class="number">67</span>, <span class="number">18</span>, <span class="number">211</span>, <span class="number">100</span>, <span class="number">91</span>, <span class="number">38</span>, <span class="number">83</span>, <span class="number">147</span>, <span class="number">40</span>, <span class="number">78</span>, <span class="number">239</span>, <span class="number">113</span>, <span class="number">232</span>, <span class="number">83</span>, <span class="number">227</span>, <span class="number">47</span>, <span class="number">192</span>, <span class="number">227</span>, <span class="number">70</span>, <span class="number">167</span>, <span class="number">201</span>, <span class="number">249</span>, <span class="number">156</span>, <span class="number">101</span>, <span class="number">216</span>, <span class="number">159</span>, <span class="number">116</span>, <span class="number">210</span>, <span class="number">152</span>, <span class="number">234</span>, <span class="number">38</span>, <span class="number">145</span>, <span class="number">198</span>, <span class="number">58</span>, <span class="number">24</span>, <span class="number">183</span>, <span class="number">72</span>, <span class="number">143</span>, <span class="number">136</span>, <span class="number">234</span>, <span class="number">246</span>&#125;</span><br><span class="line">	KdlaH := []<span class="type">byte</span>&#123;</span><br><span class="line">		<span class="number">191</span>, <span class="number">140</span>, <span class="number">114</span>, <span class="number">245</span>, <span class="number">142</span>, <span class="number">55</span>, <span class="number">190</span>, <span class="number">30</span>, <span class="number">161</span>, <span class="number">18</span>, <span class="number">200</span>, <span class="number">7</span>, <span class="number">21</span>, <span class="number">59</span>, <span class="number">17</span>, <span class="number">44</span>, <span class="number">34</span>, <span class="number">181</span>, <span class="number">109</span>, <span class="number">116</span>, <span class="number">146</span>, <span class="number">145</span>, <span class="number">189</span>, <span class="number">68</span>, <span class="number">142</span>, <span class="number">113</span>, <span class="number">0</span>, <span class="number">33</span>, <span class="number">46</span>, <span class="number">184</span>, <span class="number">21</span>, <span class="number">33</span>, <span class="number">66</span>, <span class="number">99</span>, <span class="number">124</span>, <span class="number">167</span>, <span class="number">201</span>, <span class="number">88</span>, <span class="number">133</span>, <span class="number">20</span>, <span class="number">211</span>, <span class="number">67</span>, <span class="number">133</span>, <span class="number">250</span>, <span class="number">62</span>, <span class="number">28</span>, <span class="number">138</span>, <span class="number">229</span>, <span class="number">105</span>, <span class="number">102</span>, <span class="number">125</span>, <span class="number">124</span>, <span class="number">208</span>, <span class="number">180</span>, <span class="number">50</span>, <span class="number">146</span>, <span class="number">67</span>, <span class="number">39</span>, <span class="number">55</span>, <span class="number">240</span>, <span class="number">239</span>, <span class="number">203</span>, <span class="number">230</span>, <span class="number">142</span>, <span class="number">20</span>, <span class="number">90</span>, <span class="number">205</span>, <span class="number">27</span>, <span class="number">128</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">140</span>, <span class="number">222</span>, <span class="number">92</span>, <span class="number">152</span>, <span class="number">1</span>, <span class="number">222</span>, <span class="number">138</span>, <span class="number">254</span>, <span class="number">246</span>, <span class="number">223</span>, <span class="number">224</span>, <span class="number">236</span>, <span class="number">33</span>, <span class="number">60</span>, <span class="number">170</span>, <span class="number">189</span>, <span class="number">77</span>, <span class="number">124</span>, <span class="number">72</span>, <span class="number">135</span>, <span class="number">46</span>, <span class="number">235</span>, <span class="number">17</span>, <span class="number">32</span>, <span class="number">28</span>, <span class="number">245</span>&#125;</span><br><span class="line">	fmt.Print(MPyt9GWTRfAFNvb1(jjxXf))</span><br><span class="line">	fmt.Scanf(<span class="string">&quot;%20s\n&quot;</span>, &amp;nFAzj)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;First scanf: %s\n&quot;</span>, nFAzj)</span><br><span class="line">	fmt.Print(kZ2BFvOxepd5ALDR(KdlaH))</span><br><span class="line">	fmt.Scanf(<span class="string">&quot;%20s&quot;</span>, &amp;CuSkl)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Second Scanf: %s\n&quot;</span>, CuSkl)</span><br><span class="line">	vNvUO := GwSqNHQ7dPXpIG64(nFAzj)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;vNvUO %s\n&quot;</span>, vNvUO)</span><br><span class="line">	YJCya := <span class="string">&quot;&quot;</span></span><br><span class="line">	mvOxK := YI3z8ZxOKhfLmTPC(CuSkl)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;mvOxK %s\n&quot;</span>, mvOxK)</span><br><span class="line">	<span class="keyword">if</span> mvOxK != <span class="literal">nil</span> &#123;</span><br><span class="line">		YJCya = mvOxK()</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> YJCya != <span class="string">&quot;&quot;</span> &amp;&amp; vNvUO != <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;flag&#123;%s%s&#125;\n&quot;</span>, vNvUO, YJCya)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Input the first function, which has <span class="number">6</span> parameters and the third named gLIhR: </span><br><span class="line">ZlXDJkH3OZN4Mayd</span><br><span class="line">First scanf: ZlXDJkH3OZN4Mayd</span><br><span class="line">Input the second function, which has <span class="number">3</span> callers and invokes the function named cHZv5op8rOmlAkb6:</span><br><span class="line">YsMgm9rKB7qiuQ1d</span><br><span class="line">Second Scanf: YsMgm9rKB7qiuQ1d</span><br><span class="line">vNvUO <span class="number">3</span>a4e76449355c414</span><br><span class="line"></span><br><span class="line">mvOxK %!s(main.dIWKr=<span class="number">0x877d80</span>)</span><br><span class="line">flag&#123;<span class="number">3</span>a4e76449355c4148ce3da2b46019f75&#125;</span><br></pre></td></tr></table></figure>

<h2 id="whereiscode"><a href="#whereiscode" class="headerlink" title="whereiscode"></a>whereiscode</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/08/30/test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/30/test/" class="post-title-link" itemprop="url">test</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-08-30 19:21:57" itemprop="dateCreated datePublished" datetime="2022-08-30T19:21:57+08:00">2022-08-30</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/08/02/qwb2022/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/02/qwb2022/" class="post-title-link" itemprop="url">qwb2022</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-08-02 00:52:33" itemprop="dateCreated datePublished" datetime="2022-08-02T00:52:33+08:00">2022-08-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-30 16:21:51" itemprop="dateModified" datetime="2022-08-30T16:21:51+08:00">2022-08-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="qwb2022"><a href="#qwb2022" class="headerlink" title="qwb2022"></a>qwb2022</h1><p>这次还是很坐牢，但跟师傅们学习到了很多方法</p>
<h2 id="deeprev"><a href="#deeprev" class="headerlink" title="deeprev"></a>deeprev</h2><p>我们会发现，这个题给了个libsecret.so文件和deeprev文件，deeprev里很清楚，只要check函数等于0就行，但在程序中根本找不到check函数。经搜索发现是GoogleCTF改编题，直接跑下面脚本，把关于flag的运算直接跑出来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Author: hgarrereyn</span></span><br><span class="line"><span class="comment"># Desc: Lifter solution for GoogleCTF 2022 eldar</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lief</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Any</span></span><br><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">md = Cs(CS_ARCH_X86, CS_MODE_64)</span><br><span class="line"></span><br><span class="line">b = <span class="literal">None</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    b = lief.ELF.parse(<span class="string">&#x27;./deeprev&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&#x27;Must have the ./eldar binary in cwd&#x27;</span>)</span><br><span class="line"></span><br><span class="line">rela = [x <span class="keyword">for</span> x <span class="keyword">in</span> b.sections <span class="keyword">if</span> x.name == <span class="string">&#x27;.rela.dyn&#x27;</span>][<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(rela)</span><br><span class="line">dynsym = [x <span class="keyword">for</span> x <span class="keyword">in</span> b.sections <span class="keyword">if</span> x.name == <span class="string">&#x27;.dynsym&#x27;</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Symbol</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    idx: <span class="built_in">int</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;s<span class="subst">&#123;self.idx&#125;</span>&#x27;</span></span><br><span class="line">        </span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Reloc</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    idx: <span class="built_in">int</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;r<span class="subst">&#123;self.idx&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Ref</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    val: <span class="type">Any</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;&amp;<span class="subst">&#123;self.val&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SymAddr</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    sym: Symbol</span><br><span class="line">    field: <span class="built_in">str</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;self.sym&#125;</span>.<span class="subst">&#123;self.field&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RelocAddr</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    reloc: Reloc</span><br><span class="line">    field: <span class="built_in">str</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;self.reloc&#125;</span>.<span class="subst">&#123;self.field&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">vaddr</span>(<span class="params">self</span>):</span><br><span class="line">        off = <span class="number">0</span></span><br><span class="line">        match self.field:</span><br><span class="line">            case <span class="string">&#x27;r_address&#x27;</span>:off = <span class="number">0</span></span><br><span class="line">            case <span class="string">&#x27;r_info&#x27;</span>: off = <span class="number">8</span></span><br><span class="line">            case <span class="string">&#x27;r_addend&#x27;</span>: off = <span class="number">16</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> (self.reloc.idx * <span class="number">24</span>) + off + rela.virtual_address</span><br><span class="line">    </span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FlagAddr</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    idx: <span class="built_in">int</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;flag[<span class="subst">&#123;self.idx&#125;</span>]&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OutAddr</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    idx: <span class="built_in">int</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;out[<span class="subst">&#123;self.idx&#125;</span>]&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ArrAddr</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    idx: <span class="built_in">int</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;arr[<span class="subst">&#123;self.idx&#125;</span>]&#x27;</span></span><br><span class="line"></span><br><span class="line">BaseAddr = namedtuple(<span class="string">&#x27;baseaddr&#x27;</span>, [])</span><br><span class="line">FailAddr = namedtuple(<span class="string">&#x27;fail&#x27;</span>, [])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">format_addr</span>(<span class="params">addr: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">if</span> addr &gt;= rela.virtual_address <span class="keyword">and</span> addr &lt; rela.virtual_address + rela.size:</span><br><span class="line">        offset = addr - rela.virtual_address</span><br><span class="line">        r_offset = (offset // <span class="number">24</span>)</span><br><span class="line">        r_rem = offset % <span class="number">24</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> r_offset &gt;= <span class="number">3</span> <span class="keyword">and</span> r_offset &lt;= <span class="number">88</span>:</span><br><span class="line">            arr_idx = (r_offset - <span class="number">3</span>) * <span class="number">3</span> + (r_rem // <span class="number">8</span>)</span><br><span class="line">            <span class="keyword">return</span> ArrAddr(arr_idx)</span><br><span class="line">        <span class="keyword">elif</span> r_offset == <span class="number">89</span>:</span><br><span class="line">            <span class="keyword">return</span> OutAddr(r_rem)</span><br><span class="line">        </span><br><span class="line">        match r_rem:</span><br><span class="line">            case <span class="number">0</span>: <span class="keyword">return</span> RelocAddr(Reloc(r_offset), <span class="string">&#x27;r_address&#x27;</span>)</span><br><span class="line">            case <span class="number">8</span>: <span class="keyword">return</span> RelocAddr(Reloc(r_offset), <span class="string">&#x27;r_info&#x27;</span>)</span><br><span class="line">            case <span class="number">16</span>: <span class="keyword">return</span> RelocAddr(Reloc(r_offset), <span class="string">&#x27;r_addend&#x27;</span>)</span><br><span class="line">            case _: <span class="keyword">return</span> RelocAddr(Reloc(r_offset), r_rem)</span><br><span class="line">    <span class="keyword">elif</span> addr &gt; dynsym.virtual_address <span class="keyword">and</span> addr &lt; dynsym.virtual_address + dynsym.size:</span><br><span class="line">        offset = addr - dynsym.virtual_address</span><br><span class="line">        r_offset = (offset // <span class="number">24</span>)</span><br><span class="line">        r_rem = offset % <span class="number">24</span></span><br><span class="line">        </span><br><span class="line">        match r_rem:</span><br><span class="line">            case <span class="number">0</span>: <span class="keyword">return</span> SymAddr(Symbol(r_offset), <span class="string">&#x27;st_name&#x27;</span>)</span><br><span class="line">            case <span class="number">8</span>: <span class="keyword">return</span> Symbol(r_offset)</span><br><span class="line">            case <span class="number">16</span>: <span class="keyword">return</span> SymAddr(Symbol(r_offset), <span class="string">&#x27;st_size&#x27;</span>)</span><br><span class="line">            case _: <span class="keyword">return</span> SymAddr(Symbol(r_offset), r_rem)</span><br><span class="line">    <span class="keyword">elif</span> addr &gt;= <span class="number">0x404040</span> <span class="keyword">and</span> addr &lt; <span class="number">0x404040</span>+<span class="number">33</span>:</span><br><span class="line">        off = addr-<span class="number">0x404040</span></span><br><span class="line">        <span class="keyword">return</span> FlagAddr(off)</span><br><span class="line">    <span class="keyword">elif</span> addr == <span class="number">0x804000</span>:</span><br><span class="line">        <span class="keyword">return</span> BaseAddr()</span><br><span class="line">    <span class="keyword">elif</span> addr == <span class="number">0x404064</span>:</span><br><span class="line">        <span class="keyword">return</span> FailAddr()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> addr</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_sym</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(name) == <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> Symbol(<span class="built_in">ord</span>(name[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">Rel = namedtuple(<span class="string">&#x27;REL&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>,<span class="string">&#x27;val&#x27;</span>,<span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line">Copy = namedtuple(<span class="string">&#x27;CPY&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>, <span class="string">&#x27;symbol&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line">R64 = namedtuple(<span class="string">&#x27;R64&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>,<span class="string">&#x27;symbol&#x27;</span>,<span class="string">&#x27;addend&#x27;</span>,<span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line">R32 = namedtuple(<span class="string">&#x27;R32&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>,<span class="string">&#x27;symbol&#x27;</span>,<span class="string">&#x27;addend&#x27;</span>,<span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">b</span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[*] Loading relocations...&#x27;</span>)</span><br><span class="line">    relocs = <span class="built_in">list</span>(b.relocations)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[*] Parsing...&#x27;</span>)</span><br><span class="line">    instructions = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="built_in">len</span>(relocs)):</span><br><span class="line">        r = relocs[i]</span><br><span class="line">        match r.<span class="built_in">type</span>:</span><br><span class="line">            case <span class="number">1</span>: <span class="comment"># R64</span></span><br><span class="line">                instructions.append(R64(format_addr(r.address), to_sym(r.symbol.name), format_addr(r.addend), i))</span><br><span class="line">            case <span class="number">5</span>: <span class="comment"># CPY</span></span><br><span class="line">                instructions.append(Copy(format_addr(r.address), to_sym(r.symbol.name), i))</span><br><span class="line">            case <span class="number">8</span>: <span class="comment"># REL</span></span><br><span class="line">                instructions.append(Rel(format_addr(r.address), format_addr(r.addend), i))</span><br><span class="line">            case <span class="number">10</span>: <span class="comment"># R32</span></span><br><span class="line">                instructions.append(R32(format_addr(r.address), to_sym(r.symbol.name), format_addr(r.addend), i))</span><br><span class="line">                </span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Mov = namedtuple(<span class="string">&#x27;mov&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;sz&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line">Add = namedtuple(<span class="string">&#x27;add&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;addend&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_mov_add</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    sizes = []</span><br><span class="line">    curr = [<span class="number">8</span>] * <span class="number">8</span></span><br><span class="line">    sizes.append(curr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> instr <span class="keyword">in</span> instructions:</span><br><span class="line">        c = <span class="built_in">list</span>(curr)</span><br><span class="line">        match instr:</span><br><span class="line">            case Rel(SymAddr(Symbol(idx), <span class="string">&#x27;st_size&#x27;</span>), val, ridx):</span><br><span class="line">                c[idx] = val</span><br><span class="line">        sizes.append(c)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx]:</span><br><span class="line">            case Rel(dst, val, ridx):</span><br><span class="line">                instructions[idx] = Mov(dst, Ref(val), <span class="number">8</span>, ridx)</span><br><span class="line">            case Copy(dst, sym, ridx):</span><br><span class="line">                instructions[idx] = Mov(dst, sym, sizes[idx][sym.idx], ridx)</span><br><span class="line">            case R64(dst, sym, add, ridx):</span><br><span class="line">                instructions[idx] = Add(dst, sym, add, ridx)</span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove_sizes</span>(<span class="params">instructions</span>):</span><br><span class="line">    <span class="comment"># Sizes are now nops</span></span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx]:</span><br><span class="line">            case Mov(SymAddr(Symbol(s), <span class="string">&#x27;st_size&#x27;</span>), _, _, _) <span class="keyword">if</span> s != <span class="number">3</span>:</span><br><span class="line">                instructions[idx:idx+<span class="number">1</span>] = []</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_indirect</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">3</span>]:</span><br><span class="line">            case [</span><br><span class="line">                Mov(RelocAddr(Reloc(rel_1), <span class="string">&#x27;r_addend&#x27;</span>), Symbol(sidx_1), sz_1, ridx_1),</span><br><span class="line">                Add(dst_2, sym_2, _, ridx_2),</span><br><span class="line">                Mov(RelocAddr(Reloc(rel_3), <span class="string">&#x27;r_addend&#x27;</span>), Ref(<span class="number">0</span>), sz_3, _),</span><br><span class="line">            ] <span class="keyword">if</span> (</span><br><span class="line">                (rel_1 == ridx_2) <span class="keyword">and</span> (rel_3 == ridx_2)</span><br><span class="line">            ):</span><br><span class="line">                instructions[idx:idx+<span class="number">3</span>] = [</span><br><span class="line">                    Add(dst_2, sym_2, Symbol(sidx_1), ridx_1)</span><br><span class="line">                ]</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Block = namedtuple(<span class="string">&#x27;block&#x27;</span>, [<span class="string">&#x27;arr&#x27;</span>, <span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line">Output = namedtuple(<span class="string">&#x27;output&#x27;</span>, [<span class="string">&#x27;out&#x27;</span>, <span class="string">&#x27;arr&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_block</span>(<span class="params">instructions</span>):</span><br><span class="line"> </span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">18</span>]:</span><br><span class="line">            case [</span><br><span class="line">                Mov(_,arr,_,ridx),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,flag,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                R32(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">            ]:</span><br><span class="line">                instructions[idx:idx+<span class="number">18</span>] = [</span><br><span class="line">                    Block(arr, flag, ridx)</span><br><span class="line">                ]</span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Reset = namedtuple(<span class="string">&#x27;reset&#x27;</span>, [<span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line">ShuffleBlock = namedtuple(<span class="string">&#x27;shuffleblock&#x27;</span>, [<span class="string">&#x27;f1&#x27;</span>, <span class="string">&#x27;f2&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_reset</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions) - <span class="number">256</span>:</span><br><span class="line">        good = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            op = instructions[idx+i]</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">type</span>(op) == Mov:</span><br><span class="line">                dst, src, _, _ = op</span><br><span class="line">                <span class="keyword">if</span> dst != ArrAddr(i) <span class="keyword">or</span> src != Ref(i):</span><br><span class="line">                    good = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                good = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> good:</span><br><span class="line">            instructions[idx:idx+<span class="number">256</span>] = [Reset(instructions[idx].ridx)]</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_shuffle_block</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions) - <span class="number">256</span>:</span><br><span class="line">        good = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            op = instructions[idx+i]</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">type</span>(op) == Block:</span><br><span class="line">                arr, flag, ridx = op</span><br><span class="line">                <span class="keyword">if</span> arr != Ref(ArrAddr(i)):</span><br><span class="line">                    good = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                good = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> good:</span><br><span class="line">            instructions[idx:idx+<span class="number">256</span>] = [ShuffleBlock(instructions[idx].flag, instructions[idx+<span class="number">1</span>].flag, instructions[idx].ridx)]</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Output = namedtuple(<span class="string">&#x27;output&#x27;</span>, [<span class="string">&#x27;out&#x27;</span>, <span class="string">&#x27;arr&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_output</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">26</span>]:</span><br><span class="line">            case [</span><br><span class="line">                Mov(_,arr,_,ridx),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                R32(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                R32(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Add(_,_,_,_),</span><br><span class="line">                Mov(out,_,_,_),</span><br><span class="line">            ]:</span><br><span class="line">                instructions[idx:idx+<span class="number">26</span>] = [Output(out, arr, ridx)]</span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">MultAdd = namedtuple(<span class="string">&#x27;multadd&#x27;</span>, [<span class="string">&#x27;out&#x27;</span>, <span class="string">&#x27;val&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_multadd</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">3</span>]:</span><br><span class="line">            <span class="comment"># block prefix</span></span><br><span class="line">            case [</span><br><span class="line">                Mov(Symbol(<span class="number">2</span>), out, _, ridx),</span><br><span class="line">                Mov(Symbol(<span class="number">5</span>), Symbol(<span class="number">2</span>), _, _),</span><br><span class="line">                Mov(Symbol(<span class="number">6</span>), Ref(<span class="number">0</span>), _, _),</span><br><span class="line">            ]:</span><br><span class="line">                k = <span class="number">0</span></span><br><span class="line">                double = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">                ptr = idx + <span class="number">3</span></span><br><span class="line"></span><br><span class="line">                good = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">while</span> ptr &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">                    match instructions[ptr]:</span><br><span class="line">                        case Mov(Symbol(<span class="number">2</span>), Ref(Symbol(<span class="number">6</span>)), _, _):</span><br><span class="line">                            double = <span class="literal">True</span></span><br><span class="line">                        case Mov(Symbol(<span class="number">2</span>), Ref(Symbol(<span class="number">5</span>)), _, _):</span><br><span class="line">                            double = <span class="literal">False</span></span><br><span class="line">                        case Add(Symbol(<span class="number">6</span>), Symbol(<span class="number">6</span>), Symbol(<span class="number">2</span>), _):</span><br><span class="line">                            k = (k * <span class="number">2</span>) <span class="keyword">if</span> double <span class="keyword">else</span> (k + <span class="number">1</span>)</span><br><span class="line">                        case Add(Symbol(<span class="number">7</span>), Symbol(<span class="number">7</span>), Symbol(<span class="number">2</span>), _):</span><br><span class="line">                            ptr += <span class="number">1</span></span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        case _:</span><br><span class="line">                            good = <span class="literal">False</span></span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">                    ptr += <span class="number">1</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> good:</span><br><span class="line">                    instructions[idx:ptr] = [</span><br><span class="line">                        MultAdd(Symbol(<span class="number">7</span>), out, k, ridx)</span><br><span class="line">                    ]</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Trunc = namedtuple(<span class="string">&#x27;trunc&#x27;</span>, [<span class="string">&#x27;val&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_truncate</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">2</span>]:</span><br><span class="line">            case [</span><br><span class="line">                Mov(Symbol(<span class="number">2</span>), Ref(SymAddr(Symbol(<span class="number">5</span>), <span class="number">11</span>)), _, ridx),</span><br><span class="line">                Mov(SymAddr(Symbol(<span class="number">7</span>), <span class="number">11</span>), Symbol(<span class="number">2</span>), <span class="number">5</span>, _)</span><br><span class="line">            ]:</span><br><span class="line">                instructions[idx:idx+<span class="number">2</span>] = [</span><br><span class="line">                    Trunc(Symbol(<span class="number">7</span>), <span class="number">0xffffff</span>, ridx)]</span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">ArraySlots = namedtuple(<span class="string">&#x27;arr&#x27;</span>, [<span class="string">&#x27;values&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_array_slots</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx]:</span><br><span class="line">            case Mov(BaseAddr(), Ref(<span class="number">0</span>), _, ridx):</span><br><span class="line">                ptr = idx+<span class="number">1</span></span><br><span class="line">                <span class="keyword">while</span> ptr &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">                    op = instructions[ptr]</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">type</span>(op) != Mov <span class="keyword">or</span> op.dst != BaseAddr():</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    ptr += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                start = idx</span><br><span class="line">                end = ptr</span><br><span class="line"></span><br><span class="line">                data = []</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Check for movs into array.</span></span><br><span class="line">                vstart = RelocAddr(Reloc(ridx), <span class="string">&#x27;r_address&#x27;</span>).vaddr()</span><br><span class="line">                offset = <span class="number">0</span></span><br><span class="line">                <span class="keyword">while</span> end + offset &lt; <span class="built_in">len</span>(instructions) <span class="keyword">and</span> offset &lt; ((end - start) * <span class="number">3</span>):</span><br><span class="line">                    op = instructions[end + offset]</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">type</span>(op) == Mov <span class="keyword">and</span> <span class="built_in">type</span>(op.dst) <span class="keyword">is</span> RelocAddr <span class="keyword">and</span> op.dst.vaddr() == vstart + (offset * <span class="number">8</span>):</span><br><span class="line">                        data.append(op.src.val)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    offset += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(data) &gt; <span class="number">0</span>:</span><br><span class="line">                    data += [<span class="number">0</span>] * (((end - start) * <span class="number">3</span>) - <span class="built_in">len</span>(data))   </span><br><span class="line">                    instructions[idx:end+offset] = [</span><br><span class="line">                        ArraySlots(data, ridx)</span><br><span class="line">                    ]</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Shellcode = namedtuple(<span class="string">&#x27;shellcode&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>, <span class="string">&#x27;code&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_shellcode</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">6</span>]:</span><br><span class="line">            case [</span><br><span class="line">                ArraySlots(values, ridx),</span><br><span class="line">                Mov(Symbol(<span class="number">3</span>), Ref(RelocAddr(Reloc(rel2), <span class="string">&#x27;r_address&#x27;</span>)), _, _),</span><br><span class="line">                Mov(SymAddr(Symbol(<span class="number">3</span>), <span class="string">&#x27;st_name&#x27;</span>), _, _, _),</span><br><span class="line">                Add(dst, Symbol(<span class="number">3</span>), _, _),</span><br><span class="line">                Mov(Symbol(<span class="number">2</span>), _, _, _),</span><br><span class="line">                Mov(RelocAddr(Reloc(rel6), <span class="string">&#x27;r_address&#x27;</span>), Symbol(<span class="number">2</span>), _, _)</span><br><span class="line">            ] <span class="keyword">if</span> (rel2 == ridx) <span class="keyword">and</span> (rel6 == ridx):</span><br><span class="line">                instructions[idx:idx+<span class="number">6</span>] = [</span><br><span class="line">                    Shellcode(dst, <span class="string">b&#x27;&#x27;</span>.join([(x &amp; <span class="number">0xffffffffffffffff</span>).to_bytes(<span class="number">8</span>, <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> values]), ridx)</span><br><span class="line">                ]</span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">Aop = namedtuple(<span class="string">&#x27;aop&#x27;</span>, [<span class="string">&#x27;dst&#x27;</span>, <span class="string">&#x27;op&#x27;</span>, <span class="string">&#x27;val&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;ridx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_aop</span>(<span class="params">instructions</span>):</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(instructions):</span><br><span class="line">        match instructions[idx:idx+<span class="number">5</span>]:</span><br><span class="line">            case [</span><br><span class="line">                Mov(Symbol(<span class="number">2</span>), val, _, ridx),</span><br><span class="line">                Mov(Symbol(<span class="number">5</span>), Symbol(<span class="number">2</span>), _, _),</span><br><span class="line">                Shellcode(_, data, _),</span><br><span class="line">                Mov(Symbol(<span class="number">2</span>), Ref(Symbol(<span class="number">5</span>)), _, _),</span><br><span class="line">                Add(dst, dst2, Symbol(<span class="number">2</span>), _)</span><br><span class="line">            ] <span class="keyword">if</span> <span class="built_in">len</span>(data) == <span class="number">24</span> <span class="keyword">and</span> (dst == dst2):</span><br><span class="line">                op = <span class="built_in">next</span>(md.disasm(data, <span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">                t = op.mnemonic</span><br><span class="line">                k = <span class="built_in">int</span>(op.op_str.split(<span class="string">&#x27;, &#x27;</span>)[-<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">                instructions[idx:idx+<span class="number">5</span>] = [</span><br><span class="line">                    Aop(dst, t, val, k, ridx)</span><br><span class="line">                ]</span><br><span class="line"></span><br><span class="line">        idx += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">instructions</span>):</span><br><span class="line">    <span class="keyword">for</span> op <span class="keyword">in</span> instructions:</span><br><span class="line">        match op:</span><br><span class="line">            case Mov(SymAddr(sym, <span class="string">&#x27;st_name&#x27;</span>), Ref(val), <span class="number">8</span>, ridx) <span class="keyword">if</span> <span class="built_in">type</span>(val) <span class="keyword">is</span> <span class="built_in">int</span>:</span><br><span class="line">                name = val &amp; <span class="number">0xffffffff</span></span><br><span class="line">                info = (val &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xff</span></span><br><span class="line">                other = (val &gt;&gt; <span class="number">5</span>) &amp; <span class="number">0xff</span></span><br><span class="line">                shndx = (val &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0xffff</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: setinfo <span class="subst">&#123;sym&#125;</span>, name=0x<span class="subst">&#123;name:x&#125;</span>, info=0x<span class="subst">&#123;info:x&#125;</span>, other=0x<span class="subst">&#123;other:x&#125;</span>, shndx=0x<span class="subst">&#123;shndx:x&#125;</span>&#x27;</span>)</span><br><span class="line">            case Mov(BaseAddr(), Ref(<span class="number">0</span>), _, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: [ARRAY SLOT]&#x27;</span>)</span><br><span class="line">            case Mov(dst, src, <span class="number">8</span>, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: mov <span class="subst">&#123;dst&#125;</span>, <span class="subst">&#123;src&#125;</span>&#x27;</span>)</span><br><span class="line">            case Mov(dst, src, sz, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: mov(<span class="subst">&#123;sz&#125;</span>) <span class="subst">&#123;dst&#125;</span>, <span class="subst">&#123;src&#125;</span>&#x27;</span>)</span><br><span class="line">            case Add(dst, src, add, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: add <span class="subst">&#123;dst&#125;</span>, <span class="subst">&#123;src&#125;</span>, <span class="subst">&#123;add&#125;</span>&#x27;</span>)</span><br><span class="line">            case R32(dst, src, add, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: r32 <span class="subst">&#123;dst&#125;</span>, <span class="subst">&#123;src&#125;</span>, <span class="subst">&#123;add&#125;</span>&#x27;</span>)</span><br><span class="line">            case Block(arr, flag, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: shuffle <span class="subst">&#123;arr&#125;</span>, <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">            case Output(out, arr, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: output <span class="subst">&#123;out&#125;</span>, <span class="subst">&#123;arr&#125;</span>&#x27;</span>)</span><br><span class="line">            case ShuffleBlock(f1, f2, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: shuffleblock <span class="subst">&#123;f1&#125;</span>, <span class="subst">&#123;f2&#125;</span>&#x27;</span>)</span><br><span class="line">            case MultAdd(dst, val, k, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: madd <span class="subst">&#123;dst&#125;</span> += (<span class="subst">&#123;val&#125;</span> * <span class="subst">&#123;k&#125;</span>)&#x27;</span>)</span><br><span class="line">            case Aop(dst, op, val, k, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: aop <span class="subst">&#123;dst&#125;</span> += (<span class="subst">&#123;val&#125;</span> <span class="subst">&#123;op&#125;</span> <span class="subst">&#123;k&#125;</span>)&#x27;</span>)</span><br><span class="line">            case Reset(ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: reset&#x27;</span>)</span><br><span class="line">            case Trunc(val, k, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: trunc <span class="subst">&#123;val&#125;</span> &amp;= 0x<span class="subst">&#123;k:x&#125;</span>&#x27;</span>)</span><br><span class="line">            case ArraySlots(values, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: array [<span class="subst">&#123;<span class="string">&quot;, &quot;</span>.join([<span class="built_in">hex</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> values])&#125;</span>]&#x27;</span>)</span><br><span class="line">            case Shellcode(dst, code, ridx):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[<span class="subst">&#123;ridx:04d&#125;</span>] :: exec <span class="subst">&#123;dst&#125;</span> &lt;- <span class="subst">&#123;code.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">20</span>)</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> md.disasm(code, <span class="number">0</span>):</span><br><span class="line">                    <span class="keyword">if</span> i.mnemonic == <span class="string">&#x27;ret&#x27;</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;    0x%x:\t%s\t%s&quot;</span> %(i.address, i.mnemonic, i.op_str.replace(<span class="string">&#x27;0x8040e4&#x27;</span>, <span class="string">&#x27;s5&#x27;</span>).replace(<span class="string">&#x27;0x8040cc&#x27;</span>, <span class="string">&#x27;s4&#x27;</span>)))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span> * <span class="number">20</span>)</span><br><span class="line">            case _:</span><br><span class="line">                <span class="built_in">print</span>(op)</span><br><span class="line"></span><br><span class="line">LIFTS = [</span><br><span class="line">    lift_mov_add,</span><br><span class="line">    remove_sizes,</span><br><span class="line">    lift_indirect,</span><br><span class="line">    lift_block,</span><br><span class="line">    lift_reset,</span><br><span class="line">    lift_shuffle_block,</span><br><span class="line">    lift_output,</span><br><span class="line">    lift_multadd,</span><br><span class="line">    lift_truncate,</span><br><span class="line">    lift_array_slots,</span><br><span class="line">    lift_shellcode,</span><br><span class="line">    lift_aop,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift</span>(<span class="params">instructions</span>):</span><br><span class="line">    <span class="keyword">for</span> lift_fn <span class="keyword">in</span> LIFTS:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;[*] <span class="subst">&#123;lift_fn.__name__&#125;</span>...&#x27;</span>)</span><br><span class="line">        instructions = lift_fn(instructions)</span><br><span class="line">    <span class="keyword">return</span> instructions</span><br><span class="line"></span><br><span class="line">instructions = parse(b)</span><br><span class="line">instructions = lift(instructions)</span><br><span class="line">dump(instructions)</span><br></pre></td></tr></table></figure>

<p>然后得到下面的类似汇编，甚至还有机器码。</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br></pre></td><td class="code"><pre><span class="line">[0005] :: mov s2, &amp;flag[0]</span><br><span class="line">[0007] :: mov(1) s4, s2</span><br><span class="line">[0008] :: [ARRAY SLOT]</span><br><span class="line">[0009] :: mov arr[15], &amp;1585408084625667200</span><br><span class="line">[0010] :: mov arr[16], &amp;195</span><br><span class="line">[0011] :: mov s3, &amp;arr[15]</span><br><span class="line">[0012] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0013] :: add arr[15], s3, 0</span><br><span class="line">[0014] :: mov s2, &amp;r101002.r_address</span><br><span class="line">[0016] :: mov(24) arr[15], s2</span><br><span class="line">[0017] :: [ARRAY SLOT]</span><br><span class="line">[0018] :: mov arr[42], &amp;141015791240320</span><br><span class="line">[0019] :: mov arr[43], &amp;195</span><br><span class="line">[0020] :: mov s3, &amp;arr[42]</span><br><span class="line">[0021] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0022] :: add arr[42], s3, 0</span><br><span class="line">[0023] :: mov arr[42], s2</span><br><span class="line">[0024] :: mov s2, &amp;s4</span><br><span class="line">[0026] :: mov(1) arr[0], s2</span><br><span class="line">[0027] :: mov s2, &amp;flag[1]</span><br><span class="line">[0028] :: mov s4, s2</span><br><span class="line">[0029] :: [ARRAY SLOT]</span><br><span class="line">[0030] :: mov arr[78], &amp;1657465678663595136</span><br><span class="line">[0031] :: mov arr[79], &amp;195</span><br><span class="line">[0032] :: mov s3, &amp;arr[78]</span><br><span class="line">[0033] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0034] :: add arr[78], s3, 0</span><br><span class="line">[0035] :: mov s2, &amp;r101002.r_address</span><br><span class="line">[0037] :: mov(24) arr[78], s2</span><br><span class="line">[0038] :: [ARRAY SLOT]</span><br><span class="line">[0039] :: mov arr[105], &amp;72198609829168256</span><br><span class="line">[0040] :: mov arr[106], &amp;195</span><br><span class="line">[0041] :: mov s3, &amp;arr[105]</span><br><span class="line">[0042] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0043] :: add arr[105], s3, 0</span><br><span class="line">[0044] :: mov arr[105], s2</span><br><span class="line">[0045] :: mov s2, &amp;s4</span><br><span class="line">[0047] :: mov(1) arr[0], s2</span><br><span class="line">[0048] :: mov s2, &amp;flag[2]</span><br><span class="line">[0049] :: mov s4, s2</span><br><span class="line">[0050] :: [ARRAY SLOT]</span><br><span class="line">[0051] :: mov arr[141], &amp;1153062520398099584</span><br><span class="line">[0052] :: mov arr[142], &amp;195</span><br><span class="line">[0053] :: mov s3, &amp;arr[141]</span><br><span class="line">[0054] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0055] :: add arr[141], s3, 0</span><br><span class="line">[0056] :: mov s2, &amp;r101002.r_address</span><br><span class="line">[0058] :: mov(24) arr[141], s2</span><br><span class="line">[0059] :: [ARRAY SLOT]</span><br><span class="line">[0060] :: mov arr[168], &amp;144256203867096192</span><br><span class="line">[0061] :: mov arr[169], &amp;195</span><br><span class="line">[0062] :: mov s3, &amp;arr[168]</span><br><span class="line">[0063] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0064] :: add arr[168], s3, 0</span><br><span class="line">[0065] :: mov arr[168], s2</span><br><span class="line">[0066] :: mov s2, &amp;s4</span><br><span class="line">[0068] :: mov(1) arr[0], s2</span><br><span class="line">[0069] :: mov s2, &amp;flag[3]</span><br><span class="line">[0070] :: mov s4, s2</span><br><span class="line">[0071] :: [ARRAY SLOT]</span><br><span class="line">[0072] :: mov arr[204], &amp;1297177708473955456</span><br><span class="line">[0073] :: mov arr[205], &amp;195</span><br><span class="line">[0074] :: mov s3, &amp;arr[204]</span><br><span class="line">[0075] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0076] :: add arr[204], s3, 0</span><br><span class="line">[0077] :: mov s2, &amp;r101002.r_address</span><br><span class="line">[0079] :: mov(24) arr[204], s2</span><br><span class="line">[0080] :: [ARRAY SLOT]</span><br><span class="line">[0081] :: mov arr[231], &amp;216313797905024128</span><br><span class="line">[0082] :: mov arr[232], &amp;195</span><br><span class="line">[0083] :: mov s3, &amp;arr[231]</span><br><span class="line">[0084] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0085] :: add arr[231], s3, 0</span><br><span class="line">[0086] :: mov arr[231], s2</span><br><span class="line">[0087] :: mov s2, &amp;s4</span><br><span class="line">[0089] :: mov(1) arr[0], s2</span><br><span class="line">[0090] :: mov s2, &amp;flag[4]</span><br><span class="line">[0091] :: mov s4, s2</span><br><span class="line">[0092] :: exec r92.r_address &lt;- 803425cc40800010c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x10</span><br><span class="line">--------------------</span><br><span class="line">[0101] :: array [0x4008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0104] :: mov s3, &amp;r101.r_address</span><br><span class="line">[0105] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0106] :: add r101.r_address, s3, 0</span><br><span class="line">[0107] :: mov r101.r_address, s2</span><br><span class="line">[0108] :: mov s2, &amp;s4</span><br><span class="line">[0110] :: mov(1) arr[0], s2</span><br><span class="line">[0111] :: mov s2, &amp;flag[5]</span><br><span class="line">[0112] :: mov s4, s2</span><br><span class="line">[0113] :: exec r113.r_address &lt;- 803425cc40800011c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x11</span><br><span class="line">--------------------</span><br><span class="line">[0122] :: array [0x5008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0125] :: mov s3, &amp;r122.r_address</span><br><span class="line">[0126] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0127] :: add r122.r_address, s3, 0</span><br><span class="line">[0128] :: mov r122.r_address, s2</span><br><span class="line">[0129] :: mov s2, &amp;s4</span><br><span class="line">[0131] :: mov(1) arr[0], s2</span><br><span class="line">[0132] :: mov s2, &amp;flag[6]</span><br><span class="line">[0133] :: mov s4, s2</span><br><span class="line">[0134] :: exec r134.r_address &lt;- 803425cc40800012c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x12</span><br><span class="line">--------------------</span><br><span class="line">[0143] :: array [0x6008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0146] :: mov s3, &amp;r143.r_address</span><br><span class="line">[0147] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0148] :: add r143.r_address, s3, 0</span><br><span class="line">[0149] :: mov r143.r_address, s2</span><br><span class="line">[0150] :: mov s2, &amp;s4</span><br><span class="line">[0152] :: mov(1) arr[0], s2</span><br><span class="line">[0153] :: mov s2, &amp;flag[7]</span><br><span class="line">[0154] :: mov s4, s2</span><br><span class="line">[0155] :: exec r155.r_address &lt;- 803425cc40800013c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x13</span><br><span class="line">--------------------</span><br><span class="line">[0164] :: array [0x7008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0167] :: mov s3, &amp;r164.r_address</span><br><span class="line">[0168] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0169] :: add r164.r_address, s3, 0</span><br><span class="line">[0170] :: mov r164.r_address, s2</span><br><span class="line">[0171] :: mov s2, &amp;s4</span><br><span class="line">[0173] :: mov(1) arr[0], s2</span><br><span class="line">[0174] :: mov s2, &amp;flag[8]</span><br><span class="line">[0175] :: mov s4, s2</span><br><span class="line">[0176] :: exec r176.r_address &lt;- 803425cc40800014c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x14</span><br><span class="line">--------------------</span><br><span class="line">[0185] :: array [0x8008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0188] :: mov s3, &amp;r185.r_address</span><br><span class="line">[0189] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0190] :: add r185.r_address, s3, 0</span><br><span class="line">[0191] :: mov r185.r_address, s2</span><br><span class="line">[0192] :: mov s2, &amp;s4</span><br><span class="line">[0194] :: mov(1) arr[1], s2</span><br><span class="line">[0195] :: mov s2, &amp;flag[9]</span><br><span class="line">[0196] :: mov s4, s2</span><br><span class="line">[0197] :: exec r197.r_address &lt;- 803425cc40800015c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x15</span><br><span class="line">--------------------</span><br><span class="line">[0206] :: array [0x9008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0209] :: mov s3, &amp;r206.r_address</span><br><span class="line">[0210] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0211] :: add r206.r_address, s3, 0</span><br><span class="line">[0212] :: mov r206.r_address, s2</span><br><span class="line">[0213] :: mov s2, &amp;s4</span><br><span class="line">[0215] :: mov(1) arr[1], s2</span><br><span class="line">[0216] :: mov s2, &amp;flag[10]</span><br><span class="line">[0217] :: mov s4, s2</span><br><span class="line">[0218] :: exec r218.r_address &lt;- 803425cc40800016c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x16</span><br><span class="line">--------------------</span><br><span class="line">[0227] :: array [0xa008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0230] :: mov s3, &amp;r227.r_address</span><br><span class="line">[0231] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0232] :: add r227.r_address, s3, 0</span><br><span class="line">[0233] :: mov r227.r_address, s2</span><br><span class="line">[0234] :: mov s2, &amp;s4</span><br><span class="line">[0236] :: mov(1) arr[1], s2</span><br><span class="line">[0237] :: mov s2, &amp;flag[11]</span><br><span class="line">[0238] :: mov s4, s2</span><br><span class="line">[0239] :: exec r239.r_address &lt;- 803425cc40800017c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x17</span><br><span class="line">--------------------</span><br><span class="line">[0248] :: array [0xb008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0251] :: mov s3, &amp;r248.r_address</span><br><span class="line">[0252] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0253] :: add r248.r_address, s3, 0</span><br><span class="line">[0254] :: mov r248.r_address, s2</span><br><span class="line">[0255] :: mov s2, &amp;s4</span><br><span class="line">[0257] :: mov(1) arr[1], s2</span><br><span class="line">[0258] :: mov s2, &amp;flag[12]</span><br><span class="line">[0259] :: mov s4, s2</span><br><span class="line">[0260] :: exec r260.r_address &lt;- 803425cc40800018c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x18</span><br><span class="line">--------------------</span><br><span class="line">[0269] :: array [0xc008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0272] :: mov s3, &amp;r269.r_address</span><br><span class="line">[0273] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0274] :: add r269.r_address, s3, 0</span><br><span class="line">[0275] :: mov r269.r_address, s2</span><br><span class="line">[0276] :: mov s2, &amp;s4</span><br><span class="line">[0278] :: mov(1) arr[1], s2</span><br><span class="line">[0279] :: mov s2, &amp;flag[13]</span><br><span class="line">[0280] :: mov s4, s2</span><br><span class="line">[0281] :: exec r281.r_address &lt;- 803425cc40800019c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x19</span><br><span class="line">--------------------</span><br><span class="line">[0290] :: array [0xd008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0293] :: mov s3, &amp;r290.r_address</span><br><span class="line">[0294] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0295] :: add r290.r_address, s3, 0</span><br><span class="line">[0296] :: mov r290.r_address, s2</span><br><span class="line">[0297] :: mov s2, &amp;s4</span><br><span class="line">[0299] :: mov(1) arr[1], s2</span><br><span class="line">[0300] :: mov s2, &amp;flag[14]</span><br><span class="line">[0301] :: mov s4, s2</span><br><span class="line">[0302] :: exec r302.r_address &lt;- 803425cc40800024c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x24</span><br><span class="line">--------------------</span><br><span class="line">[0311] :: array [0xe008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0314] :: mov s3, &amp;r311.r_address</span><br><span class="line">[0315] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0316] :: add r311.r_address, s3, 0</span><br><span class="line">[0317] :: mov r311.r_address, s2</span><br><span class="line">[0318] :: mov s2, &amp;s4</span><br><span class="line">[0320] :: mov(1) arr[1], s2</span><br><span class="line">[0321] :: mov s2, &amp;flag[15]</span><br><span class="line">[0322] :: mov s4, s2</span><br><span class="line">[0323] :: exec r323.r_address &lt;- 803425cc4080002cc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x2c</span><br><span class="line">--------------------</span><br><span class="line">[0332] :: array [0xf008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0335] :: mov s3, &amp;r332.r_address</span><br><span class="line">[0336] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0337] :: add r332.r_address, s3, 0</span><br><span class="line">[0338] :: mov r332.r_address, s2</span><br><span class="line">[0339] :: mov s2, &amp;s4</span><br><span class="line">[0341] :: mov(1) arr[1], s2</span><br><span class="line">[0342] :: mov s2, &amp;flag[16]</span><br><span class="line">[0343] :: mov s4, s2</span><br><span class="line">[0344] :: exec r344.r_address &lt;- 803425cc40800026c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x26</span><br><span class="line">--------------------</span><br><span class="line">[0353] :: array [0x10008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0356] :: mov s3, &amp;r353.r_address</span><br><span class="line">[0357] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0358] :: add r353.r_address, s3, 0</span><br><span class="line">[0359] :: mov r353.r_address, s2</span><br><span class="line">[0360] :: mov s2, &amp;s4</span><br><span class="line">[0362] :: mov(1) arr[2], s2</span><br><span class="line">[0363] :: mov s2, &amp;flag[17]</span><br><span class="line">[0364] :: mov s4, s2</span><br><span class="line">[0365] :: exec r365.r_address &lt;- 803425cc4080001ec3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x1e</span><br><span class="line">--------------------</span><br><span class="line">[0374] :: array [0x11008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0377] :: mov s3, &amp;r374.r_address</span><br><span class="line">[0378] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0379] :: add r374.r_address, s3, 0</span><br><span class="line">[0380] :: mov r374.r_address, s2</span><br><span class="line">[0381] :: mov s2, &amp;s4</span><br><span class="line">[0383] :: mov(1) arr[2], s2</span><br><span class="line">[0384] :: mov s2, &amp;flag[18]</span><br><span class="line">[0385] :: mov s4, s2</span><br><span class="line">[0386] :: exec r386.r_address &lt;- 803425cc4080001fc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x1f</span><br><span class="line">--------------------</span><br><span class="line">[0395] :: array [0x12008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0398] :: mov s3, &amp;r395.r_address</span><br><span class="line">[0399] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0400] :: add r395.r_address, s3, 0</span><br><span class="line">[0401] :: mov r395.r_address, s2</span><br><span class="line">[0402] :: mov s2, &amp;s4</span><br><span class="line">[0404] :: mov(1) arr[2], s2</span><br><span class="line">[0405] :: mov s2, &amp;flag[19]</span><br><span class="line">[0406] :: mov s4, s2</span><br><span class="line">[0407] :: exec r407.r_address &lt;- 803425cc40800020c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x20</span><br><span class="line">--------------------</span><br><span class="line">[0416] :: array [0x13008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0419] :: mov s3, &amp;r416.r_address</span><br><span class="line">[0420] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0421] :: add r416.r_address, s3, 0</span><br><span class="line">[0422] :: mov r416.r_address, s2</span><br><span class="line">[0423] :: mov s2, &amp;s4</span><br><span class="line">[0425] :: mov(1) arr[2], s2</span><br><span class="line">[0426] :: mov s2, &amp;flag[20]</span><br><span class="line">[0427] :: mov s4, s2</span><br><span class="line">[0428] :: exec r428.r_address &lt;- 803425cc40800020c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x20</span><br><span class="line">--------------------</span><br><span class="line">[0437] :: array [0x14008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0440] :: mov s3, &amp;r437.r_address</span><br><span class="line">[0441] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0442] :: add r437.r_address, s3, 0</span><br><span class="line">[0443] :: mov r437.r_address, s2</span><br><span class="line">[0444] :: mov s2, &amp;s4</span><br><span class="line">[0446] :: mov(1) arr[2], s2</span><br><span class="line">[0447] :: mov s2, &amp;flag[21]</span><br><span class="line">[0448] :: mov s4, s2</span><br><span class="line">[0449] :: exec r449.r_address &lt;- 803425cc40800021c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x21</span><br><span class="line">--------------------</span><br><span class="line">[0458] :: array [0x15008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0461] :: mov s3, &amp;r458.r_address</span><br><span class="line">[0462] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0463] :: add r458.r_address, s3, 0</span><br><span class="line">[0464] :: mov r458.r_address, s2</span><br><span class="line">[0465] :: mov s2, &amp;s4</span><br><span class="line">[0467] :: mov(1) arr[2], s2</span><br><span class="line">[0468] :: mov s2, &amp;flag[22]</span><br><span class="line">[0469] :: mov s4, s2</span><br><span class="line">[0470] :: exec r470.r_address &lt;- 803425cc40800023c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x23</span><br><span class="line">--------------------</span><br><span class="line">[0479] :: array [0x16008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0482] :: mov s3, &amp;r479.r_address</span><br><span class="line">[0483] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0484] :: add r479.r_address, s3, 0</span><br><span class="line">[0485] :: mov r479.r_address, s2</span><br><span class="line">[0486] :: mov s2, &amp;s4</span><br><span class="line">[0488] :: mov(1) arr[2], s2</span><br><span class="line">[0489] :: mov s2, &amp;flag[23]</span><br><span class="line">[0490] :: mov s4, s2</span><br><span class="line">[0491] :: exec r491.r_address &lt;- 803425cc40800027c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x27</span><br><span class="line">--------------------</span><br><span class="line">[0500] :: array [0x17008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0503] :: mov s3, &amp;r500.r_address</span><br><span class="line">[0504] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0505] :: add r500.r_address, s3, 0</span><br><span class="line">[0506] :: mov r500.r_address, s2</span><br><span class="line">[0507] :: mov s2, &amp;s4</span><br><span class="line">[0509] :: mov(1) arr[2], s2</span><br><span class="line">[0510] :: mov s2, &amp;flag[24]</span><br><span class="line">[0511] :: mov s4, s2</span><br><span class="line">[0512] :: exec r512.r_address &lt;- 803425cc40800024c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x24</span><br><span class="line">--------------------</span><br><span class="line">[0521] :: array [0x18008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0524] :: mov s3, &amp;r521.r_address</span><br><span class="line">[0525] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0526] :: add r521.r_address, s3, 0</span><br><span class="line">[0527] :: mov r521.r_address, s2</span><br><span class="line">[0528] :: mov s2, &amp;s4</span><br><span class="line">[0530] :: mov(1) arr[3], s2</span><br><span class="line">[0531] :: mov s2, &amp;flag[25]</span><br><span class="line">[0532] :: mov s4, s2</span><br><span class="line">[0533] :: exec r533.r_address &lt;- 803425cc40800025c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x25</span><br><span class="line">--------------------</span><br><span class="line">[0542] :: array [0x19008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0545] :: mov s3, &amp;r542.r_address</span><br><span class="line">[0546] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0547] :: add r542.r_address, s3, 0</span><br><span class="line">[0548] :: mov r542.r_address, s2</span><br><span class="line">[0549] :: mov s2, &amp;s4</span><br><span class="line">[0551] :: mov(1) arr[3], s2</span><br><span class="line">[0552] :: mov s2, &amp;flag[26]</span><br><span class="line">[0553] :: mov s4, s2</span><br><span class="line">[0554] :: exec r554.r_address &lt;- 803425cc40800026c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x26</span><br><span class="line">--------------------</span><br><span class="line">[0563] :: array [0x1a008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0566] :: mov s3, &amp;r563.r_address</span><br><span class="line">[0567] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0568] :: add r563.r_address, s3, 0</span><br><span class="line">[0569] :: mov r563.r_address, s2</span><br><span class="line">[0570] :: mov s2, &amp;s4</span><br><span class="line">[0572] :: mov(1) arr[3], s2</span><br><span class="line">[0573] :: mov s2, &amp;flag[27]</span><br><span class="line">[0574] :: mov s4, s2</span><br><span class="line">[0575] :: exec r575.r_address &lt;- 803425cc40800027c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [s4], 0x27</span><br><span class="line">--------------------</span><br><span class="line">[0584] :: array [0x1b008040cc250480, 0xc3, 0x0]</span><br><span class="line">[0587] :: mov s3, &amp;r584.r_address</span><br><span class="line">[0588] :: setinfo s3, name=0x1a, info=0x1, other=0x0, shndx=0x0</span><br><span class="line">[0589] :: add r584.r_address, s3, 0</span><br><span class="line">[0590] :: mov r584.r_address, s2</span><br><span class="line">[0591] :: mov s2, &amp;s4</span><br><span class="line">[0593] :: mov(1) arr[3], s2</span><br><span class="line">[0594] :: mov s4, &amp;0</span><br><span class="line">[0595] :: mov fail(), &amp;0</span><br><span class="line">[0596] :: mov s5, &amp;0</span><br><span class="line">[0597] :: mov s2, &amp;arr[0]</span><br><span class="line">[0599] :: mov s6, s2</span><br><span class="line">[0600] :: exec r600.r_address &lt;- 803425fc40800070c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x70</span><br><span class="line">--------------------</span><br><span class="line">[0609] :: mov s2, &amp;s6</span><br><span class="line">[0611] :: add s5, s5, s2</span><br><span class="line">[0614] :: mov s6, &amp;0</span><br><span class="line">[0615] :: mov s2, &amp;arr[0]</span><br><span class="line">[0616] :: mov s6, s2</span><br><span class="line">[0617] :: exec r617.r_address &lt;- 803425fc4080007cc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x7c</span><br><span class="line">--------------------</span><br><span class="line">[0626] :: mov s2, &amp;s6</span><br><span class="line">[0628] :: add s5, s5, s2</span><br><span class="line">[0631] :: mov s6, &amp;0</span><br><span class="line">[0632] :: mov s2, &amp;arr[0]</span><br><span class="line">[0633] :: mov s6, s2</span><br><span class="line">[0634] :: exec r634.r_address &lt;- 803425fc40800073c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x73</span><br><span class="line">--------------------</span><br><span class="line">[0643] :: mov s2, &amp;s6</span><br><span class="line">[0645] :: add s5, s5, s2</span><br><span class="line">[0648] :: mov s6, &amp;0</span><br><span class="line">[0649] :: mov s2, &amp;arr[0]</span><br><span class="line">[0650] :: mov s6, s2</span><br><span class="line">[0651] :: exec r651.r_address &lt;- 803425fc40800078c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x78</span><br><span class="line">--------------------</span><br><span class="line">[0660] :: mov s2, &amp;s6</span><br><span class="line">[0662] :: add s5, s5, s2</span><br><span class="line">[0665] :: mov s6, &amp;0</span><br><span class="line">[0666] :: mov s2, &amp;arr[0]</span><br><span class="line">[0667] :: mov s6, s2</span><br><span class="line">[0668] :: exec r668.r_address &lt;- 803425fc4080006fc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x6f</span><br><span class="line">--------------------</span><br><span class="line">[0677] :: mov s2, &amp;s6</span><br><span class="line">[0679] :: add s5, s5, s2</span><br><span class="line">[0682] :: mov s6, &amp;0</span><br><span class="line">[0683] :: mov s2, &amp;arr[0]</span><br><span class="line">[0684] :: mov s6, s2</span><br><span class="line">[0685] :: exec r685.r_address &lt;- 803425fc40800027c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x27</span><br><span class="line">--------------------</span><br><span class="line">[0694] :: mov s2, &amp;s6</span><br><span class="line">[0696] :: add s5, s5, s2</span><br><span class="line">[0699] :: mov s6, &amp;0</span><br><span class="line">[0700] :: mov s2, &amp;arr[0]</span><br><span class="line">[0701] :: mov s6, s2</span><br><span class="line">[0702] :: exec r702.r_address &lt;- 803425fc4080002ac3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x2a</span><br><span class="line">--------------------</span><br><span class="line">[0711] :: mov s2, &amp;s6</span><br><span class="line">[0713] :: add s5, s5, s2</span><br><span class="line">[0716] :: mov s6, &amp;0</span><br><span class="line">[0717] :: mov s2, &amp;arr[0]</span><br><span class="line">[0718] :: mov s6, s2</span><br><span class="line">[0719] :: exec r719.r_address &lt;- 803425fc4080002cc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x2c</span><br><span class="line">--------------------</span><br><span class="line">[0728] :: mov s2, &amp;s6</span><br><span class="line">[0730] :: add s5, s5, s2</span><br><span class="line">[0733] :: mov s6, &amp;0</span><br><span class="line">[0734] :: mov s2, &amp;arr[1]</span><br><span class="line">[0735] :: mov s6, s2</span><br><span class="line">[0736] :: exec r736.r_address &lt;- 803425fc4080007fc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x7f</span><br><span class="line">--------------------</span><br><span class="line">[0745] :: mov s2, &amp;s6</span><br><span class="line">[0747] :: add s5, s5, s2</span><br><span class="line">[0750] :: mov s6, &amp;0</span><br><span class="line">[0751] :: mov s2, &amp;arr[1]</span><br><span class="line">[0752] :: mov s6, s2</span><br><span class="line">[0753] :: exec r753.r_address &lt;- 803425fc40800035c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x35</span><br><span class="line">--------------------</span><br><span class="line">[0762] :: mov s2, &amp;s6</span><br><span class="line">[0764] :: add s5, s5, s2</span><br><span class="line">[0767] :: mov s6, &amp;0</span><br><span class="line">[0768] :: mov s2, &amp;arr[1]</span><br><span class="line">[0769] :: mov s6, s2</span><br><span class="line">[0770] :: exec r770.r_address &lt;- 803425fc4080002dc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x2d</span><br><span class="line">--------------------</span><br><span class="line">[0779] :: mov s2, &amp;s6</span><br><span class="line">[0781] :: add s5, s5, s2</span><br><span class="line">[0784] :: mov s6, &amp;0</span><br><span class="line">[0785] :: mov s2, &amp;arr[1]</span><br><span class="line">[0786] :: mov s6, s2</span><br><span class="line">[0787] :: exec r787.r_address &lt;- 803425fc40800032c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x32</span><br><span class="line">--------------------</span><br><span class="line">[0796] :: mov s2, &amp;s6</span><br><span class="line">[0798] :: add s5, s5, s2</span><br><span class="line">[0801] :: mov s6, &amp;0</span><br><span class="line">[0802] :: mov s2, &amp;arr[1]</span><br><span class="line">[0803] :: mov s6, s2</span><br><span class="line">[0804] :: exec r804.r_address &lt;- 803425fc40800037c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x37</span><br><span class="line">--------------------</span><br><span class="line">[0813] :: mov s2, &amp;s6</span><br><span class="line">[0815] :: add s5, s5, s2</span><br><span class="line">[0818] :: mov s6, &amp;0</span><br><span class="line">[0819] :: mov s2, &amp;arr[1]</span><br><span class="line">[0820] :: mov s6, s2</span><br><span class="line">[0821] :: exec r821.r_address &lt;- 803425fc4080003bc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x3b</span><br><span class="line">--------------------</span><br><span class="line">[0830] :: mov s2, &amp;s6</span><br><span class="line">[0832] :: add s5, s5, s2</span><br><span class="line">[0835] :: mov s6, &amp;0</span><br><span class="line">[0836] :: mov s2, &amp;arr[1]</span><br><span class="line">[0837] :: mov s6, s2</span><br><span class="line">[0838] :: exec r838.r_address &lt;- 803425fc40800022c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x22</span><br><span class="line">--------------------</span><br><span class="line">[0847] :: mov s2, &amp;s6</span><br><span class="line">[0849] :: add s5, s5, s2</span><br><span class="line">[0852] :: mov s6, &amp;0</span><br><span class="line">[0853] :: mov s2, &amp;arr[1]</span><br><span class="line">[0854] :: mov s6, s2</span><br><span class="line">[0855] :: exec r855.r_address &lt;- 803425fc40800059c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x59</span><br><span class="line">--------------------</span><br><span class="line">[0864] :: mov s2, &amp;s6</span><br><span class="line">[0866] :: add s5, s5, s2</span><br><span class="line">[0869] :: mov s6, &amp;0</span><br><span class="line">[0870] :: mov s2, &amp;arr[2]</span><br><span class="line">[0871] :: mov s6, s2</span><br><span class="line">[0872] :: exec r872.r_address &lt;- 803425fc40800053c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x53</span><br><span class="line">--------------------</span><br><span class="line">[0881] :: mov s2, &amp;s6</span><br><span class="line">[0883] :: add s5, s5, s2</span><br><span class="line">[0886] :: mov s6, &amp;0</span><br><span class="line">[0887] :: mov s2, &amp;arr[2]</span><br><span class="line">[0888] :: mov s6, s2</span><br><span class="line">[0889] :: exec r889.r_address &lt;- 803425fc4080008ec3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x8e</span><br><span class="line">--------------------</span><br><span class="line">[0898] :: mov s2, &amp;s6</span><br><span class="line">[0900] :: add s5, s5, s2</span><br><span class="line">[0903] :: mov s6, &amp;0</span><br><span class="line">[0904] :: mov s2, &amp;arr[2]</span><br><span class="line">[0905] :: mov s6, s2</span><br><span class="line">[0906] :: exec r906.r_address &lt;- 803425fc4080003dc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x3d</span><br><span class="line">--------------------</span><br><span class="line">[0915] :: mov s2, &amp;s6</span><br><span class="line">[0917] :: add s5, s5, s2</span><br><span class="line">[0920] :: mov s6, &amp;0</span><br><span class="line">[0921] :: mov s2, &amp;arr[2]</span><br><span class="line">[0922] :: mov s6, s2</span><br><span class="line">[0923] :: exec r923.r_address &lt;- 803425fc4080002ac3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x2a</span><br><span class="line">--------------------</span><br><span class="line">[0932] :: mov s2, &amp;s6</span><br><span class="line">[0934] :: add s5, s5, s2</span><br><span class="line">[0937] :: mov s6, &amp;0</span><br><span class="line">[0938] :: mov s2, &amp;arr[2]</span><br><span class="line">[0939] :: mov s6, s2</span><br><span class="line">[0940] :: exec r940.r_address &lt;- 803425fc40800059c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x59</span><br><span class="line">--------------------</span><br><span class="line">[0949] :: mov s2, &amp;s6</span><br><span class="line">[0951] :: add s5, s5, s2</span><br><span class="line">[0954] :: mov s6, &amp;0</span><br><span class="line">[0955] :: mov s2, &amp;arr[2]</span><br><span class="line">[0956] :: mov s6, s2</span><br><span class="line">[0957] :: exec r957.r_address &lt;- 803425fc40800027c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x27</span><br><span class="line">--------------------</span><br><span class="line">[0966] :: mov s2, &amp;s6</span><br><span class="line">[0968] :: add s5, s5, s2</span><br><span class="line">[0971] :: mov s6, &amp;0</span><br><span class="line">[0972] :: mov s2, &amp;arr[2]</span><br><span class="line">[0973] :: mov s6, s2</span><br><span class="line">[0974] :: exec r974.r_address &lt;- 803425fc4080002dc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x2d</span><br><span class="line">--------------------</span><br><span class="line">[0983] :: mov s2, &amp;s6</span><br><span class="line">[0985] :: add s5, s5, s2</span><br><span class="line">[0988] :: mov s6, &amp;0</span><br><span class="line">[0989] :: mov s2, &amp;arr[2]</span><br><span class="line">[0990] :: mov s6, s2</span><br><span class="line">[0991] :: exec r991.r_address &lt;- 803425fc40800029c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x29</span><br><span class="line">--------------------</span><br><span class="line">[1000] :: mov s2, &amp;s6</span><br><span class="line">[1002] :: add s5, s5, s2</span><br><span class="line">[1005] :: mov s6, &amp;0</span><br><span class="line">[1006] :: mov s2, &amp;arr[3]</span><br><span class="line">[1007] :: mov s6, s2</span><br><span class="line">[1008] :: exec r1008.r_address &lt;- 803425fc40800034c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x34</span><br><span class="line">--------------------</span><br><span class="line">[1017] :: mov s2, &amp;s6</span><br><span class="line">[1019] :: add s5, s5, s2</span><br><span class="line">[1022] :: mov s6, &amp;0</span><br><span class="line">[1023] :: mov s2, &amp;arr[3]</span><br><span class="line">[1024] :: mov s6, s2</span><br><span class="line">[1025] :: exec r1025.r_address &lt;- 803425fc4080002dc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x2d</span><br><span class="line">--------------------</span><br><span class="line">[1034] :: mov s2, &amp;s6</span><br><span class="line">[1036] :: add s5, s5, s2</span><br><span class="line">[1039] :: mov s6, &amp;0</span><br><span class="line">[1040] :: mov s2, &amp;arr[3]</span><br><span class="line">[1041] :: mov s6, s2</span><br><span class="line">[1042] :: exec r1042.r_address &lt;- 803425fc40800061c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x61</span><br><span class="line">--------------------</span><br><span class="line">[1051] :: mov s2, &amp;s6</span><br><span class="line">[1053] :: add s5, s5, s2</span><br><span class="line">[1056] :: mov s6, &amp;0</span><br><span class="line">[1057] :: mov s2, &amp;arr[3]</span><br><span class="line">[1058] :: mov s6, s2</span><br><span class="line">[1059] :: exec r1059.r_address &lt;- 803425fc40800032c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x8040fc], 0x32</span><br><span class="line">--------------------</span><br><span class="line">[1068] :: mov s2, &amp;s6</span><br><span class="line">[1070] :: add s5, s5, s2</span><br><span class="line">[1073] :: mov s6, &amp;0</span><br><span class="line">[1074] :: mov s2, &amp;flag[28]</span><br><span class="line">[1075] :: mov s6, s2</span><br><span class="line">[1076] :: mov s2, &amp;flag[29]</span><br><span class="line">[1077] :: mov s7, s2</span><br><span class="line">[1078] :: mov s8, &amp;0</span><br><span class="line">[1079] :: mov s2, &amp;s8</span><br><span class="line">[1080] :: add s8, s8, s2</span><br><span class="line">[1083] :: mov s2, &amp;s6</span><br><span class="line">[1084] :: add s8, s8, s2</span><br><span class="line">[1087] :: mov s9, &amp;0</span><br><span class="line">[1088] :: mov s2, &amp;s9</span><br><span class="line">[1089] :: add s9, s9, s2</span><br><span class="line">[1092] :: mov s2, &amp;s7</span><br><span class="line">[1093] :: add s9, s9, s2</span><br><span class="line">[1096] :: mov s2, &amp;s9</span><br><span class="line">[1097] :: add s10, s8, s2</span><br><span class="line">[1100] :: exec r1100.r_address &lt;- 8034255c4180006cc3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x80415c], 0x6c</span><br><span class="line">--------------------</span><br><span class="line">[1109] :: mov s2, &amp;s10</span><br><span class="line">[1111] :: add s5, s5, s2</span><br><span class="line">[1114] :: mov s6, &amp;0</span><br><span class="line">[1115] :: mov s7, &amp;0</span><br><span class="line">[1116] :: mov s8, &amp;0</span><br><span class="line">[1117] :: mov s9, &amp;0</span><br><span class="line">[1118] :: mov s10, &amp;0</span><br><span class="line">[1119] :: mov s2, &amp;flag[28]</span><br><span class="line">[1120] :: mov s6, s2</span><br><span class="line">[1121] :: mov s2, &amp;flag[29]</span><br><span class="line">[1122] :: mov s7, s2</span><br><span class="line">[1123] :: mov s8, &amp;0</span><br><span class="line">[1124] :: mov s2, &amp;s8</span><br><span class="line">[1125] :: add s8, s8, s2</span><br><span class="line">[1128] :: mov s2, &amp;s6</span><br><span class="line">[1129] :: add s8, s8, s2</span><br><span class="line">[1132] :: mov s2, &amp;s8</span><br><span class="line">[1133] :: add s8, s8, s2</span><br><span class="line">[1136] :: mov s9, &amp;0</span><br><span class="line">[1137] :: mov s2, &amp;s9</span><br><span class="line">[1138] :: add s9, s9, s2</span><br><span class="line">[1141] :: mov s2, &amp;s7</span><br><span class="line">[1142] :: add s9, s9, s2</span><br><span class="line">[1145] :: mov s2, &amp;s9</span><br><span class="line">[1146] :: add s10, s8, s2</span><br><span class="line">[1149] :: exec r1149.r_address &lt;- 8034255c418000a1c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x80415c], 0xa1</span><br><span class="line">--------------------</span><br><span class="line">[1158] :: mov s2, &amp;s10</span><br><span class="line">[1160] :: add s5, s5, s2</span><br><span class="line">[1163] :: mov s6, &amp;0</span><br><span class="line">[1164] :: mov s7, &amp;0</span><br><span class="line">[1165] :: mov s8, &amp;0</span><br><span class="line">[1166] :: mov s9, &amp;0</span><br><span class="line">[1167] :: mov s10, &amp;0</span><br><span class="line">[1168] :: mov s2, &amp;flag[30]</span><br><span class="line">[1169] :: mov s6, s2</span><br><span class="line">[1170] :: mov s2, &amp;flag[31]</span><br><span class="line">[1171] :: mov s7, s2</span><br><span class="line">[1172] :: mov s8, &amp;0</span><br><span class="line">[1173] :: mov s2, &amp;s8</span><br><span class="line">[1174] :: add s8, s8, s2</span><br><span class="line">[1177] :: mov s2, &amp;s6</span><br><span class="line">[1178] :: add s8, s8, s2</span><br><span class="line">[1181] :: mov s9, &amp;0</span><br><span class="line">[1182] :: mov s2, &amp;s9</span><br><span class="line">[1183] :: add s9, s9, s2</span><br><span class="line">[1186] :: mov s2, &amp;s7</span><br><span class="line">[1187] :: add s9, s9, s2</span><br><span class="line">[1190] :: mov s2, &amp;s9</span><br><span class="line">[1191] :: add s10, s8, s2</span><br><span class="line">[1194] :: exec r1194.r_address &lt;- 8034255c418000b1c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x80415c], 0xb1</span><br><span class="line">--------------------</span><br><span class="line">[1203] :: mov s2, &amp;s10</span><br><span class="line">[1205] :: add s5, s5, s2</span><br><span class="line">[1208] :: mov s6, &amp;0</span><br><span class="line">[1209] :: mov s7, &amp;0</span><br><span class="line">[1210] :: mov s8, &amp;0</span><br><span class="line">[1211] :: mov s9, &amp;0</span><br><span class="line">[1212] :: mov s10, &amp;0</span><br><span class="line">[1213] :: mov s2, &amp;flag[30]</span><br><span class="line">[1214] :: mov s6, s2</span><br><span class="line">[1215] :: mov s2, &amp;flag[31]</span><br><span class="line">[1216] :: mov s7, s2</span><br><span class="line">[1217] :: mov s8, &amp;0</span><br><span class="line">[1218] :: mov s2, &amp;s8</span><br><span class="line">[1219] :: add s8, s8, s2</span><br><span class="line">[1222] :: mov s2, &amp;s6</span><br><span class="line">[1223] :: add s8, s8, s2</span><br><span class="line">[1226] :: mov s2, &amp;s8</span><br><span class="line">[1227] :: add s8, s8, s2</span><br><span class="line">[1230] :: mov s9, &amp;0</span><br><span class="line">[1231] :: mov s2, &amp;s9</span><br><span class="line">[1232] :: add s9, s9, s2</span><br><span class="line">[1235] :: mov s2, &amp;s7</span><br><span class="line">[1236] :: add s9, s9, s2</span><br><span class="line">[1239] :: mov s2, &amp;s9</span><br><span class="line">[1240] :: add s10, s8, s2</span><br><span class="line">[1243] :: exec r1243.r_address &lt;- 8034255c418000e5c3000000000000000000000000000000</span><br><span class="line">--------------------</span><br><span class="line">    0x0:	xor	byte ptr [0x80415c], 0xe5</span><br><span class="line">--------------------</span><br><span class="line">[1252] :: mov s2, &amp;s10</span><br><span class="line">[1254] :: add s5, s5, s2</span><br><span class="line">[1257] :: mov s6, &amp;0</span><br><span class="line">[1258] :: mov s7, &amp;0</span><br><span class="line">[1259] :: mov s8, &amp;0</span><br><span class="line">[1260] :: mov s9, &amp;0</span><br><span class="line">[1261] :: mov s10, &amp;0</span><br><span class="line">[1262] :: mov s2, &amp;s5</span><br><span class="line">[1264] :: mov(1) fail(),</span><br></pre></td></tr></table></figure>

<p>我们选择一个进行分析</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    <span class="number">0</span>x0:	xor	byte ptr <span class="selector-attr">[s4]</span>, <span class="number">0</span>x10</span><br><span class="line">--------------------</span><br><span class="line"><span class="selector-attr">[0101]</span> :: array <span class="selector-attr">[0x4008040cc250480, 0xc3, 0x0]</span></span><br><span class="line"><span class="selector-attr">[0104]</span> :: mov s3, &amp;r101<span class="selector-class">.r_address</span></span><br><span class="line"><span class="selector-attr">[0105]</span> :: setinfo s3, name=<span class="number">0</span>x1a, info=<span class="number">0</span>x1, other=<span class="number">0</span>x0, shndx=<span class="number">0</span>x0</span><br><span class="line"><span class="selector-attr">[0106]</span> :: add r101<span class="selector-class">.r_address</span>, s3, <span class="number">0</span></span><br><span class="line"><span class="selector-attr">[0107]</span> :: mov r101<span class="selector-class">.r_address</span>, s2</span><br><span class="line"><span class="selector-attr">[0108]</span> :: mov s2, &amp;s4</span><br><span class="line"><span class="selector-attr">[0110]</span> :: <span class="built_in">mov</span>(<span class="number">1</span>) arr<span class="selector-attr">[0]</span>, s2</span><br><span class="line"><span class="selector-attr">[0111]</span> :: mov s2, &amp;flag<span class="selector-attr">[5]</span></span><br><span class="line"><span class="selector-attr">[0112]</span> :: mov s4, s2</span><br><span class="line"><span class="selector-attr">[0113]</span> :: exec r113<span class="selector-class">.r_address</span> &lt;- <span class="number">803425</span>cc40800011c3000000000000000000000000000000</span><br></pre></td></tr></table></figure>

<p>array里的机器码转变顺序放到ida里就是add 0x4，后面的exec其实就是个异或，那么我们能够看出这个题的逻辑是flag先异或在加上自己在数组的位置就等于后面的encflag，根据提示还得爆破后4位才行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">xor=[<span class="number">0x16</span>,<span class="number">0x17</span>,<span class="number">0x10</span>,<span class="number">0x12</span>,<span class="number">0x10</span>,<span class="number">0x11</span>,<span class="number">0x12</span>,<span class="number">0x13</span>,<span class="number">0x14</span>,<span class="number">0x15</span>,<span class="number">0x16</span>,<span class="number">0x17</span>,<span class="number">0x18</span>,<span class="number">0x19</span>,<span class="number">0x24</span>,<span class="number">0x2c</span>,<span class="number">0x26</span>,<span class="number">0x1e</span>,<span class="number">0x1f</span>,<span class="number">0x20</span>,<span class="number">0x20</span>,<span class="number">0x21</span>,<span class="number">0x23</span>,<span class="number">0x27</span>,<span class="number">0x24</span>,<span class="number">0x25</span>,<span class="number">0x26</span>,<span class="number">0x27</span>]</span><br><span class="line">encflag=[<span class="number">0x70</span>,<span class="number">0x7c</span>,<span class="number">0x73</span>,<span class="number">0x78</span>,<span class="number">0x6f</span>,<span class="number">0x27</span>,<span class="number">0x2a</span>,<span class="number">0x2c</span>,<span class="number">0x7f</span>,<span class="number">0x35</span>,<span class="number">0x2d</span>,<span class="number">0x32</span>,<span class="number">0x37</span>,<span class="number">0x3b</span>,<span class="number">0x22</span>,<span class="number">0x59</span>,<span class="number">0x53</span>,<span class="number">0x8e</span>,<span class="number">0x3d</span>,<span class="number">0x2a</span>,<span class="number">0x59</span>,<span class="number">0x27</span>,<span class="number">0x2d</span>,<span class="number">0x29</span>,<span class="number">0x34</span>,<span class="number">0x2d</span>,<span class="number">0x61</span>,<span class="number">0x32</span>]</span><br><span class="line">a=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encflag)):</span><br><span class="line">   a+=<span class="built_in">chr</span>((encflag[i]-i)^xor[i])</span><br><span class="line">l = <span class="string">&quot;1234567890abcdef&quot;</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> l:</span><br><span class="line"> <span class="keyword">for</span> c <span class="keyword">in</span> l:</span><br><span class="line">  <span class="keyword">for</span> d <span class="keyword">in</span> l:</span><br><span class="line">    flag = a+b+c+d+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">    sha = hashlib.sha256(flag.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> sha[<span class="number">0</span>:<span class="number">16</span>] == <span class="string">&quot;f860464d767610bb&quot;</span>:</span><br><span class="line">     <span class="built_in">print</span>(flag)</span><br><span class="line">     <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="gamemaster"><a href="#gamemaster" class="headerlink" title="gamemaster"></a>gamemaster</h2><p>是个经典21点游戏</p>
<p>发现dll文件是c#写的，放入dnspy，发现似乎是对文件异或和进行了aes加密，那么源文件已经给了，直接模拟生成一下</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220802171638649.png" alt="image-20220802171638649"></p>
<p>发现里面有个MZ签名，dump出来还是一个c#写的</p>
<p>EasyRe</p>
<p>这个题每一行都要分析，能学到很多东西。</p>
<p>先用finger跑一下会发现清晰很多。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_4021BB</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// er8</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// er9</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  sub_402150();<span class="comment">//将re3的shellcode写到文件中</span></span><br><span class="line">  v5 = fork();<span class="comment">//创建子进程，返回子进程id</span></span><br><span class="line">  <span class="keyword">if</span> ( v5 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_401F2F(v5);<span class="comment">//主进程进入函数</span></span><br><span class="line">    remove((__int64)<span class="string">&quot;re3&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sys_ptrace(PTRACE_TRACEME, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>, v12, v13, a2);<span class="comment">//ptrace函数</span></span><br><span class="line">    sub_44B680((<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;re3&quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;re3&quot;</span>, *(_QWORD *)(a2 + <span class="number">8</span>), <span class="number">0</span>, v2, v3, a2);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ptrace函数最重要的是第一个参数request，它决定了系统调用</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830094057553.png" alt="image-20220830094057553"></p>
<p>我们主要看主进程进入的函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_401F2F</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// r8</span></span><br><span class="line">  __int64 v2; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// ecx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// r8</span></span><br><span class="line">  __int64 v7; <span class="comment">// r9</span></span><br><span class="line">  __int64 v8; <span class="comment">// r8</span></span><br><span class="line">  __int64 v9; <span class="comment">// r9</span></span><br><span class="line">  __int64 v10; <span class="comment">// r8</span></span><br><span class="line">  __int64 v11; <span class="comment">// r9</span></span><br><span class="line">  __int64 v12; <span class="comment">// r8</span></span><br><span class="line">  __int64 v13; <span class="comment">// r9</span></span><br><span class="line">  __int64 v14; <span class="comment">// r8</span></span><br><span class="line">  __int64 v15; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [rsp+0h] [rbp-130h]</span></span><br><span class="line">  <span class="type">char</span> v17; <span class="comment">// [rsp+0h] [rbp-130h]</span></span><br><span class="line">  <span class="type">char</span> v18; <span class="comment">// [rsp+0h] [rbp-130h]</span></span><br><span class="line">  <span class="type">char</span> v19; <span class="comment">// [rsp+0h] [rbp-130h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v20; <span class="comment">// [rsp+10h] [rbp-120h]</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// [rsp+2Ch] [rbp-104h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v23[<span class="number">128</span>]; <span class="comment">// [rsp+30h] [rbp-100h] BYREF</span></span><br><span class="line">  __int64 v24; <span class="comment">// [rsp+B0h] [rbp-80h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+108h] [rbp-28h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+110h] [rbp-20h]</span></span><br><span class="line">  __int64 v27; <span class="comment">// [rsp+118h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+124h] [rbp-Ch]</span></span><br><span class="line">  __int64 v29; <span class="comment">// [rsp+128h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  sys_wait(a1, <span class="number">0LL</span>, <span class="number">0</span>);<span class="comment">//等待子进程信号</span></span><br><span class="line">  sys_ptrace(PTRACE_CONT, a1, <span class="number">0LL</span>, <span class="number">0LL</span>, v1, v2, v16);<span class="comment">//重新运行处于stopped状态程序</span></span><br><span class="line">  v27 = sub_401A30(a1);</span><br><span class="line">  v3 = sub_4017E5();<span class="comment">//如下表，将下表数据存到result</span></span><br><span class="line">  result = v4;</span><br><span class="line">  v20 = v3;</span><br><span class="line">  v21 = v4;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">2</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v22 = <span class="number">0</span>;</span><br><span class="line">    sys_wait(a1, &amp;v22, <span class="number">0</span>);	<span class="comment">//等待子进程信号</span></span><br><span class="line">    result = v22 &amp; <span class="number">0x7F</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (v22 &amp; <span class="number">0x7F</span>) == <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    sys_ptrace(PTRACE_GETREGS, a1, <span class="number">0LL</span>, v23, v6, v7, v17);<span class="comment">//复制通用寄存器</span></span><br><span class="line">    v26 = v24 - <span class="number">1</span>;</span><br><span class="line">    v25 = sys_ptrace(PTRACE_PEEKTEXT, a1, v24 - <span class="number">1</span>, <span class="number">0LL</span>, v8, v9, v18);<span class="comment">//子进程给父进程数据</span></span><br><span class="line">    <span class="keyword">if</span> ( v25 == <span class="number">0xCAFEB055BFCC</span>LL )</span><br><span class="line">    &#123;</span><br><span class="line">      v29 = v26;</span><br><span class="line">      sub_401BB1(a1, v26, v27, v20, v21);</span><br><span class="line">      v24 = v26 + <span class="number">10</span>;</span><br><span class="line">      sys_ptrace(<span class="number">13LL</span>, a1, <span class="number">0LL</span>, v23, v12, v13, v19);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v25 == <span class="number">0xCAFE1055BFCC</span>LL )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_401D78(a1, v29, v26, v27, v20, v21);</span><br><span class="line">      v24 = v26 + <span class="number">10</span>;</span><br><span class="line">      sys_ptrace(PTRACE_SETREGS, a1, <span class="number">0LL</span>, v23, v14, v15, v19);</span><br><span class="line">    &#125;</span><br><span class="line">    result = sys_ptrace(PTRACE_CONT, a1, <span class="number">0LL</span>, <span class="number">0LL</span>, v10, v11, v19);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830102915693.png" alt="image-20220830102915693"></p>
<p>当子进程给父进程数据时，有两个选择，我们需要知道进入了哪个地方。</p>
<p>接下来看re3这个数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">jmp_buf_tag</span> <span class="title">env</span>[1];</span> <span class="comment">// [rsp+10h] [rbp-850h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">jmp_buf_tag</span> <span class="title">v5</span>[1];</span> <span class="comment">// [rsp+E0h] [rbp-780h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">jmp_buf_tag</span> <span class="title">v6</span>[1];</span> <span class="comment">// [rsp+1B0h] [rbp-6B0h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">jmp_buf_tag</span> <span class="title">v7</span>[1];</span> <span class="comment">// [rsp+280h] [rbp-5E0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v8[<span class="number">640</span>]; <span class="comment">// [rsp+350h] [rbp-510h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v9[<span class="number">636</span>]; <span class="comment">// [rsp+5D0h] [rbp-290h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+84Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+850h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+854h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [rsp+858h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+85Ch] [rbp-4h]</span></span><br><span class="line">  __int64 savedregs; <span class="comment">// [rsp+860h] [rbp+0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v14 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a1 != <span class="number">2</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  (sub_2490)(a2[<span class="number">1</span>], a2, a3);<span class="comment">//主要加密我们现在不关心</span></span><br><span class="line">  (loc_21F9)(&amp;unk_55C0, v9, v8);<span class="comment">//这个地方要注意</span></span><br><span class="line">  v13 = _setjmp(env);</span><br><span class="line">  <span class="keyword">if</span> ( v13 &lt;= <span class="number">24</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = _setjmp(v5);</span><br><span class="line">    <span class="keyword">if</span> ( v11 &lt; byte_50A0[<span class="number">25</span> * v13] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( byte_50A0[<span class="number">25</span> * v13 + <span class="number">1</span> + v11] != *(&amp;savedregs + <span class="number">25</span> * v13 + v11 - <span class="number">655</span>) )</span><br><span class="line">        v14 = <span class="number">0</span>;</span><br><span class="line">      longjmp(v5, v11 + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    longjmp(env, v13 + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v12 = _setjmp(v6);</span><br><span class="line">  <span class="keyword">if</span> ( v12 &lt;= <span class="number">24</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = _setjmp(v7);</span><br><span class="line">    <span class="keyword">if</span> ( v10 &lt; byte_5320[<span class="number">25</span> * v12] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( byte_5320[<span class="number">25</span> * v12 + <span class="number">1</span> + v10] != *(&amp;savedregs + <span class="number">25</span> * v12 + v10 - <span class="number">1295</span>) )</span><br><span class="line">        v14 = <span class="number">0</span>;</span><br><span class="line">      longjmp(v7, v10 + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    longjmp(v6, v12 + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v14 == <span class="number">1</span> )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;GOOD JOB&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(loc_21F9)(&amp;unk_55C0, v9, v8);</span><br></pre></td></tr></table></figure>

<p>这个地方的数据非常奇怪，无法反编译，我们需要仔细看一下</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830105602247.png" alt="image-20220830105602247"></p>
<p>发现int 3，并且有一个CAFEB055BF这样一个数据，这个数据是在主进程里进行判断的数据，那么我们可以推测这个题的主要逻辑就是：主进程先等待子进程运行，子进程抛出int 3等待主进程调试，主进程判断异常类型，进行对上面的smc处理。</p>
<p>获取smc加密后文件的方法有两种：分别是静态分析和动态调试</p>
<p>静态分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_401BB1</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1, __int64 a2, <span class="type">int</span> a3, <span class="type">char</span> a4, __int64 a5)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v5; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v6; <span class="comment">// r8</span></span><br><span class="line">  __int64 v7; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// er8</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// er9</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// er8</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// er9</span></span><br><span class="line">  __int64 v13; <span class="comment">// r8</span></span><br><span class="line">  __int64 v14; <span class="comment">// r9</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [rsp+0h] [rbp-C0h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v17; <span class="comment">// [rsp+0h] [rbp-C0h]</span></span><br><span class="line">  <span class="type">char</span> v18; <span class="comment">// [rsp+0h] [rbp-C0h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v21; <span class="comment">// [rsp+20h] [rbp-A0h]</span></span><br><span class="line">  <span class="type">char</span> v22[<span class="number">32</span>]; <span class="comment">// [rsp+30h] [rbp-90h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v23[<span class="number">32</span>]; <span class="comment">// [rsp+50h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v24[<span class="number">24</span>]; <span class="comment">// [rsp+70h] [rbp-50h] BYREF</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+88h] [rbp-38h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+90h] [rbp-30h]</span></span><br><span class="line">  <span class="type">int</span> v27; <span class="comment">// [rsp+9Ch] [rbp-24h]</span></span><br><span class="line">  __int64 v28; <span class="comment">// [rsp+A0h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> v29; <span class="comment">// [rsp+ACh] [rbp-14h]</span></span><br><span class="line">  __int64 v30; <span class="comment">// [rsp+B0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+B8h] [rbp-8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+BCh] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v16 = a4;</span><br><span class="line">  v30 = sub_401AC2(a1, a2);</span><br><span class="line">  v29 = (v30 - a2 - <span class="number">10</span>) &gt;&gt; <span class="number">4</span>;</span><br><span class="line">  v21 = a2 + <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= v29 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v28 = sys_ptrace(PTRACE_PEEKTEXT, a1, v21, v5, v6, v7, v16);</span><br><span class="line">    v27 = sub_40190E((v21 - a3), v17, a5);</span><br><span class="line">    <span class="built_in">sprintf</span>(v23, &amp;unk_490008, v27, &amp;unk_490008, v8, v9, v17);</span><br><span class="line">    v10 = j_strnlen(v23);</span><br><span class="line">    md5(v23, v10, v24);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">15</span>; j &gt; <span class="number">7</span>; --j )</span><br><span class="line">      <span class="built_in">sprintf</span>(&amp;v22[<span class="number">2</span> * (<span class="number">15</span> - j)], <span class="string">&quot;%02x&quot;</span>, v24[j], &amp;v22[<span class="number">2</span> * (<span class="number">15</span> - j)], v11, v12, v18);</span><br><span class="line">    v26 = sub_40B660(v22, <span class="number">0LL</span>, <span class="number">16LL</span>);</span><br><span class="line">    v25 = v26 ^ v28;</span><br><span class="line">    sys_ptrace(PTRACE_POKETEXT, a1, v21, v26 ^ v28, v13, v14, v18);</span><br><span class="line">    v21 += <span class="number">16LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们直接看主进程进入的smc函数，最重要的是一个md5一个异或2，经过动态调试</p>
<p>，可以知道v28是在子程序中取int 3后面的qword，v26是将原始值进行md5后再将从第八个字节倒序。如何获取这个值呢，我们需要利用条件断点</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830115323802.png" alt="image-20220830115323802"></p>
<p>拿到值后我们直接去子进程用idapython恢复一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">xorKey = &#123;<span class="number">8723</span>: <span class="number">2533025110152939745</span>, <span class="number">8739</span>: <span class="number">5590097037203163468</span>, <span class="number">8755</span>: <span class="number">17414346542877855401</span>, <span class="number">8771</span>: <span class="number">17520503086133755340</span>, <span class="number">8787</span>: <span class="number">12492599841064285544</span>, <span class="number">8803</span>: <span class="number">12384833368350302160</span>, <span class="number">8819</span>: <span class="number">11956541642520230699</span>, <span class="number">8835</span>: <span class="number">12628929057681570616</span>, <span class="number">8851</span>: <span class="number">910654967627959011</span>, <span class="number">8867</span>: <span class="number">5684234031469876551</span>, <span class="number">8883</span>: <span class="number">6000358478182005051</span>, <span class="number">8899</span>: <span class="number">3341586462889168127</span>, <span class="number">8915</span>: <span class="number">11094889238442167020</span>, <span class="number">8931</span>: <span class="number">17237527861538956365</span>, <span class="number">8947</span>: <span class="number">17178915143649401084</span>, <span class="number">8963</span>: <span class="number">11176844209899222046</span>, <span class="number">8979</span>: <span class="number">18079493192679046363</span>, <span class="number">8995</span>: <span class="number">7090159446630928781</span>, <span class="number">9011</span>: <span class="number">863094436381699168</span>, <span class="number">9027</span>: <span class="number">6906972144372600884</span>, <span class="number">9043</span>: <span class="number">16780793948225765908</span>, <span class="number">9059</span>: <span class="number">7086655467811962655</span>, <span class="number">9075</span>: <span class="number">13977154540038163446</span>, <span class="number">9091</span>: <span class="number">7066662532691991888</span>, <span class="number">9107</span>: <span class="number">15157921356638311270</span>, <span class="number">9123</span>: <span class="number">12585839823593393444</span>, <span class="number">9139</span>: <span class="number">1360651393631625694</span>, <span class="number">9155</span>: <span class="number">2139328426318955142</span>, <span class="number">9171</span>: <span class="number">2478274715212481947</span>, <span class="number">9187</span>: <span class="number">12876028885252459748</span>, <span class="number">9203</span>: <span class="number">18132176846268847269</span>, <span class="number">9219</span>: <span class="number">17242441603067001509</span>, <span class="number">9235</span>: <span class="number">8492111998925944081</span>, <span class="number">9251</span>: <span class="number">14679986489201789069</span>, <span class="number">9267</span>: <span class="number">13188777131396593592</span>, <span class="number">9283</span>: <span class="number">5298970373130621883</span>, <span class="number">9299</span>: <span class="number">525902164359904478</span>, <span class="number">9315</span>: <span class="number">2117701741234018776</span>, <span class="number">9331</span>: <span class="number">9158760851580517972</span>&#125;</span><br><span class="line"></span><br><span class="line">addr = <span class="number">0x2213</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    data = get_qword(addr)</span><br><span class="line">    key = xorKey[addr]</span><br><span class="line">    dec = data ^ key</span><br><span class="line">    idc.patch_qword(addr, dec)</span><br><span class="line">    addr += <span class="number">16</span></span><br></pre></td></tr></table></figure>

<p>动态调试：</p>
<p>也就是经常说的patch死循环，但之前一直没操作过，这次学会了。</p>
<p>patch死循环目的是什么呢？我们知道如果不patch我们是没法在主进程中查看子进程的，通过patch死循环可以直接调试子进程。</p>
<p>为什么for循环3次呢？第一次是int3处理smc解密，第二次是int3处理smc加密，就是将解密完的数据再加密回去，第三次是等待子进程结束。</p>
<p>如何操作？先找到子进程末尾，在末尾写个死循环就是jmp到本地址，第二步为了不使smc又把解密完的数据加密回去，异或改为0，第三步patch 401F2F函数的 for 循环为2</p>
<p>patch前</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830155226276.png" alt="image-20220830155226276"></p>
<p>patch后</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830155301280.png" alt="image-20220830155301280"></p>
<p>异或改为0：</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830155531523.png" alt="image-20220830155531523"></p>
<p>for循环改为1：</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830155554253.png" alt="image-20220830155554253"></p>
<p>修改完后运行发现仍然再跑</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830155922080.png" alt="image-20220830155922080"></p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830160100683.png" alt="image-20220830160100683"></p>
<p>成功！</p>
<p>用下面脚本找到smc那个函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">0x56534AF3F00C</span></span><br><span class="line"><span class="keyword">while</span>(a &lt; <span class="number">0x56534af3f48d</span>):</span><br><span class="line">    <span class="keyword">if</span>(get_wide_byte(a) == <span class="number">0x55</span> <span class="keyword">and</span> get_wide_byte(a+<span class="number">1</span>) == <span class="number">0x48</span> <span class="keyword">and</span> get_wide_byte(a+<span class="number">4</span>) == <span class="number">0x48</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(a),end = <span class="string">&quot;, &quot;</span>)</span><br><span class="line">    a+=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830160553793.png" alt="image-20220830160553793"></p>
<p>这样就可以把这个dump出来了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// positive sp value has been detected, the output may be wrong!</span></span><br><span class="line"><span class="type">void</span> __fastcall <span class="title function_">sub_21F9</span><span class="params">(__int64 input, __int64 data1, __int64 data2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> offsett; <span class="comment">// [rsp+20h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> statee; <span class="comment">// [rsp+24h] [rbp-24h]</span></span><br><span class="line">  <span class="type">char</span> count2; <span class="comment">// [rsp+28h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> jj; <span class="comment">// [rsp+2Ch] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+30h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> offset; <span class="comment">// [rsp+34h] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> state; <span class="comment">// [rsp+38h] [rbp-10h]</span></span><br><span class="line">  <span class="type">char</span> lineCount; <span class="comment">// [rsp+3Ch] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> ii; <span class="comment">// [rsp+40h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+44h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">24</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    ii = <span class="number">0</span>;</span><br><span class="line">    lineCount = <span class="number">0</span>;</span><br><span class="line">    state = <span class="number">0</span>;</span><br><span class="line">    offset = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ( ii &lt;= <span class="number">24</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(<span class="number">25</span> * i + ii + input) )            </span><br><span class="line">      &#123;</span><br><span class="line">        ++lineCount;</span><br><span class="line">        state = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( state )                            </span><br><span class="line">        &#123;</span><br><span class="line">          *(data1 + <span class="number">25LL</span> * i + offset) = lineCount;</span><br><span class="line">          lineCount = <span class="number">0</span>;</span><br><span class="line">          ++offset;</span><br><span class="line">        &#125;</span><br><span class="line">        state = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( ++ii == <span class="number">25</span> &amp;&amp; state )                </span><br><span class="line">      &#123;</span><br><span class="line">        *(data1 + <span class="number">25LL</span> * i + offset) = lineCount;</span><br><span class="line">        lineCount = <span class="number">0</span>;</span><br><span class="line">        ++offset;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    *(<span class="number">25LL</span> * i + data1) = offset - <span class="number">1</span>;           </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">24</span>; ++j )                   </span><br><span class="line">  &#123;</span><br><span class="line">    jj = <span class="number">0</span>;</span><br><span class="line">    count2 = <span class="number">0</span>;</span><br><span class="line">    statee = <span class="number">0</span>;</span><br><span class="line">    offsett = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ( jj &lt;= <span class="number">24</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(<span class="number">25</span> * jj + j + input) )</span><br><span class="line">      &#123;</span><br><span class="line">        ++count2;</span><br><span class="line">        statee = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( statee )</span><br><span class="line">        &#123;</span><br><span class="line">          *(data2 + <span class="number">25LL</span> * j + offsett) = count2;</span><br><span class="line">          count2 = <span class="number">0</span>;</span><br><span class="line">          ++offsett;</span><br><span class="line">        &#125;</span><br><span class="line">        statee = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( ++jj == <span class="number">25</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( statee )</span><br><span class="line">        &#123;</span><br><span class="line">          *(data2 + <span class="number">25LL</span> * j + offsett) = count2;</span><br><span class="line">          count2 = <span class="number">0</span>;</span><br><span class="line">          ++offsett;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    *(<span class="number">25LL</span> * j + data2) = offsett - <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实前面的操作就很难了，后面这个加密更难，其实是个数织游戏</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830161743593.png" alt="image-20220830161743593"></p>
<p>这个地方取出来的数据其实是不对的，因为在程序运行的时候init段进行了初始化，真正的在</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830161940268.png" alt="image-20220830161940268"></p>
<p>找到在线网站解密就行<a target="_blank" rel="noopener" href="https://handsomeone.github.io/Nonogram/%EF%BC%8C%E6%B3%A8%E6%84%8F%E6%AF%8F%E8%A1%8C%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%95%B0%E6%98%AF%E5%81%8F%E7%A7%BB%EF%BC%8C%E4%B8%8D%E8%83%BD%E5%87%BA%E7%8E%B0%E5%9C%A8%E8%A7%A3%E5%AF%86%E9%87%8C">https://handsomeone.github.io/Nonogram/，注意每行第一个数是偏移，不能出现在解密里</a></p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220830162146771.png" alt="image-20220830162146771"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/25/DASCTF-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/25/DASCTF-7/" class="post-title-link" itemprop="url">DASCTF_7</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-07-25 11:30:54" itemprop="dateCreated datePublished" datetime="2022-07-25T11:30:54+08:00">2022-07-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-26 09:50:48" itemprop="dateModified" datetime="2022-07-26T09:50:48+08:00">2022-07-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="DASCTF-7月赛"><a href="#DASCTF-7月赛" class="headerlink" title="DASCTF_7月赛"></a>DASCTF_7月赛</h1><p>这次逆向没以前那么坐牢了。</p>
<h2 id="隐秘的角落"><a href="#隐秘的角落" class="headerlink" title="隐秘的角落"></a>隐秘的角落</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">main_main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v1; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v2; <span class="comment">// [rsp+8h] [rbp-88h]</span></span><br><span class="line">  _QWORD *v3; <span class="comment">// [rsp+8h] [rbp-88h]</span></span><br><span class="line">  _QWORD *v4; <span class="comment">// [rsp+50h] [rbp-40h]</span></span><br><span class="line">  _QWORD v5[<span class="number">4</span>]; <span class="comment">// [rsp+58h] [rbp-38h] BYREF</span></span><br><span class="line">  __int64 v6[<span class="number">2</span>]; <span class="comment">// [rsp+78h] [rbp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sync___ptr_WaitGroup__Add((__int64)&amp;main_wg, <span class="number">1LL</span>);</span><br><span class="line">  runtime_newobject((__int64)&amp;unk_4B0DA0, v2);</span><br><span class="line">  v4 = v3;</span><br><span class="line">  v6[<span class="number">0</span>] = (__int64)&amp;unk_4B0DA0;</span><br><span class="line">  v6[<span class="number">1</span>] = (__int64)&amp;off_4E9BB0;</span><br><span class="line">  fmt_Fprintln((__int64)&amp;go_itab__os_File_io_Writer, os_Stdout, (__int64)v6, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  v5[<span class="number">2</span>] = &amp;unk_4AE9C0;</span><br><span class="line">  v5[<span class="number">3</span>] = v4;</span><br><span class="line">  fmt_Fscanf(v0, v1, (<span class="type">const</span> <span class="type">char</span> *)&amp;go_itab__os_File_io_Reader);</span><br><span class="line">  runtime_newproc(<span class="number">16</span>, (<span class="type">char</span>)&amp;off_4D2310, *v4);</span><br><span class="line">  v5[<span class="number">0</span>] = &amp;unk_4B0DA0;</span><br><span class="line">  v5[<span class="number">1</span>] = &amp;off_4E9BC0;</span><br><span class="line">  fmt_Fprintln((__int64)&amp;go_itab__os_File_io_Writer, os_Stdout, (__int64)v5, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  sync___ptr_WaitGroup__Wait((__int64)&amp;main_wg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也是个go，通过动调发现关键函数在off_4D2310，点进去发现有check函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __golang <span class="title function_">main_checkflag</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v2; <span class="comment">// al</span></span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+18h] [rbp-70h]</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [rsp+18h] [rbp-70h]</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+20h] [rbp-68h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">32</span>]; <span class="comment">// [rsp+40h] [rbp-48h] BYREF</span></span><br><span class="line">  _QWORD v7[<span class="number">2</span>]; <span class="comment">// [rsp+60h] [rbp-28h] BYREF</span></span><br><span class="line">  _QWORD v8[<span class="number">2</span>]; <span class="comment">// [rsp+70h] [rbp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = runtime_stringtoslicebyte((__int64)v6, a1, a2);</span><br><span class="line">  main_Myencode(v3);</span><br><span class="line">  <span class="keyword">if</span> ( v5 == qword_55EA78 )</span><br><span class="line">  &#123;</span><br><span class="line">    runtime_memequal((__int64)main_enc, v3, qword_55EA78, v3);</span><br><span class="line">    v2 = v4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v8[<span class="number">0</span>] = &amp;unk_4B0DA0;</span><br><span class="line">    v8[<span class="number">1</span>] = &amp;off_4E9B90;</span><br><span class="line">    fmt_Fprintln((__int64)&amp;go_itab__os_File_io_Writer, os_Stdout, (__int64)v8, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v7[<span class="number">0</span>] = &amp;unk_4B0DA0;</span><br><span class="line">    v7[<span class="number">1</span>] = &amp;off_4E9BA0;</span><br><span class="line">    fmt_Fprintln((__int64)&amp;go_itab__os_File_io_Writer, os_Stdout, (__int64)v7, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sync___ptr_WaitGroup__Add((__int64)&amp;main_wg, <span class="number">-1LL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接看encode，发现是rc4，交叉引用密文和密钥，发现密文在init段被异或了，拿脚本直接解了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_main</span>(<span class="params">key=<span class="string">&quot;init_key&quot;</span>, message=<span class="string">&quot;init_message&quot;</span></span>):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;RC4解密主函数调用成功&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  s_box = rc4_init_sbox(key)</span><br><span class="line">  crypt = rc4_excrypt(message, s_box)</span><br><span class="line">  <span class="keyword">return</span> crypt</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_init_sbox</span>(<span class="params">key</span>):</span><br><span class="line">  s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;原来的 s 盒：%s&quot;</span> % s_box)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  j = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    j = (j + s_box[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">    s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;混乱后的 s 盒：%s&quot;</span> % s_box)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> s_box</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_excrypt</span>(<span class="params">plain, box</span>):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;调用解密程序成功。&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  plain = base64.b64decode(plain.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">  plain = <span class="built_in">bytes</span>.decode(plain)</span><br><span class="line">  res = []</span><br><span class="line">  i = j = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">    i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">    j = (j + box[i]) % <span class="number">256</span></span><br><span class="line">    box[i], box[j] = box[j], box[i]</span><br><span class="line">    t = (box[i] + box[j]) % <span class="number">256</span></span><br><span class="line">    k = box[t]</span><br><span class="line">    res.append((<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;res用于解密字符串，解密后是：%res&quot;</span> % res)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  cipher = <span class="string">&quot;&quot;</span>.join(res)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;解密后的字符串是：%s&quot;</span> % cipher)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> cipher</span><br><span class="line"><span class="comment">#a=[0xE0,0xB2,0x5F,0x3D,0x8F,0xFA,0x94,0xB6,0xE7,0x9D,0x6C,0x98,0x66,0xD2,0x0F,0xEA,0x6D,0x6F,0xBE,0xC5,0x71,0x40,0x08,0x1B,0xF6,0xF3,0xBD,0xA8,0x8D,0x09,0x7B,0x7C]</span></span><br><span class="line">a = [<span class="number">251</span>, <span class="number">198</span>, <span class="number">166</span>, <span class="number">157</span>, <span class="number">196</span>, <span class="number">219</span>, <span class="number">123</span>, <span class="number">86</span>, <span class="number">182</span>, <span class="number">70</span>, <span class="number">166</span>, <span class="number">192</span>, <span class="number">133</span>, <span class="number">100</span>, <span class="number">122</span>, <span class="number">154</span>, <span class="number">55</span>, <span class="number">76</span>, <span class="number">16</span>, <span class="number">150</span>, <span class="number">233</span>, <span class="number">167</span>, <span class="number">40</span>, <span class="number">196</span>, <span class="number">177</span>, <span class="number">45</span>, <span class="number">241</span>, <span class="number">222</span>, <span class="number">71</span>, <span class="number">59</span>, <span class="number">181</span>, <span class="number">243</span>, <span class="number">44</span>, <span class="number">125</span>, <span class="number">103</span>, <span class="number">29</span>]</span><br><span class="line">s = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">  s += <span class="built_in">chr</span>(i)</span><br><span class="line">s = <span class="built_in">str</span>(base64.b64encode(s.encode(<span class="string">&#x27;utf-8&#x27;</span>)), <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">rc4_main(<span class="string">&quot;thisiskkk&quot;</span>, s)</span><br></pre></td></tr></table></figure>



<h2 id="EzGo"><a href="#EzGo" class="headerlink" title="EzGo"></a>EzGo</h2><p>这个题又是go，确实不难。难的是解方程。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">main_main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v1; <span class="comment">// rsi</span></span><br><span class="line">  __int128 v2; <span class="comment">// xmm0</span></span><br><span class="line">  __int64 v3; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 i; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+10h] [rbp-120h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+10h] [rbp-120h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int64 v12; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int128 v13; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  <span class="type">char</span> v15; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  _QWORD *v16; <span class="comment">// [rsp+20h] [rbp-110h]</span></span><br><span class="line">  __int64 v17; <span class="comment">// [rsp+20h] [rbp-110h]</span></span><br><span class="line">  __int64 v18; <span class="comment">// [rsp+20h] [rbp-110h]</span></span><br><span class="line">  __int64 v19; <span class="comment">// [rsp+28h] [rbp-108h]</span></span><br><span class="line">  __int64 v20; <span class="comment">// [rsp+28h] [rbp-108h]</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp+30h] [rbp-100h]</span></span><br><span class="line">  __int64 v22; <span class="comment">// [rsp+30h] [rbp-100h]</span></span><br><span class="line">  __int64 v23; <span class="comment">// [rsp+38h] [rbp-F8h]</span></span><br><span class="line">  __int128 v24; <span class="comment">// [rsp+40h] [rbp-F0h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+50h] [rbp-E0h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+58h] [rbp-D8h]</span></span><br><span class="line">  __int64 v27; <span class="comment">// [rsp+60h] [rbp-D0h]</span></span><br><span class="line">  <span class="type">char</span> v28[<span class="number">24</span>]; <span class="comment">// [rsp+68h] [rbp-C8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v29; <span class="comment">// [rsp+80h] [rbp-B0h] BYREF</span></span><br><span class="line">  __int64 v30; <span class="comment">// [rsp+88h] [rbp-A8h]</span></span><br><span class="line">  __int64 *v31; <span class="comment">// [rsp+90h] [rbp-A0h]</span></span><br><span class="line">  _QWORD v32[<span class="number">2</span>]; <span class="comment">// [rsp+98h] [rbp-98h] BYREF</span></span><br><span class="line">  _QWORD v33[<span class="number">2</span>]; <span class="comment">// [rsp+A8h] [rbp-88h] BYREF</span></span><br><span class="line">  _QWORD v34[<span class="number">2</span>]; <span class="comment">// [rsp+B8h] [rbp-78h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v35[<span class="number">8</span>]; <span class="comment">// [rsp+C8h] [rbp-68h] BYREF</span></span><br><span class="line">  __int64 v36; <span class="comment">// [rsp+D0h] [rbp-60h]</span></span><br><span class="line">  __int128 v37; <span class="comment">// [rsp+D8h] [rbp-58h]</span></span><br><span class="line">  <span class="type">char</span> v38[<span class="number">8</span>]; <span class="comment">// [rsp+E8h] [rbp-48h] BYREF</span></span><br><span class="line">  __int64 v39; <span class="comment">// [rsp+F0h] [rbp-40h]</span></span><br><span class="line">  __int128 v40; <span class="comment">// [rsp+F8h] [rbp-38h]</span></span><br><span class="line">  <span class="type">char</span> v41[<span class="number">8</span>]; <span class="comment">// [rsp+108h] [rbp-28h] BYREF</span></span><br><span class="line">  __int64 v42; <span class="comment">// [rsp+110h] [rbp-20h]</span></span><br><span class="line">  __int128 v43; <span class="comment">// [rsp+118h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int64)&amp;v29 &lt;= *(_QWORD *)(*(_QWORD *)NtCurrentTeb()-&gt;NtTib.ArbitraryUserPointer + <span class="number">16LL</span>) )</span><br><span class="line">    runtime_morestack_noctxt();</span><br><span class="line">  v31 = (__int64 *)runtime_newobject((__int64)&amp;unk_4D3020);</span><br><span class="line">  v34[<span class="number">0</span>] = <span class="string">&quot;\b&quot;</span>;</span><br><span class="line">  v34[<span class="number">1</span>] = v31;</span><br><span class="line">  v9 = <span class="number">2</span>;</span><br><span class="line">  v16 = v34;</span><br><span class="line">  v19 = <span class="number">1LL</span>;</span><br><span class="line">  v21 = <span class="number">1LL</span>;</span><br><span class="line">  fmt_Fscanf(v0, v1, (<span class="type">const</span> <span class="type">char</span> *)&amp;off_515980);</span><br><span class="line">  <span class="keyword">if</span> ( v31[<span class="number">1</span>] != <span class="number">40</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">  v41[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v42 = <span class="number">0LL</span>;</span><br><span class="line">  v2 = <span class="number">0LL</span>;</span><br><span class="line">  v43 = <span class="number">0LL</span>;</span><br><span class="line">  v3 = *v31;</span><br><span class="line">  v30 = *v31;</span><br><span class="line">  v4 = v31[<span class="number">1</span>];</span><br><span class="line">  v27 = v4;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; v4; i = v26 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(<span class="type">unsigned</span> __int8 *)(v3 + i) &gt;= <span class="number">0x80</span>u )</span><br><span class="line">    &#123;</span><br><span class="line">      runtime_decoderune(v3, v4, i, v9, (__int64)v16);</span><br><span class="line">      v6 = v17;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v26 = v6;</span><br><span class="line">    v25 = math_big_nat_shl(</span><br><span class="line">            v42,</span><br><span class="line">            v43,</span><br><span class="line">            *((__int64 *)&amp;v43 + <span class="number">1</span>),</span><br><span class="line">            v42,</span><br><span class="line">            v43,</span><br><span class="line">            *((__int64 *)&amp;v43 + <span class="number">1</span>),</span><br><span class="line">            <span class="number">8LL</span>,</span><br><span class="line">            v23,</span><br><span class="line">            v24,</span><br><span class="line">            *((__int64 *)&amp;v24 + <span class="number">1</span>));</span><br><span class="line">    v43 = v24;</span><br><span class="line">    v42 = v23;</span><br><span class="line">    v38[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    v39 = <span class="number">0LL</span>;</span><br><span class="line">    v40 = <span class="number">0LL</span>;</span><br><span class="line">    v10 = math_big___ptr_Int__SetInt64((__int64)v38, SHIDWORD(v25), v7);</span><br><span class="line">    v16 = (_QWORD *)math_big___ptr_Int__Add((__int64)v41, (__int64)v41, v8, v10);</span><br><span class="line">    v4 = v27;</span><br><span class="line">    v3 = v30;</span><br><span class="line">    v2 = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v35[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v36 = <span class="number">0LL</span>;</span><br><span class="line">  v37 = v2;</span><br><span class="line">  v22 = math_big___ptr_Int__SetString(</span><br><span class="line">          (__int64)v35,</span><br><span class="line">          (__int64)<span class="string">&quot;13145309456454850877228433642468099885703532627357198144609408341691751453534987676043709654743561019&quot;</span></span><br><span class="line">                   <span class="string">&quot;0391556347148927592380050533193934285571983556924577144473815598516557161&quot;</span>,</span><br><span class="line">          <span class="number">174LL</span>,</span><br><span class="line">          <span class="number">10LL</span>,</span><br><span class="line">          (__int64)v16,</span><br><span class="line">          v19);</span><br><span class="line">  math_big___ptr_Int__Mul((__int64)v41, (__int64)v41, (__int64)v41, v11);</span><br><span class="line">  math_big___ptr_Int__Mod((__int64)v41, (__int64)v41, (__int64)v35, v12);</span><br><span class="line">  math_big_nat_itoa(v42, v43, DWORD2(v43), v41[<span class="number">0</span>], <span class="number">10LL</span>, v19, v22, v23);</span><br><span class="line">  v19 = runtime_slicebytetostring((__int64)v28, v20, v21, v13);</span><br><span class="line">  <span class="keyword">if</span> ( v18 != <span class="number">173</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">  runtime_memequal(</span><br><span class="line">    v14,</span><br><span class="line">    (__int64)<span class="string">&quot;33529281532734294938614341047870321616766628114182320093600990983456360122704185955921012051918080449587733&quot;</span></span><br><span class="line">             <span class="string">&quot;939007294096845300395098833835443815283246602601870001850089370636&quot;</span>,</span><br><span class="line">    <span class="number">173LL</span>,</span><br><span class="line">    v14);</span><br><span class="line">  <span class="keyword">if</span> ( v15 )</span><br><span class="line">  &#123;</span><br><span class="line">    v33[<span class="number">0</span>] = &amp;unk_4D3020;</span><br><span class="line">    v33[<span class="number">1</span>] = &amp;off_514208;</span><br><span class="line">    fmt_Fprintln((__int64)&amp;off_5159A0, qword_59D910, (__int64)v33, <span class="number">1LL</span>, <span class="number">1LL</span>, v19, v21, v23);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_10:</span><br><span class="line">    v32[<span class="number">0</span>] = &amp;unk_4D3020;</span><br><span class="line">    v32[<span class="number">1</span>] = &amp;off_514218;</span><br><span class="line">    fmt_Fprintln((__int64)&amp;off_5159A0, qword_59D910, (__int64)v32, <span class="number">1LL</span>, <span class="number">1LL</span>, v19, v21, v23);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>v14是我们通过输入计算出的值，来看程序，首先是输入，然后是一个for循环，for里嵌套一个decode程序，不知道是干什么的，刚开始还以为是解密程序，准备试试能不能解密，发现好像不行，那就慢慢跟程序，else里的是把输入的flag转换成ascii然后拼在一块，接下来是一个Mul函数，是将其乘方，然后是一个Mod函数，也就是mod这个大数，最后是equal函数，与大数对比。我们通过输入和输出就可以判断出自己的想法是否正确。</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">输入 <span class="string">&#x27;1&#x27;</span> * <span class="number">40</span></span><br><span class="line">得到 <span class="number">44940666680036190507667229736237320843945547872118244516233712832889597565447002558460113570518306630271439743085954562346590579900861429645286911145287866527699481049284543</span></span><br><span class="line"></span><br><span class="line">猜测：<span class="number">0</span>x31313131313131313131313131313131313131313131313131313131313131313131313131313131 * <span class="number">0</span>x31313131313131313131313131313131313131313131313131313131313131313131313131313131 <span class="comment">% 131453094564548508772284336424680998857035326273571981446094083416917514535349876760437096547435610190391556347148927592380050533193934285571983556924577144473815598516557161 = 44940666680036190507667229736237320843945547872118244516233712832889597565447002558460113570518306630271439743085954562346590579900861429645286911145287866527699481049284543</span></span><br><span class="line">所以我们可以知道，我们要解一个方程 x^<span class="number">2</span> <span class="comment">% big_num = result</span></span><br></pre></td></tr></table></figure>

<p>这玩意是个rabin，纯密码学了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="comment">#导入公钥</span></span><br><span class="line">n=<span class="number">131453094564548508772284336424680998857035326273571981446094083416917514535349876760437096547435610190391556347148927592380050533193934285571983556924577144473815598516557161</span></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line">c=<span class="number">33529281532734294938614341047870321616766628114182320093600990983456360122704185955921012051918080449587733939007294096845300395098833835443815283246602601870001850089370636</span></span><br><span class="line"><span class="comment">#n 在线分解</span></span><br><span class="line">p=<span class="number">17489158711316178659</span></span><br><span class="line">q=<span class="number">7516261744453902635364442762653073356746063224482072262455102025715350278471780391042196223686233375846890331396948280463168691132631674699134296333350979</span></span><br><span class="line">inv_p = gmpy2.invert(p, q)</span><br><span class="line">inv_q = gmpy2.invert(q, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">a = (inv_p * p * mq + inv_q * q * mp) % n</span><br><span class="line">b = n - <span class="built_in">int</span>(a)</span><br><span class="line">c = (inv_p * p * mq - inv_q * q * mp) % n</span><br><span class="line">d = n - <span class="built_in">int</span>(c)</span><br><span class="line"><span class="comment">#因为rabin 加密有四种结果，全部列出。</span></span><br><span class="line">aa=[a,b,c,d]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(i)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#DASCTF&#123;48fa8aa2b489e9adac1750ea16ddc7b5&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="fantansic-maze"><a href="#fantansic-maze" class="headerlink" title="fantansic maze"></a>fantansic maze</h2><p>这题刚开始比赛的时候就在看这个，首先是与靶机交互，先爆破四位sha256，然后得到base64加密的ELF文件，创建新文件发现迷宫，就是要走1000次然后到达func1000。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000001358</span>                 public function_0</span><br><span class="line">.text:<span class="number">0000000000001358</span> function_0      proc near               ; CODE XREF: function_156+<span class="number">85</span>↓p</span><br><span class="line">.text:<span class="number">0000000000001358</span>                                         ; function_328+C1↓p ...</span><br><span class="line">.text:<span class="number">0000000000001358</span></span><br><span class="line">.text:<span class="number">0000000000001358</span> var_4           = dword ptr <span class="number">-4</span></span><br><span class="line">.text:<span class="number">0000000000001358</span></span><br><span class="line">.text:<span class="number">0000000000001358</span> ; __unwind &#123;</span><br><span class="line">.text:<span class="number">0000000000001358</span>                 endbr64</span><br><span class="line">.text:<span class="number">000000000000135</span>C                 push    rbp</span><br><span class="line">.text:<span class="number">000000000000135</span>D                 mov     rbp, rsp</span><br><span class="line">.text:<span class="number">0000000000001360</span>                 sub     rsp, <span class="number">10</span>h</span><br><span class="line">.text:<span class="number">0000000000001364</span>                 mov     eax, cs:tmp</span><br><span class="line">.text:<span class="number">000000000000136</span>A                 add     eax, <span class="number">1</span></span><br><span class="line">.text:<span class="number">000000000000136</span>D                 mov     cs:tmp, eax</span><br><span class="line">.text:<span class="number">0000000000001373</span>                 lea     rdi, s          ; <span class="string">&quot;step1:&quot;</span></span><br><span class="line">.text:<span class="number">000000000000137</span>A                 call    _puts</span><br><span class="line">.text:<span class="number">000000000000137F</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001384</span>                 call    read_num</span><br><span class="line">.text:<span class="number">0000000000001389</span>                 mov     [rbp+var_4], eax</span><br><span class="line">.text:<span class="number">000000000000138</span>C                 cmp     [rbp+var_4], <span class="number">0</span>Ah</span><br><span class="line">.text:<span class="number">0000000000001390</span>                 ja      loc_141E</span><br><span class="line">.text:<span class="number">0000000000001396</span>                 mov     eax, [rbp+var_4]</span><br><span class="line">.text:<span class="number">0000000000001399</span>                 lea     rdx, ds:<span class="number">0</span>[rax*<span class="number">4</span>]</span><br><span class="line">.text:<span class="number">00000000000013</span>A1                 lea     rax, unk_3501C</span><br><span class="line">.text:<span class="number">00000000000013</span>A8                 mov     eax, [rdx+rax]</span><br><span class="line">.text:<span class="number">00000000000013</span>AB                 cdqe</span><br><span class="line">.text:<span class="number">00000000000013</span>AD                 lea     rdx, unk_3501C</span><br><span class="line">.text:<span class="number">00000000000013B</span>4                 add     rax, rdx</span><br><span class="line">.text:<span class="number">00000000000013B</span>7                 db      <span class="number">3</span>Eh</span><br><span class="line">.text:<span class="number">00000000000013B</span>7                 jmp     rax</span><br><span class="line">.text:<span class="number">00000000000013B</span>A ; ---------------------------------------------------------------------------</span><br><span class="line">.text:<span class="number">00000000000013B</span>A                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013B</span>F                 call    function_163</span><br><span class="line">.text:<span class="number">00000000000013</span>C4                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013</span>C9                 call    function_451</span><br><span class="line">.text:<span class="number">00000000000013</span>CE                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013</span>D3                 call    function_771</span><br><span class="line">.text:<span class="number">00000000000013</span>D8                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013</span>DD                 call    function_602</span><br><span class="line">.text:<span class="number">00000000000013E2</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013E7</span>                 call    function_859</span><br><span class="line">.text:<span class="number">00000000000013</span>EC                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013F</span>1                 call    function_998</span><br><span class="line">.text:<span class="number">00000000000013F</span>6                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013F</span>B                 call    function_958</span><br><span class="line">.text:<span class="number">0000000000001400</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001405</span>                 call    function_437</span><br><span class="line">.text:<span class="number">000000000000140</span>A                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">000000000000140F</span>                 call    function_582</span><br><span class="line">.text:<span class="number">0000000000001414</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001419</span>                 call    function_474</span><br><span class="line">.text:<span class="number">000000000000141</span>E</span><br><span class="line">.text:<span class="number">000000000000141</span>E loc_141E:                               ; CODE XREF: function_0+<span class="number">38</span>↑j</span><br><span class="line">.text:<span class="number">000000000000141</span>E                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001423</span>                 call    main</span><br><span class="line">.text:<span class="number">0000000000001428</span>                 nop</span><br><span class="line">.text:<span class="number">0000000000001429</span>                 leave</span><br><span class="line">.text:<span class="number">000000000000142</span>A                 retn</span><br><span class="line">.text:<span class="number">000000000000142</span>A ; &#125; <span class="comment">// starts at 1358</span></span><br><span class="line">.text:<span class="number">000000000000142</span>A function_0      endp</span><br></pre></td></tr></table></figure>

<p>直接看汇编，也就是一个switch，输入1就跳转到function_163这样的。这种switch操作是通过rax寄存器进行跳转，并不是找表来跳转。如果我们每次switch都选择default，其实就可以一直填充计数器，所以只需找一条路直达func1000就行，我们只能从传过来的16进制来分析call指令的地址，call指令占5个字节如<code>00000000000013BF                 call    function_541</code> 在 Hex View 中为<code>\x00\x01\xbd\x7b\xe8</code>(这里为大端序), <code>\xe8</code>可以理解为标志位,<code>\x00\x01\xbd\x7b</code>为地址到跳转函数的<code>00000000000013BF</code>偏移,而这里每一个函数的偏移为0xd3，这里就可以通过偏移来算出<code>call</code>指令所指向的函数,不会写交互脚本，所以只能借鉴出题师傅的脚本来写一遍：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">1447</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pass_proof</span>():</span><br><span class="line">    <span class="built_in">dir</span> = string.ascii_letters + string.digits</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;[+] sha256(XXXX+&#x27;</span>)</span><br><span class="line">    <span class="comment">#salt是已知的后面几位</span></span><br><span class="line">    salt = p.recv(<span class="number">16</span>).strip().decode()</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;) == &#x27;</span>)</span><br><span class="line">    <span class="comment">#hash就是要等于的值</span></span><br><span class="line">    <span class="built_in">hash</span> = p.recv(<span class="number">64</span>).strip().decode()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        rand_str = (<span class="string">&#x27;&#x27;</span>.join([random.choice(<span class="built_in">dir</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)])) + salt</span><br><span class="line">        <span class="keyword">if</span> sha256(rand_str.encode()).hexdigest() == <span class="built_in">hash</span>:</span><br><span class="line">            <span class="built_in">print</span>(rand_str[:<span class="number">4</span>])</span><br><span class="line">            p.sendlineafter(<span class="string">&#x27;[+] Plz Tell Me XXXX :&#x27;</span>, rand_str[:<span class="number">4</span>])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_elf</span>():</span><br><span class="line">    p.recvuntil(<span class="string">&quot;map :\n&quot;</span>)</span><br><span class="line">    data = p.recvuntil(<span class="string">&#x27;That\&#x27;s all\n&#x27;</span>,drop=<span class="literal">True</span>)[:-<span class="number">1</span>]</span><br><span class="line">    data = base64.b64decode(data)</span><br><span class="line">    fd = <span class="built_in">open</span>(<span class="string">&#x27;./1&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    fd.write(data)</span><br><span class="line">    fd.close()</span><br><span class="line"></span><br><span class="line">pass_proof()</span><br><span class="line">get_elf()</span><br><span class="line"></span><br><span class="line">fd = <span class="built_in">open</span>(<span class="string">&quot;./1&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line"><span class="comment">#fucn0地址</span></span><br><span class="line">offset = <span class="number">0x13c0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_map</span>(<span class="params">fd, offset</span>):</span><br><span class="line">    Map = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        addr = offset</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            fd.seek(addr)</span><br><span class="line">            fc = u64(fd.read(<span class="number">4</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">            <span class="keyword">if</span> fc &lt;= <span class="number">0x33765</span>:</span><br><span class="line">                fc = fc // <span class="number">0xd3</span> + i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                fc = fc - <span class="number">0x100000000</span></span><br><span class="line">                <span class="keyword">if</span> fc &gt; -<span class="number">0xd3</span>:</span><br><span class="line">                    fc = i</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">if</span> addr + fc &lt; <span class="number">0x134a</span>:</span><br><span class="line">                        fc = <span class="number">1000</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        fc = fc // <span class="number">0xd3</span></span><br><span class="line">                        fc = fc + i + <span class="number">1</span></span><br><span class="line">            Map.append(fc)</span><br><span class="line">            addr += <span class="number">0xa</span></span><br><span class="line">        offset += <span class="number">0xd3</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> Map</span><br><span class="line">Map = get_map(fd, offset)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">do_bfs</span>(<span class="params">Map</span>):</span><br><span class="line">    values = []</span><br><span class="line">    keys = []</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">                values.append([])</span><br><span class="line">            values[y].append(Map[x + y * <span class="number">10</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        keys.append(i)</span><br><span class="line">    result = <span class="built_in">dict</span>(<span class="built_in">zip</span>(keys, values))</span><br><span class="line">    result[<span class="number">1000</span>] = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment">#print(result)</span></span><br><span class="line">    result1 = <span class="literal">None</span></span><br><span class="line">    q = [(<span class="number">0</span>, <span class="string">&quot;&quot;</span>)]</span><br><span class="line">    check_map = &#123;&#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(q):</span><br><span class="line">        f = q[<span class="number">0</span>]</span><br><span class="line">        q = q[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">if</span>(f[<span class="number">0</span>] == <span class="number">1000</span>):</span><br><span class="line">            result1 = f[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> f[<span class="number">0</span>] <span class="keyword">not</span> <span class="keyword">in</span> check_map:</span><br><span class="line">            check_map[f[<span class="number">0</span>]] = f[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">                <span class="keyword">if</span> result[f[<span class="number">0</span>]][i] <span class="keyword">not</span> <span class="keyword">in</span> check_map:</span><br><span class="line">                    q.append((result[f[<span class="number">0</span>]][i],f[<span class="number">1</span>]+<span class="built_in">str</span>(i)))</span><br><span class="line">    <span class="keyword">return</span> result1</span><br><span class="line"></span><br><span class="line">result = do_bfs(Map)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line">result = <span class="built_in">str</span>(result)</span><br><span class="line">times = <span class="number">999</span> - <span class="built_in">len</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment">#default</span></span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(times):</span><br><span class="line">    p.sendline(<span class="string">&quot;11&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="built_in">int</span>(result[i])+<span class="number">1</span>))</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="bj777"
      src="/images/bitbug_favicon.ico">
  <p class="site-author-name" itemprop="name">bj777</p>
  <div class="site-description" itemprop="description">一位逆向菜狗</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">35</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/jonathanbest7" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jonathanbest7" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/506611735@qq.com" title="E-Mail → 506611735@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/bang-ji-1" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;bang-ji-1" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>知乎</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">bj777</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  
		<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
		<script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
		<script type="text/javascript" src="/js/src/fireworks.js"></script>
  
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":300,"height":600},"mobile":{"show":false},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
