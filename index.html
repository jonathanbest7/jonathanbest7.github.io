<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/bitbug_favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/bitbug_favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jonathanbest7.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="一位逆向菜狗">
<meta property="og:type" content="website">
<meta property="og:title" content="bj777的blog">
<meta property="og:url" content="https://jonathanbest7.github.io/index.html">
<meta property="og:site_name" content="bj777的blog">
<meta property="og:description" content="一位逆向菜狗">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="bj777">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://jonathanbest7.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>bj777的blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">bj777的blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">记录学习每一瞬间</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">25</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/25/DASCTF-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/25/DASCTF-7/" class="post-title-link" itemprop="url">DASCTF_7</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-07-25 11:30:54" itemprop="dateCreated datePublished" datetime="2022-07-25T11:30:54+08:00">2022-07-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-26 09:50:48" itemprop="dateModified" datetime="2022-07-26T09:50:48+08:00">2022-07-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="DASCTF-7月赛"><a href="#DASCTF-7月赛" class="headerlink" title="DASCTF_7月赛"></a>DASCTF_7月赛</h1><p>这次逆向没以前那么坐牢了。</p>
<h2 id="隐秘的角落"><a href="#隐秘的角落" class="headerlink" title="隐秘的角落"></a>隐秘的角落</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">main_main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v1; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v2; <span class="comment">// [rsp+8h] [rbp-88h]</span></span><br><span class="line">  _QWORD *v3; <span class="comment">// [rsp+8h] [rbp-88h]</span></span><br><span class="line">  _QWORD *v4; <span class="comment">// [rsp+50h] [rbp-40h]</span></span><br><span class="line">  _QWORD v5[<span class="number">4</span>]; <span class="comment">// [rsp+58h] [rbp-38h] BYREF</span></span><br><span class="line">  __int64 v6[<span class="number">2</span>]; <span class="comment">// [rsp+78h] [rbp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sync___ptr_WaitGroup__Add((__int64)&amp;main_wg, <span class="number">1LL</span>);</span><br><span class="line">  runtime_newobject((__int64)&amp;unk_4B0DA0, v2);</span><br><span class="line">  v4 = v3;</span><br><span class="line">  v6[<span class="number">0</span>] = (__int64)&amp;unk_4B0DA0;</span><br><span class="line">  v6[<span class="number">1</span>] = (__int64)&amp;off_4E9BB0;</span><br><span class="line">  fmt_Fprintln((__int64)&amp;go_itab__os_File_io_Writer, os_Stdout, (__int64)v6, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  v5[<span class="number">2</span>] = &amp;unk_4AE9C0;</span><br><span class="line">  v5[<span class="number">3</span>] = v4;</span><br><span class="line">  fmt_Fscanf(v0, v1, (<span class="type">const</span> <span class="type">char</span> *)&amp;go_itab__os_File_io_Reader);</span><br><span class="line">  runtime_newproc(<span class="number">16</span>, (<span class="type">char</span>)&amp;off_4D2310, *v4);</span><br><span class="line">  v5[<span class="number">0</span>] = &amp;unk_4B0DA0;</span><br><span class="line">  v5[<span class="number">1</span>] = &amp;off_4E9BC0;</span><br><span class="line">  fmt_Fprintln((__int64)&amp;go_itab__os_File_io_Writer, os_Stdout, (__int64)v5, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  sync___ptr_WaitGroup__Wait((__int64)&amp;main_wg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也是个go，通过动调发现关键函数在off_4D2310，点进去发现有check函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __golang <span class="title function_">main_checkflag</span><span class="params">(__int64 a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v2; <span class="comment">// al</span></span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+18h] [rbp-70h]</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [rsp+18h] [rbp-70h]</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+20h] [rbp-68h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">32</span>]; <span class="comment">// [rsp+40h] [rbp-48h] BYREF</span></span><br><span class="line">  _QWORD v7[<span class="number">2</span>]; <span class="comment">// [rsp+60h] [rbp-28h] BYREF</span></span><br><span class="line">  _QWORD v8[<span class="number">2</span>]; <span class="comment">// [rsp+70h] [rbp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = runtime_stringtoslicebyte((__int64)v6, a1, a2);</span><br><span class="line">  main_Myencode(v3);</span><br><span class="line">  <span class="keyword">if</span> ( v5 == qword_55EA78 )</span><br><span class="line">  &#123;</span><br><span class="line">    runtime_memequal((__int64)main_enc, v3, qword_55EA78, v3);</span><br><span class="line">    v2 = v4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v8[<span class="number">0</span>] = &amp;unk_4B0DA0;</span><br><span class="line">    v8[<span class="number">1</span>] = &amp;off_4E9B90;</span><br><span class="line">    fmt_Fprintln((__int64)&amp;go_itab__os_File_io_Writer, os_Stdout, (__int64)v8, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v7[<span class="number">0</span>] = &amp;unk_4B0DA0;</span><br><span class="line">    v7[<span class="number">1</span>] = &amp;off_4E9BA0;</span><br><span class="line">    fmt_Fprintln((__int64)&amp;go_itab__os_File_io_Writer, os_Stdout, (__int64)v7, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sync___ptr_WaitGroup__Add((__int64)&amp;main_wg, <span class="number">-1LL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接看encode，发现是rc4，交叉引用密文和密钥，发现密文在init段被异或了，拿脚本直接解了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_main</span>(<span class="params">key=<span class="string">&quot;init_key&quot;</span>, message=<span class="string">&quot;init_message&quot;</span></span>):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;RC4解密主函数调用成功&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  s_box = rc4_init_sbox(key)</span><br><span class="line">  crypt = rc4_excrypt(message, s_box)</span><br><span class="line">  <span class="keyword">return</span> crypt</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_init_sbox</span>(<span class="params">key</span>):</span><br><span class="line">  s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;原来的 s 盒：%s&quot;</span> % s_box)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  j = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    j = (j + s_box[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">    s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;混乱后的 s 盒：%s&quot;</span> % s_box)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> s_box</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_excrypt</span>(<span class="params">plain, box</span>):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;调用解密程序成功。&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  plain = base64.b64decode(plain.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">  plain = <span class="built_in">bytes</span>.decode(plain)</span><br><span class="line">  res = []</span><br><span class="line">  i = j = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">    i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">    j = (j + box[i]) % <span class="number">256</span></span><br><span class="line">    box[i], box[j] = box[j], box[i]</span><br><span class="line">    t = (box[i] + box[j]) % <span class="number">256</span></span><br><span class="line">    k = box[t]</span><br><span class="line">    res.append((<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;res用于解密字符串，解密后是：%res&quot;</span> % res)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  cipher = <span class="string">&quot;&quot;</span>.join(res)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;解密后的字符串是：%s&quot;</span> % cipher)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> cipher</span><br><span class="line"><span class="comment">#a=[0xE0,0xB2,0x5F,0x3D,0x8F,0xFA,0x94,0xB6,0xE7,0x9D,0x6C,0x98,0x66,0xD2,0x0F,0xEA,0x6D,0x6F,0xBE,0xC5,0x71,0x40,0x08,0x1B,0xF6,0xF3,0xBD,0xA8,0x8D,0x09,0x7B,0x7C]</span></span><br><span class="line">a = [<span class="number">251</span>, <span class="number">198</span>, <span class="number">166</span>, <span class="number">157</span>, <span class="number">196</span>, <span class="number">219</span>, <span class="number">123</span>, <span class="number">86</span>, <span class="number">182</span>, <span class="number">70</span>, <span class="number">166</span>, <span class="number">192</span>, <span class="number">133</span>, <span class="number">100</span>, <span class="number">122</span>, <span class="number">154</span>, <span class="number">55</span>, <span class="number">76</span>, <span class="number">16</span>, <span class="number">150</span>, <span class="number">233</span>, <span class="number">167</span>, <span class="number">40</span>, <span class="number">196</span>, <span class="number">177</span>, <span class="number">45</span>, <span class="number">241</span>, <span class="number">222</span>, <span class="number">71</span>, <span class="number">59</span>, <span class="number">181</span>, <span class="number">243</span>, <span class="number">44</span>, <span class="number">125</span>, <span class="number">103</span>, <span class="number">29</span>]</span><br><span class="line">s = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">  s += <span class="built_in">chr</span>(i)</span><br><span class="line">s = <span class="built_in">str</span>(base64.b64encode(s.encode(<span class="string">&#x27;utf-8&#x27;</span>)), <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">rc4_main(<span class="string">&quot;thisiskkk&quot;</span>, s)</span><br></pre></td></tr></table></figure>



<h2 id="EzGo"><a href="#EzGo" class="headerlink" title="EzGo"></a>EzGo</h2><p>这个题又是go，确实不难。难的是解方程。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">main_main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v1; <span class="comment">// rsi</span></span><br><span class="line">  __int128 v2; <span class="comment">// xmm0</span></span><br><span class="line">  __int64 v3; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 i; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+10h] [rbp-120h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+10h] [rbp-120h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int64 v12; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int128 v13; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  <span class="type">char</span> v15; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  _QWORD *v16; <span class="comment">// [rsp+20h] [rbp-110h]</span></span><br><span class="line">  __int64 v17; <span class="comment">// [rsp+20h] [rbp-110h]</span></span><br><span class="line">  __int64 v18; <span class="comment">// [rsp+20h] [rbp-110h]</span></span><br><span class="line">  __int64 v19; <span class="comment">// [rsp+28h] [rbp-108h]</span></span><br><span class="line">  __int64 v20; <span class="comment">// [rsp+28h] [rbp-108h]</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp+30h] [rbp-100h]</span></span><br><span class="line">  __int64 v22; <span class="comment">// [rsp+30h] [rbp-100h]</span></span><br><span class="line">  __int64 v23; <span class="comment">// [rsp+38h] [rbp-F8h]</span></span><br><span class="line">  __int128 v24; <span class="comment">// [rsp+40h] [rbp-F0h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+50h] [rbp-E0h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+58h] [rbp-D8h]</span></span><br><span class="line">  __int64 v27; <span class="comment">// [rsp+60h] [rbp-D0h]</span></span><br><span class="line">  <span class="type">char</span> v28[<span class="number">24</span>]; <span class="comment">// [rsp+68h] [rbp-C8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v29; <span class="comment">// [rsp+80h] [rbp-B0h] BYREF</span></span><br><span class="line">  __int64 v30; <span class="comment">// [rsp+88h] [rbp-A8h]</span></span><br><span class="line">  __int64 *v31; <span class="comment">// [rsp+90h] [rbp-A0h]</span></span><br><span class="line">  _QWORD v32[<span class="number">2</span>]; <span class="comment">// [rsp+98h] [rbp-98h] BYREF</span></span><br><span class="line">  _QWORD v33[<span class="number">2</span>]; <span class="comment">// [rsp+A8h] [rbp-88h] BYREF</span></span><br><span class="line">  _QWORD v34[<span class="number">2</span>]; <span class="comment">// [rsp+B8h] [rbp-78h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v35[<span class="number">8</span>]; <span class="comment">// [rsp+C8h] [rbp-68h] BYREF</span></span><br><span class="line">  __int64 v36; <span class="comment">// [rsp+D0h] [rbp-60h]</span></span><br><span class="line">  __int128 v37; <span class="comment">// [rsp+D8h] [rbp-58h]</span></span><br><span class="line">  <span class="type">char</span> v38[<span class="number">8</span>]; <span class="comment">// [rsp+E8h] [rbp-48h] BYREF</span></span><br><span class="line">  __int64 v39; <span class="comment">// [rsp+F0h] [rbp-40h]</span></span><br><span class="line">  __int128 v40; <span class="comment">// [rsp+F8h] [rbp-38h]</span></span><br><span class="line">  <span class="type">char</span> v41[<span class="number">8</span>]; <span class="comment">// [rsp+108h] [rbp-28h] BYREF</span></span><br><span class="line">  __int64 v42; <span class="comment">// [rsp+110h] [rbp-20h]</span></span><br><span class="line">  __int128 v43; <span class="comment">// [rsp+118h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int64)&amp;v29 &lt;= *(_QWORD *)(*(_QWORD *)NtCurrentTeb()-&gt;NtTib.ArbitraryUserPointer + <span class="number">16LL</span>) )</span><br><span class="line">    runtime_morestack_noctxt();</span><br><span class="line">  v31 = (__int64 *)runtime_newobject((__int64)&amp;unk_4D3020);</span><br><span class="line">  v34[<span class="number">0</span>] = <span class="string">&quot;\b&quot;</span>;</span><br><span class="line">  v34[<span class="number">1</span>] = v31;</span><br><span class="line">  v9 = <span class="number">2</span>;</span><br><span class="line">  v16 = v34;</span><br><span class="line">  v19 = <span class="number">1LL</span>;</span><br><span class="line">  v21 = <span class="number">1LL</span>;</span><br><span class="line">  fmt_Fscanf(v0, v1, (<span class="type">const</span> <span class="type">char</span> *)&amp;off_515980);</span><br><span class="line">  <span class="keyword">if</span> ( v31[<span class="number">1</span>] != <span class="number">40</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">  v41[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v42 = <span class="number">0LL</span>;</span><br><span class="line">  v2 = <span class="number">0LL</span>;</span><br><span class="line">  v43 = <span class="number">0LL</span>;</span><br><span class="line">  v3 = *v31;</span><br><span class="line">  v30 = *v31;</span><br><span class="line">  v4 = v31[<span class="number">1</span>];</span><br><span class="line">  v27 = v4;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; v4; i = v26 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(<span class="type">unsigned</span> __int8 *)(v3 + i) &gt;= <span class="number">0x80</span>u )</span><br><span class="line">    &#123;</span><br><span class="line">      runtime_decoderune(v3, v4, i, v9, (__int64)v16);</span><br><span class="line">      v6 = v17;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v26 = v6;</span><br><span class="line">    v25 = math_big_nat_shl(</span><br><span class="line">            v42,</span><br><span class="line">            v43,</span><br><span class="line">            *((__int64 *)&amp;v43 + <span class="number">1</span>),</span><br><span class="line">            v42,</span><br><span class="line">            v43,</span><br><span class="line">            *((__int64 *)&amp;v43 + <span class="number">1</span>),</span><br><span class="line">            <span class="number">8LL</span>,</span><br><span class="line">            v23,</span><br><span class="line">            v24,</span><br><span class="line">            *((__int64 *)&amp;v24 + <span class="number">1</span>));</span><br><span class="line">    v43 = v24;</span><br><span class="line">    v42 = v23;</span><br><span class="line">    v38[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    v39 = <span class="number">0LL</span>;</span><br><span class="line">    v40 = <span class="number">0LL</span>;</span><br><span class="line">    v10 = math_big___ptr_Int__SetInt64((__int64)v38, SHIDWORD(v25), v7);</span><br><span class="line">    v16 = (_QWORD *)math_big___ptr_Int__Add((__int64)v41, (__int64)v41, v8, v10);</span><br><span class="line">    v4 = v27;</span><br><span class="line">    v3 = v30;</span><br><span class="line">    v2 = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v35[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v36 = <span class="number">0LL</span>;</span><br><span class="line">  v37 = v2;</span><br><span class="line">  v22 = math_big___ptr_Int__SetString(</span><br><span class="line">          (__int64)v35,</span><br><span class="line">          (__int64)<span class="string">&quot;13145309456454850877228433642468099885703532627357198144609408341691751453534987676043709654743561019&quot;</span></span><br><span class="line">                   <span class="string">&quot;0391556347148927592380050533193934285571983556924577144473815598516557161&quot;</span>,</span><br><span class="line">          <span class="number">174LL</span>,</span><br><span class="line">          <span class="number">10LL</span>,</span><br><span class="line">          (__int64)v16,</span><br><span class="line">          v19);</span><br><span class="line">  math_big___ptr_Int__Mul((__int64)v41, (__int64)v41, (__int64)v41, v11);</span><br><span class="line">  math_big___ptr_Int__Mod((__int64)v41, (__int64)v41, (__int64)v35, v12);</span><br><span class="line">  math_big_nat_itoa(v42, v43, DWORD2(v43), v41[<span class="number">0</span>], <span class="number">10LL</span>, v19, v22, v23);</span><br><span class="line">  v19 = runtime_slicebytetostring((__int64)v28, v20, v21, v13);</span><br><span class="line">  <span class="keyword">if</span> ( v18 != <span class="number">173</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">  runtime_memequal(</span><br><span class="line">    v14,</span><br><span class="line">    (__int64)<span class="string">&quot;33529281532734294938614341047870321616766628114182320093600990983456360122704185955921012051918080449587733&quot;</span></span><br><span class="line">             <span class="string">&quot;939007294096845300395098833835443815283246602601870001850089370636&quot;</span>,</span><br><span class="line">    <span class="number">173LL</span>,</span><br><span class="line">    v14);</span><br><span class="line">  <span class="keyword">if</span> ( v15 )</span><br><span class="line">  &#123;</span><br><span class="line">    v33[<span class="number">0</span>] = &amp;unk_4D3020;</span><br><span class="line">    v33[<span class="number">1</span>] = &amp;off_514208;</span><br><span class="line">    fmt_Fprintln((__int64)&amp;off_5159A0, qword_59D910, (__int64)v33, <span class="number">1LL</span>, <span class="number">1LL</span>, v19, v21, v23);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_10:</span><br><span class="line">    v32[<span class="number">0</span>] = &amp;unk_4D3020;</span><br><span class="line">    v32[<span class="number">1</span>] = &amp;off_514218;</span><br><span class="line">    fmt_Fprintln((__int64)&amp;off_5159A0, qword_59D910, (__int64)v32, <span class="number">1LL</span>, <span class="number">1LL</span>, v19, v21, v23);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>v14是我们通过输入计算出的值，来看程序，首先是输入，然后是一个for循环，for里嵌套一个decode程序，不知道是干什么的，刚开始还以为是解密程序，准备试试能不能解密，发现好像不行，那就慢慢跟程序，else里的是把输入的flag转换成ascii然后拼在一块，接下来是一个Mul函数，是将其乘方，然后是一个Mod函数，也就是mod这个大数，最后是equal函数，与大数对比。我们通过输入和输出就可以判断出自己的想法是否正确。</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">输入 <span class="string">&#x27;1&#x27;</span> * <span class="number">40</span></span><br><span class="line">得到 <span class="number">44940666680036190507667229736237320843945547872118244516233712832889597565447002558460113570518306630271439743085954562346590579900861429645286911145287866527699481049284543</span></span><br><span class="line"></span><br><span class="line">猜测：<span class="number">0</span>x31313131313131313131313131313131313131313131313131313131313131313131313131313131 * <span class="number">0</span>x31313131313131313131313131313131313131313131313131313131313131313131313131313131 <span class="comment">% 131453094564548508772284336424680998857035326273571981446094083416917514535349876760437096547435610190391556347148927592380050533193934285571983556924577144473815598516557161 = 44940666680036190507667229736237320843945547872118244516233712832889597565447002558460113570518306630271439743085954562346590579900861429645286911145287866527699481049284543</span></span><br><span class="line">所以我们可以知道，我们要解一个方程 x^<span class="number">2</span> <span class="comment">% big_num = result</span></span><br></pre></td></tr></table></figure>

<p>这玩意是个rabin，纯密码学了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="comment">#导入公钥</span></span><br><span class="line">n=<span class="number">131453094564548508772284336424680998857035326273571981446094083416917514535349876760437096547435610190391556347148927592380050533193934285571983556924577144473815598516557161</span></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line">c=<span class="number">33529281532734294938614341047870321616766628114182320093600990983456360122704185955921012051918080449587733939007294096845300395098833835443815283246602601870001850089370636</span></span><br><span class="line"><span class="comment">#n 在线分解</span></span><br><span class="line">p=<span class="number">17489158711316178659</span></span><br><span class="line">q=<span class="number">7516261744453902635364442762653073356746063224482072262455102025715350278471780391042196223686233375846890331396948280463168691132631674699134296333350979</span></span><br><span class="line">inv_p = gmpy2.invert(p, q)</span><br><span class="line">inv_q = gmpy2.invert(q, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">a = (inv_p * p * mq + inv_q * q * mp) % n</span><br><span class="line">b = n - <span class="built_in">int</span>(a)</span><br><span class="line">c = (inv_p * p * mq - inv_q * q * mp) % n</span><br><span class="line">d = n - <span class="built_in">int</span>(c)</span><br><span class="line"><span class="comment">#因为rabin 加密有四种结果，全部列出。</span></span><br><span class="line">aa=[a,b,c,d]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(i)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#DASCTF&#123;48fa8aa2b489e9adac1750ea16ddc7b5&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="fantansic-maze"><a href="#fantansic-maze" class="headerlink" title="fantansic maze"></a>fantansic maze</h2><p>这题刚开始比赛的时候就在看这个，首先是与靶机交互，先爆破四位sha256，然后得到base64加密的ELF文件，创建新文件发现迷宫，就是要走1000次然后到达func1000。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000001358</span>                 public function_0</span><br><span class="line">.text:<span class="number">0000000000001358</span> function_0      proc near               ; CODE XREF: function_156+<span class="number">85</span>↓p</span><br><span class="line">.text:<span class="number">0000000000001358</span>                                         ; function_328+C1↓p ...</span><br><span class="line">.text:<span class="number">0000000000001358</span></span><br><span class="line">.text:<span class="number">0000000000001358</span> var_4           = dword ptr <span class="number">-4</span></span><br><span class="line">.text:<span class="number">0000000000001358</span></span><br><span class="line">.text:<span class="number">0000000000001358</span> ; __unwind &#123;</span><br><span class="line">.text:<span class="number">0000000000001358</span>                 endbr64</span><br><span class="line">.text:<span class="number">000000000000135</span>C                 push    rbp</span><br><span class="line">.text:<span class="number">000000000000135</span>D                 mov     rbp, rsp</span><br><span class="line">.text:<span class="number">0000000000001360</span>                 sub     rsp, <span class="number">10</span>h</span><br><span class="line">.text:<span class="number">0000000000001364</span>                 mov     eax, cs:tmp</span><br><span class="line">.text:<span class="number">000000000000136</span>A                 add     eax, <span class="number">1</span></span><br><span class="line">.text:<span class="number">000000000000136</span>D                 mov     cs:tmp, eax</span><br><span class="line">.text:<span class="number">0000000000001373</span>                 lea     rdi, s          ; <span class="string">&quot;step1:&quot;</span></span><br><span class="line">.text:<span class="number">000000000000137</span>A                 call    _puts</span><br><span class="line">.text:<span class="number">000000000000137F</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001384</span>                 call    read_num</span><br><span class="line">.text:<span class="number">0000000000001389</span>                 mov     [rbp+var_4], eax</span><br><span class="line">.text:<span class="number">000000000000138</span>C                 cmp     [rbp+var_4], <span class="number">0</span>Ah</span><br><span class="line">.text:<span class="number">0000000000001390</span>                 ja      loc_141E</span><br><span class="line">.text:<span class="number">0000000000001396</span>                 mov     eax, [rbp+var_4]</span><br><span class="line">.text:<span class="number">0000000000001399</span>                 lea     rdx, ds:<span class="number">0</span>[rax*<span class="number">4</span>]</span><br><span class="line">.text:<span class="number">00000000000013</span>A1                 lea     rax, unk_3501C</span><br><span class="line">.text:<span class="number">00000000000013</span>A8                 mov     eax, [rdx+rax]</span><br><span class="line">.text:<span class="number">00000000000013</span>AB                 cdqe</span><br><span class="line">.text:<span class="number">00000000000013</span>AD                 lea     rdx, unk_3501C</span><br><span class="line">.text:<span class="number">00000000000013B</span>4                 add     rax, rdx</span><br><span class="line">.text:<span class="number">00000000000013B</span>7                 db      <span class="number">3</span>Eh</span><br><span class="line">.text:<span class="number">00000000000013B</span>7                 jmp     rax</span><br><span class="line">.text:<span class="number">00000000000013B</span>A ; ---------------------------------------------------------------------------</span><br><span class="line">.text:<span class="number">00000000000013B</span>A                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013B</span>F                 call    function_163</span><br><span class="line">.text:<span class="number">00000000000013</span>C4                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013</span>C9                 call    function_451</span><br><span class="line">.text:<span class="number">00000000000013</span>CE                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013</span>D3                 call    function_771</span><br><span class="line">.text:<span class="number">00000000000013</span>D8                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013</span>DD                 call    function_602</span><br><span class="line">.text:<span class="number">00000000000013E2</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013E7</span>                 call    function_859</span><br><span class="line">.text:<span class="number">00000000000013</span>EC                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013F</span>1                 call    function_998</span><br><span class="line">.text:<span class="number">00000000000013F</span>6                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000000013F</span>B                 call    function_958</span><br><span class="line">.text:<span class="number">0000000000001400</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001405</span>                 call    function_437</span><br><span class="line">.text:<span class="number">000000000000140</span>A                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">000000000000140F</span>                 call    function_582</span><br><span class="line">.text:<span class="number">0000000000001414</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001419</span>                 call    function_474</span><br><span class="line">.text:<span class="number">000000000000141</span>E</span><br><span class="line">.text:<span class="number">000000000000141</span>E loc_141E:                               ; CODE XREF: function_0+<span class="number">38</span>↑j</span><br><span class="line">.text:<span class="number">000000000000141</span>E                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001423</span>                 call    main</span><br><span class="line">.text:<span class="number">0000000000001428</span>                 nop</span><br><span class="line">.text:<span class="number">0000000000001429</span>                 leave</span><br><span class="line">.text:<span class="number">000000000000142</span>A                 retn</span><br><span class="line">.text:<span class="number">000000000000142</span>A ; &#125; <span class="comment">// starts at 1358</span></span><br><span class="line">.text:<span class="number">000000000000142</span>A function_0      endp</span><br></pre></td></tr></table></figure>

<p>直接看汇编，也就是一个switch，输入1就跳转到function_163这样的。这种switch操作是通过rax寄存器进行跳转，并不是找表来跳转。如果我们每次switch都选择default，其实就可以一直填充计数器，所以只需找一条路直达func1000就行，我们只能从传过来的16进制来分析call指令的地址，call指令占5个字节如<code>00000000000013BF                 call    function_541</code> 在 Hex View 中为<code>\x00\x01\xbd\x7b\xe8</code>(这里为大端序), <code>\xe8</code>可以理解为标志位,<code>\x00\x01\xbd\x7b</code>为地址到跳转函数的<code>00000000000013BF</code>偏移,而这里每一个函数的偏移为0xd3，这里就可以通过偏移来算出<code>call</code>指令所指向的函数,不会写交互脚本，所以只能借鉴出题师傅的脚本来写一遍：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">1447</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pass_proof</span>():</span><br><span class="line">    <span class="built_in">dir</span> = string.ascii_letters + string.digits</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;[+] sha256(XXXX+&#x27;</span>)</span><br><span class="line">    <span class="comment">#salt是已知的后面几位</span></span><br><span class="line">    salt = p.recv(<span class="number">16</span>).strip().decode()</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;) == &#x27;</span>)</span><br><span class="line">    <span class="comment">#hash就是要等于的值</span></span><br><span class="line">    <span class="built_in">hash</span> = p.recv(<span class="number">64</span>).strip().decode()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        rand_str = (<span class="string">&#x27;&#x27;</span>.join([random.choice(<span class="built_in">dir</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)])) + salt</span><br><span class="line">        <span class="keyword">if</span> sha256(rand_str.encode()).hexdigest() == <span class="built_in">hash</span>:</span><br><span class="line">            <span class="built_in">print</span>(rand_str[:<span class="number">4</span>])</span><br><span class="line">            p.sendlineafter(<span class="string">&#x27;[+] Plz Tell Me XXXX :&#x27;</span>, rand_str[:<span class="number">4</span>])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_elf</span>():</span><br><span class="line">    p.recvuntil(<span class="string">&quot;map :\n&quot;</span>)</span><br><span class="line">    data = p.recvuntil(<span class="string">&#x27;That\&#x27;s all\n&#x27;</span>,drop=<span class="literal">True</span>)[:-<span class="number">1</span>]</span><br><span class="line">    data = base64.b64decode(data)</span><br><span class="line">    fd = <span class="built_in">open</span>(<span class="string">&#x27;./1&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    fd.write(data)</span><br><span class="line">    fd.close()</span><br><span class="line"></span><br><span class="line">pass_proof()</span><br><span class="line">get_elf()</span><br><span class="line"></span><br><span class="line">fd = <span class="built_in">open</span>(<span class="string">&quot;./1&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line"><span class="comment">#fucn0地址</span></span><br><span class="line">offset = <span class="number">0x13c0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_map</span>(<span class="params">fd, offset</span>):</span><br><span class="line">    Map = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        addr = offset</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            fd.seek(addr)</span><br><span class="line">            fc = u64(fd.read(<span class="number">4</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">            <span class="keyword">if</span> fc &lt;= <span class="number">0x33765</span>:</span><br><span class="line">                fc = fc // <span class="number">0xd3</span> + i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                fc = fc - <span class="number">0x100000000</span></span><br><span class="line">                <span class="keyword">if</span> fc &gt; -<span class="number">0xd3</span>:</span><br><span class="line">                    fc = i</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">if</span> addr + fc &lt; <span class="number">0x134a</span>:</span><br><span class="line">                        fc = <span class="number">1000</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        fc = fc // <span class="number">0xd3</span></span><br><span class="line">                        fc = fc + i + <span class="number">1</span></span><br><span class="line">            Map.append(fc)</span><br><span class="line">            addr += <span class="number">0xa</span></span><br><span class="line">        offset += <span class="number">0xd3</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> Map</span><br><span class="line">Map = get_map(fd, offset)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">do_bfs</span>(<span class="params">Map</span>):</span><br><span class="line">    values = []</span><br><span class="line">    keys = []</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">                values.append([])</span><br><span class="line">            values[y].append(Map[x + y * <span class="number">10</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        keys.append(i)</span><br><span class="line">    result = <span class="built_in">dict</span>(<span class="built_in">zip</span>(keys, values))</span><br><span class="line">    result[<span class="number">1000</span>] = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment">#print(result)</span></span><br><span class="line">    result1 = <span class="literal">None</span></span><br><span class="line">    q = [(<span class="number">0</span>, <span class="string">&quot;&quot;</span>)]</span><br><span class="line">    check_map = &#123;&#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(q):</span><br><span class="line">        f = q[<span class="number">0</span>]</span><br><span class="line">        q = q[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">if</span>(f[<span class="number">0</span>] == <span class="number">1000</span>):</span><br><span class="line">            result1 = f[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> f[<span class="number">0</span>] <span class="keyword">not</span> <span class="keyword">in</span> check_map:</span><br><span class="line">            check_map[f[<span class="number">0</span>]] = f[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">                <span class="keyword">if</span> result[f[<span class="number">0</span>]][i] <span class="keyword">not</span> <span class="keyword">in</span> check_map:</span><br><span class="line">                    q.append((result[f[<span class="number">0</span>]][i],f[<span class="number">1</span>]+<span class="built_in">str</span>(i)))</span><br><span class="line">    <span class="keyword">return</span> result1</span><br><span class="line"></span><br><span class="line">result = do_bfs(Map)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line">result = <span class="built_in">str</span>(result)</span><br><span class="line">times = <span class="number">999</span> - <span class="built_in">len</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment">#default</span></span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(times):</span><br><span class="line">    p.sendline(<span class="string">&quot;11&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="built_in">int</span>(result[i])+<span class="number">1</span>))</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/18/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%AD%E7%9A%84%E6%B5%AE%E7%82%B9%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/18/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%AD%E7%9A%84%E6%B5%AE%E7%82%B9%E6%95%B0/" class="post-title-link" itemprop="url">深入理解计算机中的浮点数</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-07-18 00:15:09" itemprop="dateCreated datePublished" datetime="2022-07-18T00:15:09+08:00">2022-07-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/18/VNCTF2022/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/18/VNCTF2022/" class="post-title-link" itemprop="url">VNCTF2022</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-07-18 00:14:18" itemprop="dateCreated datePublished" datetime="2022-07-18T00:14:18+08:00">2022-07-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/18/SUSCTF2022/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/18/SUSCTF2022/" class="post-title-link" itemprop="url">SUSCTF2022</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-07-18 00:13:43 / 修改时间：00:54:54" itemprop="dateCreated datePublished" datetime="2022-07-18T00:13:43+08:00">2022-07-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SUSCTF2022"><a href="#SUSCTF2022" class="headerlink" title="SUSCTF2022"></a>SUSCTF2022</h1><p>简述：应该是第一次和syclover的师傅们一块参与到比赛中（tql就出一道签到，不算），本次做出了4道题，两道逆向，两道misc，只交了两道misc，逆向师傅太强了！！！</p>
<p><img src="/SUSCTF2022/11.png"></p>
<p>师傅们都太强了！！！！！</p>
<h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="DigitalCircuits"><a href="#DigitalCircuits" class="headerlink" title="DigitalCircuits"></a><strong>DigitalCircuits</strong></h3><p>给了一个exe的包，包上图片是python。在极客大挑战中就遇到过这种问题，我们首先将exe转成pyc文件：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python</span> pyinstxtractor.<span class="keyword">py</span> DigitalCircuits.<span class="keyword">exe</span></span><br></pre></td></tr></table></figure>

<p>然后取出生成文件夹的struct和同名pyc文件，将struct文件前16字节覆盖到pyc文件上，然后反编译pyc文件。</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uncompyle6 <span class="module-access"><span class="module"><span class="identifier">DigitalCircuits</span>.</span></span>pyc &gt; <span class="module-access"><span class="module"><span class="identifier">DigitalCircuits</span>.</span></span>py</span><br></pre></td></tr></table></figure>

<p>得到源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f1</span>(<span class="params">a, b</span>):</span><br><span class="line">  <span class="keyword">if</span> a == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> b == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f2</span>(<span class="params">a, b</span>):</span><br><span class="line">  <span class="keyword">if</span> a == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> b == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f3</span>(<span class="params">a</span>):</span><br><span class="line">  <span class="keyword">if</span> a == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> a == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f4</span>(<span class="params">a, b</span>):</span><br><span class="line">  <span class="keyword">return</span> f2(f1(a, f3(b)), f1(f3(a), b))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f5</span>(<span class="params">x, y, z</span>):</span><br><span class="line">  s = f4(f4(x, y), z)</span><br><span class="line">  c = f2(f1(x, y), f1(z, f2(x, y)))</span><br><span class="line">  <span class="keyword">return</span> (s, c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f6</span>(<span class="params">a, b</span>):</span><br><span class="line">  ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  z = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">  a = a[::-<span class="number">1</span>]</span><br><span class="line">  b = b[::-<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    ans += f5(a[i], b[i], z)[<span class="number">0</span>]</span><br><span class="line">    z = f5(a[i], b[i], z)[<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">return</span> ans[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f7</span>(<span class="params">a, n</span>):</span><br><span class="line">  <span class="keyword">return</span> a[n:] + <span class="string">&#x27;0&#x27;</span> * n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f8</span>(<span class="params">a, n</span>):</span><br><span class="line">  <span class="keyword">return</span> n * <span class="string">&#x27;0&#x27;</span> + a[:-n]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f9</span>(<span class="params">a, b</span>):</span><br><span class="line">  ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    ans += f4(a[i], b[i])</span><br><span class="line">  <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f10</span>(<span class="params">v0, v1, k0, k1, k2, k3</span>):</span><br><span class="line">  s = <span class="string">&#x27;00000000000000000000000000000000&#x27;</span></span><br><span class="line">  d = <span class="string">&#x27;10011110001101110111100110111001&#x27;</span><span class="comment">#这是delta的值，老朋友了</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    s = f6(s, d)</span><br><span class="line">    v0 = f6(v0, f9(f9(f6(f7(v1, <span class="number">4</span>), k0), f6(v1, s)), f6(f8(v1, <span class="number">5</span>), k1))) <span class="comment">#从常数猜测是tea加密，并没有&amp;3，不是xtea</span></span><br><span class="line">    v1 = f6(v1, f9(f9(f6(f7(v0, <span class="number">4</span>), k2), f6(v0, s)), f6(f8(v0, <span class="number">5</span>), k3)))</span><br><span class="line">  <span class="keyword">return</span> v0 + v1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k0 = <span class="string">&#x27;0100010001000101&#x27;</span>.zfill(<span class="number">32</span>)  <span class="comment">#密钥，zfill是将前面的数补成后面长度，前面加0</span></span><br><span class="line">k1 = <span class="string">&#x27;0100000101000100&#x27;</span>.zfill(<span class="number">32</span>)  <span class="comment">#密钥</span></span><br><span class="line">k2 = <span class="string">&#x27;0100001001000101&#x27;</span>.zfill(<span class="number">32</span>)  <span class="comment">#密钥</span></span><br><span class="line">k3 = <span class="string">&#x27;0100010101000110&#x27;</span>.zfill(<span class="number">32</span>)  <span class="comment">#密钥</span></span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&#x27;please input flag:&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> flag[<span class="number">0</span>:<span class="number">7</span>] != <span class="string">&#x27;SUSCTF&#123;&#x27;</span> <span class="keyword">or</span> flag[(-<span class="number">1</span>)] != <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Error!!!The formate of flag is SUSCTF&#123;XXX&#125;&#x27;</span>)</span><br><span class="line">  time.sleep(<span class="number">5</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line">flagstr = flag[<span class="number">7</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(flagstr) != <span class="number">24</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Error!!!The length of flag 24&#x27;</span>)</span><br><span class="line">  time.sleep(<span class="number">5</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flagstr), <span class="number">8</span>):</span><br><span class="line">    v0 = flagstr[i:i + <span class="number">4</span>]</span><br><span class="line">    v0 = <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[i]))[<span class="number">2</span>:].zfill(<span class="number">8</span>) + <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">1</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>) + <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">2</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>) + <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">3</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line">    v1 = <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">4</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>) + <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">5</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>) + <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">6</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>) + <span class="built_in">bin</span>(<span class="built_in">ord</span>(flagstr[(i + <span class="number">7</span>)]))[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line">    res += f10(v0, v1, k0, k1, k2, k3)</span><br><span class="line">  <span class="keyword">if</span> res == <span class="string">&#x27;00111110100010010100011111001011 11001100100101000100011000111001 00110001001101011000001110001000 00111011000010110110100010010011 11011010011000100111001101100001 00111011001011100110010000100111&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;True&#x27;</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;False&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line"><span class="comment"># okay decompiling DigitalCircuits.pyc</span></span><br></pre></td></tr></table></figure>

<p>很显然从f10能看出这就是个tea加密，并且没有魔改：</p>
<p>但从res能看出是3组数组，不是4组，所以给出脚本：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">btea</span> <span class="params">(<span class="type">uint32_t</span>* v,<span class="type">int</span> n, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">  <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0xC6EF3720</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">  <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;           <span class="comment">/* a key schedule constant */</span></span><br><span class="line">  <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];  <span class="comment">/* cache key */</span></span><br><span class="line">  <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;             <span class="comment">/* basic cycle start */</span></span><br><span class="line">    v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">    v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">    sum -= delta;</span><br><span class="line">  &#125;                        <span class="comment">/* end cycle */</span></span><br><span class="line">  v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">uint32_t</span> v[<span class="number">2</span>]= &#123;<span class="number">0x3e8947cb</span>,<span class="number">0xcc944639</span>&#125;;</span><br><span class="line">  <span class="type">uint32_t</span> w[<span class="number">2</span>]= &#123;<span class="number">0x31358388</span>,<span class="number">0x3b0b6893</span>&#125;;</span><br><span class="line">  <span class="type">uint32_t</span> x[<span class="number">2</span>]= &#123;<span class="number">0xda627361</span>,<span class="number">0x3b2e6427</span>&#125;;</span><br><span class="line">  <span class="type">uint32_t</span> k[<span class="number">4</span>]= &#123;<span class="number">17477</span>,<span class="number">16708</span>,<span class="number">16965</span>,<span class="number">17734</span>&#125;;</span><br><span class="line">  <span class="type">int</span> n = <span class="number">2</span>; <span class="comment">//n的绝对值表示v的长度，取正表示加密，取负表示解密</span></span><br><span class="line">  <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">  <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">  btea(v, -n, k);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%x %x &quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">  btea(w, -n, k);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%x %x &quot;</span>,w[<span class="number">0</span>],w[<span class="number">1</span>]);</span><br><span class="line">  btea(x, -n, k);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%x %x&quot;</span>,x[<span class="number">0</span>],x[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>解出来，转换成字符串，然后套上壳。</p>
<p><strong>hell_world</strong></p>
<p>这个题听师傅说与西湖论剑的题是一样的。怪不得出那么快，我们来好好看一下这个题，有点像hgame里面那道虚拟机的题</p>
<p>这个题运行顺序是：0 – 1 – 2 – 3，在3出进行一次字符串判断，长度是44才能到4去，如果不是到5，然后输出wrong。</p>
<p>看内存发现输入数据存入了a1数组</p>
<p><img src="/../../../blog/source/_posts/SUSCTF2022/image-20220301155721448.png"></p>
<p>然后转到9 – 10 – 11</p>
<p>其中case9是将输入转化为二进制，只是0和1使用2和3来替换，接着执行的case10是使用异或数组与输入进行异或操作且转化为二进制。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">       v17 = sub_7FF6554DEB56();</span><br><span class="line">       v41 = *(_QWORD *)(a1 + <span class="number">344</span>);</span><br><span class="line">       v42 = <span class="number">0</span>;</span><br><span class="line">       sub_7FF6554A3F60((__int64)&amp;v41);</span><br><span class="line">       *(_QWORD *)(a1 + <span class="number">344</span>) = v41;</span><br><span class="line">       *(_BYTE *)(a1 + <span class="number">368</span>) = v42;</span><br><span class="line">       sub_7FF6554DEBD4(v17);</span><br><span class="line">       *(_DWORD *)(a1 + <span class="number">372</span>) = *(<span class="type">unsigned</span> __int8 *)(a1 + <span class="number">368</span>);</span><br><span class="line">       v18 = sub_7FF6554DEB56();</span><br><span class="line">       v19 = *(_DWORD *)(a1 + <span class="number">372</span>);</span><br><span class="line">       <span class="keyword">if</span> ( v19 &lt; <span class="number">0</span> )</span><br><span class="line">         sub_7FF6554F88D2(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">48</span>i64);</span><br><span class="line">       sub_7FF6554D0180(&amp;v77, (<span class="type">unsigned</span> <span class="type">int</span>)v19, <span class="number">8</span>i64);</span><br><span class="line">       v55 = v77;</span><br><span class="line">       v56 = v38;</span><br><span class="line">       v38[<span class="number">0</span>] = *(_DWORD *)v78;</span><br><span class="line">       v38[<span class="number">1</span>] = *(_DWORD *)(v78 + <span class="number">4</span>);</span><br><span class="line">       v39 = *(_BYTE *)(v78 + <span class="number">8</span>);</span><br><span class="line">       v40 = *(_DWORD *)(v78 + <span class="number">12</span>);</span><br><span class="line">       <span class="keyword">if</span> ( v40 != <span class="number">8</span> )</span><br><span class="line">         sub_7FF6554F88D2(<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">48</span>i64);</span><br><span class="line">       v23 = v55;</span><br><span class="line">       <span class="keyword">for</span> ( i = <span class="number">0</span>i64; (<span class="type">unsigned</span> <span class="type">int</span>)i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">       &#123;</span><br><span class="line">         v25 = *(_BYTE **)(a1 + <span class="number">8</span> * i + <span class="number">16</span>);</span><br><span class="line">         *(_BYTE *)(a1 + i + <span class="number">392</span>) = *(_BYTE *)(v23 + i);</span><br><span class="line">         v26 = <span class="number">1</span>;</span><br><span class="line">         <span class="keyword">if</span> ( !v25[<span class="number">42</span>] )</span><br><span class="line">           v26 = *v25 != *(_BYTE *)(a1 + i + <span class="number">392</span>);</span><br><span class="line">         <span class="keyword">if</span> ( v26 )</span><br><span class="line">           sub_7FF6554E5B00();</span><br><span class="line">       &#125;</span><br><span class="line">       sub_7FF6554DEBD4(v18);</span><br><span class="line">       result = sub_7FF6554DF80C(<span class="number">1000000</span>i64, (__int64)<span class="string">&quot;hello.vhdl&quot;</span>, <span class="number">0x31</span>u);</span><br><span class="line">       *(_DWORD *)(a1 + <span class="number">380</span>) = <span class="number">10</span>;</span><br><span class="line">       <span class="keyword">return</span> result;</span><br></pre></td></tr></table></figure>

<p>我们看到case11处，我们能动调出比较函数，那么一定存在加密后的值，v71–》v6，所以找到了密文，我们输入经过加密就跟密文对比。</p>
<p><img src="/../../../blog/source/_posts/SUSCTF2022/image-20220301164512915.png"></p>
<p>那么我们很容易就写出脚本了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">data1 = [<span class="number">86</span>,</span><br><span class="line"> <span class="number">218</span>,</span><br><span class="line"> <span class="number">205</span>,</span><br><span class="line"> <span class="number">58</span>,</span><br><span class="line"> <span class="number">126</span>,</span><br><span class="line"> <span class="number">134</span>,</span><br><span class="line"> <span class="number">19</span>,</span><br><span class="line"> <span class="number">181</span>,</span><br><span class="line"> <span class="number">29</span>,</span><br><span class="line"> <span class="number">157</span>,</span><br><span class="line"> <span class="number">252</span>,</span><br><span class="line"> <span class="number">151</span>,</span><br><span class="line"> <span class="number">140</span>,</span><br><span class="line"> <span class="number">49</span>,</span><br><span class="line"> <span class="number">107</span>,</span><br><span class="line"> <span class="number">201</span>,</span><br><span class="line"> <span class="number">251</span>,</span><br><span class="line"> <span class="number">26</span>,</span><br><span class="line"> <span class="number">226</span>,</span><br><span class="line"> <span class="number">45</span>,</span><br><span class="line"> <span class="number">220</span>,</span><br><span class="line"> <span class="number">211</span>,</span><br><span class="line"> <span class="number">241</span>,</span><br><span class="line"> <span class="number">244</span>,</span><br><span class="line"> <span class="number">54</span>,</span><br><span class="line"> <span class="number">9</span>,</span><br><span class="line"> <span class="number">32</span>,</span><br><span class="line"> <span class="number">66</span>,</span><br><span class="line"> <span class="number">4</span>,</span><br><span class="line"> <span class="number">106</span>,</span><br><span class="line"> <span class="number">113</span>,</span><br><span class="line"> <span class="number">83</span>,</span><br><span class="line"> <span class="number">120</span>,</span><br><span class="line"> <span class="number">164</span>,</span><br><span class="line"> <span class="number">151</span>,</span><br><span class="line"> <span class="number">143</span>,</span><br><span class="line"> <span class="number">122</span>,</span><br><span class="line"> <span class="number">114</span>,</span><br><span class="line"> <span class="number">57</span>,</span><br><span class="line"> <span class="number">232</span>,</span><br><span class="line"> <span class="number">61</span>,</span><br><span class="line"> <span class="number">250</span>,</span><br><span class="line"> <span class="number">64</span>,</span><br><span class="line"> <span class="number">61</span>,</span><br><span class="line"> <span class="number">408</span>,</span><br><span class="line"> <span class="number">0</span>,</span><br><span class="line"> <span class="number">0</span>,</span><br><span class="line"> <span class="number">0</span>]</span><br><span class="line">data2 = [<span class="number">5</span>,</span><br><span class="line"> <span class="number">143</span>,</span><br><span class="line"> <span class="number">158</span>,</span><br><span class="line"> <span class="number">121</span>,</span><br><span class="line"> <span class="number">42</span>,</span><br><span class="line"> <span class="number">192</span>,</span><br><span class="line"> <span class="number">104</span>,</span><br><span class="line"> <span class="number">129</span>,</span><br><span class="line"> <span class="number">45</span>,</span><br><span class="line"> <span class="number">252</span>,</span><br><span class="line"> <span class="number">207</span>,</span><br><span class="line"> <span class="number">164</span>,</span><br><span class="line"> <span class="number">181</span>,</span><br><span class="line"> <span class="number">85</span>,</span><br><span class="line"> <span class="number">95</span>,</span><br><span class="line"> <span class="number">228</span>,</span><br><span class="line"> <span class="number">157</span>,</span><br><span class="line"> <span class="number">35</span>,</span><br><span class="line"> <span class="number">214</span>,</span><br><span class="line"> <span class="number">29</span>,</span><br><span class="line"> <span class="number">241</span>,</span><br><span class="line"> <span class="number">231</span>,</span><br><span class="line"> <span class="number">151</span>,</span><br><span class="line"> <span class="number">145</span>,</span><br><span class="line"> <span class="number">6</span>,</span><br><span class="line"> <span class="number">36</span>,</span><br><span class="line"> <span class="number">66</span>,</span><br><span class="line"> <span class="number">113</span>,</span><br><span class="line"> <span class="number">60</span>,</span><br><span class="line"> <span class="number">88</span>,</span><br><span class="line"> <span class="number">92</span>,</span><br><span class="line"> <span class="number">48</span>,</span><br><span class="line"> <span class="number">25</span>,</span><br><span class="line"> <span class="number">198</span>,</span><br><span class="line"> <span class="number">245</span>,</span><br><span class="line"> <span class="number">188</span>,</span><br><span class="line"> <span class="number">75</span>,</span><br><span class="line"> <span class="number">66</span>,</span><br><span class="line"> <span class="number">93</span>,</span><br><span class="line"> <span class="number">218</span>,</span><br><span class="line"> <span class="number">88</span>,</span><br><span class="line"> <span class="number">155</span>,</span><br><span class="line"> <span class="number">36</span>,</span><br><span class="line"> <span class="number">64</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data2)):</span><br><span class="line">  flag += <span class="built_in">chr</span>(data1[i] ^ data2[i])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#SUSCTF&#123;40a339d4-f940-4fe0-b382-cabb310d2ead&#125;</span></span><br></pre></td></tr></table></figure>

<p>K.O</p>
<h3 id="tttree"><a href="#tttree" class="headerlink" title="tttree"></a>tttree</h3><p>刚看的时候感觉是个二叉树，但无法反汇编，所以只能审代码。有点难度，复现一下：</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><p>本次misc出了很快，这种感觉很不错，但我很烦题目都是英文，翻译根本翻不了。。。</p>
<h3 id="ra2"><a href="#ra2" class="headerlink" title="ra2"></a>ra2</h3><p>红警游戏，让找旗子，说什么降落到了月球，设定是晚上很危险，白天安全，那直接把白天时间拉满不就行了。</p>
<p>找到目录\Romanovs-Vengeance\mods\rv\maps\ctf-01，找到ctf-01.lua文件，改几个数据</p>
<p><img src="/../../../blog/source/_posts/SUSCTF2022/image-20220228161719337.png"></p>
<p>把时间无限延长，然后进去放几个狗，乱跑找flag</p>
<p><img src="/../../../blog/source/_posts/SUSCTF2022/image-20220228161731827.png"></p>
<p>这个体验不错，就我在图书馆玩游戏，笑死。。</p>
<h3 id="Tanner"><a href="#Tanner" class="headerlink" title="Tanner"></a>Tanner</h3><p>这个题其实我第一天就有思路，而且差不多出来了，就是他这个英文翻译很不准确。。真服了，导致我虚拟机没写完呢，今天还要赶虚拟机。。</p>
<p><img src="/../../../blog/source/_posts/SUSCTF2022/image-20220228161958465.png"></p>
<p>这个图，应该是lpdc的另一种表示，可以表示成矩阵，checknodes当成行，bitnodes当成列，得到（10，5）矩阵，题目给了这样一段提示</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">THE FLAG IS <span class="keyword">the</span> sha256 <span class="keyword">of</span> <span class="keyword">the</span> <span class="built_in">sum</span> ofthe proper codewords(binary plus)which satisfy <span class="keyword">the</span> condition.(note: <span class="keyword">with</span> no zeros front)</span><br></pre></td></tr></table></figure>

<p>我纯纯文盲，应该是让求码字，note的意思应该是最后sum的和前面不能加0，而不是不能用码字求和。。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">N=<span class="number">10</span></span><br><span class="line">K=<span class="number">5</span>   <span class="comment">#这个值是列数-行数，而不是行数！！！这题比较巧</span></span><br><span class="line"></span><br><span class="line">H=np.array([[ <span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line">b=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**N):</span><br><span class="line">    a=<span class="built_in">format</span>(i,<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">    b.append(<span class="string">&quot;&#123;:0&gt;10s&#125;&quot;</span>.<span class="built_in">format</span>(a))</span><br><span class="line"></span><br><span class="line">v=np.zeros((<span class="number">2</span>**N,N))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**N):</span><br><span class="line">    v[i]=b[i]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        v[i][j]=b[i][j] <span class="comment">#v是0000000~1111111</span></span><br><span class="line"></span><br><span class="line">w=np.zeros((<span class="number">1</span>,N-K))</span><br><span class="line"><span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**N):</span><br><span class="line">    <span class="keyword">if</span> np.<span class="built_in">all</span>(np.dot(v[o],H.T)%<span class="number">2</span>==w):</span><br><span class="line">        <span class="built_in">print</span>(v[o])</span><br></pre></td></tr></table></figure>

<p>得到许多二进制，我们求和</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a =</span><br><span class="line"><span class="number">0b0000000000</span>+<span class="number">0b0000000111</span>+<span class="number">0b0000011001</span>+<span class="number">0b0000011110</span>+<span class="number">0b0000101010</span>+<span class="number">0b0000101101</span>+<span class="number">0b0000110011</span>+<span class="number">0b0000110100</span>+<span class="number">0b0011000001</span>+<span class="number">0b0011000110</span>+<span class="number">0b0011011000</span>+<span class="number">0b0011011111</span>+<span class="number">0b0011101011</span>+<span class="number">0b0011101100</span>+<span class="number">0b0011110010</span>+<span class="number">0b0011110101</span>+<span class="number">0b0101000010</span>+<span class="number">0b0101000101</span>+<span class="number">0b0101011011</span>+<span class="number">0b0101011100</span>+<span class="number">0b0101101000</span>+<span class="number">0b0101101111</span>+<span class="number">0b0101110001</span>+<span class="number">0b0101110110</span>+<span class="number">0b0110000011</span>+<span class="number">0b0110000100</span>+<span class="number">0b0110011010</span>+<span class="number">0b0110011101</span>+<span class="number">0b0110101001</span>+<span class="number">0b0110101110</span>+<span class="number">0b0110110000</span>+<span class="number">0b0110110111</span>+<span class="number">0b1001001000</span>+<span class="number">0b1001001111</span>+<span class="number">0b1001010001</span>+<span class="number">0b1001010110</span>+<span class="number">0b1001100010</span>+<span class="number">0b1001100101</span>+<span class="number">0b1001111011</span>+<span class="number">0b1001111100</span>+<span class="number">0b1010001001</span>+<span class="number">0b1010001110</span>+<span class="number">0b1010010000</span>+<span class="number">0b1010010111</span>+<span class="number">0b1010100011</span>+<span class="number">0b1010100100</span>+<span class="number">0b1010111010</span>+<span class="number">0b1010111101</span>+<span class="number">0b1100001010</span>+<span class="number">0b1100001101</span>+<span class="number">0b1100010011</span>+<span class="number">0b1100010100</span>+<span class="number">0b1100100000</span>+<span class="number">0b1100100111</span>+<span class="number">0b1100111001</span>+<span class="number">0b1100111110</span>+<span class="number">0b1111001011</span>+<span class="number">0b1111001100</span>+<span class="number">0b1111010010</span>+<span class="number">0b1111010101</span>+<span class="number">0b1111100001</span>+<span class="number">0b1111100110</span>+<span class="number">0b1111111000</span>+<span class="number">0b1111111111</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment">#111111111100000</span></span><br><span class="line"><span class="comment">#c17019990bf57492cddf24f3cc3be588507b2d567934a101d4de2fa6d606b5c1</span></span><br></pre></td></tr></table></figure>

<p>求得的值再sha256，用小写形式交了！！大写不行！！！</p>
<h3 id="audio"><a href="#audio" class="headerlink" title="audio"></a>audio</h3><p>如果给出了原音频和加密过的音频，要进行音频相消！</p>
<p>把两段音频同时拖进audacity里面，然后分别对音频进行标准化，然后分别截去静音，然后对fromfriends.wav进行反相操作，而后把两段音频叠起来即可</p>
<p><img src="/SUSCTF2022/image-20220301172357554.png" alt="image-20220301172357554"></p>
<p>读出摩斯密码！</p>
<h3 id="misound"><a href="#misound" class="headerlink" title="misound"></a>misound</h3><p>频谱图中有AnEWmuLTiPLyis_etimes_wiLLbEcomE_B，本以为是前一段flag，没想到是提示。</p>
<p>然后silenteye搞出来base64，翻出来是207 359 220 224 352 315 359 374 290 310 277 507 391 513 423 392 508 383 440 322 420 427 503 460 295 318 245 302 407 414 410 130 369 317</p>
<p>但这个最牛逼的是听起来像个摩斯密码，用sstv分析</p>
<p><img src="/SUSCTF2022/image-20220301185258769.png" alt="image-20220301185258769"></p>
<p><img src="/SUSCTF2022/image-20220301185427312.png" alt="image-20220301185427312"></p>
<p>用该网站<a target="_blank" rel="noopener" href="https://www.dcode.fr/dotsies-writing%E8%A7%A3%E5%87%BA%E6%9D%A5">https://www.dcode.fr/dotsies-writing解出来</a></p>
<p>我们用第一组数乘第二组数，然后除以26就基本确定flag长度了，26这个值可以试出来</p>
<p>或者我们观察第一组乘第二组除以第三组就是26的近似值！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/18/d3ctf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/18/d3ctf/" class="post-title-link" itemprop="url">d3ctf</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-07-18 00:08:16 / 修改时间：00:37:24" itemprop="dateCreated datePublished" datetime="2022-07-18T00:08:16+08:00">2022-07-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="D-3CTF"><a href="#D-3CTF" class="headerlink" title="D^3CTF"></a>D^3CTF</h1><p>本次CTF终极被虐，太难了，但始终参与进程中，这两天把逆向题复现一下，这次逆向题的”外壳”很难搞定，学到的东西很多，师傅们太强了！</p>
<p><img src="/d3ctf/image-20220307141619512.png"></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a><strong>Reverse</strong></h2><h3 id="D3MUG"><a href="#D3MUG" class="headerlink" title="D3MUG"></a><strong>D3MUG</strong></h3><p>这个题是unity3d游戏，而且是一个音游，应该是拿到perfect就会给flag，但被人修改了，用连点器都没用的。</p>
<p>第一次接触unity3d逆向，首先我们要用IL2CPP，来对libil2cpp.so<code>与</code>global-metadata.dat进行操作</p>
<p>我们先把apk软件解压，找到下述文件，copy到Il2CppDumper.exe的文件夹下。</p>
<figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\lib\armeabi-v7a\libil2cpp.so`</span><br><span class="line">`\assets\bin\Data\Managed\Metadata\global-metadata.dat</span><br></pre></td></tr></table></figure>

<p>要新建两个文件夹，第一个是input，第二个是output</p>
<p><img src="/d3ctf/image-20220307144718157.png"></p>
<p>将<code>libil2cpp.so</code>与<code>global-metadata.dat</code>拷贝到<code>input</code>目录中。再在记事本下输入：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..\Il2CppDumper<span class="selector-class">.exe</span> libil2cpp<span class="selector-class">.so</span> global-metadata<span class="selector-class">.dat</span> ..\output</span><br></pre></td></tr></table></figure>

<p>然后重命名成：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">il2cpp_decompilation.bat</span><br></pre></td></tr></table></figure>

<p>然后运行</p>
<p><img src="/d3ctf/image-20220307144841622.png"></p>
<p>发现output文件夹生成</p>
<p><img src="/d3ctf/image-20220307144915739.png"></p>
<p>在DummyDll中存在很多dll文件</p>
<p><img src="/d3ctf/image-20220307145215194.png"></p>
<p>dump.cs这个文件会把<code>C#</code>的<code>dll</code>代码的类、方法、字段列出来</p>
<p><img src="/d3ctf/image-20220307145153661.png"></p>
<p>il2cpp.h生成<code>cpp</code>的头文件，从头文件里我们也可以看到相关的数据结构。</p>
<p><img src="/d3ctf/image-20220307145140712.png"></p>
<p>script.json以<code>json</code>格式显示类的方法信息：</p>
<p><img src="/d3ctf/image-20220307145249152.png"></p>
<p>stringliteral.json以<code>json</code>的格式显示所有的字符串信息：</p>
<p><img src="/d3ctf/image-20220307145310439.png"></p>
<p>我们在dump.cs文件中找到ScoreScene类，发现Start会check flag，</p>
<p><img src="/d3ctf/image-20220307151020607.png"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">GameManager</span> :</span> MonoBehaviour <span class="comment">// TypeDefIndex: 4296</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// Fields</span></span><br><span class="line">	public <span class="type">static</span> GameManager instance; <span class="comment">// 0x0</span></span><br><span class="line">	public TMP_Text GoodText; <span class="comment">// 0xC</span></span><br><span class="line">	public TMP_Text PerfectText; <span class="comment">// 0x10</span></span><br><span class="line">	public TMP_Text MissText; <span class="comment">// 0x14</span></span><br><span class="line">	public BeatScroller beatScroller; <span class="comment">// 0x18</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Methods</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x42CD60 Offset: 0x42CD60 VA: 0x42CD60</span></span><br><span class="line">	public <span class="type">static</span> <span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">update</span><span class="params">(uint msecs)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x42CE00 Offset: 0x42CE00 VA: 0x42CE00</span></span><br><span class="line">	private <span class="type">void</span> <span class="title function_">Start</span><span class="params">()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x42CF24 Offset: 0x42CF24 VA: 0x42CF24</span></span><br><span class="line">	private <span class="type">void</span> <span class="title function_">Update</span><span class="params">()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	[IteratorStateMachine(typeof(GameManager.&lt;loadBeatmap&gt;d__8))]</span><br><span class="line">	<span class="comment">// RVA: 0x42CE7C Offset: 0x42CE7C VA: 0x42CE7C</span></span><br><span class="line">	private IEnumerator <span class="title function_">loadBeatmap</span><span class="params">()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x42CF50 Offset: 0x42CF50 VA: 0x42CF50</span></span><br><span class="line">	public <span class="type">void</span> <span class="title function_">NoteHit</span><span class="params">(<span class="type">float</span> preciseTime, <span class="type">int</span> level)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x42D0A0 Offset: 0x42D0A0 VA: 0x42D0A0</span></span><br><span class="line">	public <span class="type">void</span> <span class="title function_">NoteMissed</span><span class="params">()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// RVA: 0x42D1B0 Offset: 0x42D1B0 VA: 0x42D1B0</span></span><br><span class="line">	public <span class="type">void</span> .ctor() &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>GameManager这个类中的update就是d3mug.so中的update函数</p>
<p>如何恢复libil2cpp.so的字符串和函数：</p>
<p>1.先在ida打开libil2cpp.so文件</p>
<p>2.用Script file打开我们下载文件夹中的ida_with_struct.py脚本</p>
<p><img src="/d3ctf/image-20220307155201813.png"></p>
<p>3.然后会直接让选择下一个文件，我们找到output里的文件</p>
<p><img src="/d3ctf/image-20220307155249001.png"></p>
<p>4.继续选文件，我们选择il2cpp.h头文件</p>
<p>等待加载就行，但我一加载就卡死，可能这个太大了吧，320mb果然大的离谱</p>
<p><img src="/d3ctf/image-20220307155743870.png"></p>
<p>找到score_start函数，卡的要死。。。</p>
<p><img src="/d3ctf/image-20220307155915866.png"></p>
<p><img src="/d3ctf/image-20220307160824542.png"></p>
<p>在if函数中的就是要检测是否有D3CTF，如果没就会返回这句话,另一个重要的是这个</p>
<p><img src="/d3ctf/image-20220307161326276.png"></p>
<p><img src="/d3ctf/image-20220307161426572.png"></p>
<p>可知道这个是引用d3mug文件中的update函数</p>
<p>通过对GameManagerupdate进行交叉引用发现是GameManageNoteHit或GameManagerNoteMissed最后调用的GameManagerupdate，对GameManager__NoteHit进行交叉引用就可以得知是从MusicController上获取的时间，如下图</p>
<p><img src="/d3ctf/image-20220307161617480.png"></p>
<p>总之，逻辑如下：</p>
<p>玩游戏点击方块后，GameManagerNoteHit之前会从MusicController上获取preciseTime，点击后，GameManagerNoteHit在函数最后调用GameManagerupdate，传入preciseTime，然后update。接下来update检测server：：instance，如果没有就初始化，初始化的值不变，若初始化，就再调用d3mug中server：：run函数，这个函数会更新instance，最后check的地方也是d3mug中的get文件，拿到最后的instance然后比较是否是D3CTF开头</p>
<p><img src="/d3ctf/image-20220307162703379.png"></p>
<p>GameManagerloadBeatmap_d8__MoveNext函数中发现hintpoints很重要</p>
<p>使用AssetstdioGui来载入assets\bin\Data\data.unity3d</p>
<p>搜索hitpoints，发现有3个，通过运行可以得知总共会掉落1608个块，找到了恰好有1608个的hitpoints</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">hitpoints = <span class="string">&quot;&quot;&quot;4,0 </span></span><br><span class="line"><span class="string">3,0 </span></span><br><span class="line"><span class="string">1,0 </span></span><br><span class="line"><span class="string">3,146 </span></span><br><span class="line"><span class="string">...... </span></span><br><span class="line"><span class="string">2,140195 </span></span><br><span class="line"><span class="string">1,140195 </span></span><br><span class="line"><span class="string">4,140195 </span></span><br><span class="line"><span class="string">3,140195 </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span> </span><br><span class="line">arr = [] </span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> hitpoints.splitlines(): </span><br><span class="line">    arr.append(<span class="built_in">eval</span>(l[l.find(<span class="string">&#x27;,&#x27;</span>)+<span class="number">1</span>:]))</span><br></pre></td></tr></table></figure>

<p>提取逗号后面的数，后面的数就是参数</p>
<p>方法一：对函数复原</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Server::run</span><span class="params">(__int64 this, <span class="type">char</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// x9</span></span><br><span class="line">  __int64 v3; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// x13</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 *v5; <span class="comment">// x12</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// x14</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// x14</span></span><br><span class="line">  __int64 v8; <span class="comment">// x14</span></span><br><span class="line">  <span class="type">int</span> *v9; <span class="comment">// x12</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// w10</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// w13</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// w15</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v14; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v15; <span class="comment">// t2</span></span><br><span class="line"></span><br><span class="line">  v2 = *(_QWORD *)(this + <span class="number">5032</span>);</span><br><span class="line">  v3 = this + <span class="number">40</span>;</span><br><span class="line">  v4 = (v2 + <span class="number">1</span>) % <span class="number">0x270</span>uLL;</span><br><span class="line">  v5 = (<span class="type">unsigned</span> __int64 *)(this + <span class="number">40</span> + <span class="number">8</span> * v4);</span><br><span class="line">  *(_QWORD *)(this + <span class="number">40</span> + <span class="number">8</span> * v2) = (<span class="number">2567483615u</span> * (*v5 &amp; <span class="number">1</span>)) ^ *(_QWORD *)(this + <span class="number">40</span> + <span class="number">8</span> * ((v2 + <span class="number">397</span>) % <span class="number">0x270</span>uLL)) ^ ((*v5 &amp; <span class="number">0x7FFFFFFE</span> | *(_QWORD *)(this + <span class="number">40</span> + <span class="number">8</span> * v2) &amp; <span class="number">0xFFFFFFFF80000000</span>LL) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">  v6 = *(_QWORD *)(this + <span class="number">40</span> + <span class="number">8LL</span> * *(_QWORD *)(this + <span class="number">5032</span>));</span><br><span class="line">  *(_QWORD *)(this + <span class="number">5032</span>) = v4;</span><br><span class="line">  v7 = (((<span class="type">unsigned</span> <span class="type">int</span>)(v6 &gt;&gt; <span class="number">11</span>) ^ (<span class="type">unsigned</span> <span class="type">int</span>)v6) &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9D2C5680</span> ^ (<span class="type">unsigned</span> <span class="type">int</span>)(v6 &gt;&gt; <span class="number">11</span>) ^ v6;</span><br><span class="line">  <span class="keyword">if</span> ( (((_DWORD)v7 &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xEFC60000</span> ^ v7 ^ ((((_DWORD)v7 &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xEFC60000</span> ^ v7) &gt;&gt; <span class="number">18</span>)) % <span class="number">7</span> &gt;= <span class="number">3</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = (<span class="type">unsigned</span> __int16)(v4 + <span class="number">1</span>) % <span class="number">0x270</span>u;</span><br><span class="line">    *v5 = (<span class="number">2567483615u</span> * (*(_QWORD *)(v3 + <span class="number">8LL</span> * (<span class="type">unsigned</span> <span class="type">int</span>)v8) &amp; <span class="number">1LL</span>)) ^ *(_QWORD *)(v3</span><br><span class="line">                                                                                       + <span class="number">8LL</span></span><br><span class="line">                                                                                       * ((<span class="type">unsigned</span> __int16)(v4 + <span class="number">397</span>)</span><br><span class="line">                                                                                        % <span class="number">0x270</span>u)) ^ ((*(_QWORD *)(v3 + <span class="number">8LL</span> * (<span class="type">unsigned</span> <span class="type">int</span>)v8) &amp; <span class="number">0x7FFFFFFE</span>LL | *v5 &amp; <span class="number">0xFFFFFFFF80000000</span>LL) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    v9 = (<span class="type">int</span> *)(this + (a2 &amp; <span class="number">0xF</span>));</span><br><span class="line">    v10 = *(_QWORD *)(v3 + <span class="number">8LL</span> * *(_QWORD *)(this + <span class="number">5032</span>));</span><br><span class="line">    *(_QWORD *)(this + <span class="number">5032</span>) = v8;</span><br><span class="line">    v11 = *v9;</span><br><span class="line">    v12 = v9[<span class="number">1</span>];</span><br><span class="line">    LODWORD(v8) = v9[<span class="number">2</span>];</span><br><span class="line">    v13 = v9[<span class="number">3</span>];</span><br><span class="line">    *v9 = v8;</span><br><span class="line">    v9[<span class="number">1</span>] = v13;</span><br><span class="line">    v14 = (((((<span class="type">unsigned</span> <span class="type">int</span>)(v10 &gt;&gt; <span class="number">11</span>) ^ (<span class="type">unsigned</span> <span class="type">int</span>)v10) &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9D2C5680</span> ^ (<span class="type">unsigned</span> <span class="type">int</span>)(v10 &gt;&gt; <span class="number">11</span>) ^ (<span class="type">unsigned</span> <span class="type">int</span>)v10) &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xEFC60000</span> ^ (((<span class="type">unsigned</span> <span class="type">int</span>)(v10 &gt;&gt; <span class="number">11</span>) ^ (<span class="type">unsigned</span> <span class="type">int</span>)v10) &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9D2C5680</span> ^ (<span class="type">unsigned</span> <span class="type">int</span>)(v10 &gt;&gt; <span class="number">11</span>) ^ v10;</span><br><span class="line">    HIDWORD(v15) = v8 ^ (v14 &gt;&gt; <span class="number">18</span>) ^ v14;</span><br><span class="line">    LODWORD(v15) = HIDWORD(v15);</span><br><span class="line">    LODWORD(v14) = v15 &gt;&gt; <span class="number">19</span>;</span><br><span class="line">    v9[<span class="number">2</span>] = v14 ^ v11;</span><br><span class="line">    v9[<span class="number">3</span>] = v12 ^ __ROR4__(v13, <span class="number">18</span>) ^ v14;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> this;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面是要复原的函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> DWORD hitp[] = &#123; <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">146</span>,<span class="number">292</span>,<span class="number">292</span>,<span class="number">439</span>,<span class="number">512</span>,<span class="number">585</span>,<span class="number">585</span>,<span class="number">658</span>,<span class="number">731</span>,<span class="number">804</span>,<span class="number">878</span>,<span class="number">1024</span>,<span class="number">1170</span>,<span class="number">1170</span>,<span class="number">1317</span>,<span class="number">1463</span>,<span class="number">1463</span>,<span class="number">1609</span>,<span class="number">1682</span>,<span class="number">1756</span>,<span class="number">1756</span>,<span class="number">1902</span>,<span class="number">2048</span>,<span class="number">2195</span>,<span class="number">2341</span>,<span class="number">2341</span>,<span class="number">2487</span>,<span class="number">2634</span>,<span class="number">2634</span>,<span class="number">2780</span>,<span class="number">2853</span>,<span class="number">2926</span>,<span class="number">2926</span>,<span class="number">3073</span>,<span class="number">3146</span>,<span class="number">3219</span>,<span class="number">3219</span>,<span class="number">3365</span>,<span class="number">3439</span>,<span class="number">3512</span>,<span class="number">3512</span>,<span class="number">3658</span>,<span class="number">3804</span>,<span class="number">3878</span>,<span class="number">3951</span>,<span class="number">4024</span>,<span class="number">4097</span>,<span class="number">4097</span>,<span class="number">4243</span>,<span class="number">4390</span>,<span class="number">4682</span>,<span class="number">4682</span>,<span class="number">4682</span>,<span class="number">4829</span>,<span class="number">4975</span>,<span class="number">4975</span>,<span class="number">5121</span>,<span class="number">5195</span>,<span class="number">5268</span>,<span class="number">5341</span>,<span class="number">5414</span>,<span class="number">5487</span>,<span class="number">5560</span>,<span class="number">5560</span>,<span class="number">5853</span>,<span class="number">5853</span>,<span class="number">5999</span>,<span class="number">6146</span>,<span class="number">6146</span>,<span class="number">6292</span>,<span class="number">6365</span>,<span class="number">6439</span>,<span class="number">6439</span>,<span class="number">6585</span>,<span class="number">6731</span>,<span class="number">6731</span>,<span class="number">6731</span>,<span class="number">7024</span>,<span class="number">7024</span>,<span class="number">7170</span>,<span class="number">7317</span>,<span class="number">7317</span>,<span class="number">7463</span>,<span class="number">7536</span>,<span class="number">7609</span>,<span class="number">7609</span>,<span class="number">7682</span>,<span class="number">7756</span>,<span class="number">7829</span>,<span class="number">7902</span>,<span class="number">7902</span>,<span class="number">7975</span>,<span class="number">8048</span>,<span class="number">8121</span>,<span class="number">8195</span>,<span class="number">8341</span>,<span class="number">8487</span>,<span class="number">8634</span>,<span class="number">8780</span>,<span class="number">9073</span>,<span class="number">9073</span>,<span class="number">9073</span>,<span class="number">9219</span>,<span class="number">9365</span>,<span class="number">9365</span>,<span class="number">9512</span>,<span class="number">9658</span>,<span class="number">9658</span>,<span class="number">9804</span>,<span class="number">9878</span>,<span class="number">9951</span>,<span class="number">9951</span>,<span class="number">10097</span>,<span class="number">10243</span>,<span class="number">10243</span>,<span class="number">10243</span>,<span class="number">10390</span>,<span class="number">10463</span>,<span class="number">10536</span>,<span class="number">10536</span>,<span class="number">10682</span>,<span class="number">10829</span>,<span class="number">10829</span>,<span class="number">10975</span>,<span class="number">11121</span>,<span class="number">11121</span>,<span class="number">11268</span>,<span class="number">11414</span>,<span class="number">11414</span>,<span class="number">11560</span>,<span class="number">11707</span>,<span class="number">11707</span>,<span class="number">11853</span>,<span class="number">11999</span>,<span class="number">11999</span>,<span class="number">11999</span>,<span class="number">12146</span>,<span class="number">12292</span>,<span class="number">12292</span>,<span class="number">12439</span>,<span class="number">12439</span>,<span class="number">12585</span>,<span class="number">12585</span>,<span class="number">12585</span>,<span class="number">12731</span>,<span class="number">12878</span>,<span class="number">12951</span>,<span class="number">13024</span>,<span class="number">13097</span>,<span class="number">13170</span>,<span class="number">13170</span>,<span class="number">13317</span>,<span class="number">13463</span>,<span class="number">13463</span>,<span class="number">13463</span>,<span class="number">13609</span>,<span class="number">13756</span>,<span class="number">13756</span>,<span class="number">13756</span>,<span class="number">13902</span>,<span class="number">14048</span>,<span class="number">14048</span>,<span class="number">14195</span>,<span class="number">14341</span>,<span class="number">14487</span>,<span class="number">14634</span>,<span class="number">14634</span>,<span class="number">14926</span>,<span class="number">14926</span>,<span class="number">14926</span>,<span class="number">15219</span>,<span class="number">15219</span>,<span class="number">15219</span>,<span class="number">15365</span>,<span class="number">15365</span>,<span class="number">15512</span>,<span class="number">15512</span>,<span class="number">15658</span>,<span class="number">15804</span>,<span class="number">15804</span>,<span class="number">15951</span>,<span class="number">16024</span>,<span class="number">16097</span>,<span class="number">16097</span>,<span class="number">16170</span>,<span class="number">16243</span>,<span class="number">16317</span>,<span class="number">16390</span>,<span class="number">16390</span>,<span class="number">16536</span>,<span class="number">16682</span>,<span class="number">16682</span>,<span class="number">16829</span>,<span class="number">16902</span>,<span class="number">16975</span>,<span class="number">16975</span>,<span class="number">17121</span>,<span class="number">17268</span>,<span class="number">17268</span>,<span class="number">17268</span>,<span class="number">17414</span>,<span class="number">17560</span>,<span class="number">17634</span>,<span class="number">17707</span>,<span class="number">17780</span>,<span class="number">17853</span>,<span class="number">17926</span>,<span class="number">17999</span>,<span class="number">18073</span>,<span class="number">18146</span>,<span class="number">18146</span>,<span class="number">18292</span>,<span class="number">18439</span>,<span class="number">18439</span>,<span class="number">18731</span>,<span class="number">18731</span>,<span class="number">18731</span>,<span class="number">18878</span>,<span class="number">19024</span>,<span class="number">19024</span>,<span class="number">19024</span>,<span class="number">19170</span>,<span class="number">19243</span>,<span class="number">19317</span>,<span class="number">19463</span>,<span class="number">19609</span>,<span class="number">19609</span>,<span class="number">19609</span>,<span class="number">19756</span>,<span class="number">19829</span>,<span class="number">19902</span>,<span class="number">20048</span>,<span class="number">20195</span>,<span class="number">20195</span>,<span class="number">20341</span>,<span class="number">20487</span>,<span class="number">20487</span>,<span class="number">20634</span>,<span class="number">20780</span>,<span class="number">20780</span>,<span class="number">20926</span>,<span class="number">21073</span>,<span class="number">21073</span>,<span class="number">21219</span>,<span class="number">21365</span>,<span class="number">21365</span>,<span class="number">21365</span>,<span class="number">21512</span>,<span class="number">21585</span>,<span class="number">21658</span>,<span class="number">21658</span>,<span class="number">21804</span>,<span class="number">21951</span>,<span class="number">21951</span>,<span class="number">21951</span>,<span class="number">22097</span>,<span class="number">22243</span>,<span class="number">22317</span>,<span class="number">22390</span>,<span class="number">22463</span>,<span class="number">22536</span>,<span class="number">22536</span>,<span class="number">22609</span>,<span class="number">22682</span>,<span class="number">22756</span>,<span class="number">22829</span>,<span class="number">22829</span>,<span class="number">22975</span>,<span class="number">23121</span>,<span class="number">23121</span>,<span class="number">23268</span>,<span class="number">23414</span>,<span class="number">23560</span>,<span class="number">23707</span>,<span class="number">23780</span>,<span class="number">23853</span>,<span class="number">23926</span>,<span class="number">23999</span>,<span class="number">23999</span>,<span class="number">24073</span>,<span class="number">24146</span>,<span class="number">24219</span>,<span class="number">24292</span>,<span class="number">24365</span>,<span class="number">24439</span>,<span class="number">24512</span>,<span class="number">24585</span>,<span class="number">24585</span>,<span class="number">24731</span>,<span class="number">24731</span>,<span class="number">24878</span>,<span class="number">24878</span>,<span class="number">24878</span>,<span class="number">25024</span>,<span class="number">25170</span>,<span class="number">25170</span>,<span class="number">25317</span>,<span class="number">25390</span>,<span class="number">25463</span>,<span class="number">25463</span>,<span class="number">25609</span>,<span class="number">25756</span>,<span class="number">25756</span>,<span class="number">25756</span>,<span class="number">25902</span>,<span class="number">25902</span>,<span class="number">26048</span>,<span class="number">26048</span>,<span class="number">26195</span>,<span class="number">26195</span>,<span class="number">26341</span>,<span class="number">26341</span>,<span class="number">26414</span>,<span class="number">26487</span>,<span class="number">26487</span>,<span class="number">26560</span>,<span class="number">26634</span>,<span class="number">26634</span>,<span class="number">26780</span>,<span class="number">26780</span>,<span class="number">26926</span>,<span class="number">27219</span>,<span class="number">27512</span>,<span class="number">27585</span>,<span class="number">27658</span>,<span class="number">27731</span>,<span class="number">27804</span>,<span class="number">27804</span>,<span class="number">28097</span>,<span class="number">28097</span>,<span class="number">28390</span>,<span class="number">28682</span>,<span class="number">28682</span>,<span class="number">28975</span>,<span class="number">29268</span>,<span class="number">29268</span>,<span class="number">29560</span>,<span class="number">29560</span>,<span class="number">29853</span>,<span class="number">29853</span>,<span class="number">30146</span>,<span class="number">30439</span>,<span class="number">30439</span>,<span class="number">30731</span>,<span class="number">31024</span>,<span class="number">31024</span>,<span class="number">31317</span>,<span class="number">31609</span>,<span class="number">31609</span>,<span class="number">31902</span>,<span class="number">32195</span>,<span class="number">32195</span>,<span class="number">32487</span>,<span class="number">32780</span>,<span class="number">32780</span>,<span class="number">32780</span>,<span class="number">33365</span>,<span class="number">33365</span>,<span class="number">33365</span>,<span class="number">33951</span>,<span class="number">33951</span>,<span class="number">34243</span>,<span class="number">34536</span>,<span class="number">34536</span>,<span class="number">34829</span>,<span class="number">35121</span>,<span class="number">35121</span>,<span class="number">35414</span>,<span class="number">35707</span>,<span class="number">35707</span>,<span class="number">35707</span>,<span class="number">35999</span>,<span class="number">36292</span>,<span class="number">36585</span>,<span class="number">36878</span>,<span class="number">36878</span>,<span class="number">37024</span>,<span class="number">37024</span>,<span class="number">37170</span>,<span class="number">37170</span>,<span class="number">37463</span>,<span class="number">37463</span>,<span class="number">37463</span>,<span class="number">37609</span>,<span class="number">37756</span>,<span class="number">37756</span>,<span class="number">37902</span>,<span class="number">38048</span>,<span class="number">38048</span>,<span class="number">38195</span>,<span class="number">38341</span>,<span class="number">38341</span>,<span class="number">38487</span>,<span class="number">38634</span>,<span class="number">38634</span>,<span class="number">38780</span>,<span class="number">38926</span>,<span class="number">39073</span>,<span class="number">39219</span>,<span class="number">39365</span>,<span class="number">39512</span>,<span class="number">39658</span>,<span class="number">39804</span>,<span class="number">39804</span>,<span class="number">39951</span>,<span class="number">40097</span>,<span class="number">40097</span>,<span class="number">40243</span>,<span class="number">40390</span>,<span class="number">40390</span>,<span class="number">40536</span>,<span class="number">40682</span>,<span class="number">40829</span>,<span class="number">40975</span>,<span class="number">40975</span>,<span class="number">41121</span>,<span class="number">41268</span>,<span class="number">41414</span>,<span class="number">41560</span>,<span class="number">41707</span>,<span class="number">41853</span>,<span class="number">41999</span>,<span class="number">42146</span>,<span class="number">42146</span>,<span class="number">42292</span>,<span class="number">42292</span>,<span class="number">42439</span>,<span class="number">42585</span>,<span class="number">42731</span>,<span class="number">42731</span>,<span class="number">42878</span>,<span class="number">42878</span>,<span class="number">43024</span>,<span class="number">43170</span>,<span class="number">43317</span>,<span class="number">43317</span>,<span class="number">43463</span>,<span class="number">43463</span>,<span class="number">43609</span>,<span class="number">43609</span>,<span class="number">43682</span>,<span class="number">43756</span>,<span class="number">43756</span>,<span class="number">43829</span>,<span class="number">43902</span>,<span class="number">43902</span>,<span class="number">44048</span>,<span class="number">44048</span>,<span class="number">44195</span>,<span class="number">44195</span>,<span class="number">44341</span>,<span class="number">44341</span>,<span class="number">44487</span>,<span class="number">44560</span>,<span class="number">44634</span>,<span class="number">44707</span>,<span class="number">44780</span>,<span class="number">44853</span>,<span class="number">44926</span>,<span class="number">44999</span>,<span class="number">45073</span>,<span class="number">45146</span>,<span class="number">45219</span>,<span class="number">45292</span>,<span class="number">45365</span>,<span class="number">45439</span>,<span class="number">45512</span>,<span class="number">45585</span>,<span class="number">45658</span>,<span class="number">45658</span>,<span class="number">45804</span>,<span class="number">45951</span>,<span class="number">45951</span>,<span class="number">46097</span>,<span class="number">46243</span>,<span class="number">46243</span>,<span class="number">46536</span>,<span class="number">46536</span>,<span class="number">46536</span>,<span class="number">46829</span>,<span class="number">46829</span>,<span class="number">46902</span>,<span class="number">46975</span>,<span class="number">47121</span>,<span class="number">47121</span>,<span class="number">47268</span>,<span class="number">47414</span>,<span class="number">47414</span>,<span class="number">47560</span>,<span class="number">47634</span>,<span class="number">47707</span>,<span class="number">47707</span>,<span class="number">47853</span>,<span class="number">47926</span>,<span class="number">47999</span>,<span class="number">47999</span>,<span class="number">48146</span>,<span class="number">48292</span>,<span class="number">48292</span>,<span class="number">48439</span>,<span class="number">48585</span>,<span class="number">48585</span>,<span class="number">48731</span>,<span class="number">48878</span>,<span class="number">48878</span>,<span class="number">49024</span>,<span class="number">49170</span>,<span class="number">49170</span>,<span class="number">49243</span>,<span class="number">49317</span>,<span class="number">49463</span>,<span class="number">49463</span>,<span class="number">49609</span>,<span class="number">49756</span>,<span class="number">49756</span>,<span class="number">49902</span>,<span class="number">49975</span>,<span class="number">50048</span>,<span class="number">50048</span>,<span class="number">50121</span>,<span class="number">50195</span>,<span class="number">50268</span>,<span class="number">50341</span>,<span class="number">50341</span>,<span class="number">50487</span>,<span class="number">50487</span>,<span class="number">50707</span>,<span class="number">50707</span>,<span class="number">50926</span>,<span class="number">50926</span>,<span class="number">51073</span>,<span class="number">51219</span>,<span class="number">51365</span>,<span class="number">51512</span>,<span class="number">51512</span>,<span class="number">51585</span>,<span class="number">51658</span>,<span class="number">51804</span>,<span class="number">51804</span>,<span class="number">51951</span>,<span class="number">52097</span>,<span class="number">52097</span>,<span class="number">52170</span>,<span class="number">52243</span>,<span class="number">52317</span>,<span class="number">52390</span>,<span class="number">52390</span>,<span class="number">52536</span>,<span class="number">52609</span>,<span class="number">52682</span>,<span class="number">52682</span>,<span class="number">52829</span>,<span class="number">52975</span>,<span class="number">52975</span>,<span class="number">53121</span>,<span class="number">53268</span>,<span class="number">53268</span>,<span class="number">53414</span>,<span class="number">53560</span>,<span class="number">53560</span>,<span class="number">53707</span>,<span class="number">53853</span>,<span class="number">53853</span>,<span class="number">53926</span>,<span class="number">53999</span>,<span class="number">54073</span>,<span class="number">54146</span>,<span class="number">54146</span>,<span class="number">54219</span>,<span class="number">54292</span>,<span class="number">54365</span>,<span class="number">54439</span>,<span class="number">54439</span>,<span class="number">54512</span>,<span class="number">54585</span>,<span class="number">54658</span>,<span class="number">54731</span>,<span class="number">54731</span>,<span class="number">54878</span>,<span class="number">54878</span>,<span class="number">55024</span>,<span class="number">55024</span>,<span class="number">55024</span>,<span class="number">55317</span>,<span class="number">55317</span>,<span class="number">55317</span>,<span class="number">55609</span>,<span class="number">55609</span>,<span class="number">55609</span>,<span class="number">55902</span>,<span class="number">55902</span>,<span class="number">55902</span>,<span class="number">56195</span>,<span class="number">56268</span>,<span class="number">56341</span>,<span class="number">56487</span>,<span class="number">56487</span>,<span class="number">56634</span>,<span class="number">56780</span>,<span class="number">56780</span>,<span class="number">56926</span>,<span class="number">56999</span>,<span class="number">57073</span>,<span class="number">57073</span>,<span class="number">57219</span>,<span class="number">57292</span>,<span class="number">57365</span>,<span class="number">57365</span>,<span class="number">57512</span>,<span class="number">57658</span>,<span class="number">57658</span>,<span class="number">57804</span>,<span class="number">57951</span>,<span class="number">57951</span>,<span class="number">58097</span>,<span class="number">58243</span>,<span class="number">58243</span>,<span class="number">58390</span>,<span class="number">58536</span>,<span class="number">58536</span>,<span class="number">58609</span>,<span class="number">58682</span>,<span class="number">58829</span>,<span class="number">58829</span>,<span class="number">58975</span>,<span class="number">59121</span>,<span class="number">59121</span>,<span class="number">59268</span>,<span class="number">59341</span>,<span class="number">59414</span>,<span class="number">59414</span>,<span class="number">59560</span>,<span class="number">59634</span>,<span class="number">59707</span>,<span class="number">59707</span>,<span class="number">59853</span>,<span class="number">59926</span>,<span class="number">59999</span>,<span class="number">59999</span>,<span class="number">60073</span>,<span class="number">60292</span>,<span class="number">60292</span>,<span class="number">60439</span>,<span class="number">60585</span>,<span class="number">60585</span>,<span class="number">60731</span>,<span class="number">60878</span>,<span class="number">60878</span>,<span class="number">60951</span>,<span class="number">61024</span>,<span class="number">61024</span>,<span class="number">61170</span>,<span class="number">61170</span>,<span class="number">61317</span>,<span class="number">61317</span>,<span class="number">61463</span>,<span class="number">61463</span>,<span class="number">61463</span>,<span class="number">61536</span>,<span class="number">61609</span>,<span class="number">61609</span>,<span class="number">61756</span>,<span class="number">61756</span>,<span class="number">61902</span>,<span class="number">61902</span>,<span class="number">62048</span>,<span class="number">62048</span>,<span class="number">62048</span>,<span class="number">62121</span>,<span class="number">62195</span>,<span class="number">62195</span>,<span class="number">62341</span>,<span class="number">62341</span>,<span class="number">62414</span>,<span class="number">62487</span>,<span class="number">62560</span>,<span class="number">62634</span>,<span class="number">62634</span>,<span class="number">62780</span>,<span class="number">62780</span>,<span class="number">62926</span>,<span class="number">62926</span>,<span class="number">63073</span>,<span class="number">63073</span>,<span class="number">63219</span>,<span class="number">63219</span>,<span class="number">63292</span>,<span class="number">63365</span>,<span class="number">63439</span>,<span class="number">63512</span>,<span class="number">63512</span>,<span class="number">63585</span>,<span class="number">63658</span>,<span class="number">63731</span>,<span class="number">63804</span>,<span class="number">63804</span>,<span class="number">63878</span>,<span class="number">63951</span>,<span class="number">64024</span>,<span class="number">64097</span>,<span class="number">64097</span>,<span class="number">64170</span>,<span class="number">64243</span>,<span class="number">64317</span>,<span class="number">64390</span>,<span class="number">64390</span>,<span class="number">64536</span>,<span class="number">64536</span>,<span class="number">64609</span>,<span class="number">64682</span>,<span class="number">64829</span>,<span class="number">64975</span>,<span class="number">65121</span>,<span class="number">65268</span>,<span class="number">65414</span>,<span class="number">65560</span>,<span class="number">65560</span>,<span class="number">65707</span>,<span class="number">65853</span>,<span class="number">65999</span>,<span class="number">66146</span>,<span class="number">66146</span>,<span class="number">66439</span>,<span class="number">66585</span>,<span class="number">66878</span>,<span class="number">67170</span>,<span class="number">67317</span>,<span class="number">67317</span>,<span class="number">67609</span>,<span class="number">67902</span>,<span class="number">68048</span>,<span class="number">68195</span>,<span class="number">68341</span>,<span class="number">68487</span>,<span class="number">68487</span>,<span class="number">68780</span>,<span class="number">68926</span>,<span class="number">69073</span>,<span class="number">69219</span>,<span class="number">69365</span>,<span class="number">69512</span>,<span class="number">69658</span>,<span class="number">69658</span>,<span class="number">69804</span>,<span class="number">69951</span>,<span class="number">70243</span>,<span class="number">70390</span>,<span class="number">70536</span>,<span class="number">70682</span>,<span class="number">70829</span>,<span class="number">70829</span>,<span class="number">71121</span>,<span class="number">71268</span>,<span class="number">71560</span>,<span class="number">71853</span>,<span class="number">71999</span>,<span class="number">71999</span>,<span class="number">72292</span>,<span class="number">72585</span>,<span class="number">72731</span>,<span class="number">72878</span>,<span class="number">73024</span>,<span class="number">73170</span>,<span class="number">73317</span>,<span class="number">73463</span>,<span class="number">73609</span>,<span class="number">73609</span>,<span class="number">73756</span>,<span class="number">73975</span>,<span class="number">74195</span>,<span class="number">74341</span>,<span class="number">74341</span>,<span class="number">74634</span>,<span class="number">74707</span>,<span class="number">74780</span>,<span class="number">74926</span>,<span class="number">74926</span>,<span class="number">75073</span>,<span class="number">75073</span>,<span class="number">75219</span>,<span class="number">75219</span>,<span class="number">75219</span>,<span class="number">75365</span>,<span class="number">75512</span>,<span class="number">75512</span>,<span class="number">75658</span>,<span class="number">75658</span>,<span class="number">75804</span>,<span class="number">75804</span>,<span class="number">75804</span>,<span class="number">75951</span>,<span class="number">76097</span>,<span class="number">76097</span>,<span class="number">76390</span>,<span class="number">76390</span>,<span class="number">76390</span>,<span class="number">76536</span>,<span class="number">76682</span>,<span class="number">76682</span>,<span class="number">76829</span>,<span class="number">76829</span>,<span class="number">76975</span>,<span class="number">76975</span>,<span class="number">76975</span>,<span class="number">77268</span>,<span class="number">77268</span>,<span class="number">77414</span>,<span class="number">77560</span>,<span class="number">77560</span>,<span class="number">77561</span>,<span class="number">77707</span>,<span class="number">77853</span>,<span class="number">77853</span>,<span class="number">77999</span>,<span class="number">77999</span>,<span class="number">78146</span>,<span class="number">78146</span>,<span class="number">78146</span>,<span class="number">78292</span>,<span class="number">78439</span>,<span class="number">78439</span>,<span class="number">78731</span>,<span class="number">78732</span>,<span class="number">78732</span>,<span class="number">78878</span>,<span class="number">79024</span>,<span class="number">79024</span>,<span class="number">79170</span>,<span class="number">79171</span>,<span class="number">79317</span>,<span class="number">79317</span>,<span class="number">79463</span>,<span class="number">79609</span>,<span class="number">79609</span>,<span class="number">79756</span>,<span class="number">79902</span>,<span class="number">79902</span>,<span class="number">80048</span>,<span class="number">80195</span>,<span class="number">80341</span>,<span class="number">80341</span>,<span class="number">80487</span>,<span class="number">80487</span>,<span class="number">80634</span>,<span class="number">80780</span>,<span class="number">80780</span>,<span class="number">80926</span>,<span class="number">80926</span>,<span class="number">81073</span>,<span class="number">81073</span>,<span class="number">81073</span>,<span class="number">81219</span>,<span class="number">81365</span>,<span class="number">81512</span>,<span class="number">81512</span>,<span class="number">81658</span>,<span class="number">81658</span>,<span class="number">81658</span>,<span class="number">81951</span>,<span class="number">81951</span>,<span class="number">81951</span>,<span class="number">82097</span>,<span class="number">82243</span>,<span class="number">82243</span>,<span class="number">82390</span>,<span class="number">82536</span>,<span class="number">82682</span>,<span class="number">82682</span>,<span class="number">82829</span>,<span class="number">82829</span>,<span class="number">82829</span>,<span class="number">82975</span>,<span class="number">83121</span>,<span class="number">83121</span>,<span class="number">83268</span>,<span class="number">83414</span>,<span class="number">83414</span>,<span class="number">83560</span>,<span class="number">83707</span>,<span class="number">83853</span>,<span class="number">83853</span>,<span class="number">83999</span>,<span class="number">83999</span>,<span class="number">83999</span>,<span class="number">84292</span>,<span class="number">84292</span>,<span class="number">84365</span>,<span class="number">84439</span>,<span class="number">84512</span>,<span class="number">84585</span>,<span class="number">84585</span>,<span class="number">84731</span>,<span class="number">84804</span>,<span class="number">84878</span>,<span class="number">84878</span>,<span class="number">84951</span>,<span class="number">85024</span>,<span class="number">85097</span>,<span class="number">85170</span>,<span class="number">85170</span>,<span class="number">85317</span>,<span class="number">85390</span>,<span class="number">85463</span>,<span class="number">85463</span>,<span class="number">85536</span>,<span class="number">85609</span>,<span class="number">85682</span>,<span class="number">85756</span>,<span class="number">85756</span>,<span class="number">85829</span>,<span class="number">85902</span>,<span class="number">85975</span>,<span class="number">86048</span>,<span class="number">86048</span>,<span class="number">86121</span>,<span class="number">86195</span>,<span class="number">86268</span>,<span class="number">86341</span>,<span class="number">86341</span>,<span class="number">86487</span>,<span class="number">86634</span>,<span class="number">86634</span>,<span class="number">86707</span>,<span class="number">86780</span>,<span class="number">86853</span>,<span class="number">86926</span>,<span class="number">86926</span>,<span class="number">87073</span>,<span class="number">87146</span>,<span class="number">87219</span>,<span class="number">87219</span>,<span class="number">87292</span>,<span class="number">87365</span>,<span class="number">87439</span>,<span class="number">87512</span>,<span class="number">87512</span>,<span class="number">87658</span>,<span class="number">87804</span>,<span class="number">87804</span>,<span class="number">87878</span>,<span class="number">87951</span>,<span class="number">88024</span>,<span class="number">88097</span>,<span class="number">88097</span>,<span class="number">88170</span>,<span class="number">88243</span>,<span class="number">88317</span>,<span class="number">88390</span>,<span class="number">88390</span>,<span class="number">88536</span>,<span class="number">88609</span>,<span class="number">88682</span>,<span class="number">88682</span>,<span class="number">88829</span>,<span class="number">88975</span>,<span class="number">88975</span>,<span class="number">89121</span>,<span class="number">89121</span>,<span class="number">89268</span>,<span class="number">89268</span>,<span class="number">89414</span>,<span class="number">89414</span>,<span class="number">89560</span>,<span class="number">89560</span>,<span class="number">89707</span>,<span class="number">89707</span>,<span class="number">89853</span>,<span class="number">89853</span>,<span class="number">89999</span>,<span class="number">89999</span>,<span class="number">90146</span>,<span class="number">90146</span>,<span class="number">90292</span>,<span class="number">90292</span>,<span class="number">90439</span>,<span class="number">90439</span>,<span class="number">90585</span>,<span class="number">90585</span>,<span class="number">90731</span>,<span class="number">90731</span>,<span class="number">90878</span>,<span class="number">90878</span>,<span class="number">91024</span>,<span class="number">91024</span>,<span class="number">91170</span>,<span class="number">91170</span>,<span class="number">91317</span>,<span class="number">91317</span>,<span class="number">91390</span>,<span class="number">91463</span>,<span class="number">91536</span>,<span class="number">91609</span>,<span class="number">91682</span>,<span class="number">91756</span>,<span class="number">91829</span>,<span class="number">91902</span>,<span class="number">91975</span>,<span class="number">92048</span>,<span class="number">92121</span>,<span class="number">92195</span>,<span class="number">92268</span>,<span class="number">92341</span>,<span class="number">92634</span>,<span class="number">92780</span>,<span class="number">92926</span>,<span class="number">93219</span>,<span class="number">93365</span>,<span class="number">93365</span>,<span class="number">93365</span>,<span class="number">93365</span>,<span class="number">93658</span>,<span class="number">93658</span>,<span class="number">93804</span>,<span class="number">93878</span>,<span class="number">93951</span>,<span class="number">93951</span>,<span class="number">94097</span>,<span class="number">94243</span>,<span class="number">94317</span>,<span class="number">94390</span>,<span class="number">94463</span>,<span class="number">94536</span>,<span class="number">94536</span>,<span class="number">94682</span>,<span class="number">94829</span>,<span class="number">94829</span>,<span class="number">94975</span>,<span class="number">95121</span>,<span class="number">95121</span>,<span class="number">95268</span>,<span class="number">95414</span>,<span class="number">95487</span>,<span class="number">95560</span>,<span class="number">95634</span>,<span class="number">95707</span>,<span class="number">95707</span>,<span class="number">95853</span>,<span class="number">95853</span>,<span class="number">95999</span>,<span class="number">95999</span>,<span class="number">96146</span>,<span class="number">96292</span>,<span class="number">96292</span>,<span class="number">96292</span>,<span class="number">96439</span>,<span class="number">96585</span>,<span class="number">96585</span>,<span class="number">96658</span>,<span class="number">96731</span>,<span class="number">96804</span>,<span class="number">96878</span>,<span class="number">96878</span>,<span class="number">97024</span>,<span class="number">97170</span>,<span class="number">97170</span>,<span class="number">97317</span>,<span class="number">97390</span>,<span class="number">97463</span>,<span class="number">97463</span>,<span class="number">97609</span>,<span class="number">97756</span>,<span class="number">97756</span>,<span class="number">97829</span>,<span class="number">97902</span>,<span class="number">98048</span>,<span class="number">98048</span>,<span class="number">98048</span>,<span class="number">98195</span>,<span class="number">98341</span>,<span class="number">98341</span>,<span class="number">98487</span>,<span class="number">98560</span>,<span class="number">98634</span>,<span class="number">98634</span>,<span class="number">98780</span>,<span class="number">98926</span>,<span class="number">98926</span>,<span class="number">99073</span>,<span class="number">99219</span>,<span class="number">99219</span>,<span class="number">99365</span>,<span class="number">99512</span>,<span class="number">99512</span>,<span class="number">99658</span>,<span class="number">99804</span>,<span class="number">99804</span>,<span class="number">99951</span>,<span class="number">100097</span>,<span class="number">100170</span>,<span class="number">100243</span>,<span class="number">100317</span>,<span class="number">100390</span>,<span class="number">100390</span>,<span class="number">100536</span>,<span class="number">100682</span>,<span class="number">100682</span>,<span class="number">100829</span>,<span class="number">100975</span>,<span class="number">100975</span>,<span class="number">100975</span>,<span class="number">101121</span>,<span class="number">101268</span>,<span class="number">101268</span>,<span class="number">101341</span>,<span class="number">101414</span>,<span class="number">101487</span>,<span class="number">101560</span>,<span class="number">101560</span>,<span class="number">101707</span>,<span class="number">101853</span>,<span class="number">101853</span>,<span class="number">101926</span>,<span class="number">101999</span>,<span class="number">102073</span>,<span class="number">102146</span>,<span class="number">102146</span>,<span class="number">102292</span>,<span class="number">102439</span>,<span class="number">102439</span>,<span class="number">102439</span>,<span class="number">102585</span>,<span class="number">102658</span>,<span class="number">102731</span>,<span class="number">102731</span>,<span class="number">102878</span>,<span class="number">103024</span>,<span class="number">103024</span>,<span class="number">103024</span>,<span class="number">103170</span>,<span class="number">103243</span>,<span class="number">103317</span>,<span class="number">103317</span>,<span class="number">103317</span>,<span class="number">103463</span>,<span class="number">103609</span>,<span class="number">103682</span>,<span class="number">103756</span>,<span class="number">103829</span>,<span class="number">103902</span>,<span class="number">103902</span>,<span class="number">104048</span>,<span class="number">104195</span>,<span class="number">104195</span>,<span class="number">104341</span>,<span class="number">104487</span>,<span class="number">104487</span>,<span class="number">104487</span>,<span class="number">104634</span>,<span class="number">104780</span>,<span class="number">104853</span>,<span class="number">104926</span>,<span class="number">104999</span>,<span class="number">105073</span>,<span class="number">105073</span>,<span class="number">105219</span>,<span class="number">105365</span>,<span class="number">105365</span>,<span class="number">105512</span>,<span class="number">105658</span>,<span class="number">105658</span>,<span class="number">105658</span>,<span class="number">105804</span>,<span class="number">105951</span>,<span class="number">105951</span>,<span class="number">106097</span>,<span class="number">106170</span>,<span class="number">106243</span>,<span class="number">106243</span>,<span class="number">106317</span>,<span class="number">106390</span>,<span class="number">106536</span>,<span class="number">106536</span>,<span class="number">106682</span>,<span class="number">106756</span>,<span class="number">106829</span>,<span class="number">106829</span>,<span class="number">106829</span>,<span class="number">106975</span>,<span class="number">107121</span>,<span class="number">107121</span>,<span class="number">107268</span>,<span class="number">107268</span>,<span class="number">107414</span>,<span class="number">107414</span>,<span class="number">107414</span>,<span class="number">107560</span>,<span class="number">107707</span>,<span class="number">107707</span>,<span class="number">107707</span>,<span class="number">107853</span>,<span class="number">107999</span>,<span class="number">107999</span>,<span class="number">107999</span>,<span class="number">108146</span>,<span class="number">108292</span>,<span class="number">108292</span>,<span class="number">108439</span>,<span class="number">108585</span>,<span class="number">108585</span>,<span class="number">108731</span>,<span class="number">108878</span>,<span class="number">108878</span>,<span class="number">108878</span>,<span class="number">109024</span>,<span class="number">109170</span>,<span class="number">109170</span>,<span class="number">109317</span>,<span class="number">109463</span>,<span class="number">109463</span>,<span class="number">109536</span>,<span class="number">109609</span>,<span class="number">109682</span>,<span class="number">109756</span>,<span class="number">109756</span>,<span class="number">109902</span>,<span class="number">110048</span>,<span class="number">110048</span>,<span class="number">110048</span>,<span class="number">110195</span>,<span class="number">110195</span>,<span class="number">110341</span>,<span class="number">110341</span>,<span class="number">110341</span>,<span class="number">110487</span>,<span class="number">110487</span>,<span class="number">110634</span>,<span class="number">110634</span>,<span class="number">110634</span>,<span class="number">110780</span>,<span class="number">110780</span>,<span class="number">110926</span>,<span class="number">110926</span>,<span class="number">110926</span>,<span class="number">111073</span>,<span class="number">111073</span>,<span class="number">111219</span>,<span class="number">111219</span>,<span class="number">111219</span>,<span class="number">111365</span>,<span class="number">111512</span>,<span class="number">111658</span>,<span class="number">111731</span>,<span class="number">111804</span>,<span class="number">111878</span>,<span class="number">111951</span>,<span class="number">112024</span>,<span class="number">112097</span>,<span class="number">112097</span>,<span class="number">112097</span>,<span class="number">112390</span>,<span class="number">112390</span>,<span class="number">112536</span>,<span class="number">112682</span>,<span class="number">112682</span>,<span class="number">112682</span>,<span class="number">112829</span>,<span class="number">112975</span>,<span class="number">112975</span>,<span class="number">113121</span>,<span class="number">113268</span>,<span class="number">113268</span>,<span class="number">113414</span>,<span class="number">113560</span>,<span class="number">113560</span>,<span class="number">113707</span>,<span class="number">113853</span>,<span class="number">113853</span>,<span class="number">113999</span>,<span class="number">114146</span>,<span class="number">114219</span>,<span class="number">114292</span>,<span class="number">114365</span>,<span class="number">114439</span>,<span class="number">114439</span>,<span class="number">114585</span>,<span class="number">114731</span>,<span class="number">114731</span>,<span class="number">114878</span>,<span class="number">115024</span>,<span class="number">115024</span>,<span class="number">115024</span>,<span class="number">115170</span>,<span class="number">115317</span>,<span class="number">115317</span>,<span class="number">115463</span>,<span class="number">115536</span>,<span class="number">115609</span>,<span class="number">115609</span>,<span class="number">115756</span>,<span class="number">115902</span>,<span class="number">115902</span>,<span class="number">115975</span>,<span class="number">116048</span>,<span class="number">116121</span>,<span class="number">116195</span>,<span class="number">116195</span>,<span class="number">116268</span>,<span class="number">116341</span>,<span class="number">116414</span>,<span class="number">116487</span>,<span class="number">116487</span>,<span class="number">116560</span>,<span class="number">116634</span>,<span class="number">116707</span>,<span class="number">116780</span>,<span class="number">116780</span>,<span class="number">116926</span>,<span class="number">117073</span>,<span class="number">117073</span>,<span class="number">117219</span>,<span class="number">117365</span>,<span class="number">117365</span>,<span class="number">117512</span>,<span class="number">117658</span>,<span class="number">117658</span>,<span class="number">117804</span>,<span class="number">117878</span>,<span class="number">117951</span>,<span class="number">117951</span>,<span class="number">118097</span>,<span class="number">118243</span>,<span class="number">118243</span>,<span class="number">118390</span>,<span class="number">118536</span>,<span class="number">118536</span>,<span class="number">118682</span>,<span class="number">118829</span>,<span class="number">118902</span>,<span class="number">118975</span>,<span class="number">119048</span>,<span class="number">119121</span>,<span class="number">119121</span>,<span class="number">119268</span>,<span class="number">119414</span>,<span class="number">119414</span>,<span class="number">119560</span>,<span class="number">119707</span>,<span class="number">119707</span>,<span class="number">119853</span>,<span class="number">119999</span>,<span class="number">119999</span>,<span class="number">120146</span>,<span class="number">120292</span>,<span class="number">120292</span>,<span class="number">120439</span>,<span class="number">120439</span>,<span class="number">120731</span>,<span class="number">121024</span>,<span class="number">121170</span>,<span class="number">121463</span>,<span class="number">121536</span>,<span class="number">121609</span>,<span class="number">121682</span>,<span class="number">121756</span>,<span class="number">121756</span>,<span class="number">121756</span>,<span class="number">121902</span>,<span class="number">122048</span>,<span class="number">122048</span>,<span class="number">122048</span>,<span class="number">122195</span>,<span class="number">122341</span>,<span class="number">122341</span>,<span class="number">122341</span>,<span class="number">122487</span>,<span class="number">122560</span>,<span class="number">122634</span>,<span class="number">122634</span>,<span class="number">122634</span>,<span class="number">122780</span>,<span class="number">122926</span>,<span class="number">122926</span>,<span class="number">122926</span>,<span class="number">123073</span>,<span class="number">123219</span>,<span class="number">123219</span>,<span class="number">123219</span>,<span class="number">123365</span>,<span class="number">123512</span>,<span class="number">123512</span>,<span class="number">123512</span>,<span class="number">123585</span>,<span class="number">123658</span>,<span class="number">123731</span>,<span class="number">123804</span>,<span class="number">123804</span>,<span class="number">123804</span>,<span class="number">123951</span>,<span class="number">124097</span>,<span class="number">124097</span>,<span class="number">124097</span>,<span class="number">124243</span>,<span class="number">124390</span>,<span class="number">124390</span>,<span class="number">124390</span>,<span class="number">124536</span>,<span class="number">124682</span>,<span class="number">124682</span>,<span class="number">124682</span>,<span class="number">124829</span>,<span class="number">124975</span>,<span class="number">124975</span>,<span class="number">124975</span>,<span class="number">125121</span>,<span class="number">125268</span>,<span class="number">125268</span>,<span class="number">125268</span>,<span class="number">125414</span>,<span class="number">125487</span>,<span class="number">125560</span>,<span class="number">125560</span>,<span class="number">125560</span>,<span class="number">125707</span>,<span class="number">125853</span>,<span class="number">125853</span>,<span class="number">125853</span>,<span class="number">125999</span>,<span class="number">126146</span>,<span class="number">126146</span>,<span class="number">126146</span>,<span class="number">126292</span>,<span class="number">126439</span>,<span class="number">126439</span>,<span class="number">126439</span>,<span class="number">126585</span>,<span class="number">126585</span>,<span class="number">126731</span>,<span class="number">126731</span>,<span class="number">126878</span>,<span class="number">126878</span>,<span class="number">127024</span>,<span class="number">127024</span>,<span class="number">127024</span>,<span class="number">127170</span>,<span class="number">127170</span>,<span class="number">127317</span>,<span class="number">127317</span>,<span class="number">127463</span>,<span class="number">127463</span>,<span class="number">127609</span>,<span class="number">127609</span>,<span class="number">127609</span>,<span class="number">127756</span>,<span class="number">127756</span>,<span class="number">127902</span>,<span class="number">127902</span>,<span class="number">128048</span>,<span class="number">128048</span>,<span class="number">128195</span>,<span class="number">128195</span>,<span class="number">128268</span>,<span class="number">128341</span>,<span class="number">128341</span>,<span class="number">128414</span>,<span class="number">128487</span>,<span class="number">128487</span>,<span class="number">128560</span>,<span class="number">128634</span>,<span class="number">128707</span>,<span class="number">128780</span>,<span class="number">128780</span>,<span class="number">128853</span>,<span class="number">128926</span>,<span class="number">128999</span>,<span class="number">129073</span>,<span class="number">129146</span>,<span class="number">129219</span>,<span class="number">129292</span>,<span class="number">129365</span>,<span class="number">129365</span>,<span class="number">129439</span>,<span class="number">129512</span>,<span class="number">129585</span>,<span class="number">129658</span>,<span class="number">129731</span>,<span class="number">129804</span>,<span class="number">129878</span>,<span class="number">129951</span>,<span class="number">129951</span>,<span class="number">130024</span>,<span class="number">130097</span>,<span class="number">130170</span>,<span class="number">130243</span>,<span class="number">130243</span>,<span class="number">130317</span>,<span class="number">130390</span>,<span class="number">130463</span>,<span class="number">130536</span>,<span class="number">130536</span>,<span class="number">130682</span>,<span class="number">130756</span>,<span class="number">130829</span>,<span class="number">130829</span>,<span class="number">130829</span>,<span class="number">130975</span>,<span class="number">130975</span>,<span class="number">131121</span>,<span class="number">131195</span>,<span class="number">131268</span>,<span class="number">131341</span>,<span class="number">131560</span>,<span class="number">131707</span>,<span class="number">131707</span>,<span class="number">131780</span>,<span class="number">131853</span>,<span class="number">131926</span>,<span class="number">132146</span>,<span class="number">132292</span>,<span class="number">132365</span>,<span class="number">132439</span>,<span class="number">132512</span>,<span class="number">132731</span>,<span class="number">132878</span>,<span class="number">132878</span>,<span class="number">132951</span>,<span class="number">133024</span>,<span class="number">133097</span>,<span class="number">133463</span>,<span class="number">133463</span>,<span class="number">133756</span>,<span class="number">134048</span>,<span class="number">134048</span>,<span class="number">134048</span>,<span class="number">134341</span>,<span class="number">134634</span>,<span class="number">134634</span>,<span class="number">134926</span>,<span class="number">134926</span>,<span class="number">135219</span>,<span class="number">135219</span>,<span class="number">135219</span>,<span class="number">135512</span>,<span class="number">135512</span>,<span class="number">135658</span>,<span class="number">135658</span>,<span class="number">135804</span>,<span class="number">135804</span>,<span class="number">135951</span>,<span class="number">135951</span>,<span class="number">136097</span>,<span class="number">136097</span>,<span class="number">136243</span>,<span class="number">136243</span>,<span class="number">136390</span>,<span class="number">136390</span>,<span class="number">136536</span>,<span class="number">136536</span>,<span class="number">136609</span>,<span class="number">136682</span>,<span class="number">136682</span>,<span class="number">136829</span>,<span class="number">136829</span>,<span class="number">136902</span>,<span class="number">136975</span>,<span class="number">136975</span>,<span class="number">137121</span>,<span class="number">137121</span>,<span class="number">137268</span>,<span class="number">137268</span>,<span class="number">137414</span>,<span class="number">137414</span>,<span class="number">137560</span>,<span class="number">137560</span>,<span class="number">137707</span>,<span class="number">137707</span>,<span class="number">137780</span>,<span class="number">137853</span>,<span class="number">137926</span>,<span class="number">137999</span>,<span class="number">137999</span>,<span class="number">138073</span>,<span class="number">138146</span>,<span class="number">138146</span>,<span class="number">138219</span>,<span class="number">138292</span>,<span class="number">138365</span>,<span class="number">138439</span>,<span class="number">138439</span>,<span class="number">138512</span>,<span class="number">138585</span>,<span class="number">138658</span>,<span class="number">138731</span>,<span class="number">138731</span>,<span class="number">138804</span>,<span class="number">138878</span>,<span class="number">138951</span>,<span class="number">139024</span>,<span class="number">139024</span>,<span class="number">139097</span>,<span class="number">139170</span>,<span class="number">139243</span>,<span class="number">139317</span>,<span class="number">139317</span>,<span class="number">139463</span>,<span class="number">139463</span>,<span class="number">139609</span>,<span class="number">139609</span>,<span class="number">139756</span>,<span class="number">139756</span>,<span class="number">139902</span>,<span class="number">139902</span>,<span class="number">140195</span>,<span class="number">140195</span>,<span class="number">140195</span>,<span class="number">140195</span> &#125;;</span><br><span class="line"></span><br><span class="line">DWORD __ROR4__(DWORD a1, <span class="type">char</span> a2)</span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">return</span> (a1 &gt;&gt; a2) | (a1 &lt;&lt; (<span class="number">32</span> - a2));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">rounds</span><span class="params">(<span class="type">uint8_t</span>* bytes, <span class="type">unsigned</span> <span class="type">int</span> a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line"> DWORD* v3; <span class="comment">// r4</span></span><br><span class="line"> DWORD v4; <span class="comment">// r12</span></span><br><span class="line"> DWORD v5[<span class="number">2</span>]; <span class="comment">// r5</span></span><br><span class="line"> DWORD v6; <span class="comment">// r3</span></span><br><span class="line"> DWORD result; <span class="comment">// r0</span></span><br><span class="line"> </span><br><span class="line"> v3 = (DWORD*)((<span class="type">char</span>*)bytes + a3);</span><br><span class="line"> v4 = *(DWORD*)((<span class="type">char</span>*)bytes + a3);</span><br><span class="line"> *(DWORD64*)&amp;v5[<span class="number">0</span>] = *(DWORD64*)((<span class="type">char</span>*)bytes + a3 + <span class="number">4</span>);</span><br><span class="line"> v6 = *(DWORD*)((<span class="type">char</span>*)bytes + a3 + <span class="number">12</span>);</span><br><span class="line"> *(DWORD*)((<span class="type">char</span>*)bytes + a3) = *(&amp;v5[<span class="number">0</span>] + <span class="number">1</span>);</span><br><span class="line"> result = v4 ^ __ROR4__(*(&amp;v5[<span class="number">0</span>] + <span class="number">1</span>) ^ a2, <span class="number">19</span>);</span><br><span class="line"> v3[<span class="number">3</span>] = v5[<span class="number">0</span>] ^ __ROR4__(v6, <span class="number">18</span>) ^ __ROR4__(*(&amp;v5[<span class="number">0</span>] + <span class="number">1</span>) ^ a2, <span class="number">19</span>);</span><br><span class="line"> v3[<span class="number">1</span>] = v6;</span><br><span class="line"> v3[<span class="number">2</span>] = result;</span><br><span class="line"> <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="type">unsigned</span> <span class="type">char</span> enc_bytes[] =</span><br><span class="line"> &#123;</span><br><span class="line">  <span class="number">0x3C</span>, <span class="number">0xAC</span>, <span class="number">0x92</span>, <span class="number">0x6F</span>, <span class="number">0x44</span>, <span class="number">0xA1</span>, <span class="number">0xC1</span>, <span class="number">0x17</span>, <span class="number">0xFD</span>, <span class="number">0x62</span>,</span><br><span class="line">  <span class="number">0x60</span>, <span class="number">0xDD</span>, <span class="number">0x63</span>, <span class="number">0xF8</span>, <span class="number">0xE3</span>, <span class="number">0x2A</span>, <span class="number">0x5E</span>, <span class="number">0x75</span>, <span class="number">0x78</span>, <span class="number">0xBE</span>,</span><br><span class="line">  <span class="number">0x59</span>, <span class="number">0x46</span>, <span class="number">0x33</span>, <span class="number">0xF6</span>, <span class="number">0x2E</span>, <span class="number">0x64</span>, <span class="number">0x61</span>, <span class="number">0x8A</span>, <span class="number">0x27</span>, <span class="number">0x93</span>,</span><br><span class="line">  <span class="number">0x21</span>, <span class="number">0x7D</span>, <span class="number">0x00</span></span><br><span class="line"> &#125;;</span><br><span class="line"> mt19937 <span class="title function_">rng</span><span class="params">(<span class="number">-196167794</span>)</span>;</span><br><span class="line"> <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1608</span>; ++i)</span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">if</span> (rng() % <span class="number">7</span> &gt;= <span class="number">3</span>)</span><br><span class="line">  &#123;</span><br><span class="line">   rounds(enc_bytes, rng(), hitp[i] &amp; <span class="number">0xF</span>);</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, enc_bytes);</span><br><span class="line"> getchar();</span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//D3CTF&#123;Gb78e-7b04-4364-82d2-7f44&#125;</span></span><br></pre></td></tr></table></figure>

<p>我只能说写出这个脚本的人是神！</p>
<p>方法二：用frida</p>
<p>frida hook得到最后的server::instance，也就是flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function hooktest () &#123; </span><br><span class="line">    let i = <span class="number">0</span>; </span><br><span class="line">    var d3mug = Module.findBaseAddress(<span class="string">&quot;libd3mug.so&quot;</span>); </span><br><span class="line">    Interceptor.attach(d3mug.add(<span class="number">0x0000780</span>), &#123; </span><br><span class="line">        onEnter: function (args) &#123; </span><br><span class="line">            var real_time = arr[i++]; </span><br><span class="line">            args[<span class="number">0</span>] = new NativePointer(real_time); </span><br><span class="line">        &#125;,</span><br><span class="line">        onLeave: function (arg) &#123; </span><br><span class="line">            console.log(hexdump(d3mug.add(<span class="number">0x0000000000002D18</span>).readPointer())); </span><br><span class="line">            <span class="keyword">return</span> arg; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;); </span><br><span class="line">&#125;</span><br><span class="line">setImmediate(function () &#123; </span><br><span class="line">    setTimeout(hooktest, <span class="number">100</span>); </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>安卓机子到了再搞。</p>
<h3 id="d3arm"><a href="#d3arm" class="headerlink" title="d3arm"></a><strong>d3arm</strong></h3><p>这个题也是第一次见，给了一个bin文件，首先我们将bin转换成hex文件，然后用ida的arm小端来打开hex文件就行</p>
<p><img src="/d3ctf/image-20220307182342150.png"></p>
<p><img src="/d3ctf/image-20220308093225798.png"></p>
<p>上面是主函数</p>
<p><img src="/d3ctf/image-20220308093822234.png"></p>
<p>这个函数选择难度，我们必须选择hard难度 这样这个MEMORY[0x200028E4] &#x3D;&#x3D; 450000才成立</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_5FA4</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  sub_75C2(<span class="number">536880148</span>);</span><br><span class="line">  sub_765E(<span class="number">536880148</span>, <span class="number">536871392</span>, <span class="number">6</span>);</span><br><span class="line">  sub_75D0(<span class="number">536880148</span>, (<span class="type">const</span> <span class="type">char</span> *)&amp;unk_6068);</span><br><span class="line">  sub_75D0(<span class="number">536880148</span>, <span class="string">&quot;  You get %2d points  &quot;</span>, MEMORY[<span class="number">0x2000326C</span>]);</span><br><span class="line">  sub_75D0(<span class="number">536880148</span>, <span class="string">&quot; Good! Try it again. &quot;</span>);</span><br><span class="line">  sub_75D0(<span class="number">536880148</span>, <span class="string">&quot;                     &quot;</span>);</span><br><span class="line">  sub_7610(<span class="number">536880148</span>);</span><br><span class="line">  <span class="keyword">if</span> ( MEMORY[<span class="number">0x2000326C</span>] == <span class="number">42</span> &amp;&amp; MEMORY[<span class="number">0x200028E4</span>] == <span class="number">450000</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_75C2(<span class="number">536880148</span>);</span><br><span class="line">    sub_765E(<span class="number">536880148</span>, <span class="number">536871392</span>, <span class="number">6</span>);</span><br><span class="line">    sub_75D0(<span class="number">536880148</span>, (<span class="type">const</span> <span class="type">char</span> *)<span class="number">0x800E094</span>);</span><br><span class="line">    sub_75D0(<span class="number">536880148</span>, <span class="string">&quot; flag is shown below &quot;</span>);</span><br><span class="line">    sub_75D0(<span class="number">536880148</span>, (<span class="type">const</span> <span class="type">char</span> *)<span class="number">0x200022C8</span>);</span><br><span class="line">    sub_7610(<span class="number">536880148</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sub_7F48(<span class="number">1000000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们通过字符串找到主函数</p>
<p>我们发现对比是内存中*（0x2000326C）&#x3D;&#x3D; 42 *（0x200028E4）&#x3D;&#x3D; 45000</p>
<p><img src="/d3ctf/image-20220308094116490.png"></p>
<p>这个是对flag的生成</p>
<p>通过对异或的值交叉引用发现异或的值有一个生成过程</p>
<p><img src="/d3ctf/image-20220308094853385.png"></p>
<p>找到异或后的值的生成位置</p>
<p>直接写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">xor_arr = [] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>): </span><br><span class="line">    v1 = i % <span class="number">3</span> </span><br><span class="line">    xor_arr.append((<span class="number">0x335E44</span> &gt;&gt; (<span class="number">8</span> * v1)) &amp; <span class="number">0xff</span>) </span><br><span class="line">cmp = [<span class="number">0x00000020</span>, <span class="number">0x0000006D</span>, <span class="number">0x00000050</span>, <span class="number">0x00000030</span>, <span class="number">0x00000038</span>, <span class="number">0x00000048</span>, </span><br><span class="line"><span class="number">0x00000020</span>, <span class="number">0x0000006C</span>, <span class="number">0x00000007</span>, <span class="number">0x0000007D</span>, <span class="number">0x0000006C</span>, <span class="number">0x00000055</span>, </span><br><span class="line"><span class="number">0x0000007D</span>, <span class="number">0x00000068</span>, <span class="number">0x00000003</span>, <span class="number">0x00000027</span>, <span class="number">0x00000066</span>, <span class="number">0x00000000</span>, </span><br><span class="line"><span class="number">0x00000022</span>, <span class="number">0x00000069</span>, <span class="number">0x00000002</span>, <span class="number">0x0000007D</span>, <span class="number">0x0000006D</span>, <span class="number">0x0000000B</span>, </span><br><span class="line"><span class="number">0x00000077</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000002</span>, <span class="number">0x00000027</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000050</span>, </span><br><span class="line"><span class="number">0x00000073</span>, <span class="number">0x00000038</span>, <span class="number">0x00000004</span>, <span class="number">0x00000071</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000050</span>, </span><br><span class="line"><span class="number">0x0000007D</span>, <span class="number">0x0000006A</span>, <span class="number">0x00000052</span>, <span class="number">0x00000075</span>, <span class="number">0x0000006D</span>, <span class="number">0x0000004E</span>] </span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cmp)): </span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(cmp[j] ^ xor_arr[j]), end=<span class="string">&#x27;&#x27;</span>) </span><br><span class="line"><span class="comment"># d3ctf&#123;d2492f960c83f719383e1cec7f75ec94a13&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="d3thon"><a href="#d3thon" class="headerlink" title="d3thon"></a><strong>d3thon</strong></h3><p>第一次见这种题，给了三种文件，从未见过lbc文件，剩下也不知道是做什么用的，师傅们说是pyd文件，然后可以用python3.1跑起来，lbc包含了指令的逻辑，so文件是类似解释器的东西</p>
<p><img src="/d3ctf/image-20220308125453443.png"></p>
<p>这个lbc文件可用010打开</p>
<p><img src="/d3ctf/image-20220308125754914.png"></p>
<p>那只能硬猜是什么意思了，在一些函数中添加输出，发现start中循环16次，所以我们能猜测出</p>
<p>FLNPsiCIvICFtzpUAR:cnt1:1表示cnt +&#x3D;1，那么FLNPsiCIvICFtzpUAR代表add</p>
<p>OuGFUKNGxNLeHOudCK:cnt1:0:1表示cnt1&gt;0时准备jmp到下面的函数</p>
<p>ZOAmcoLkGlAXXqf就是定义函数吧</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">kZslMZYnvPBwgdCz print </span><br><span class="line">oGwDokoxZgoeViFcAF 赋值(如果赋值为KezJKhCxGRZnfLCGT, 则为输入 </span><br><span class="line">RDDDZUiIKbxCubJEN jmp </span><br><span class="line">todeVDuRkYSIITaT 转为2进制 </span><br><span class="line">uPapnsSbmeJLjin 转为10进制 </span><br><span class="line">kuhisCvwaXWfqCs -flag - 1 </span><br><span class="line">IEKMEDdrPpzpdKy add </span><br><span class="line">OcKUQCYqhwHXfAgGZH xor </span><br><span class="line">FLNPsiCIvICFtzpUAR sub </span><br><span class="line">OuGFUKNGxNLeHOudCK cmp</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">fp = <span class="built_in">open</span>(<span class="string">&#x27;data.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">a = fp.read().strip().replace(<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">fpout = <span class="built_in">open</span>(<span class="string">&#x27;data2.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">out_list = []</span><br><span class="line">a = a[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> a:</span><br><span class="line">    l = l.split(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> l[<span class="number">0</span>] ==<span class="string">&#x27;kuhisCvwaXWfqCs&#x27;</span>:</span><br><span class="line">        fpout.write(<span class="string">&#x27;flag = -flag\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> l[<span class="number">0</span>] == <span class="string">&#x27;IEKMEDdrPpzpdKy&#x27;</span>:</span><br><span class="line">        fpout.write(<span class="string">&#x27;flag -= &#x27;</span> + l[<span class="number">2</span>] + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> l[<span class="number">0</span>] == <span class="string">&#x27;FLNPsiCIvICFtzpUAR&#x27;</span>:</span><br><span class="line">        fpout.write(<span class="string">&#x27;flag += &#x27;</span> + l[<span class="number">2</span>] + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> l[<span class="number">0</span>] == <span class="string">&#x27;OcKUQCYqhwHXfAgGZH&#x27;</span>:</span><br><span class="line">        fpout.write(<span class="string">&#x27;flag ^= &#x27;</span> + l[<span class="number">2</span>] + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们可以按上面的逻辑进行字符串的替换，得到一个新的脚本，这个脚本就是完全逆向的。</p>
<p>整理输出flag</p>
<h3 id="d3hotel"><a href="#d3hotel" class="headerlink" title="d3hotel"></a>d3hotel</h3><p>这个题哦其实没那么麻烦，我们在网站中点f12查看文件，这个网页上总共四个文件</p>
<p><img src="/d3ctf/image-20220308190749396.png"></p>
<p>这有3个还有数据包在url中</p>
<p><img src="/d3ctf/image-20220308190816476.png"></p>
<p>拿到数据包就导入assertstdiogui查看</p>
<p><img src="/d3ctf/image-20220308190920416.png"></p>
<p>其中main.lua是重点，我们取下来，然后进行反编译</p>
<p>如何进行lua的反编译，首先将lua文件和unluac.jar文件放在一个文件夹中</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">java </span>-<span class="keyword">jar </span>unlua.<span class="keyword">jar </span>main.lua&gt;main1.lua</span><br></pre></td></tr></table></figure>

<p>main1.lua就是我们要的反编译后的程序</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line">local L0_1, L1_1, L2_1, L3_1, L4_1, L5_1, L6_1, L7_1, L8_1, L9_1, L10_1, L11_1</span><br><span class="line">L0_1 = require</span><br><span class="line">L1_1 = <span class="string">&quot;matrix&quot;</span></span><br><span class="line">L0_1 = L0_1(L1_1)</span><br><span class="line">matrix = L0_1</span><br><span class="line">L0_1 = matrix</span><br><span class="line">L1_1 = <span class="number">5</span></span><br><span class="line">L2_1 = <span class="number">5</span></span><br><span class="line">L3_1 = <span class="number">0</span></span><br><span class="line">L0_1 = L0_1(L1_1, L2_1, L3_1)</span><br><span class="line">m = L0_1</span><br><span class="line">L0_1 = matrix</span><br><span class="line">L1_1 = &#123;&#125;</span><br><span class="line">L2_1 = &#123;&#125;</span><br><span class="line">L3_1 = <span class="number">6422944</span></span><br><span class="line">L4_1 = <span class="number">-7719232</span></span><br><span class="line">L5_1 = <span class="number">41640292</span></span><br><span class="line">L6_1 = <span class="number">-1428488</span></span><br><span class="line">L7_1 = <span class="number">-36954388</span></span><br><span class="line">L2_1[<span class="number">1</span>] = L3_1</span><br><span class="line">L2_1[<span class="number">2</span>] = L4_1</span><br><span class="line">L2_1[<span class="number">3</span>] = L5_1</span><br><span class="line">L2_1[<span class="number">4</span>] = L6_1</span><br><span class="line">L2_1[<span class="number">5</span>] = L7_1</span><br><span class="line">L3_1 = &#123;&#125;</span><br><span class="line">L4_1 = <span class="number">43676120</span></span><br><span class="line">L5_1 = <span class="number">-26534136</span></span><br><span class="line">L6_1 = <span class="number">-31608964</span></span><br><span class="line">L7_1 = <span class="number">-20570796</span></span><br><span class="line">L8_1 = <span class="number">22753040</span></span><br><span class="line">L3_1[<span class="number">1</span>] = L4_1</span><br><span class="line">L3_1[<span class="number">2</span>] = L5_1</span><br><span class="line">L3_1[<span class="number">3</span>] = L6_1</span><br><span class="line">L3_1[<span class="number">4</span>] = L7_1</span><br><span class="line">L3_1[<span class="number">5</span>] = L8_1</span><br><span class="line">L4_1 = &#123;&#125;</span><br><span class="line">L5_1 = <span class="number">-6066184</span></span><br><span class="line">L6_1 = <span class="number">30440152</span></span><br><span class="line">L7_1 = <span class="number">5229916</span></span><br><span class="line">L8_1 = <span class="number">-16857572</span></span><br><span class="line">L9_1 = <span class="number">-16335464</span></span><br><span class="line">L4_1[<span class="number">1</span>] = L5_1</span><br><span class="line">L4_1[<span class="number">2</span>] = L6_1</span><br><span class="line">L4_1[<span class="number">3</span>] = L7_1</span><br><span class="line">L4_1[<span class="number">4</span>] = L8_1</span><br><span class="line">L4_1[<span class="number">5</span>] = L9_1</span><br><span class="line">L5_1 = &#123;&#125;</span><br><span class="line">L6_1 = <span class="number">-8185648</span></span><br><span class="line">L7_1 = <span class="number">-17254720</span></span><br><span class="line">L8_1 = <span class="number">-22800152</span></span><br><span class="line">L9_1 = <span class="number">-8484728</span></span><br><span class="line">L10_1 = <span class="number">44642816</span></span><br><span class="line">L5_1[<span class="number">1</span>] = L6_1</span><br><span class="line">L5_1[<span class="number">2</span>] = L7_1</span><br><span class="line">L5_1[<span class="number">3</span>] = L8_1</span><br><span class="line">L5_1[<span class="number">4</span>] = L9_1</span><br><span class="line">L5_1[<span class="number">5</span>] = L10_1</span><br><span class="line">L6_1 = &#123;&#125;</span><br><span class="line">L7_1 = <span class="number">-35858512</span></span><br><span class="line">L8_1 = <span class="number">10913104</span></span><br><span class="line">L9_1 = <span class="number">-4165844</span></span><br><span class="line">L10_1 = <span class="number">37696936</span></span><br><span class="line">L11_1 = <span class="number">-10061980</span></span><br><span class="line">L6_1[<span class="number">1</span>] = L7_1</span><br><span class="line">L6_1[<span class="number">2</span>] = L8_1</span><br><span class="line">L6_1[<span class="number">3</span>] = L9_1</span><br><span class="line">L6_1[<span class="number">4</span>] = L10_1</span><br><span class="line">L6_1[<span class="number">5</span>] = L11_1</span><br><span class="line">L1_1[<span class="number">1</span>] = L2_1</span><br><span class="line">L1_1[<span class="number">2</span>] = L3_1</span><br><span class="line">L1_1[<span class="number">3</span>] = L4_1</span><br><span class="line">L1_1[<span class="number">4</span>] = L5_1</span><br><span class="line">L1_1[<span class="number">5</span>] = L6_1</span><br><span class="line">L0_1 = L0_1(L1_1)</span><br><span class="line">n = L0_1</span><br><span class="line">function L0_1(A0_2)</span><br><span class="line">  local L1_2, L2_2, L3_2, L4_2, L5_2, L6_2, L7_2, L8_2, L9_2, L10_2, L11_2, L12_2</span><br><span class="line">  L1_2 = #A0_2</span><br><span class="line">  <span class="keyword">if</span> L1_2 ~= <span class="number">25</span> then<span class="comment">//矩阵长度25</span></span><br><span class="line">    L1_2 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> L1_2</span><br><span class="line">  end</span><br><span class="line">  L1_2 = <span class="number">1</span></span><br><span class="line">  L2_2 = <span class="number">5</span></span><br><span class="line">  L3_2 = <span class="number">1</span></span><br><span class="line">  <span class="keyword">for</span> L4_2 = L1_2, L2_2, L3_2 <span class="keyword">do</span></span><br><span class="line">    L5_2 = <span class="number">1</span></span><br><span class="line">    L6_2 = <span class="number">5</span></span><br><span class="line">    L7_2 = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> L8_2 = L5_2, L6_2, L7_2 <span class="keyword">do</span></span><br><span class="line">      L9_2 = m</span><br><span class="line">      L9_2 = L9_2[L4_2]</span><br><span class="line">      L10_2 = <span class="built_in">string</span></span><br><span class="line">      L10_2 = L10_2.byte</span><br><span class="line">      L11_2 = A0_2</span><br><span class="line">      L12_2 = L4_2 - <span class="number">1</span></span><br><span class="line">      L12_2 = L12_2 * <span class="number">5</span></span><br><span class="line">      L12_2 = L12_2 + L8_2</span><br><span class="line">      L10_2 = L10_2(L11_2, L12_2)</span><br><span class="line">      L9_2[L8_2] = L10_2</span><br><span class="line">    end</span><br><span class="line">  end</span><br><span class="line">  L1_2 = tonumber</span><br><span class="line">  L2_2 = <span class="built_in">string</span></span><br><span class="line">  L2_2 = L2_2.format</span><br><span class="line">  L3_2 = <span class="string">&quot;%.5f&quot;</span></span><br><span class="line">  L4_2 = matrix</span><br><span class="line">  L4_2 = L4_2.det</span><br><span class="line">  L5_2 = m</span><br><span class="line">  L4_2, L5_2, L6_2, L7_2, L8_2, L9_2, L10_2, L11_2, L12_2 = L4_2(L5_2)</span><br><span class="line">  L2_2, L3_2, L4_2, L5_2, L6_2, L7_2, L8_2, L9_2, L10_2, L11_2, L12_2 = L2_2(L3_2, L4_2, L5_2, L6_2, L7_2, L8_2, L9_2, L10_2, L11_2, L12_2)</span><br><span class="line">  L1_2 = L1_2(L2_2, L3_2, L4_2, L5_2, L6_2, L7_2, L8_2, L9_2, L10_2, L11_2, L12_2)</span><br><span class="line">  det = L1_2</span><br><span class="line">  L1_2 = matrix</span><br><span class="line">  L2_2 = <span class="number">5</span></span><br><span class="line">  L3_2 = <span class="string">&quot;I&quot;</span></span><br><span class="line">  L1_2 = L1_2(L2_2, L3_2)</span><br><span class="line">  L2_2 = det</span><br><span class="line">  L1_2 = L1_2 * L2_2</span><br><span class="line">  L2_2 = m</span><br><span class="line">  L3_2 = n</span><br><span class="line">  L2_2 = L2_2 * L3_2</span><br><span class="line">  <span class="keyword">if</span> L1_2 == L2_2 then<span class="comment">//matrix(5, &quot;I&quot;) * tonumber(L2_2, L3_2, L4_2, L5_2, L6_2, L7_2, L8_2, L9_2, L10_2, L11_2, L12_2) == m * n</span></span><br><span class="line">    L1_2 = <span class="number">1</span></span><br><span class="line">    L1_2 = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> L1_2</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    L1_2 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> L1_2</span><br><span class="line">  end</span><br><span class="line">end</span><br><span class="line">f = L0_1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/davidm/lua-matrix/blob/master/lua/matrix.lua%E6%BA%90%E7%A0%81">https://github.com/davidm/lua-matrix/blob/master/lua/matrix.lua源码</a></p>
<p>我们可以推出单位矩阵x<em>det（m）&#x3D;&#x3D; n</em>m</p>
<p>所以只需要求m就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line">det_n = np.linalg.det(n) </span><br><span class="line">sq2 = np.sqrt(det_n) </span><br><span class="line">sq4 = np.sqrt(sq2) </span><br><span class="line">m = n.I * sq4 </span><br><span class="line"><span class="built_in">print</span>(m)  </span><br><span class="line">[[-<span class="number">100.</span> -<span class="number">51.</span> -<span class="number">99.</span> -<span class="number">116.</span> -<span class="number">102.</span>] </span><br><span class="line">[-<span class="number">123.</span> -<span class="number">87.</span> -<span class="number">51.</span> -<span class="number">98.</span> -<span class="number">97.</span>] </span><br><span class="line">[ -<span class="number">53.</span> -<span class="number">109.</span> -<span class="number">95.</span> -<span class="number">49.</span> -<span class="number">115.</span>] </span><br><span class="line">[ -<span class="number">95.</span> -<span class="number">65.</span> -<span class="number">119.</span> -<span class="number">101.</span> -<span class="number">53.</span>]</span><br><span class="line">[-<span class="number">111.</span> -<span class="number">111.</span> -<span class="number">109.</span> -<span class="number">51.</span> -<span class="number">125.</span>]]</span><br><span class="line">m = [[-<span class="number">100</span>, -<span class="number">51</span>, -<span class="number">99</span>, -<span class="number">116</span>, -<span class="number">102</span>],</span><br><span class="line">[-<span class="number">123</span>, -<span class="number">87</span>, -<span class="number">51</span>, -<span class="number">98</span>, -<span class="number">97</span>], </span><br><span class="line">[ -<span class="number">53</span>, -<span class="number">109</span>, -<span class="number">95</span>, -<span class="number">49</span>, -<span class="number">115</span>], </span><br><span class="line">[ -<span class="number">95</span>, -<span class="number">65</span>, -<span class="number">119</span>, -<span class="number">101</span>, -<span class="number">53</span>], </span><br><span class="line">[-<span class="number">111</span>, -<span class="number">111</span>, -<span class="number">109</span>, -<span class="number">51</span>, -<span class="number">125</span>]] </span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> m: </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> l: </span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(-x),end=<span class="string">&#x27;&#x27;</span>) </span><br><span class="line">d3ctf&#123;W3ba5m_1s_Awe5oom3&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>交上去不对，然后找了许多地方，找到验证处</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">unnamed_function_39846</span><span class="params">(<span class="type">int</span> param1,undefined4 param2)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> iVar1;</span><br><span class="line">  undefined4 uVar2;</span><br><span class="line">  <span class="type">int</span> param1_00;</span><br><span class="line">  <span class="type">int</span> param2_00;</span><br><span class="line">  undefined4 *puVar3;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (cRam002f65f4 == <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">    unnamed_function_432(<span class="number">0x24b40c</span>);</span><br><span class="line">    unnamed_function_432(<span class="number">0x24b8dc</span>);</span><br><span class="line">    unnamed_function_432(<span class="number">0x252bd4</span>);</span><br><span class="line">    unnamed_function_432(<span class="number">0x251d78</span>);</span><br><span class="line">    unnamed_function_432(<span class="number">0x24fac4</span>);</span><br><span class="line">    cRam002f65f4 = <span class="string">&#x27;\x01&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  iVar1 = unnamed_function_1598</span><br><span class="line">                    (*(undefined4 *)(*(<span class="type">int</span> *)(param1 + <span class="number">0xc</span>) + <span class="number">0xc</span>),uRam00252bd4,uRam0024b8dc);</span><br><span class="line">  uVar2 = unnamed_function_670(param1,<span class="number">0</span>);</span><br><span class="line">  param1_00 = unnamed_function_702(uVar2,uRam0024b40c);</span><br><span class="line">  param2_00 = unnamed_function_4566(*(undefined4 *)(param1_00 + <span class="number">0x110</span>),<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> (*(<span class="type">int</span> *)(param2_00 + <span class="number">0xc</span>) == <span class="number">0x19</span>) &#123;     <span class="comment">//长度比较</span></span><br><span class="line">    *(<span class="type">short</span> *)(param2_00 + <span class="number">0x22</span>) = *(<span class="type">short</span> *)(param2_00 + <span class="number">0x22</span>) + <span class="number">0x21</span>;</span><br><span class="line">		<span class="comment">//这里对输入的某个字符进行了+0x21的操作</span></span><br><span class="line">  &#125;</span><br><span class="line">  uVar2 = unnamed_function_4565(<span class="number">0</span>,param2_00,<span class="number">0</span>);</span><br><span class="line">  puVar3 = (undefined4 *)<span class="number">0x24fac4</span>;</span><br><span class="line">  iVar1 = (**(code **)((longlong)*(<span class="type">int</span> *)(iVar1 + <span class="number">0xc</span>) * <span class="number">8</span>))</span><br><span class="line">                    (*(undefined4 *)(iVar1 + <span class="number">0x20</span>),uVar2,*(undefined4 *)(iVar1 + <span class="number">0x14</span>));</span><br><span class="line">  <span class="keyword">if</span> (iVar1 != <span class="number">1</span>) &#123;   <span class="comment">//1</span></span><br><span class="line">    puVar3 = (undefined4 *)<span class="number">0x251d78</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  unnamed_function_6086(param1_00,*puVar3,<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也就是说我们在验证长度后，又对某个字符进行+33的操作，那么直接爆破试试就行了！</p>
<p>d3ctf{W3b@5m_1s_Awe5oom3} </p>
<h3 id="d3wow"><a href="#d3wow" class="headerlink" title="d3wow"></a>d3wow</h3><p>这个题是一道迷宫题，给了两个函数，第一个函数是要求输入1，2，3，4但都不能超范围，通过动调发现这个函数还在验证前几个字符是否是d3ctf{2，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_401000</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [esp+0h] [ebp-10h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+8h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp+Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="number">6</span>;</span><br><span class="line">  <span class="keyword">if</span> ( *(_DWORD *)a1 != <span class="number">1952658276</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( *(_WORD *)(a1 + <span class="number">4</span>) != <span class="number">31590</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( *(_BYTE *)(a1 + <span class="number">6</span>) != <span class="number">50</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( *(_BYTE *)(v3 + a1) != <span class="number">125</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">switch</span> ( *(_BYTE *)(v3 + a1) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * v5 + <span class="number">4</span> * v4) |= <span class="number">8u</span>;</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * --v5 + <span class="number">4</span> * v4) |= <span class="number">2u</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * v5 + <span class="number">4</span> * v4) |= <span class="number">2u</span>;</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * ++v5 + <span class="number">4</span> * v4) |= <span class="number">8u</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * v5 + <span class="number">4</span> * v4) |= <span class="number">4u</span>;</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * v5 + <span class="number">4</span> * v4-- - <span class="number">4</span>) |= <span class="number">1u</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * v5 + <span class="number">4</span> * v4) |= <span class="number">1u</span>;</span><br><span class="line">        *(_DWORD *)(a2 + <span class="number">24</span> * v5 + <span class="number">4</span> * v4++ + <span class="number">4</span>) |= <span class="number">4u</span>;</span><br><span class="line">LABEL_14:</span><br><span class="line">        <span class="keyword">if</span> ( v5 &lt; <span class="number">0</span> || v4 &lt; <span class="number">0</span> || v5 &gt; <span class="number">5</span> || v4 &gt; <span class="number">5</span> )</span><br><span class="line">          <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        ++v3;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个函数很好理解，下一个函数明显是64位的，但被嵌在32位中了，我们通过dump进行提取：</p>
<p>在32位里打开找到函数地址</p>
<p><img src="/d3ctf/image-20220311162653245.png"></p>
<p><img src="/d3ctf/image-20220311162718329.png"></p>
<p>dump出来再用64 位打开，进行创建函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line">int64 <span class="title function_">sub_0</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *v0; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+0h] [rbp-A8h]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+0h] [rbp-A8h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+0h] [rbp-A8h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+4h] [rbp-A4h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+4h] [rbp-A4h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+4h] [rbp-A4h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+8h] [rbp-A0h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+Ch] [rbp-9Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+10h] [rbp-98h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+14h] [rbp-94h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+18h] [rbp-90h]</span></span><br><span class="line">  <span class="type">int</span> m; <span class="comment">// [rsp+1Ch] [rbp-8Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v14; <span class="comment">// [rsp+20h] [rbp-88h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v15; <span class="comment">// [rsp+24h] [rbp-84h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v16; <span class="comment">// [rsp+28h] [rbp-80h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v17; <span class="comment">// [rsp+2Ch] [rbp-7Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v18; <span class="comment">// [rsp+30h] [rbp-78h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v19; <span class="comment">// [rsp+34h] [rbp-74h]</span></span><br><span class="line">  <span class="type">int</span> v20[<span class="number">4</span>]; <span class="comment">// [rsp+38h] [rbp-70h]</span></span><br><span class="line">  <span class="type">int</span> v21[<span class="number">10</span>]; <span class="comment">// [rsp+48h] [rbp-60h]</span></span><br><span class="line">  __int64 v22; <span class="comment">// [rsp+70h] [rbp-38h]</span></span><br><span class="line">  __int64 v23; <span class="comment">// [rsp+78h] [rbp-30h]</span></span><br><span class="line">  __int64 v24; <span class="comment">// [rsp+80h] [rbp-28h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+88h] [rbp-20h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+90h] [rbp-18h]</span></span><br><span class="line">  __int64 v27; <span class="comment">// [rsp+98h] [rbp-10h]</span></span><br><span class="line">  _DWORD *retaddr; <span class="comment">// [rsp+B0h] [rbp+8h]</span></span><br><span class="line"></span><br><span class="line">  MEMORY[<span class="number">0x12F0</span>]((<span class="type">unsigned</span> <span class="type">int</span>)retaddr);</span><br><span class="line">  retaddr = v0;</span><br><span class="line">  v20[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v20[<span class="number">1</span>] = <span class="number">14</span>;</span><br><span class="line">  v20[<span class="number">2</span>] = <span class="number">20</span>;</span><br><span class="line">  v21[<span class="number">0</span>] = <span class="number">4</span>;</span><br><span class="line">  v21[<span class="number">1</span>] = <span class="number">13</span>;</span><br><span class="line">  v21[<span class="number">2</span>] = <span class="number">15</span>;</span><br><span class="line">  v21[<span class="number">3</span>] = <span class="number">21</span>;</span><br><span class="line">  v21[<span class="number">4</span>] = <span class="number">24</span>;</span><br><span class="line">  v21[<span class="number">5</span>] = <span class="number">31</span>;</span><br><span class="line">  v21[<span class="number">6</span>] = <span class="number">32</span>;</span><br><span class="line">  v21[<span class="number">7</span>] = <span class="number">41</span>;</span><br><span class="line">  v21[<span class="number">8</span>] = <span class="number">45</span>;</span><br><span class="line">  v21[<span class="number">9</span>] = <span class="number">53</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">6</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * i + j] &gt; <span class="number">0xF</span>u )</span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">      v14 = retaddr[<span class="number">6</span> * i + j] % <span class="number">0x10</span>u / <span class="number">8</span>;<span class="comment">//得到的结果是0，1</span></span><br><span class="line">      v22 = j;</span><br><span class="line">      v15 = retaddr[<span class="number">6</span> * i + j] % <span class="number">8u</span> / <span class="number">4</span> + v14;</span><br><span class="line">      v23 = j;</span><br><span class="line">      v16 = retaddr[<span class="number">6</span> * i + j] % <span class="number">4u</span> / <span class="number">2</span> + v15;<span class="comment">//这个加起来最大是4，代表4条路</span></span><br><span class="line">      v24 = j;</span><br><span class="line">      <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * i + j] % <span class="number">2u</span> + v16 &gt; <span class="number">2</span> || !j &amp;&amp; retaddr[<span class="number">6</span> * i] % <span class="number">8u</span> / <span class="number">4</span> )<span class="comment">//前面代表路径不能超过2</span></span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">      <span class="keyword">if</span> ( j == <span class="number">5</span> &amp;&amp; retaddr[<span class="number">6</span> * i + <span class="number">5</span>] % <span class="number">2u</span> || !i &amp;&amp; retaddr[j] % <span class="number">0x10</span>u / <span class="number">8</span> || i == <span class="number">5</span> &amp;&amp; retaddr[j + <span class="number">30</span>] % <span class="number">4u</span> / <span class="number">2</span> )<span class="comment">//能推出1，3是下或者2，3是右，直接猜出上下左右是3142</span></span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();<span class="comment">//上述是检测是否到达边界</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="comment">//特殊点1</span></span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; (<span class="type">unsigned</span> __int64)k &lt; <span class="number">3</span>; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = v20[k] / <span class="number">10</span>;<span class="comment">//分别是0，1，2，代表列</span></span><br><span class="line">    v5 = v20[k] % <span class="number">10</span>;<span class="comment">//分别是0，4，0，代表行</span></span><br><span class="line">    <span class="comment">//平行的方向不能同时出现，也就是方向必须垂直</span></span><br><span class="line">    <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">0x10</span>u / <span class="number">8</span> &amp;&amp; retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">4u</span> / <span class="number">2</span> )</span><br><span class="line">      <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">8u</span> / <span class="number">4</span> &amp;&amp; retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">2u</span> )</span><br><span class="line">      <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    v17 = retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">0x10</span>u / <span class="number">8</span>;</span><br><span class="line">    v25 = v5;</span><br><span class="line">    v18 = retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">4u</span> / <span class="number">2</span> + v17;</span><br><span class="line">    v26 = v5;</span><br><span class="line">    v19 = retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">2u</span> + v18;</span><br><span class="line">    v27 = v5;</span><br><span class="line">    <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">8u</span> / <span class="number">4</span> + v19 != <span class="number">2</span> )<span class="comment">//该点通道必须等于2</span></span><br><span class="line">      <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    <span class="comment">//下个点与该点方向相同</span></span><br><span class="line">    <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">0x10</span>u / <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v2 - <span class="number">6</span> + v5] % <span class="number">0x10</span>u / <span class="number">8</span>) )</span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">4u</span> / <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v2 + <span class="number">6</span> + v5] % <span class="number">4u</span> / <span class="number">2</span>) )</span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">8u</span> / <span class="number">4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v2 - <span class="number">1</span> + v5] % <span class="number">8u</span> / <span class="number">4</span>) )</span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( retaddr[<span class="number">6</span> * v2 + v5] % <span class="number">2u</span> &amp;&amp; !(retaddr[<span class="number">6</span> * v2 + <span class="number">1</span> + v5] % <span class="number">2u</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//特殊点2</span></span><br><span class="line">  <span class="keyword">for</span> ( m = <span class="number">0</span>; (<span class="type">unsigned</span> __int64)m &lt; <span class="number">0xA</span>; ++m )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = v21[m] / <span class="number">10</span>;<span class="comment">//0,1,1,2,2,3,3,4,4,5列</span></span><br><span class="line">    v6 = v21[m] % <span class="number">10</span>;<span class="comment">//4,3,5,1,4,1,2,1,5,3行</span></span><br><span class="line">    <span class="comment">//方向平行</span></span><br><span class="line">    <span class="keyword">if</span> ( (!(retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">0x10</span>u / <span class="number">8</span>) || !(retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">4u</span> / <span class="number">2</span>))</span><br><span class="line">      &amp;&amp; (!(retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">8u</span> / <span class="number">4</span>) || !(retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">2u</span>))</span><br><span class="line">      || retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">0x10</span>u / <span class="number">8</span><span class="comment">//必须有垂直该点的通道</span></span><br><span class="line">      &amp;&amp; retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">4u</span> / <span class="number">2</span></span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 - <span class="number">6</span> + v6] % <span class="number">8u</span> / <span class="number">4</span>)</span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 - <span class="number">6</span> + v6] % <span class="number">2u</span>)</span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 + <span class="number">6</span> + v6] % <span class="number">8u</span> / <span class="number">4</span>)</span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 + <span class="number">6</span> + v6] % <span class="number">2u</span>)</span><br><span class="line">      || retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">8u</span> / <span class="number">4</span></span><br><span class="line">      &amp;&amp; retaddr[<span class="number">6</span> * v3 + v6] % <span class="number">2u</span></span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 + <span class="number">1</span> + v6] % <span class="number">0x10</span>u / <span class="number">8</span>)</span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 + <span class="number">1</span> + v6] % <span class="number">4u</span> / <span class="number">2</span>)</span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 - <span class="number">1</span> + v6] % <span class="number">0x10</span>u / <span class="number">8</span>)</span><br><span class="line">      &amp;&amp; !(retaddr[<span class="number">6</span> * v3 - <span class="number">1</span> + v6] % <span class="number">4u</span> / <span class="number">2</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">//自动寻路</span></span><br><span class="line">  <span class="keyword">if</span> ( *retaddr % <span class="number">0x10</span>u / <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_67:</span><br><span class="line">      <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v4 + v7] % <span class="number">0x10</span>u / <span class="number">8</span>) || v4 - <span class="number">1</span> == v10 &amp;&amp; v7 == v11 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v4 + v7] % <span class="number">4u</span> / <span class="number">2</span>) || v4 + <span class="number">1</span> == v10 &amp;&amp; v7 == v11 )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v4 + v7] % <span class="number">8u</span> / <span class="number">4</span>) || v4 == v10 &amp;&amp; v7 - <span class="number">1</span> == v11 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( !(retaddr[<span class="number">6</span> * v4 + v7] % <span class="number">2u</span>) || v4 == v10 &amp;&amp; v7 + <span class="number">1</span> == v11 )</span><br><span class="line">              <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">            v10 = v4;</span><br><span class="line">            v11 = v7++;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            v10 = v4;</span><br><span class="line">            v11 = v7--;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          v10 = v4;</span><br><span class="line">          v11 = v7;</span><br><span class="line">          ++v4;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v10 = v4;</span><br><span class="line">        v11 = v7;</span><br><span class="line">        --v4;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( !v4 &amp;&amp; !v7 )</span><br><span class="line">        <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *retaddr % <span class="number">4u</span> / <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_67;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *retaddr % <span class="number">8u</span> / <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_67;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *retaddr % <span class="number">2u</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_67;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> MEMORY[<span class="number">0x1301</span>]();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到图：</p>
<p><img src="/d3ctf/image-20220311173934317.png"></p>
<p>实心图是特殊点1，空心是特殊点2，左上角出发！</p>
<p>d3ctf{22441442223133324424441111133333}</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a><strong>Misc</strong></h2><h3 id="BadW3ter"><a href="#BadW3ter" class="headerlink" title="BadW3ter"></a><strong>BadW3ter</strong></h3><p><img src="/d3ctf/image-20220314141125696.png" alt="image-20220314141125696"></p>
<p>改一下<img src="/d3ctf/image-20220314141139098.png" alt="image-20220314141139098"></p>
<p>猜想CUY1nw31lai为deepsound的密码，然后解出一个图片，但图片是tif文件，我们用ps打开，发现该图片是叠加的</p>
<p><img src="/d3ctf/image-20220314141343566.png" alt="image-20220314141343566"></p>
<p>我们使用油漆桶吧背景搞黑，二维码就变了</p>
<p><img src="/d3ctf/image-20220314141319681.png" alt="image-20220314141319681"></p>
<p>D3CTF{M1r@9e_T@nK_1s_Om0sh1roiii1111!!!!!Isn’t_1t?} </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/16/%E5%8F%8D%E8%B0%83%E8%AF%95%E7%A0%B4%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/16/%E5%8F%8D%E8%B0%83%E8%AF%95%E7%A0%B4%E8%A7%A3/" class="post-title-link" itemprop="url">反调试破解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-07-16 14:30:00" itemprop="dateCreated datePublished" datetime="2022-07-16T14:30:00+08:00">2022-07-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-17 16:44:51" itemprop="dateModified" datetime="2022-07-17T16:44:51+08:00">2022-07-17</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="反调试破解"><a href="#反调试破解" class="headerlink" title="反调试破解"></a>反调试破解</h1><p>最近很多题都碰到了很烦人的反调试，有些反调试并不好调试过去，所以有了学习的要求。</p>
<h2 id="静态反调试技巧"><a href="#静态反调试技巧" class="headerlink" title="静态反调试技巧"></a>静态反调试技巧</h2><p>要记住几个重要的点</p>
<h3 id="一、PEB"><a href="#一、PEB" class="headerlink" title="一、PEB"></a>一、PEB</h3><p>在反调试中会遇到PEB结构体中的几个点</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220716143446427.png" alt="image-20220716143446427"></p>
<h4 id="1、BeingDebugged"><a href="#1、BeingDebugged" class="headerlink" title="1、BeingDebugged"></a>1、BeingDebugged</h4><p>在PEB结构体地址offset为0x2处，如果在调试的状态这个值会变成1，否则是0。检测的时候我们最常见到的是IsDebuggerPresent（）api函数来判断是否处于调试阶段，其原理是先从TEB中找FS:[18],然后通过TEB.ProcessEnviromentBlock成员获取PEB地址然后找到偏移处就行。</p>
<h3 id="2、Ldr"><a href="#2、Ldr" class="headerlink" title="2、Ldr"></a>2、Ldr</h3><p>在偏移处0xc，PEB.Ldr是一个指向_PEB_LDR_DATA结构体的指针，其结构体是在堆内存创建的所以看该区域有无0xfeeefeee区域，有这个说明在调试状态，所以要将其改为NULL</p>
<h3 id="3、Process-Heap"><a href="#3、Process-Heap" class="headerlink" title="3、Process Heap"></a>3、Process Heap</h3><p>PEB.ProcessHeap指向HEAP结构体的指针，偏移为0x18</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220716150628240.png" alt="image-20220716150628240"></p>
<p>进程处于调试状态时Flags和ForceFlags会变成特定值，可以从GetProcessHeap（）这个api来获取PEB.ProcessHeap，这个api原理也是从TEB开始找到PEB.ProcessHeap。在非调试状态下，Flags的值为0x2，ForceFlags成员的值为0x0.</p>
<h3 id="4、NtGlobalFlag"><a href="#4、NtGlobalFlag" class="headerlink" title="4、NtGlobalFlag"></a>4、NtGlobalFlag</h3><p>偏移为0x68，这个值在调试的时候会变成0x70，改为0x00就行</p>
<h3 id="eg"><a href="#eg" class="headerlink" title="eg:"></a>eg:</h3><p>遇到第一种情况直接F7进入查看下面hex dump中的eax值，改为0就行</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220716161942009.png" alt="image-20220716161942009"></p>
<p>对于Ldr，call eax是为了调用ntdll.NtCurrentTeb()api,PEB地址是会存到EBX寄存器的，然后进行EEFEEEFE的初始化，再将Ldr的地址存到ESI寄存器</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220716162337412.png" alt="image-20220716162337412"></p>
<h2 id="二、NtQueryInformationProcess（）"><a href="#二、NtQueryInformationProcess（）" class="headerlink" title="二、NtQueryInformationProcess（）"></a>二、NtQueryInformationProcess（）</h2><p>这是一个api，用来探测调试器的技术</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220717104125352.png" alt="image-20220717104125352"></p>
<p>主要看第二个参数PROCESSINFOCLASS ProcessInformationClass指定特定值并调用该函数，相关信息被设置到PVOID ProcessInformation,其中PROCESSINFOCLASS是枚举类型</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220717104305767.png" alt="image-20220717104305767"></p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220717104312400.png" alt="image-20220717104312400"></p>
<h3 id="1、ProcessDebugPort"><a href="#1、ProcessDebugPort" class="headerlink" title="1、ProcessDebugPort"></a>1、ProcessDebugPort</h3><p>当进程处于调试状态，系统分配一个调试端口，ProcessDebugPort参数为7时，调用NtQueryInformationProcess（）函数就能获取调试端口，若进程不在调试状态，其变量dwDebugPort值为0，若处于调试状态，其值为0xfffffff</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220717110648860.png" alt="image-20220717110648860"></p>
<p>CheckRemoteDebuggerPresent（）这个api和IsDebuggerPresent（）api是差不多的，用来检测进程是否处于调试阶段，该api不仅可以检测当前进程还能检测其他进程是否处于调试状态</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220717111402914.png" alt="image-20220717111402914"></p>
<h3 id="3、ProcessDebugFlags-0x1F"><a href="#3、ProcessDebugFlags-0x1F" class="headerlink" title="3、ProcessDebugFlags(0x1F)"></a>3、ProcessDebugFlags(0x1F)</h3><p>检测DebugFlags的值来判断是否处于调试状态，函数第二个参数设置为ProcessDebugFlags时，第三个值调取调试标志的值，若为0，则进程处于调试阶段，若为1，在非调试阶段</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220717111627367.png" alt="image-20220717111627367"></p>
<h2 id="三、NtQuerySystemInoformation（）"><a href="#三、NtQuerySystemInoformation（）" class="headerlink" title="三、NtQuerySystemInoformation（）"></a>三、NtQuerySystemInoformation（）</h2><p>这是基于调试环境检测的反调试技术</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220717163714735.png" alt="image-20220717163714735"></p>
<h2 id="四、NtQueryObject-）"><a href="#四、NtQueryObject-）" class="headerlink" title="四、NtQueryObject(）"></a>四、NtQueryObject(）</h2><p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220717164203400.png" alt="image-20220717164203400"></p>
<h2 id="五、ZwSetInformationThread"><a href="#五、ZwSetInformationThread" class="headerlink" title="五、ZwSetInformationThread()"></a>五、ZwSetInformationThread()</h2><p>找到栈前第二个参数值，改为0就行</p>
<h2 id="六、ETC"><a href="#六、ETC" class="headerlink" title="六、ETC"></a>六、ETC</h2><p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220717164336018.png" alt="image-20220717164336018"></p>
<p>我们只要找到字符串魔改就行，把findwindows（）api的第一个参数全改为null</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/12/%E8%93%9D%E5%B8%BD%E6%9D%AFwp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/12/%E8%93%9D%E5%B8%BD%E6%9D%AFwp/" class="post-title-link" itemprop="url">蓝帽杯wp</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-07-12 22:29:35 / 修改时间：22:55:06" itemprop="dateCreated datePublished" datetime="2022-07-12T22:29:35+08:00">2022-07-12</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="蓝帽杯"><a href="#蓝帽杯" class="headerlink" title="蓝帽杯"></a>蓝帽杯</h1><p>这蓝帽杯太卷了，差点被干到复赛都进不了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_7FF6308E5890</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v0; <span class="comment">// rax</span></span><br><span class="line">  _QWORD *input; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rdx</span></span><br><span class="line">  _QWORD *v3; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v5; <span class="comment">// rbx</span></span><br><span class="line">  _QWORD *v6; <span class="comment">// rax</span></span><br><span class="line">  _QWORD *v7; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v8; <span class="comment">// rdx</span></span><br><span class="line">  _QWORD *v9; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 *v11; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v12; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v13; <span class="comment">// rcx</span></span><br><span class="line">  _QWORD *v14; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v15; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v16; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v17; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 *v18; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v19; <span class="comment">// rdx</span></span><br><span class="line">  _QWORD *v20; <span class="comment">// rax</span></span><br><span class="line">  __int64 v21; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v22; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v23; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v24; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v25; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v26; <span class="comment">// rcx</span></span><br><span class="line">  __m128i v27; <span class="comment">// xmm4</span></span><br><span class="line">  __int64 v28; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v29; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v30; <span class="comment">// rcx</span></span><br><span class="line">  __m128i v31; <span class="comment">// [rsp+20h] [rbp-78h] BYREF</span></span><br><span class="line">  __m128i v32; <span class="comment">// [rsp+30h] [rbp-68h] BYREF</span></span><br><span class="line">  __int64 v33; <span class="comment">// [rsp+40h] [rbp-58h] BYREF</span></span><br><span class="line">  __int64 v34; <span class="comment">// [rsp+48h] [rbp-50h]</span></span><br><span class="line">  __m128i v35; <span class="comment">// [rsp+50h] [rbp-48h] BYREF</span></span><br><span class="line">  __int64 v36; <span class="comment">// [rsp+60h] [rbp-38h] BYREF</span></span><br><span class="line">  __int64 v37; <span class="comment">// [rsp+68h] [rbp-30h]</span></span><br><span class="line"></span><br><span class="line">  sub_7FF6308E0500(&amp;unk_7FF6308E57E0);</span><br><span class="line">  sub_7FF6308E0500(&amp;unk_7FF6308E57D0);</span><br><span class="line">  sub_7FF6308E0500(&amp;unk_7FF6308E57C0);</span><br><span class="line">  sub_7FF6308E0500(&amp;unk_7FF6308E57B0);</span><br><span class="line">  sub_7FF6308E0500(&amp;unk_7FF6308E57A0);</span><br><span class="line">  sub_7FF6308E0500(&amp;unk_7FF6308E5790);</span><br><span class="line">  sub_7FF6308E0500(&amp;unk_7FF6308E5780);</span><br><span class="line">  sub_7FF6308E0500(&amp;unk_7FF6308E5770);</span><br><span class="line">  sub_7FF6308E0500(&amp;unk_7FF6308E5760);</span><br><span class="line">  <span class="built_in">printf</span>(Format, <span class="number">1</span>i64);</span><br><span class="line">  v0 = (<span class="type">const</span> <span class="type">char</span> *)off_7FF6308E8100(<span class="number">0</span>i64);</span><br><span class="line">  LODWORD(input) = <span class="built_in">scanf</span>(v0);</span><br><span class="line">  v3 = input;</span><br><span class="line">  <span class="keyword">if</span> ( input )</span><br><span class="line">    *(input - <span class="number">2</span>) += <span class="number">8</span>i64;</span><br><span class="line">  <span class="keyword">if</span> ( qword_7FF6308FF200 )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = *(_QWORD *)(qword_7FF6308FF200 - <span class="number">16</span>);</span><br><span class="line">    v2 = qword_7FF6308FF200 - <span class="number">16</span>;</span><br><span class="line">    *(_QWORD *)(qword_7FF6308FF200 - <span class="number">16</span>) = v4 - <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(v4 - <span class="number">8</span>) &lt;= <span class="number">7</span> )</span><br><span class="line">      sub_7FF6308D9580(off_7FF6308EA350 + <span class="number">3</span>, v2);</span><br><span class="line">  &#125;</span><br><span class="line">  qword_7FF6308FF200 = (__int64)v3;</span><br><span class="line">  v5 = <span class="number">0</span>i64;</span><br><span class="line">  v6 = (_QWORD *)sub_7FF6308DC000(<span class="number">5</span>i64, v2);</span><br><span class="line">  v7 = v6;</span><br><span class="line">  <span class="keyword">if</span> ( !v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v3 )</span><br><span class="line">      sub_7FF6308DF460(<span class="number">0</span>i64, <span class="number">-1</span>i64);</span><br><span class="line">    sub_7FF6308DF460(<span class="number">0</span>i64, <span class="number">-1</span>i64);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !*v6 )</span><br><span class="line">      sub_7FF6308DF460(<span class="number">0</span>i64, <span class="number">-1</span>i64);</span><br><span class="line">    sub_7FF6308DF460(<span class="number">0</span>i64, <span class="number">-1</span>i64);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *v6 &lt;= (<span class="type">unsigned</span> __int64)v5 )</span><br><span class="line">      sub_7FF6308DF460(v5, *v6 - <span class="number">1</span>i64);</span><br><span class="line">    v8 = *v3;</span><br><span class="line">    <span class="keyword">if</span> ( *v3 &lt;= (<span class="type">unsigned</span> __int64)v5 )</span><br><span class="line">      sub_7FF6308DF460(v5, v8 - <span class="number">1</span>);</span><br><span class="line">    *((_BYTE *)v6 + v5 + <span class="number">16</span>) = *((_BYTE *)v3 + v5 + <span class="number">16</span>);</span><br><span class="line">    ++v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v5 &lt;= <span class="number">4</span> );</span><br><span class="line">  <span class="keyword">if</span> ( *v6 != <span class="number">5</span>i64 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_15;</span><br><span class="line">  v9 = v6 + <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span> ( *((_DWORD *)v7 + <span class="number">4</span>) != dword_7FF6308E9E00 )<span class="comment">// 判断前五个是不是flag&#123;</span></span><br><span class="line">    <span class="keyword">goto</span> LABEL_15;</span><br><span class="line">  <span class="keyword">if</span> ( *((_BYTE *)v9 + <span class="number">4</span>) != byte_7FF6308E9E04 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_15;</span><br><span class="line">  v11 = (<span class="type">unsigned</span> __int64 *)qword_7FF6308FF200;</span><br><span class="line">  <span class="keyword">if</span> ( !qword_7FF6308FF200 || *(_QWORD *)qword_7FF6308FF200 != <span class="string">&#x27;*&#x27;</span> || *(_BYTE *)(qword_7FF6308FF200 + <span class="number">57</span>) != <span class="string">&#x27;&#125;&#x27;</span> )<span class="comment">// 判断位数是否是42，并且最后一位是否是&#125;</span></span><br><span class="line">    <span class="keyword">goto</span> LABEL_15;</span><br><span class="line">  v12 = <span class="number">0</span>i64;</span><br><span class="line">  v14 = (_QWORD *)sub_7FF6308DC000(<span class="number">18</span>i64, v8);</span><br><span class="line">  <span class="keyword">if</span> ( !v14 )</span><br><span class="line">    sub_7FF6308DF460(<span class="number">0</span>i64, <span class="number">-1</span>i64);</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v15 = *v14;</span><br><span class="line">    <span class="keyword">if</span> ( *v14 &lt;= (<span class="type">unsigned</span> __int64)v12 )</span><br><span class="line">      sub_7FF6308DF460(v12, v15 - <span class="number">1</span>);</span><br><span class="line">    v16 = v12 + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v12 + <span class="number">5</span> &lt; <span class="number">0</span> || v16 &lt; v12 )</span><br><span class="line">      sub_7FF6308DAFB0(v13, v15);</span><br><span class="line">    <span class="keyword">if</span> ( *v11 &lt;= v16 )</span><br><span class="line">      sub_7FF6308DF460(v12 + <span class="number">5</span>, *v11 - <span class="number">1</span>);</span><br><span class="line">    *((_BYTE *)v14 + v12++ + <span class="number">16</span>) = *((_BYTE *)v11 + v16 + <span class="number">16</span>);<span class="comment">// 提取前18位</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v12 &lt;= <span class="number">17</span> );</span><br><span class="line">  v17 = <span class="number">0</span>i64;</span><br><span class="line">  sub_7FF6308E4380((__int64)v14, <span class="number">10</span>i64, &amp;xmmword_7FF6308FF1B0);<span class="comment">// 能看到取了前18位并且检验是否有-</span></span><br><span class="line">  v18 = (<span class="type">unsigned</span> __int64 *)qword_7FF6308FF200;</span><br><span class="line">  v20 = (_QWORD *)sub_7FF6308DC000(<span class="number">18</span>i64, v19);</span><br><span class="line">  <span class="keyword">if</span> ( !v20 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v18 )</span><br><span class="line">      sub_7FF6308DF460(<span class="number">0</span>i64, <span class="number">-1</span>i64);</span><br><span class="line">    sub_7FF6308DF460(<span class="number">0</span>i64, <span class="number">-1</span>i64);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !v18 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !*v20 )</span><br><span class="line">      sub_7FF6308DF460(<span class="number">0</span>i64, <span class="number">-1</span>i64);</span><br><span class="line">    sub_7FF6308DF460(<span class="number">23</span>i64, <span class="number">-1</span>i64);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v22 = *v20;</span><br><span class="line">    <span class="keyword">if</span> ( *v20 &lt;= (<span class="type">unsigned</span> __int64)v17 )</span><br><span class="line">      sub_7FF6308DF460(v17, v22 - <span class="number">1</span>);</span><br><span class="line">    v23 = v17 + <span class="number">23</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v17 + <span class="number">23</span> &lt; <span class="number">0</span> || v23 &lt; v17 )</span><br><span class="line">      sub_7FF6308DAFB0(v21, v22);</span><br><span class="line">    <span class="keyword">if</span> ( *v18 &lt;= v23 )</span><br><span class="line">      sub_7FF6308DF460(v17 + <span class="number">23</span>, *v18 - <span class="number">1</span>);</span><br><span class="line">    *((_BYTE *)v20 + v17++ + <span class="number">16</span>) = *((_BYTE *)v18 + v23 + <span class="number">16</span>);<span class="comment">// 后18位</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v17 &lt;= <span class="number">17</span> );</span><br><span class="line">  sub_7FF6308E4380((__int64)v20, <span class="number">10</span>i64, &amp;xmmword_7FF6308FF170);</span><br><span class="line">  sub_7FF6308E4380((__int64)&amp;unk_7FF6308E9DC0, <span class="number">10</span>i64, &amp;xmmword_7FF6308FF190);</span><br><span class="line">  sub_7FF6308E4380((__int64)&amp;unk_7FF6308E9D80, <span class="number">10</span>i64, &amp;xmmword_7FF6308FF1A0);</span><br><span class="line">  v32 = _mm_loadu_si128((<span class="type">const</span> __m128i *)&amp;xmmword_7FF6308FF190);</span><br><span class="line">  v31 = _mm_loadu_si128((<span class="type">const</span> __m128i *)&amp;xmmword_7FF6308FF1B0);</span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="type">unsigned</span> __int8)sub_7FF6308E50C0(&amp;v32, &amp;v31) )<span class="comment">//判断范围</span></span><br><span class="line">    <span class="keyword">goto</span> LABEL_15;</span><br><span class="line">  v32 = _mm_loadu_si128((<span class="type">const</span> __m128i *)&amp;xmmword_7FF6308FF1B0);</span><br><span class="line">  v31 = _mm_loadu_si128((<span class="type">const</span> __m128i *)&amp;xmmword_7FF6308FF1A0);</span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="type">unsigned</span> __int8)sub_7FF6308E50C0(&amp;v32, &amp;v31) )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_15;</span><br><span class="line">  v33 = <span class="number">0</span>i64;</span><br><span class="line">  v34 = <span class="number">0</span>i64;</span><br><span class="line">  v32 = (__m128i)xmmword_7FF6308FF1B0;</span><br><span class="line">  v31 = (__m128i)xmmword_7FF6308FF1B0;</span><br><span class="line">  math(&amp;v32, &amp;v31, (__int64)&amp;v33);              <span class="comment">// 前两个参数存着前18位</span></span><br><span class="line">  v24 = v33;</span><br><span class="line">  <span class="keyword">if</span> ( v33 )</span><br><span class="line">    *(_QWORD *)(v33 - <span class="number">16</span>) += <span class="number">8</span>i64;</span><br><span class="line">  <span class="keyword">if</span> ( (_QWORD)xmmword_7FF6308FF1D0 )</span><br><span class="line">  &#123;</span><br><span class="line">    v25 = xmmword_7FF6308FF1D0 - <span class="number">16</span>;</span><br><span class="line">    v26 = *(_QWORD *)(xmmword_7FF6308FF1D0 - <span class="number">16</span>) - <span class="number">8</span>i64;</span><br><span class="line">    *(_QWORD *)(xmmword_7FF6308FF1D0 - <span class="number">16</span>) = v26;</span><br><span class="line">    <span class="keyword">if</span> ( v26 &lt;= <span class="number">7</span> )</span><br><span class="line">      sub_7FF6308D9580(off_7FF6308EA350 + <span class="number">3</span>, v25);</span><br><span class="line">  &#125;</span><br><span class="line">  *(_QWORD *)&amp;xmmword_7FF6308FF1D0 = v24;</span><br><span class="line">  v35 = <span class="number">0u</span>i64;</span><br><span class="line">  BYTE8(xmmword_7FF6308FF1D0) = v34;</span><br><span class="line">  v32 = (__m128i)xmmword_7FF6308FF170;</span><br><span class="line">  v31 = (__m128i)xmmword_7FF6308FF170;</span><br><span class="line">  math(&amp;v32, &amp;v31, (__int64)&amp;v35);              <span class="comment">// 相乘得到</span></span><br><span class="line">  v27 = _mm_load_si128(&amp;v35);</span><br><span class="line">  v36 = <span class="number">0</span>i64;</span><br><span class="line">  v37 = <span class="number">0</span>i64;</span><br><span class="line">  v32 = v27;</span><br><span class="line">  multiply(&amp;v32, <span class="number">11</span>i64, &amp;v36);                  <span class="comment">// 也就是后18位相乘之后在乘11</span></span><br><span class="line">  v28 = v36;</span><br><span class="line">  <span class="keyword">if</span> ( v36 )</span><br><span class="line">    *(_QWORD *)(v36 - <span class="number">16</span>) += <span class="number">8</span>i64;</span><br><span class="line">  <span class="keyword">if</span> ( (_QWORD)xmmword_7FF6308FF160 )</span><br><span class="line">  &#123;</span><br><span class="line">    v29 = xmmword_7FF6308FF160 - <span class="number">16</span>;</span><br><span class="line">    v30 = *(_QWORD *)(xmmword_7FF6308FF160 - <span class="number">16</span>) - <span class="number">8</span>i64;</span><br><span class="line">    *(_QWORD *)(xmmword_7FF6308FF160 - <span class="number">16</span>) = v30;</span><br><span class="line">    <span class="keyword">if</span> ( v30 &lt;= <span class="number">7</span> )</span><br><span class="line">      sub_7FF6308D9580(off_7FF6308EA350 + <span class="number">3</span>, v29);</span><br><span class="line">  &#125;</span><br><span class="line">  *(_QWORD *)&amp;xmmword_7FF6308FF160 = v28;</span><br><span class="line">  v32 = _mm_loadu_si128((<span class="type">const</span> __m128i *)&amp;xmmword_7FF6308FF1D0);</span><br><span class="line">  BYTE8(xmmword_7FF6308FF160) = v37;</span><br><span class="line">  v31 = _mm_loadu_si128((<span class="type">const</span> __m128i *)&amp;xmmword_7FF6308FF160);</span><br><span class="line">  jian(v32.m128i_i64, v31.m128i_i64, (__int64)&amp;xmmword_7FF6308FF1E0);<span class="comment">// 进行减法</span></span><br><span class="line">  sub_7FF6308E4380((__int64)&amp;unk_7FF6308E9D50, <span class="number">10</span>i64, &amp;xmmword_7FF6308FF1C0);</span><br><span class="line">  v32 = _mm_loadu_si128((<span class="type">const</span> __m128i *)&amp;xmmword_7FF6308FF1E0);</span><br><span class="line">  v31 = _mm_loadu_si128((<span class="type">const</span> __m128i *)&amp;xmmword_7FF6308FF1C0);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)cmp(&amp;v32, &amp;v31) )       <span class="comment">// 对比数据</span></span><br><span class="line">  &#123;</span><br><span class="line">    qword_7FF6308ED6A0 = <span class="number">1</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_15:</span><br><span class="line">    <span class="keyword">if</span> ( qword_7FF6308ED6A0 != <span class="number">1</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">printf</span>(&amp;byte_7FF6308E9D00, <span class="number">1</span>i64);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(a0, <span class="number">1</span>i64);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这题dump出来是不对的，直接调试程序找到主要逻辑，但这个逻辑很难看懂啊。最后发现是个简单的运算，算的就是x^2 - 11 *y^2 &#x3D; 9,当x的范围在</p>
<p>100000000000000000&lt;x&lt;999999999999999999时的情况，解一下方程得到flag，注意要加一个-才对</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/07/05/re2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/05/re2/" class="post-title-link" itemprop="url">re2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-07-05 23:14:01" itemprop="dateCreated datePublished" datetime="2022-07-05T23:14:01+08:00">2022-07-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-19 18:49:49" itemprop="dateModified" datetime="2022-07-19T18:49:49+08:00">2022-07-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h1><h2 id="国赛分赛区re"><a href="#国赛分赛区re" class="headerlink" title="国赛分赛区re"></a>国赛分赛区re</h2><h3 id="puzzle"><a href="#puzzle" class="headerlink" title="puzzle"></a>puzzle</h3><p>是个upx壳，自动脱壳没脱掉，原来是upx的特征被改了，下面UPX全部被改成了vmp，全部恢复成UPX再脱壳就行，但不能调试，应该是文件到内存的偏移存在问题。</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220705231608958.png" alt="image-20220705231608958"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"> *(_QWORD *)v20 = fmt_Fprintf((__int64)&amp;off_505F00, qword_588528, <span class="string">&quot;Input: &quot;</span>, <span class="number">7LL</span>, v2, <span class="number">0LL</span>, <span class="number">0LL</span>, v16, v17, v18);</span><br><span class="line">  v38[<span class="number">0</span>] = <span class="string">&quot;\b&quot;</span>;</span><br><span class="line">  v38[<span class="number">1</span>] = v35;</span><br><span class="line">  v11 = &amp;off_505EE0;</span><br><span class="line">  v12 = (__int64 *)qword_588520;</span><br><span class="line">  *(_QWORD *)v13 = <span class="string">&quot;%s&quot;</span>;</span><br><span class="line">  *(_QWORD *)&amp;v13[<span class="number">8</span>] = <span class="number">2LL</span>;</span><br><span class="line">  *(_QWORD *)&amp;v13[<span class="number">16</span>] = v38;</span><br><span class="line">  v14 = <span class="number">1LL</span>;</span><br><span class="line">  v15 = <span class="number">1LL</span>;</span><br><span class="line">  fmt_Fscanf((__int64)v1, v0, (<span class="type">const</span> <span class="type">char</span> *)&amp;off_505EE0);</span><br><span class="line">  <span class="keyword">if</span> ( !v17 )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = v35;</span><br><span class="line">    v4 = <span class="number">0LL</span>;</span><br><span class="line">    v5 = <span class="number">0LL</span>;</span><br><span class="line">    <span class="keyword">while</span> ( v4 &lt; <span class="number">9</span> )<span class="comment">//主要加密</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; <span class="number">9</span>; ++i )</span><br><span class="line">      &#123;</span><br><span class="line">        v1 = (__int64 *)v40[<span class="number">3</span> * v4 - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> ( v40[<span class="number">3</span> * v4] &lt;= (<span class="type">unsigned</span> __int64)i )</span><br><span class="line">          sub_466740((__int64)v11, (__int64)v12);</span><br><span class="line">        v0 = *((<span class="type">unsigned</span> __int8 *)v1 + i);</span><br><span class="line">        <span class="keyword">if</span> ( !(_BYTE)v0 )</span><br><span class="line">        &#123;</span><br><span class="line">          v7 = v3[<span class="number">1</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v7 &lt;= v5 )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">          <span class="keyword">if</span> ( v7 &lt;= (<span class="type">unsigned</span> __int64)v5 )</span><br><span class="line">            sub_466740((__int64)v11, (__int64)v12);</span><br><span class="line">          v8 = *(<span class="type">unsigned</span> __int8 *)(v5 + *v3);</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)v8 &lt; <span class="string">&#x27;0&#x27;</span> || (<span class="type">unsigned</span> __int8)v8 &gt; <span class="string">&#x27;9&#x27;</span> )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">          v0 = (<span class="type">unsigned</span> <span class="type">int</span>)(v8 - <span class="number">48</span>);</span><br><span class="line">          *((_BYTE *)v1 + i) = v0;</span><br><span class="line">          ++v5;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      ++v4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v3[<span class="number">1</span>] == v5 &amp;&amp; (v15 = sub_4B8720((__int64)&amp;v39, <span class="number">9LL</span>, <span class="number">9</span>, v13[<span class="number">8</span>]), v13[<span class="number">8</span>]) )</span><br><span class="line">    &#123;</span><br><span class="line">      v17 = runtime_stringtoslicebyte((__int64)v34, *v35, v35[<span class="number">1</span>], *(__int64 *)&amp;v13[<span class="number">8</span>], *(__int64 *)&amp;v13[<span class="number">16</span>], v14);</span><br><span class="line">      v16 = sub_4938A0(*(__int64 *)&amp;v13[<span class="number">8</span>], *(__int64 *)&amp;v13[<span class="number">16</span>], v14, *(__int128 *)&amp;v13[<span class="number">8</span>]);</span><br><span class="line">      v32 = *(_OWORD *)&amp;v13[<span class="number">8</span>];</span><br><span class="line">      v33 = *(_OWORD *)&amp;v13[<span class="number">8</span>];</span><br><span class="line">      runtime_convT2Enoptr((__int64)&amp;unk_4C6160, (__int64)&amp;v33, *(__int64 *)v13, *(__int64 *)&amp;v13[<span class="number">8</span>]);</span><br><span class="line">      v37 = *(_OWORD *)v13;</span><br><span class="line">      v11 = &amp;off_505F00;</span><br><span class="line">      v12 = (__int64 *)qword_588528;</span><br><span class="line">      *(_QWORD *)v13 = <span class="string">&quot;Your flag is flag&#123;%x&#125;async stack too l&quot;</span>;</span><br><span class="line">      *(_QWORD *)&amp;v13[<span class="number">8</span>] = <span class="number">21LL</span>;</span><br><span class="line">      *(_QWORD *)&amp;v13[<span class="number">16</span>] = &amp;v37;</span><br><span class="line">      v14 = <span class="number">1LL</span>;</span><br><span class="line">      v15 = <span class="number">1LL</span>;</span><br><span class="line">      fmt_Fprintf((__int64)v1, v0, v9);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">LABEL_13:</span><br><span class="line">      v36[<span class="number">0</span>] = &amp;unk_4C5940;</span><br><span class="line">      v36[<span class="number">1</span>] = &amp;off_504828;                     <span class="comment">// Wrong！</span></span><br><span class="line">      *(_QWORD *)&amp;v19 = fmt_Fprintln((__int64)&amp;off_505F00, qword_588528, (__int64)v36, <span class="number">1LL</span>, <span class="number">1LL</span>, v14, v15, v16);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这是个go程序，直接找到main_main发现符号表并没有损坏，直接看，发现应该是个数独，毕竟这一周做了两道数独了。。。</p>
<h3 id="havetea"><a href="#havetea" class="headerlink" title="havetea"></a>havetea</h3><p>动调可以发现就是一个tea加密和xtea加密</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220706163158211.png" alt="image-20220706163158211"></p>
<p>发现输入16字节，8字节传入，进行两次tea加密</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//加密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0 = k[<span class="number">0</span>], k1 = k[<span class="number">1</span>], k2 = k[<span class="number">2</span>], k3 = k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3);</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//解密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0x9E3779B9</span> * <span class="number">32</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x9E3779B9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0 = k[<span class="number">0</span>], k1 = k[<span class="number">1</span>], k2 = k[<span class="number">2</span>], k3 = k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[] = &#123; <span class="number">0xE66F0E9E</span>, <span class="number">0x42A17CD6</span> &#125;, k[<span class="number">4</span>] = &#123; <span class="number">0x9e</span>,<span class="number">0x37</span>,<span class="number">0x79</span>,<span class="number">0xb9</span> &#125;, v1[] = &#123;  <span class="number">0x5BDDE878</span>, <span class="number">0xD236F4AD</span> &#125;;</span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    decrypt(v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]); </span><br><span class="line">    decrypt(v1, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>, v1[<span class="number">0</span>], v1[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">倒序就是密码：please_drink_tea</span><br></pre></td></tr></table></figure>

<p>然后就是一个xtea加密</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">encipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>, delta = <span class="number">0x9E3779B9</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v0 += (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">        sum += delta;</span><br><span class="line">        v1 += (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> num_rounds, <span class="type">uint32_t</span> v[<span class="number">2</span>], <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], delta = <span class="number">0x9E3779B9</span>, sum = delta * num_rounds;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[] = &#123; <span class="number">0x7D758E0A</span>, <span class="number">0xEDAFF6AD</span> &#125;, v1[] = &#123; <span class="number">0x9DDE7E86</span>, <span class="number">0xE3D36CD5</span> &#125;, v2[] = &#123; <span class="number">0xABD3C82E</span>, <span class="number">0x6B7B2CFE</span> &#125;, v3[] = &#123; <span class="number">0x2C6608C2</span>, <span class="number">0x0686A1DA</span> &#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>] = &#123; <span class="number">0x61656C70</span>, <span class="number">0x645F6573</span>, <span class="number">0x6B6E6972</span>, <span class="number">0x6165745F</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> r = <span class="number">32</span>;<span class="comment">//num_rounds建议取值为32</span></span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    decipher(r, v, k);</span><br><span class="line">    decipher(r, v1, k);</span><br><span class="line">    decipher(r, v2, k);</span><br><span class="line">    decipher(r, v3, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>, v1[<span class="number">0</span>], v1[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>, v2[<span class="number">0</span>], v2[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>, v3[<span class="number">0</span>], v3[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>倒序转换成字符就行了</p>
<p>_rdtsc</p>
<h3 id="creak3"><a href="#creak3" class="headerlink" title="creak3"></a>creak3</h3><p>用jadx打开发现很简单加密，就是把flag{xxxxxxxxx}中间的密文传进check函数，直接去so文件找jni发现关键check函数</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220707202353900.png" alt="image-20220707202353900"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_4700</span><span class="params">(__int64 *a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rbx</span></span><br><span class="line">  _DWORD *v4; <span class="comment">// r14</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v6; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+4h] [rbp-34h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+8h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+Ch] [rbp-2Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+10h] [rbp-28h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+14h] [rbp-24h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v13; <span class="comment">// [rsp+18h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  v13 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v3 = (*(__int64 (__fastcall **)(__int64 *, __int64, _QWORD))(*a1 + <span class="number">1352</span>))(a1, a3, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)sub_3D70(v3) == <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">16</span>;</span><br><span class="line">    v4 = <span class="built_in">malloc</span>(<span class="number">0x80</span>uLL);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)sub_4330(v3, v4, &amp;v10) )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = *a1;</span><br><span class="line">      v6 = <span class="string">&quot;Bad format&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v9 = *v4 ^ <span class="number">0x39DEB332</span>;</span><br><span class="line">      v11 = v4[<span class="number">1</span>] ^ v9;</span><br><span class="line">      v12 = v4[<span class="number">2</span>] ^ v11;</span><br><span class="line">      v8 = v4[<span class="number">3</span>] ^ v12;</span><br><span class="line">      <span class="keyword">if</span> ( sub_43F0((__int64)&amp;v9) &amp;&amp; (<span class="type">unsigned</span> __int8)sub_44E0(&amp;v11) &amp;&amp; (<span class="type">unsigned</span> __int8)sub_4630(&amp;v8) )</span><br><span class="line">      &#123;</span><br><span class="line">        v5 = *a1;</span><br><span class="line">        v6 = <span class="string">&quot;right flag!!!&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v5 = *a1;</span><br><span class="line">        v6 = <span class="string">&quot;sorry,wrong flag.&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5 = *a1;</span><br><span class="line">    v6 = <span class="string">&quot;length of input is not enough!!!&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (*(__int64 (__fastcall **)(__int64 *, <span class="type">const</span> <span class="type">char</span> *))(v5 + <span class="number">1336</span>))(a1, v6);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>程序的意思就是要输入一个32位的flag，然后每两个一组变成16进制，变成16位，4个4个一组，先进行异或，然后进入三个函数验证</p>
<p>第一个函数是sha1加密，4字节还知道一个字节</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> i1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xff</span>):</span><br><span class="line">    <span class="keyword">for</span> i2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xff</span>):</span><br><span class="line">        <span class="keyword">for</span> i4 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xff</span>):</span><br><span class="line">            arr = [i1, i2, <span class="number">0xe9</span>,i4]</span><br><span class="line">            <span class="keyword">if</span>(hashlib.sha1(<span class="built_in">bytes</span>(arr)).hexdigest().lower() == <span class="string">&quot;2e60865e94119223c4657eac98d744ee909e66b8&quot;</span>):  </span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">hex</span>(i1),<span class="built_in">hex</span>(i2),<span class="number">0xe9</span>,<span class="built_in">hex</span>(i4))</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>第二个函数刚开始没看出来，后面发现是sm4加密</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220707105839618.png" alt="image-20220707105839618"></p>
<p>不难发现是sm4的cbc模式，那么需要找到key和iv，发现是0-0xf，直接写脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SM4_ENCRYPT     1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SM4_DECRYPT     0</span></span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* \brief          SM4 context structure</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="type">int</span> mode;                   <span class="comment">/*!&lt;  encrypt/decrypt   */</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> sk[<span class="number">32</span>];       <span class="comment">/*!&lt;  SM4 subkeys       */</span></span><br><span class="line">&#125;</span><br><span class="line">sm4_context;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* \brief          SM4 key schedule (128-bit, encryption)</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* \param ctx      SM4 context to be initialized</span></span><br><span class="line"><span class="comment">* \param key      16-byte secret key</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">sm4_setkey_enc</span><span class="params">(sm4_context *ctx, <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>])</span>;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* \brief          SM4 key schedule (128-bit, decryption)</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* \param ctx      SM4 context to be initialized</span></span><br><span class="line"><span class="comment">* \param key      16-byte secret key</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">sm4_setkey_dec</span><span class="params">(sm4_context *ctx, <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>])</span>;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* \brief          SM4-ECB block encryption/decryption</span></span><br><span class="line"><span class="comment">* \param ctx      SM4 context</span></span><br><span class="line"><span class="comment">* \param mode     SM4_ENCRYPT or SM4_DECRYPT</span></span><br><span class="line"><span class="comment">* \param length   length of the input data</span></span><br><span class="line"><span class="comment">* \param input    input block</span></span><br><span class="line"><span class="comment">* \param output   output block</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">sm4_crypt_ecb</span><span class="params">(sm4_context *ctx,</span></span><br><span class="line"><span class="params">	<span class="type">int</span> mode,</span></span><br><span class="line"><span class="params">	<span class="type">int</span> length,</span></span><br><span class="line"><span class="params">	<span class="type">unsigned</span> <span class="type">char</span> *input,</span></span><br><span class="line"><span class="params">	<span class="type">unsigned</span> <span class="type">char</span> *output)</span>;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* \brief          SM4-CBC buffer encryption/decryption</span></span><br><span class="line"><span class="comment">* \param ctx      SM4 context</span></span><br><span class="line"><span class="comment">* \param mode     SM4_ENCRYPT or SM4_DECRYPT</span></span><br><span class="line"><span class="comment">* \param length   length of the input data</span></span><br><span class="line"><span class="comment">* \param iv       initialization vector (updated after use)</span></span><br><span class="line"><span class="comment">* \param input    buffer holding the input data</span></span><br><span class="line"><span class="comment">* \param output   buffer holding the output data</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">sm4_crypt_cbc</span><span class="params">(sm4_context *ctx,</span></span><br><span class="line"><span class="params">	<span class="type">int</span> mode,</span></span><br><span class="line"><span class="params">	<span class="type">int</span> length,</span></span><br><span class="line"><span class="params">	<span class="type">unsigned</span> <span class="type">char</span> iv[<span class="number">16</span>],</span></span><br><span class="line"><span class="params">	<span class="type">unsigned</span> <span class="type">char</span> *input,</span></span><br><span class="line"><span class="params">	<span class="type">unsigned</span> <span class="type">char</span> *output)</span>;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 32-bit integer manipulation macros (big endian)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> GET_ULONG_BE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GET_ULONG_BE(n,b,i)                             \</span></span><br><span class="line"><span class="meta">&#123;                                                       \</span></span><br><span class="line"><span class="meta">    (n) = ( (unsigned long) (b)[(i)    ] &lt;&lt; 24 )        \</span></span><br><span class="line"><span class="meta">        | ( (unsigned long) (b)[(i) + 1] &lt;&lt; 16 )        \</span></span><br><span class="line"><span class="meta">        | ( (unsigned long) (b)[(i) + 2] &lt;&lt;  8 )        \</span></span><br><span class="line"><span class="meta">        | ( (unsigned long) (b)[(i) + 3]       );       \</span></span><br><span class="line"><span class="meta">&#125;</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> PUT_ULONG_BE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PUT_ULONG_BE(n,b,i)                             \</span></span><br><span class="line"><span class="meta">&#123;                                                       \</span></span><br><span class="line"><span class="meta">    (b)[(i)    ] = (unsigned char) ( (n) &gt;&gt; 24 );       \</span></span><br><span class="line"><span class="meta">    (b)[(i) + 1] = (unsigned char) ( (n) &gt;&gt; 16 );       \</span></span><br><span class="line"><span class="meta">    (b)[(i) + 2] = (unsigned char) ( (n) &gt;&gt;  8 );       \</span></span><br><span class="line"><span class="meta">    (b)[(i) + 3] = (unsigned char) ( (n)       );       \</span></span><br><span class="line"><span class="meta">&#125;</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*rotate shift left marco definition</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  SHL(x,n) (((x) &amp; 0xFFFFFFFF) &lt;&lt; n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ROTL(x,n) (SHL((x),n) | ((x) &gt;&gt; (32 - n)))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SWAP(a,b) &#123; unsigned long t = a; a = b; b = t; t = 0; &#125;</span></span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Expanded SM4 S-boxes</span></span><br><span class="line"><span class="comment">/* Sbox table: 8bits input convert to 8 bits output*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> SboxTable[<span class="number">16</span>][<span class="number">16</span>] =</span><br><span class="line">&#123;</span><br><span class="line">	&#123; <span class="number">0xd6</span>,<span class="number">0x90</span>,<span class="number">0xe9</span>,<span class="number">0xfe</span>,<span class="number">0xcc</span>,<span class="number">0xe1</span>,<span class="number">0x3d</span>,<span class="number">0xb7</span>,<span class="number">0x16</span>,<span class="number">0xb6</span>,<span class="number">0x14</span>,<span class="number">0xc2</span>,<span class="number">0x28</span>,<span class="number">0xfb</span>,<span class="number">0x2c</span>,<span class="number">0x05</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0x2b</span>,<span class="number">0x67</span>,<span class="number">0x9a</span>,<span class="number">0x76</span>,<span class="number">0x2a</span>,<span class="number">0xbe</span>,<span class="number">0x04</span>,<span class="number">0xc3</span>,<span class="number">0xaa</span>,<span class="number">0x44</span>,<span class="number">0x13</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x86</span>,<span class="number">0x06</span>,<span class="number">0x99</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0x9c</span>,<span class="number">0x42</span>,<span class="number">0x50</span>,<span class="number">0xf4</span>,<span class="number">0x91</span>,<span class="number">0xef</span>,<span class="number">0x98</span>,<span class="number">0x7a</span>,<span class="number">0x33</span>,<span class="number">0x54</span>,<span class="number">0x0b</span>,<span class="number">0x43</span>,<span class="number">0xed</span>,<span class="number">0xcf</span>,<span class="number">0xac</span>,<span class="number">0x62</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0xe4</span>,<span class="number">0xb3</span>,<span class="number">0x1c</span>,<span class="number">0xa9</span>,<span class="number">0xc9</span>,<span class="number">0x08</span>,<span class="number">0xe8</span>,<span class="number">0x95</span>,<span class="number">0x80</span>,<span class="number">0xdf</span>,<span class="number">0x94</span>,<span class="number">0xfa</span>,<span class="number">0x75</span>,<span class="number">0x8f</span>,<span class="number">0x3f</span>,<span class="number">0xa6</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0x47</span>,<span class="number">0x07</span>,<span class="number">0xa7</span>,<span class="number">0xfc</span>,<span class="number">0xf3</span>,<span class="number">0x73</span>,<span class="number">0x17</span>,<span class="number">0xba</span>,<span class="number">0x83</span>,<span class="number">0x59</span>,<span class="number">0x3c</span>,<span class="number">0x19</span>,<span class="number">0xe6</span>,<span class="number">0x85</span>,<span class="number">0x4f</span>,<span class="number">0xa8</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0x68</span>,<span class="number">0x6b</span>,<span class="number">0x81</span>,<span class="number">0xb2</span>,<span class="number">0x71</span>,<span class="number">0x64</span>,<span class="number">0xda</span>,<span class="number">0x8b</span>,<span class="number">0xf8</span>,<span class="number">0xeb</span>,<span class="number">0x0f</span>,<span class="number">0x4b</span>,<span class="number">0x70</span>,<span class="number">0x56</span>,<span class="number">0x9d</span>,<span class="number">0x35</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0x1e</span>,<span class="number">0x24</span>,<span class="number">0x0e</span>,<span class="number">0x5e</span>,<span class="number">0x63</span>,<span class="number">0x58</span>,<span class="number">0xd1</span>,<span class="number">0xa2</span>,<span class="number">0x25</span>,<span class="number">0x22</span>,<span class="number">0x7c</span>,<span class="number">0x3b</span>,<span class="number">0x01</span>,<span class="number">0x21</span>,<span class="number">0x78</span>,<span class="number">0x87</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0xd4</span>,<span class="number">0x00</span>,<span class="number">0x46</span>,<span class="number">0x57</span>,<span class="number">0x9f</span>,<span class="number">0xd3</span>,<span class="number">0x27</span>,<span class="number">0x52</span>,<span class="number">0x4c</span>,<span class="number">0x36</span>,<span class="number">0x02</span>,<span class="number">0xe7</span>,<span class="number">0xa0</span>,<span class="number">0xc4</span>,<span class="number">0xc8</span>,<span class="number">0x9e</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0xea</span>,<span class="number">0xbf</span>,<span class="number">0x8a</span>,<span class="number">0xd2</span>,<span class="number">0x40</span>,<span class="number">0xc7</span>,<span class="number">0x38</span>,<span class="number">0xb5</span>,<span class="number">0xa3</span>,<span class="number">0xf7</span>,<span class="number">0xf2</span>,<span class="number">0xce</span>,<span class="number">0xf9</span>,<span class="number">0x61</span>,<span class="number">0x15</span>,<span class="number">0xa1</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0xe0</span>,<span class="number">0xae</span>,<span class="number">0x5d</span>,<span class="number">0xa4</span>,<span class="number">0x9b</span>,<span class="number">0x34</span>,<span class="number">0x1a</span>,<span class="number">0x55</span>,<span class="number">0xad</span>,<span class="number">0x93</span>,<span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0xf5</span>,<span class="number">0x8c</span>,<span class="number">0xb1</span>,<span class="number">0xe3</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0x1d</span>,<span class="number">0xf6</span>,<span class="number">0xe2</span>,<span class="number">0x2e</span>,<span class="number">0x82</span>,<span class="number">0x66</span>,<span class="number">0xca</span>,<span class="number">0x60</span>,<span class="number">0xc0</span>,<span class="number">0x29</span>,<span class="number">0x23</span>,<span class="number">0xab</span>,<span class="number">0x0d</span>,<span class="number">0x53</span>,<span class="number">0x4e</span>,<span class="number">0x6f</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0xd5</span>,<span class="number">0xdb</span>,<span class="number">0x37</span>,<span class="number">0x45</span>,<span class="number">0xde</span>,<span class="number">0xfd</span>,<span class="number">0x8e</span>,<span class="number">0x2f</span>,<span class="number">0x03</span>,<span class="number">0xff</span>,<span class="number">0x6a</span>,<span class="number">0x72</span>,<span class="number">0x6d</span>,<span class="number">0x6c</span>,<span class="number">0x5b</span>,<span class="number">0x51</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0x8d</span>,<span class="number">0x1b</span>,<span class="number">0xaf</span>,<span class="number">0x92</span>,<span class="number">0xbb</span>,<span class="number">0xdd</span>,<span class="number">0xbc</span>,<span class="number">0x7f</span>,<span class="number">0x11</span>,<span class="number">0xd9</span>,<span class="number">0x5c</span>,<span class="number">0x41</span>,<span class="number">0x1f</span>,<span class="number">0x10</span>,<span class="number">0x5a</span>,<span class="number">0xd8</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0x0a</span>,<span class="number">0xc1</span>,<span class="number">0x31</span>,<span class="number">0x88</span>,<span class="number">0xa5</span>,<span class="number">0xcd</span>,<span class="number">0x7b</span>,<span class="number">0xbd</span>,<span class="number">0x2d</span>,<span class="number">0x74</span>,<span class="number">0xd0</span>,<span class="number">0x12</span>,<span class="number">0xb8</span>,<span class="number">0xe5</span>,<span class="number">0xb4</span>,<span class="number">0xb0</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0x89</span>,<span class="number">0x69</span>,<span class="number">0x97</span>,<span class="number">0x4a</span>,<span class="number">0x0c</span>,<span class="number">0x96</span>,<span class="number">0x77</span>,<span class="number">0x7e</span>,<span class="number">0x65</span>,<span class="number">0xb9</span>,<span class="number">0xf1</span>,<span class="number">0x09</span>,<span class="number">0xc5</span>,<span class="number">0x6e</span>,<span class="number">0xc6</span>,<span class="number">0x84</span> &#125;,</span><br><span class="line">	&#123; <span class="number">0x18</span>,<span class="number">0xf0</span>,<span class="number">0x7d</span>,<span class="number">0xec</span>,<span class="number">0x3a</span>,<span class="number">0xdc</span>,<span class="number">0x4d</span>,<span class="number">0x20</span>,<span class="number">0x79</span>,<span class="number">0xee</span>,<span class="number">0x5f</span>,<span class="number">0x3e</span>,<span class="number">0xd7</span>,<span class="number">0xcb</span>,<span class="number">0x39</span>,<span class="number">0x48</span> &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* System parameter */</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">unsigned</span> <span class="type">long</span> FK[<span class="number">4</span>] =</span><br><span class="line">&#123; <span class="number">0xa3b1bac6</span>,<span class="number">0x56aa3350</span>,<span class="number">0x677d9197</span>,<span class="number">0xb27022dc</span> &#125;;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* fixed parameter */</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">unsigned</span> <span class="type">long</span> CK[<span class="number">32</span>] =</span><br><span class="line">&#123;</span><br><span class="line">	<span class="number">0x00070e15</span>,<span class="number">0x1c232a31</span>,<span class="number">0x383f464d</span>,<span class="number">0x545b6269</span>,</span><br><span class="line">	<span class="number">0x70777e85</span>,<span class="number">0x8c939aa1</span>,<span class="number">0xa8afb6bd</span>,<span class="number">0xc4cbd2d9</span>,</span><br><span class="line">	<span class="number">0xe0e7eef5</span>,<span class="number">0xfc030a11</span>,<span class="number">0x181f262d</span>,<span class="number">0x343b4249</span>,</span><br><span class="line">	<span class="number">0x50575e65</span>,<span class="number">0x6c737a81</span>,<span class="number">0x888f969d</span>,<span class="number">0xa4abb2b9</span>,</span><br><span class="line">	<span class="number">0xc0c7ced5</span>,<span class="number">0xdce3eaf1</span>,<span class="number">0xf8ff060d</span>,<span class="number">0x141b2229</span>,</span><br><span class="line">	<span class="number">0x30373e45</span>,<span class="number">0x4c535a61</span>,<span class="number">0x686f767d</span>,<span class="number">0x848b9299</span>,</span><br><span class="line">	<span class="number">0xa0a7aeb5</span>,<span class="number">0xbcc3cad1</span>,<span class="number">0xd8dfe6ed</span>,<span class="number">0xf4fb0209</span>,</span><br><span class="line">	<span class="number">0x10171e25</span>,<span class="number">0x2c333a41</span>,<span class="number">0x484f565d</span>,<span class="number">0x646b7279</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* private function:</span></span><br><span class="line"><span class="comment">* look up in SboxTable and get the related value.</span></span><br><span class="line"><span class="comment">* args:    [in] inch: 0x00~0xFF (8 bits unsigned value).</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">sm4Sbox</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> inch)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> *pTable = (<span class="type">unsigned</span> <span class="type">char</span> *)SboxTable;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> retVal = (<span class="type">unsigned</span> <span class="type">char</span>)(pTable[inch]);</span><br><span class="line">	<span class="keyword">return</span> retVal;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* private F(Lt) function:</span></span><br><span class="line"><span class="comment">* &quot;T algorithm&quot; == &quot;L algorithm&quot; + &quot;t algorithm&quot;.</span></span><br><span class="line"><span class="comment">* args:    [in] a: a is a 32 bits unsigned value;</span></span><br><span class="line"><span class="comment">* return: c: c is calculated with line algorithm &quot;L&quot; and nonline algorithm &quot;t&quot;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="title function_">sm4Lt</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> ka)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> bb = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> c = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> a[<span class="number">4</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> b[<span class="number">4</span>];</span><br><span class="line">	PUT_ULONG_BE(ka, a, <span class="number">0</span>)</span><br><span class="line">		b[<span class="number">0</span>] = sm4Sbox(a[<span class="number">0</span>]);</span><br><span class="line">	b[<span class="number">1</span>] = sm4Sbox(a[<span class="number">1</span>]);</span><br><span class="line">	b[<span class="number">2</span>] = sm4Sbox(a[<span class="number">2</span>]);</span><br><span class="line">	b[<span class="number">3</span>] = sm4Sbox(a[<span class="number">3</span>]);</span><br><span class="line">	GET_ULONG_BE(bb, b, <span class="number">0</span>)</span><br><span class="line">		c = bb ^ (ROTL(bb, <span class="number">2</span>)) ^ (ROTL(bb, <span class="number">10</span>)) ^ (ROTL(bb, <span class="number">18</span>)) ^ (ROTL(bb, <span class="number">24</span>));</span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* private F function:</span></span><br><span class="line"><span class="comment">* Calculating and getting encryption/decryption contents.</span></span><br><span class="line"><span class="comment">* args:    [in] x0: original contents;</span></span><br><span class="line"><span class="comment">* args:    [in] x1: original contents;</span></span><br><span class="line"><span class="comment">* args:    [in] x2: original contents;</span></span><br><span class="line"><span class="comment">* args:    [in] x3: original contents;</span></span><br><span class="line"><span class="comment">* args:    [in] rk: encryption/decryption key;</span></span><br><span class="line"><span class="comment">* return the contents of encryption/decryption contents.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="title function_">sm4F</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> x0, <span class="type">unsigned</span> <span class="type">long</span> x1, <span class="type">unsigned</span> <span class="type">long</span> x2, <span class="type">unsigned</span> <span class="type">long</span> x3, <span class="type">unsigned</span> <span class="type">long</span> rk)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> (x0^sm4Lt(x1^x2^x3^rk));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/* private function:</span></span><br><span class="line"><span class="comment">* Calculating round encryption key.</span></span><br><span class="line"><span class="comment">* args:    [in] a: a is a 32 bits unsigned value;</span></span><br><span class="line"><span class="comment">* return: sk[i]: i&#123;0,1,2,3,...31&#125;.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="title function_">sm4CalciRK</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> ka)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> bb = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> rk = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> a[<span class="number">4</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> b[<span class="number">4</span>];</span><br><span class="line">	PUT_ULONG_BE(ka, a, <span class="number">0</span>)</span><br><span class="line">		b[<span class="number">0</span>] = sm4Sbox(a[<span class="number">0</span>]);</span><br><span class="line">	b[<span class="number">1</span>] = sm4Sbox(a[<span class="number">1</span>]);</span><br><span class="line">	b[<span class="number">2</span>] = sm4Sbox(a[<span class="number">2</span>]);</span><br><span class="line">	b[<span class="number">3</span>] = sm4Sbox(a[<span class="number">3</span>]);</span><br><span class="line">	GET_ULONG_BE(bb, b, <span class="number">0</span>)</span><br><span class="line">		rk = bb ^ (ROTL(bb, <span class="number">13</span>)) ^ (ROTL(bb, <span class="number">23</span>));</span><br><span class="line">	<span class="keyword">return</span> rk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">sm4_setkey</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> SK[<span class="number">32</span>], <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> MK[<span class="number">4</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> k[<span class="number">36</span>];</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	GET_ULONG_BE(MK[<span class="number">0</span>], key, <span class="number">0</span>);</span><br><span class="line">	GET_ULONG_BE(MK[<span class="number">1</span>], key, <span class="number">4</span>);</span><br><span class="line">	GET_ULONG_BE(MK[<span class="number">2</span>], key, <span class="number">8</span>);</span><br><span class="line">	GET_ULONG_BE(MK[<span class="number">3</span>], key, <span class="number">12</span>);</span><br><span class="line">	k[<span class="number">0</span>] = MK[<span class="number">0</span>] ^ FK[<span class="number">0</span>];</span><br><span class="line">	k[<span class="number">1</span>] = MK[<span class="number">1</span>] ^ FK[<span class="number">1</span>];</span><br><span class="line">	k[<span class="number">2</span>] = MK[<span class="number">2</span>] ^ FK[<span class="number">2</span>];</span><br><span class="line">	k[<span class="number">3</span>] = MK[<span class="number">3</span>] ^ FK[<span class="number">3</span>];</span><br><span class="line">	<span class="keyword">for</span> (; i&lt;<span class="number">32</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		k[i + <span class="number">4</span>] = k[i] ^ (sm4CalciRK(k[i + <span class="number">1</span>] ^ k[i + <span class="number">2</span>] ^ k[i + <span class="number">3</span>] ^ CK[i]));</span><br><span class="line">		SK[i] = k[i + <span class="number">4</span>];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* SM4 standard one round processing</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">sm4_one_round</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> sk[<span class="number">32</span>],</span></span><br><span class="line"><span class="params">	<span class="type">unsigned</span> <span class="type">char</span> input[<span class="number">16</span>],</span></span><br><span class="line"><span class="params">	<span class="type">unsigned</span> <span class="type">char</span> output[<span class="number">16</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> ulbuf[<span class="number">36</span>];</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(ulbuf, <span class="number">0</span>, <span class="keyword">sizeof</span>(ulbuf));</span><br><span class="line">	GET_ULONG_BE(ulbuf[<span class="number">0</span>], input, <span class="number">0</span>)</span><br><span class="line">		GET_ULONG_BE(ulbuf[<span class="number">1</span>], input, <span class="number">4</span>)</span><br><span class="line">		GET_ULONG_BE(ulbuf[<span class="number">2</span>], input, <span class="number">8</span>)</span><br><span class="line">		GET_ULONG_BE(ulbuf[<span class="number">3</span>], input, <span class="number">12</span>)</span><br><span class="line">		<span class="keyword">while</span> (i&lt;<span class="number">32</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			ulbuf[i + <span class="number">4</span>] = sm4F(ulbuf[i], ulbuf[i + <span class="number">1</span>], ulbuf[i + <span class="number">2</span>], ulbuf[i + <span class="number">3</span>], sk[i]);</span><br><span class="line">			i++;</span><br><span class="line">		&#125;</span><br><span class="line">	PUT_ULONG_BE(ulbuf[<span class="number">35</span>], output, <span class="number">0</span>);</span><br><span class="line">	PUT_ULONG_BE(ulbuf[<span class="number">34</span>], output, <span class="number">4</span>);</span><br><span class="line">	PUT_ULONG_BE(ulbuf[<span class="number">33</span>], output, <span class="number">8</span>);</span><br><span class="line">	PUT_ULONG_BE(ulbuf[<span class="number">32</span>], output, <span class="number">12</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* SM4 key schedule (128-bit, encryption)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">sm4_setkey_enc</span><span class="params">(sm4_context *ctx, <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">	ctx-&gt;mode = SM4_ENCRYPT;</span><br><span class="line">	sm4_setkey(ctx-&gt;sk, key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* SM4 key schedule (128-bit, decryption)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">sm4_setkey_dec</span><span class="params">(sm4_context *ctx, <span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	ctx-&gt;mode = SM4_ENCRYPT;</span><br><span class="line">	sm4_setkey(ctx-&gt;sk, key);</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		SWAP(ctx-&gt;sk[i], ctx-&gt;sk[<span class="number">31</span> - i]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* SM4-ECB block encryption/decryption</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">sm4_crypt_ecb</span><span class="params">(sm4_context *ctx,</span></span><br><span class="line"><span class="params">	<span class="type">int</span> mode,</span></span><br><span class="line"><span class="params">	<span class="type">int</span> length,</span></span><br><span class="line"><span class="params">	<span class="type">unsigned</span> <span class="type">char</span> *input,</span></span><br><span class="line"><span class="params">	<span class="type">unsigned</span> <span class="type">char</span> *output)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span> (length &gt; <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		sm4_one_round(ctx-&gt;sk, input, output);</span><br><span class="line">		input += <span class="number">16</span>;</span><br><span class="line">		output += <span class="number">16</span>;</span><br><span class="line">		length -= <span class="number">16</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* SM4-CBC buffer encryption/decryption</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">sm4_crypt_cbc</span><span class="params">(sm4_context *ctx,</span></span><br><span class="line"><span class="params">	<span class="type">int</span> mode,</span></span><br><span class="line"><span class="params">	<span class="type">int</span> length,</span></span><br><span class="line"><span class="params">	<span class="type">unsigned</span> <span class="type">char</span> iv[<span class="number">16</span>],</span></span><br><span class="line"><span class="params">	<span class="type">unsigned</span> <span class="type">char</span> *input,</span></span><br><span class="line"><span class="params">	<span class="type">unsigned</span> <span class="type">char</span> *output)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> temp[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (mode == SM4_ENCRYPT)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span> (length &gt; <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">				output[i] = (<span class="type">unsigned</span> <span class="type">char</span>)(input[i] ^ iv[i]);</span><br><span class="line"></span><br><span class="line">			sm4_one_round(ctx-&gt;sk, output, output);</span><br><span class="line">			<span class="built_in">memcpy</span>(iv, output, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">			input += <span class="number">16</span>;</span><br><span class="line">			output += <span class="number">16</span>;</span><br><span class="line">			length -= <span class="number">16</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="comment">/* SM4_DECRYPT */</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span> (length &gt; <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">memcpy</span>(temp, input, <span class="number">16</span>);</span><br><span class="line">			sm4_one_round(ctx-&gt;sk, input, output);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">				output[i] = (<span class="type">unsigned</span> <span class="type">char</span>)(output[i] ^ iv[i]);</span><br><span class="line"></span><br><span class="line">			<span class="built_in">memcpy</span>(iv, temp, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">			input += <span class="number">16</span>;</span><br><span class="line">			output += <span class="number">16</span>;</span><br><span class="line">			length -= <span class="number">16</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*--------------------------------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">16</span>] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span> &#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> input[<span class="number">16</span>] = &#123; <span class="number">0xD4</span>, <span class="number">0xD9</span>, <span class="number">0x76</span>, <span class="number">0xED</span>, <span class="number">0x8C</span>, <span class="number">0xFD</span>, <span class="number">0x9E</span>, <span class="number">0x36</span>, <span class="number">0x75</span>, <span class="number">0xCF</span>, <span class="number">0x39</span>, <span class="number">0x20</span>, <span class="number">0x56</span>, <span class="number">0x3A</span>, <span class="number">0xE6</span>, <span class="number">0xBF</span> &#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> output[<span class="number">16</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> iv[<span class="number">16</span>] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span> &#125;;</span><br><span class="line">	sm4_context ctx;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> i;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	//encrypt testing</span></span><br><span class="line"><span class="comment">	sm4_setkey_enc(&amp;ctx,key);</span></span><br><span class="line"><span class="comment">	sm4_crypt_ecb(&amp;ctx,1,16,input,output);</span></span><br><span class="line"><span class="comment">	for(i=0;i&lt;16;i++)</span></span><br><span class="line"><span class="comment">		printf(&quot;%02x &quot;, output[i]);</span></span><br><span class="line"><span class="comment">	printf(&quot;\n&quot;);</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//decrypt testing</span></span><br><span class="line">	sm4_setkey_dec(&amp;ctx, key);</span><br><span class="line">	sm4_crypt_cbc(&amp;ctx, <span class="number">0</span>, <span class="number">16</span>, iv, input, output);</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i&lt;<span class="number">16</span>; i++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%02x\n&quot;</span>, output[i]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>第三个函数就是个base64直接搞</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#输出数组</span><br><span class="line">import base64</span><br><span class="line">base = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">diy_base = <span class="string">&#x27;abcdefghijklmnpoqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&#x27;</span></span><br><span class="line">s = <span class="string">&#x27;cpVVnW&#x27;</span></span><br><span class="line">ss = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">for i in range(len(s)-2):</span></span><br><span class="line"><span class="string">	ss += base[diy_base.find(s[i])]</span></span><br><span class="line"><span class="string">ss += &#x27;</span>==&#x27;</span><br><span class="line">a = base64.b64decode(ss)</span><br><span class="line">print(<span class="built_in">list</span>(<span class="built_in">map</span>(hex,a)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后再进行异或，转换两次小端序就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">v8 =  <span class="number">0x37efeb08</span></span><br><span class="line">v11 =  <span class="number">0x8275e5d1</span></span><br><span class="line">v12 = <span class="number">0xff540b2d</span></span><br><span class="line">v9 = <span class="number">0x09e948b0</span></span><br><span class="line">flag =[<span class="number">0</span>] * <span class="number">4</span></span><br><span class="line">flag[<span class="number">0</span>] = v9 ^ <span class="number">0x39DEB332</span></span><br><span class="line">flag[<span class="number">1</span>] = v9 ^ v11</span><br><span class="line">flag[<span class="number">2</span>] = v11 ^v12</span><br><span class="line">flag[<span class="number">3</span>] = v12 ^ v8</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(flag[<span class="number">0</span>]))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(flag[<span class="number">1</span>]))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(flag[<span class="number">2</span>]))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(flag[<span class="number">3</span>]))</span><br></pre></td></tr></table></figure>

<h3 id="creakme4"><a href="#creakme4" class="headerlink" title="creakme4"></a>creakme4</h3><p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220707204945097.png" alt="image-20220707204945097"></p>
<p>还是直接看so文件</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220708200200022.png" alt="image-20220708200200022"></p>
<p>findcript直接找到是blowfish加密，之前做过这个加密：</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220708200238598.png" alt="image-20220708200238598"></p>
<p>然后下面发现还有个加密</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220708200306368.png" alt="image-20220708200306368"></p>
<p>findcrypt并没有检测出，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_142B8</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// w23</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// w0</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// w3</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// w4</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// w5</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// w6</span></span><br><span class="line">  <span class="type">void</span> *v11; <span class="comment">// x7</span></span><br><span class="line">  __int64 v12; <span class="comment">// x21</span></span><br><span class="line">  __int64 v13; <span class="comment">// x0</span></span><br><span class="line">  __int64 v14; <span class="comment">// x19</span></span><br><span class="line">  __int64 v16; <span class="comment">// [xsp+0h] [xbp-E0h] BYREF</span></span><br><span class="line">  __int64 v17[<span class="number">2</span>]; <span class="comment">// [xsp+8h] [xbp-D8h] BYREF</span></span><br><span class="line">  <span class="type">void</span> *ptr; <span class="comment">// [xsp+18h] [xbp-C8h]</span></span><br><span class="line">  <span class="type">char</span> v19[<span class="number">8</span>]; <span class="comment">// [xsp+20h] [xbp-C0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v20[<span class="number">96</span>]; <span class="comment">// [xsp+28h] [xbp-B8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v21[<span class="number">8</span>]; <span class="comment">// [xsp+88h] [xbp-58h] BYREF</span></span><br><span class="line">  _QWORD v22[<span class="number">2</span>]; <span class="comment">// [xsp+90h] [xbp-50h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">1945572552</span>;</span><br><span class="line">  v22[<span class="number">1</span>] = *(_QWORD *)(_ReadStatusReg(ARM64_SYSREG(<span class="number">3</span>, <span class="number">3</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">2</span>)) + <span class="number">40</span>);</span><br><span class="line">  v17[<span class="number">1</span>] = <span class="number">0LL</span>;</span><br><span class="line">  ptr = <span class="number">0LL</span>;</span><br><span class="line">  v17[<span class="number">0</span>] = <span class="number">0LL</span>;</span><br><span class="line">  v6 = <span class="built_in">strlen</span>(a5);</span><br><span class="line">  sub_14FE0((<span class="type">int</span>)v17, (<span class="type">int</span>)a5, v6, v7, v8, v9, v10, v11);</span><br><span class="line">  v12 = (*(__int64 (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)a1 + <span class="number">1352LL</span>))(a1, a3, <span class="number">0LL</span>);</span><br><span class="line">  sub_13FC8(v12, v21);</span><br><span class="line">  v16 = <span class="number">0xE7CDAB8967452301</span>LL;</span><br><span class="line">  sub_1054C(&amp;v16, v20, <span class="number">0LL</span>);</span><br><span class="line">  sub_10C84(v22, v19, v20);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)v19[<span class="number">0</span>] == <span class="number">228</span></span><br><span class="line">    &amp;&amp; (<span class="type">unsigned</span> __int8)v19[<span class="number">1</span>] == <span class="number">234</span></span><br><span class="line">    &amp;&amp; (<span class="type">unsigned</span> __int8)v19[<span class="number">2</span>] == <span class="number">196</span></span><br><span class="line">    &amp;&amp; (<span class="type">unsigned</span> __int8)v19[<span class="number">3</span>] == <span class="number">129</span></span><br><span class="line">    &amp;&amp; (<span class="type">unsigned</span> __int8)v19[<span class="number">4</span>] == <span class="number">185</span></span><br><span class="line">    &amp;&amp; (<span class="type">unsigned</span> __int8)v19[<span class="number">5</span>] == <span class="number">254</span></span><br><span class="line">    &amp;&amp; v19[<span class="number">6</span>] == <span class="number">38</span></span><br><span class="line">    &amp;&amp; (<span class="type">unsigned</span> __int8)v19[<span class="number">7</span>] == <span class="number">188</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v13 = (*(__int64 (__fastcall **)(__int64, <span class="type">void</span> *))(*(_QWORD *)a1 + <span class="number">1336LL</span>))(a1, &amp;unk_3C090);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    (*(<span class="type">void</span> (__fastcall **)(__int64, __int64, __int64))(*(_QWORD *)a1 + <span class="number">1360LL</span>))(a1, a3, v12);</span><br><span class="line">    v13 = (*(__int64 (__fastcall **)(__int64, <span class="type">void</span> *))(*(_QWORD *)a1 + <span class="number">1336LL</span>))(a1, &amp;unk_3C050);</span><br><span class="line">  &#125;</span><br><span class="line">  v14 = v13;</span><br><span class="line">  <span class="keyword">while</span> ( v5 != <span class="number">847613141</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (v17[<span class="number">0</span>] &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      v5 = <span class="number">847613141</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v5 = <span class="number">-519487832</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v5 == <span class="number">-519487832</span> )</span><br><span class="line">      <span class="keyword">return</span> v14;</span><br><span class="line">  &#125;</span><br><span class="line">  operator <span class="title function_">delete</span><span class="params">(ptr)</span>;</span><br><span class="line">  <span class="keyword">return</span> v14;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220708200509986.png" alt="image-20220708200509986"></p>
<p>学了des加密后，发现这有8个s盒，应该是个des，并没有魔改。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> Blowfish</span><br><span class="line">key = <span class="string">b&#x27;\x12\x34\x56\x78\x9a\xbc\xde\xff&#x27;</span></span><br><span class="line">enc_data = <span class="built_in">bytes</span>([<span class="number">0x92</span>, <span class="number">0xB1</span>, <span class="number">0xC0</span>, <span class="number">0x8D</span>, <span class="number">0x7D</span>, <span class="number">0x4D</span>, <span class="number">0x02</span>, <span class="number">0XB6</span>])</span><br><span class="line">cipher = Blowfish.new(key, Blowfish.MODE_ECB) </span><br><span class="line">dec = cipher.decrypt(enc_data) </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dec:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&#123;:02x&#125;&quot;</span>.<span class="built_in">format</span>(i), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line">key = <span class="built_in">bytes</span>([<span class="number">0x01</span>, <span class="number">0x23</span>, <span class="number">0x45</span>, <span class="number">0x67</span>, <span class="number">0x89</span>, <span class="number">0xab</span>, <span class="number">0xcd</span>, <span class="number">0xe7</span>])</span><br><span class="line">enc_data = <span class="built_in">bytes</span>([<span class="number">0xE4</span>, <span class="number">0XEA</span>, <span class="number">0XC4</span>, <span class="number">0X81</span>, <span class="number">0xB9</span>, <span class="number">0xFE</span>, <span class="number">0x26</span>, <span class="number">0xBC</span>])</span><br><span class="line">cipher = DES.new(key, DES.MODE_ECB)</span><br><span class="line">dec = cipher.decrypt(enc_data)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dec:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&#123;:02x&#125;&quot;</span>.<span class="built_in">format</span>(i), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<h3 id="analgo"><a href="#analgo" class="headerlink" title="analgo"></a>analgo</h3><p>又是go语言，发现有一段brainfuck</p>
<p>直接在对比处下断点来查看输入后经过加密会怎么变化。</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220708092459410.png" alt="image-20220708092459410"></p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220708165947660.png" alt="image-20220708165947660"></p>
<p>在比较处patch一下</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">输入：<span class="number">111111111111111111111111111111111111111111</span></span><br><span class="line">输出：<span class="number">0</span><span class="built_in">F</span> <span class="number">5291</span>D4135695D8175A99DC1B5E9DE01F62A1E42366A5E8276AA9EC2B6EADB0EF3271B4F33675B8F70F</span><br><span class="line">输入：<span class="number">211111111111111111111111111111111111111111</span></span><br><span class="line">输出：C2 <span class="number">5291</span>D4135695D8175A99DC1B5E9DE01F62A1E42366A5E8276AA9EC2B6EADB0EF3271B4F33675B8F70F</span><br><span class="line">输入：<span class="number">112111111111111111111111111111111111111111</span></span><br><span class="line">输出：<span class="number">0</span><span class="built_in">F</span> <span class="number">7</span><span class="built_in">F</span> <span class="number">40</span>D4135695D8175A99DC1B5E9DE01F62A1E42366A5E8276AA9EC2B6EADB0EF3271B4F33675B8F70F</span><br></pre></td></tr></table></figure>

<p>很明显字节与字节之间并无明显关联，对程序进行单字节爆破处理，这是我第二次见这样的脚本，上次还是在hgame。。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">list</span>(<span class="string">&#x27;fl1111111111111111111111111111111111111111\n&#x27;</span>)<span class="comment">#确定前两个字符从而递归推出下面字符</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">0x2a</span>):</span><br><span class="line">    <span class="built_in">bin</span> = <span class="built_in">bytearray</span>(<span class="built_in">open</span>(<span class="string">&quot;analgo.exe&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()) </span><br><span class="line">    <span class="built_in">bin</span>[<span class="number">0xb3045</span>] = i </span><br><span class="line">    <span class="built_in">open</span>(<span class="string">&quot;analgo.exe&quot;</span>,<span class="string">&quot;wb&quot;</span>).write(<span class="built_in">bin</span>)<span class="comment">#将之后的值写入文件</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> string.printable:<span class="comment">#爆破</span></span><br><span class="line">        data[i] = j </span><br><span class="line">        pipe = subprocess.Popen(<span class="string">&quot;./analgo.exe&quot;</span>,bufsize=<span class="number">2</span>,stdout=subprocess.PIPE,stdin=subprocess.PIPE)<span class="comment">#创建管道</span></span><br><span class="line">        pipe.stdin.write(<span class="built_in">bytes</span>(<span class="string">&quot;&quot;</span>.join(data).encode(<span class="string">&quot;utf-8&quot;</span>))) <span class="comment">#将该字符写入文件进行验证</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;right!\n&#x27;</span> == pipe.stdout.read():<span class="comment">#如果子进程输出right</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(data))<span class="comment">#输出结果</span></span><br></pre></td></tr></table></figure>

<p>flag{568a3cdd-77e1-4c42-9fee-127e27a5744e}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">subprocess.run(args, *, stdin=<span class="literal">None</span>, <span class="built_in">input</span>=<span class="literal">None</span>, stdout=<span class="literal">None</span>, stderr=<span class="literal">None</span>, capture_output=<span class="literal">False</span>, shell=<span class="literal">False</span>, cwd=<span class="literal">None</span>, timeout=<span class="literal">None</span>, check=<span class="literal">False</span>, encoding=<span class="literal">None</span>, errors=<span class="literal">None</span>, text=<span class="literal">None</span>, env=<span class="literal">None</span>, universal_newlines=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">args：表示要执行的命令。必须是一个字符串，字符串参数列表。</span><br><span class="line">stdin、stdout 和 stderr：子进程的标准输入、输出和错误。其值可以是 subprocess.PIPE、subprocess.DEVNULL、一个已经存在的文件描述符、已经打开的文件对象或者 <span class="literal">None</span>。subprocess.PIPE 表示为子进程创建新的管道。subprocess.DEVNULL 表示使用 os.devnull。默认使用的是 <span class="literal">None</span>，表示什么都不做。另外，stderr 可以合并到 stdout 里一起输出。</span><br><span class="line">timeout：设置命令超时时间。如果命令执行时间超时，子进程将被杀死，并弹出 TimeoutExpired 异常。</span><br><span class="line">check：如果该参数设置为 <span class="literal">True</span>，并且进程退出状态码不是 <span class="number">0</span>，则弹 出 CalledProcessError 异常。</span><br><span class="line">encoding: 如果指定了该参数，则 stdin、stdout 和 stderr 可以接收字符串数据，并以该编码方式编码。否则只接收 <span class="built_in">bytes</span> 类型的数据。</span><br><span class="line">shell：如果该参数为 <span class="literal">True</span>，将通过操作系统的 shell 执行指定的命令</span><br></pre></td></tr></table></figure>

<h3 id="rota"><a href="#rota" class="headerlink" title="rota"></a>rota</h3><p>这题还是比较简单的</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220711181535411.png" alt="image-20220711181535411"></p>
<p>显然base64换表加密</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v13 )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>i64; i &lt; <span class="number">64</span>; ++i )</span><br><span class="line">    *((_BYTE *)&amp;unk_7FF75F6B6040 + i) = (*((_BYTE *)&amp;unk_7FF75F6B6040 + i) + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  si128 = _mm_load_si128((<span class="type">const</span> __m128i *)&amp;xmmword_7FF75F6B4340);</span><br><span class="line">  v15 = _mm_load_si128((<span class="type">const</span> __m128i *)&amp;xmmword_7FF75F6B4350);</span><br><span class="line">  v16 = <span class="number">0</span>i64;</span><br><span class="line">  v17 = _mm_cvtsi32_si128(<span class="number">6u</span>);</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v18 = _mm_add_epi32(_mm_cvtepu8_epi32(*(_DWORD *)((<span class="type">char</span> *)&amp;unk_7FF75F6B6040 + v16)), si128);</span><br><span class="line">    v19 = _mm_and_si128(</span><br><span class="line">            _mm_shuffle_epi32(</span><br><span class="line">              _mm_shufflehi_epi16(</span><br><span class="line">                _mm_shufflelo_epi16(</span><br><span class="line">                  _mm_sub_epi32(</span><br><span class="line">                    v18,</span><br><span class="line">                    _mm_sll_epi32(</span><br><span class="line">                      _mm_sra_epi32(_mm_add_epi32(_mm_and_si128(_mm_cmpgt_epi32((__m128i)<span class="number">0</span>i64, v18), v15), v18), v17),</span><br><span class="line">                      v17)),</span><br><span class="line">                  <span class="number">216</span>),</span><br><span class="line">                <span class="number">216</span>),</span><br><span class="line">              <span class="number">216</span>),</span><br><span class="line">            (__m128i)xmmword_7FF75F6B4360);</span><br><span class="line">    *(_DWORD *)((<span class="type">char</span> *)&amp;unk_7FF75F6B6040 + v16) = _mm_cvtsi128_si32(_mm_packus_epi16(v19, v19));</span><br><span class="line">    v20 = _mm_add_epi32(_mm_cvtepu8_epi32(*(_DWORD *)((<span class="type">char</span> *)&amp;unk_7FF75F6B6044 + v16)), si128);</span><br><span class="line">    v21 = _mm_and_si128(</span><br><span class="line">            _mm_shuffle_epi32(</span><br><span class="line">              _mm_shufflehi_epi16(</span><br><span class="line">                _mm_shufflelo_epi16(</span><br><span class="line">                  _mm_sub_epi32(</span><br><span class="line">                    v20,</span><br><span class="line">                    _mm_sll_epi32(</span><br><span class="line">                      _mm_sra_epi32(_mm_add_epi32(_mm_and_si128(_mm_cmpgt_epi32((__m128i)<span class="number">0</span>i64, v20), v15), v20), v17),</span><br><span class="line">                      v17)),</span><br><span class="line">                  <span class="number">216</span>),</span><br><span class="line">                <span class="number">216</span>),</span><br><span class="line">              <span class="number">216</span>),</span><br><span class="line">            (__m128i)xmmword_7FF75F6B4360);</span><br><span class="line">    *(_DWORD *)((<span class="type">char</span> *)&amp;unk_7FF75F6B6044 + v16) = _mm_cvtsi128_si32(_mm_packus_epi16(v21, v21));</span><br><span class="line">    v16 += <span class="number">8</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v16 &lt; <span class="number">64</span> );</span><br><span class="line">&#125;</span><br><span class="line">sub_7FF75F6B10E0((__int64)v24);</span><br><span class="line">sub_7FF75F6B1E10(v24, (__int64)v32, (__int64)encode2);</span><br></pre></td></tr></table></figure>

<p>下面这其实都没啥，最主要的是sub_7FF75F6B1E10函数v32是传进来的base64加密函数。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> __fastcall <span class="title function_">sub_7FF75F6B1E10</span><span class="params">(_BYTE *a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v3; <span class="comment">// bl</span></span><br><span class="line">  _BYTE *v4; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">char</span> result; <span class="comment">// al</span></span><br><span class="line">  __int64 v7; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v9; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// r8</span></span><br><span class="line">  __int64 v12; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">char</span> v13; <span class="comment">// bl</span></span><br><span class="line">  __int64 v14; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// r8</span></span><br><span class="line">  __int64 v17; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">char</span> v18; <span class="comment">// bl</span></span><br><span class="line">  __int64 v19; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">char</span> v21; <span class="comment">// r8</span></span><br><span class="line">  __int64 v22; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">char</span> v23; <span class="comment">// bl</span></span><br><span class="line">  __int64 v24; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> v25; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">char</span> v26; <span class="comment">// r8</span></span><br><span class="line">  __int64 v27; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">char</span> v28; <span class="comment">// bl</span></span><br><span class="line">  __int64 v29; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> v30; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">char</span> v31; <span class="comment">// r8</span></span><br><span class="line">  __int64 v32; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v33; <span class="comment">// rcx</span></span><br><span class="line"></span><br><span class="line">  v3 = a1[<span class="number">192</span>];</span><br><span class="line">  v4 = (_BYTE *)(a3 + <span class="number">1</span>);</span><br><span class="line">  v5 = a1[<span class="number">193</span>];</span><br><span class="line">  result = a1[<span class="number">194</span>];</span><br><span class="line">  v7 = a2 - a3;</span><br><span class="line">  v9 = <span class="number">9</span>i64;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int8)v4[v7 - <span class="number">1</span>] != aXiizduaoglak6j[v10] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( ++v10 &gt;= <span class="number">64</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        LOBYTE(v10) = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v11 = v5;</span><br><span class="line">    v12 = (v5 + a1[(v3 + (_BYTE)v10) &amp; <span class="number">0x3F</span>]) &amp; <span class="number">0x3F</span>;</span><br><span class="line">    v13 = (v3 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">    v14 = (<span class="type">unsigned</span> __int8)a1[((result + a1[v12 + <span class="number">64</span>]) &amp; <span class="number">0x3F</span>) + <span class="number">128</span>];</span><br><span class="line">    a1[<span class="number">192</span>] = v13;</span><br><span class="line">    *(v4 - <span class="number">1</span>) = aXiizduaoglak6j[v14];</span><br><span class="line">    <span class="keyword">if</span> ( !v13 )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = (v5 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">      a1[<span class="number">193</span>] = v5;</span><br><span class="line">      <span class="keyword">if</span> ( ((v11 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>) == <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        result = (result + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">        a1[<span class="number">194</span>] = result;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v15 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int8)v4[v7] != aXiizduaoglak6j[v15] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( ++v15 &gt;= <span class="number">64</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        LOBYTE(v15) = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v16 = v5;</span><br><span class="line">    v17 = (v5 + a1[(v13 + (_BYTE)v15) &amp; <span class="number">0x3F</span>]) &amp; <span class="number">0x3F</span>;</span><br><span class="line">    v18 = (v13 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">    v19 = (<span class="type">unsigned</span> __int8)a1[((result + a1[v17 + <span class="number">64</span>]) &amp; <span class="number">0x3F</span>) + <span class="number">128</span>];</span><br><span class="line">    a1[<span class="number">192</span>] = v18;</span><br><span class="line">    *v4 = aXiizduaoglak6j[v19];</span><br><span class="line">    <span class="keyword">if</span> ( !v18 )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = (v5 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">      a1[<span class="number">193</span>] = v5;</span><br><span class="line">      <span class="keyword">if</span> ( ((v16 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>) == <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        result = (result + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">        a1[<span class="number">194</span>] = result;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v20 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int8)v4[v7 + <span class="number">1</span>] != aXiizduaoglak6j[v20] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( ++v20 &gt;= <span class="number">64</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        LOBYTE(v20) = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v21 = v5;</span><br><span class="line">    v22 = (v5 + a1[(v18 + (_BYTE)v20) &amp; <span class="number">0x3F</span>]) &amp; <span class="number">0x3F</span>;</span><br><span class="line">    v23 = (v18 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">    v24 = (<span class="type">unsigned</span> __int8)a1[((result + a1[v22 + <span class="number">64</span>]) &amp; <span class="number">0x3F</span>) + <span class="number">128</span>];</span><br><span class="line">    a1[<span class="number">192</span>] = v23;</span><br><span class="line">    v4[<span class="number">1</span>] = aXiizduaoglak6j[v24];</span><br><span class="line">    <span class="keyword">if</span> ( !v23 )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = (v5 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">      a1[<span class="number">193</span>] = v5;</span><br><span class="line">      <span class="keyword">if</span> ( ((v21 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>) == <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        result = (result + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">        a1[<span class="number">194</span>] = result;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v25 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int8)v4[v7 + <span class="number">2</span>] != aXiizduaoglak6j[v25] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( ++v25 &gt;= <span class="number">64</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        LOBYTE(v25) = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v26 = v5;</span><br><span class="line">    v27 = (v5 + a1[(v23 + (_BYTE)v25) &amp; <span class="number">0x3F</span>]) &amp; <span class="number">0x3F</span>;</span><br><span class="line">    v28 = (v23 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">    v29 = (<span class="type">unsigned</span> __int8)a1[((result + a1[v27 + <span class="number">64</span>]) &amp; <span class="number">0x3F</span>) + <span class="number">128</span>];</span><br><span class="line">    a1[<span class="number">192</span>] = v28;</span><br><span class="line">    v4[<span class="number">2</span>] = aXiizduaoglak6j[v29];</span><br><span class="line">    <span class="keyword">if</span> ( !v28 )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = (v5 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">      a1[<span class="number">193</span>] = v5;</span><br><span class="line">      <span class="keyword">if</span> ( ((v26 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>) == <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        result = (result + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">        a1[<span class="number">194</span>] = result;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v30 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int8)v4[v7 + <span class="number">3</span>] != aXiizduaoglak6j[v30] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( ++v30 &gt;= <span class="number">64</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        LOBYTE(v30) = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v31 = v5;</span><br><span class="line">    v32 = (v5 + a1[(v28 + (_BYTE)v30) &amp; <span class="number">0x3F</span>]) &amp; <span class="number">0x3F</span>;</span><br><span class="line">    v3 = (v28 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">    v33 = (<span class="type">unsigned</span> __int8)a1[((result + a1[v32 + <span class="number">64</span>]) &amp; <span class="number">0x3F</span>) + <span class="number">128</span>];</span><br><span class="line">    a1[<span class="number">192</span>] = v3;</span><br><span class="line">    v4[<span class="number">3</span>] = aXiizduaoglak6j[v33];</span><br><span class="line">    <span class="keyword">if</span> ( !v3 )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = (v5 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">      a1[<span class="number">193</span>] = v5;</span><br><span class="line">      <span class="keyword">if</span> ( ((v31 + <span class="number">1</span>) &amp; <span class="number">0x3F</span>) == <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        result = (result + <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">        a1[<span class="number">194</span>] = result;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v4 += <span class="number">5</span>;</span><br><span class="line">    --v9;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v9 );</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>四个地方结构相似，发现其实只用看懂一个就行，原数据在v4，我们可以直接爆破，然后直接对比就行，其实不难。每个结构其实是对一个字符进行的加密，那么每一次do while就是加密四个，但我们可以直接单个爆破。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">cmp = <span class="string">&quot;ksPhS/34MXifj+Ibtjud2Tikj5HkA7iTpbaNELBebOaIm&quot;</span></span><br><span class="line">base_change = <span class="string">&quot;XiIzDuAoGlaK6JcjM3g/9YQmHBOsxn1hLZ4w7Tt0PV5pNqUFC+rE2dSfyvWe8kRb&quot;</span></span><br><span class="line">base = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">a1 = [<span class="number">0x33</span>, <span class="number">0x34</span>, <span class="number">0x2C</span>, <span class="number">0x36</span>, <span class="number">0x1D</span>, <span class="number">0x12</span>, <span class="number">0x1E</span>, <span class="number">0x0C</span>, <span class="number">0x1A</span>, <span class="number">0x3C</span>, <span class="number">0x29</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x14</span>, <span class="number">0x3D</span>, <span class="number">0x3B</span>, <span class="number">0x19</span>, <span class="number">0x08</span>, <span class="number">0x0E</span>, <span class="number">0x1F</span>, <span class="number">0x30</span>, <span class="number">0x05</span>, <span class="number">0x38</span>, <span class="number">0x03</span>, <span class="number">0x11</span>, <span class="number">0x1B</span>, <span class="number">0x17</span>, <span class="number">0x21</span>, <span class="number">0x2E</span>, <span class="number">0x04</span>, <span class="number">0x18</span>, <span class="number">0x23</span>, <span class="number">0x2B</span>, <span class="number">0x02</span>, <span class="number">0x27</span>, <span class="number">0x37</span>, <span class="number">0x1C</span>, <span class="number">0x24</span>, <span class="number">0x39</span>, <span class="number">0x3F</span>, <span class="number">0x35</span>, <span class="number">0x2D</span>, <span class="number">0x26</span>, <span class="number">0x13</span>, <span class="number">0x2A</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x3E</span>, <span class="number">0x01</span>, <span class="number">0x28</span>, <span class="number">0x2F</span>, <span class="number">0x32</span>, <span class="number">0x22</span>, <span class="number">0x0D</span>, <span class="number">0x06</span>, <span class="number">0x25</span>, <span class="number">0x3A</span>, <span class="number">0x09</span>, <span class="number">0x0F</span>, <span class="number">0x16</span>, <span class="number">0x0B</span>, <span class="number">0x15</span>, <span class="number">0x31</span>, <span class="number">0x0C</span>, <span class="number">0x2C</span>, <span class="number">0x0D</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x39</span>, <span class="number">0x31</span>, <span class="number">0x17</span>, <span class="number">0x1A</span>, <span class="number">0x33</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x10</span>, <span class="number">0x04</span>, <span class="number">0x1B</span>, <span class="number">0x0B</span>, <span class="number">0x34</span>, <span class="number">0x12</span>, <span class="number">0x38</span>, <span class="number">0x27</span>, <span class="number">0x0E</span>, <span class="number">0x20</span>, <span class="number">0x2B</span>, <span class="number">0x2E</span>, <span class="number">0x00</span>, <span class="number">0x13</span>, <span class="number">0x3E</span>, <span class="number">0x3A</span>, <span class="number">0x05</span>, <span class="number">0x1E</span>, <span class="number">0x36</span>, <span class="number">0x08</span>, <span class="number">0x32</span>, <span class="number">0x29</span>, <span class="number">0x19</span>, <span class="number">0x23</span>, <span class="number">0x3D</span>, <span class="number">0x3B</span>, <span class="number">0x3C</span>, <span class="number">0x3F</span>, <span class="number">0x37</span>, <span class="number">0x30</span>, <span class="number">0x18</span>, <span class="number">0x16</span>, <span class="number">0x35</span>, <span class="number">0x25</span>, <span class="number">0x0A</span>, <span class="number">0x2D</span>, <span class="number">0x28</span>, <span class="number">0x26</span>, <span class="number">0x15</span>, <span class="number">0x11</span>, <span class="number">0x07</span>, <span class="number">0x1D</span>, <span class="number">0x2A</span>, <span class="number">0x0F</span>, <span class="number">0x1F</span>, <span class="number">0x14</span>, <span class="number">0x01</span>, <span class="number">0x1C</span>, <span class="number">0x03</span>, <span class="number">0x2F</span>, <span class="number">0x13</span>, <span class="number">0x0D</span>, <span class="number">0x35</span>, <span class="number">0x31</span>, <span class="number">0x07</span>, <span class="number">0x11</span>, <span class="number">0x1B</span>, <span class="number">0x23</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x10</span>, <span class="number">0x25</span>, <span class="number">0x2B</span>, <span class="number">0x21</span>, <span class="number">0x33</span>, <span class="number">0x18</span>, <span class="number">0x27</span>, <span class="number">0x29</span>, <span class="number">0x02</span>, <span class="number">0x2F</span>, <span class="number">0x28</span>, <span class="number">0x30</span>, <span class="number">0x0E</span>, <span class="number">0x19</span>, <span class="number">0x3C</span>, <span class="number">0x08</span>, <span class="number">0x34</span>, <span class="number">0x20</span>, <span class="number">0x3D</span>, <span class="number">0x2E</span>, <span class="number">0x05</span>, <span class="number">0x15</span>, <span class="number">0x2C</span>, <span class="number">0x1C</span>, <span class="number">0x36</span>, <span class="number">0x22</span>, <span class="number">0x1E</span>, <span class="number">0x24</span>, <span class="number">0x38</span>, <span class="number">0x0A</span>, <span class="number">0x3F</span>, <span class="number">0x1A</span>, <span class="number">0x04</span>, <span class="number">0x26</span>, <span class="number">0x16</span>, <span class="number">0x2A</span>, <span class="number">0x3A</span>, <span class="number">0x1F</span>, <span class="number">0x2D</span>, <span class="number">0x32</span>, <span class="number">0x06</span>, <span class="number">0x37</span>, <span class="number">0x03</span>, <span class="number">0x3B</span>, <span class="number">0x00</span>, <span class="number">0x17</span>, <span class="number">0x1D</span>, <span class="number">0x12</span>, <span class="number">0x09</span>, <span class="number">0x01</span>, <span class="number">0x3E</span>, <span class="number">0x39</span>, <span class="number">0x0F</span>, <span class="number">0x14</span>]</span><br><span class="line">flag1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> base_change:</span><br><span class="line">        x = base_change.find(j)</span><br><span class="line">        v17 = a1[(i + x) &amp; <span class="number">0x3f</span>] &amp; <span class="number">0x3f</span></span><br><span class="line">        v14 = a1[(a1[v17 + <span class="number">64</span>] ) + <span class="number">128</span>]</span><br><span class="line">        <span class="keyword">if</span> base_change[v14] == cmp[i]:</span><br><span class="line">            flag1 += j</span><br><span class="line">        </span><br><span class="line"><span class="built_in">print</span>(flag1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag1)-<span class="number">1</span>):</span><br><span class="line">    flag += base[base_change.find(flag1[i])]</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(flag))</span><br></pre></td></tr></table></figure>

<h3 id="gocode"><a href="#gocode" class="headerlink" title="gocode"></a>gocode</h3><p>这个题字节码逆向，还是go的，不过这个go比之前做的友善多了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">main_main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v0; <span class="comment">// rdi</span></span><br><span class="line">  __int64 count; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v3; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 opcode; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 i; <span class="comment">// rsi</span></span><br><span class="line">  _QWORD *v10; <span class="comment">// rax</span></span><br><span class="line">  __int64 v11; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v12; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v13; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v14; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v15; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v16; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v17; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v18; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v19; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v20; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v21; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v22; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v23; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v24; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v25; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v26; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v27; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v28; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v29; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">void</span> **v30; <span class="comment">// [rsp+0h] [rbp-CD0h]</span></span><br><span class="line">  __int64 v31; <span class="comment">// [rsp+8h] [rbp-CC8h]</span></span><br><span class="line">  _QWORD *v32; <span class="comment">// [rsp+20h] [rbp-CB0h]</span></span><br><span class="line">  __int128 v33; <span class="comment">// [rsp+28h] [rbp-CA8h]</span></span><br><span class="line">  __int64 v34; <span class="comment">// [rsp+38h] [rbp-C98h]</span></span><br><span class="line">  __int64 v35; <span class="comment">// [rsp+40h] [rbp-C90h]</span></span><br><span class="line">  _QWORD *v36; <span class="comment">// [rsp+50h] [rbp-C80h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v37; <span class="comment">// [rsp+58h] [rbp-C78h]</span></span><br><span class="line">  __int64 v38; <span class="comment">// [rsp+68h] [rbp-C68h]</span></span><br><span class="line">  __int64 v39; <span class="comment">// [rsp+70h] [rbp-C60h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v40; <span class="comment">// [rsp+78h] [rbp-C58h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v41; <span class="comment">// [rsp+80h] [rbp-C50h] BYREF</span></span><br><span class="line">  __int128 v42[<span class="number">2</span>]; <span class="comment">// [rsp+88h] [rbp-C48h] BYREF</span></span><br><span class="line">  __int64 v43[<span class="number">374</span>]; <span class="comment">// [rsp+A8h] [rbp-C28h] BYREF</span></span><br><span class="line">  __int64 v44; <span class="comment">// [rsp+C58h] [rbp-78h] BYREF</span></span><br><span class="line">  __int64 v45; <span class="comment">// [rsp+C60h] [rbp-70h]</span></span><br><span class="line">  _QWORD v46[<span class="number">2</span>]; <span class="comment">// [rsp+C68h] [rbp-68h] BYREF</span></span><br><span class="line">  _QWORD v47[<span class="number">2</span>]; <span class="comment">// [rsp+C78h] [rbp-58h] BYREF</span></span><br><span class="line">  _QWORD v48[<span class="number">2</span>]; <span class="comment">// [rsp+C88h] [rbp-48h] BYREF</span></span><br><span class="line">  _QWORD v49[<span class="number">2</span>]; <span class="comment">// [rsp+C98h] [rbp-38h] BYREF</span></span><br><span class="line">  _QWORD v50[<span class="number">2</span>]; <span class="comment">// [rsp+CA8h] [rbp-28h] BYREF</span></span><br><span class="line">  _QWORD v51[<span class="number">2</span>]; <span class="comment">// [rsp+CB8h] [rbp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int64)&amp;v41 &lt;= *(_QWORD *)(*(_QWORD *)NtCurrentTeb()-&gt;NtTib.ArbitraryUserPointer + <span class="number">16LL</span>) )</span><br><span class="line">    runtime_morestack_noctxt();</span><br><span class="line">  qmemcpy(v43, <span class="string">&quot;\n&quot;</span>, <span class="keyword">sizeof</span>(v43));</span><br><span class="line">  v0 = (<span class="type">unsigned</span> __int64)&amp;v44;</span><br><span class="line">  <span class="built_in">memset</span>(v42, <span class="number">0</span>, <span class="keyword">sizeof</span>(v42));</span><br><span class="line">  count = <span class="number">0LL</span>;</span><br><span class="line">  v2 = <span class="number">0LL</span>;</span><br><span class="line">  v3 = <span class="number">0LL</span>;</span><br><span class="line">  v4 = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)count &gt;= <span class="number">0x176</span> )</span><br><span class="line">      runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">    v37 = v2;</span><br><span class="line">    v44 = v3;</span><br><span class="line">    v38 = count;</span><br><span class="line">    opcode = v43[count];</span><br><span class="line">    <span class="keyword">if</span> ( opcode &lt;= <span class="number">0xC</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( opcode &gt; <span class="number">0xE</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">switch</span> ( opcode )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xF</span>uLL:</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">            runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">          v22 = v43[count + <span class="number">1</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v22 &gt;= <span class="number">4</span> )</span><br><span class="line">            runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">            runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">          v23 = v43[count + <span class="number">2</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v23 &gt;= <span class="number">4</span> )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_97;</span><br><span class="line">          v24 = *((_QWORD *)v42 + v23);</span><br><span class="line">          <span class="keyword">if</span> ( !v24 )</span><br><span class="line">          &#123;</span><br><span class="line">            v31 = runtime_panicdivide(v30);</span><br><span class="line">LABEL_97:</span><br><span class="line">            runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">          &#125;</span><br><span class="line">          v0 = v3;</span><br><span class="line">          *((_QWORD *)v42 + v22) /= v24;</span><br><span class="line">          count += <span class="number">3LL</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xAA</span>uLL:</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">            runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">          v25 = v43[count + <span class="number">1</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v25 &gt;= <span class="number">4</span> )</span><br><span class="line">            runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">          v26 = *((_QWORD *)v42 + v25);</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">            runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">          v27 = v43[count + <span class="number">2</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v27 &gt;= <span class="number">4</span> )</span><br><span class="line">            runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">          v0 = *((_QWORD *)v42 + v27);</span><br><span class="line">          <span class="keyword">if</span> ( v0 != v26 )</span><br><span class="line">          &#123;</span><br><span class="line">            v47[<span class="number">0</span>] = &amp;unk_D62740;</span><br><span class="line">            v47[<span class="number">1</span>] = &amp;off_DA0B58;</span><br><span class="line">            fmt_Fprintln((__int64)&amp;off_DA2218, qword_E23428, (__int64)v47, <span class="number">1LL</span>, <span class="number">1LL</span>, v33, *((__int64 *)&amp;v33 + <span class="number">1</span>), v34);</span><br><span class="line">            v31 = os_Exit(<span class="number">0LL</span>);</span><br><span class="line">            count = v38;</span><br><span class="line">            v2 = v37;</span><br><span class="line">            v3 = v44;</span><br><span class="line">          &#125;</span><br><span class="line">          count += <span class="number">3LL</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xBB</span>uLL:</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">            runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">          v28 = v43[count + <span class="number">2</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v28 &gt;= v2 )</span><br><span class="line">            runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">          v29 = *(_QWORD *)(v3 + <span class="number">8</span> * v28);</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">            runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">          v0 = v43[count + <span class="number">1</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v0 &gt;= <span class="number">4</span> )</span><br><span class="line">            runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">          *((_QWORD *)v42 + v0) = v29;</span><br><span class="line">          count += <span class="number">3LL</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( opcode == <span class="number">13</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v18 = v43[count + <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v18 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v19 = v43[count + <span class="number">2</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v19 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      v0 = *((_QWORD *)v42 + v18) - *((_QWORD *)v42 + v19);</span><br><span class="line">      *((_QWORD *)v42 + v18) = v0;</span><br><span class="line">      count += <span class="number">3LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v20 = v43[count + <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v20 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v21 = v43[count + <span class="number">2</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v21 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      v0 = *((_QWORD *)v42 + v21) * *((_QWORD *)v42 + v20);</span><br><span class="line">      *((_QWORD *)v42 + v20) = v0;</span><br><span class="line">      count += <span class="number">3LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_12:</span><br><span class="line">    <span class="keyword">if</span> ( count &gt;= <span class="number">374</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v46[<span class="number">0</span>] = &amp;unk_D62740;</span><br><span class="line">      v46[<span class="number">1</span>] = &amp;off_DA0B78;</span><br><span class="line">      fmt_Fprintln((__int64)&amp;off_DA2218, qword_E23428, (__int64)v46, <span class="number">1LL</span>, <span class="number">1LL</span>, v33, *((__int64 *)&amp;v33 + <span class="number">1</span>), v34);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( opcode &lt;= <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( opcode == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v6 = v43[count + <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v6 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v7 = v43[count + <span class="number">2</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v7 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      v0 = *((_QWORD *)v42 + v7) ^ *((_QWORD *)v42 + v6);</span><br><span class="line">      *((_QWORD *)v42 + v6) = v0;</span><br><span class="line">      count += <span class="number">3LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( opcode == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v0 = v43[count + <span class="number">2</span>];</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v8 = v43[count + <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v8 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      *((_QWORD *)v42 + v8) = v0;</span><br><span class="line">      count += <span class="number">3LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( opcode != <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( opcode == <span class="number">11</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0LL</span>; ; i = v41 )</span><br><span class="line">      &#123;</span><br><span class="line">        v0 = qword_E23C38;</span><br><span class="line">        <span class="keyword">if</span> ( (__int64)i &gt;= qword_E23C38 )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> ( i + <span class="number">2</span> &gt; qword_E23C38 )</span><br><span class="line">          runtime_panicSliceAlen((__int64)v30, v31);</span><br><span class="line">        <span class="keyword">if</span> ( i &gt; i + <span class="number">2</span> )</span><br><span class="line">          runtime_panicSliceB((__int64)v30, v31);</span><br><span class="line">        v41 = i + <span class="number">2</span>;</span><br><span class="line">        v45 = v3;</span><br><span class="line">        v40 = v4;</span><br><span class="line">        v39 = v2;</span><br><span class="line">        v34 = strconv_ParseUint(qword_E23C30 + i, <span class="number">2LL</span>, <span class="number">16LL</span>, <span class="number">32LL</span>, (__int64)v32, v33);</span><br><span class="line">        v10 = v32;</span><br><span class="line">        <span class="keyword">if</span> ( (_QWORD)v33 )</span><br><span class="line">        &#123;</span><br><span class="line">          v48[<span class="number">0</span>] = &amp;unk_D62740;</span><br><span class="line">          v48[<span class="number">1</span>] = &amp;off_DA0B68;</span><br><span class="line">          fmt_Fprintln((__int64)&amp;off_DA2218, qword_E23428, (__int64)v48, <span class="number">1LL</span>, <span class="number">1LL</span>, v33, *((__int64 *)&amp;v33 + <span class="number">1</span>), v34);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        v11 = v39;</span><br><span class="line">        v12 = v39 + <span class="number">1</span>;</span><br><span class="line">        v13 = v40;</span><br><span class="line">        <span class="keyword">if</span> ( v40 &lt; v39 + <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v36 = v32;</span><br><span class="line">          runtime_growslice((__int64)<span class="string">&quot;\b&quot;</span>, v45, v39, v40, v39 + <span class="number">1</span>, <span class="number">0LL</span>, *((__int64 *)&amp;v33 + <span class="number">1</span>), v34);</span><br><span class="line">          v14 = v33;</span><br><span class="line">          v13 = v34;</span><br><span class="line">          v12 = *((_QWORD *)&amp;v33 + <span class="number">1</span>) + <span class="number">1LL</span>;</span><br><span class="line">          v10 = v36;</span><br><span class="line">          v11 = v39;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          v14 = v45;</span><br><span class="line">        &#125;</span><br><span class="line">        *(_QWORD *)(v14 + <span class="number">8</span> * v11) = v10;</span><br><span class="line">        count = v38;</span><br><span class="line">        v4 = v13;</span><br><span class="line">        v3 = v14;</span><br><span class="line">        v2 = v12;</span><br><span class="line">      &#125;</span><br><span class="line">      ++count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( opcode == <span class="number">12</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v15 = v43[count + <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v15 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v16 = v43[count + <span class="number">2</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v16 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      v0 = *((_QWORD *)v42 + v16) + *((_QWORD *)v42 + v15);</span><br><span class="line">      *((_QWORD *)v42 + v15) = v0;</span><br><span class="line">      count += <span class="number">3LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">  &#125;</span><br><span class="line">  v51[<span class="number">0</span>] = &amp;unk_D62740;</span><br><span class="line">  v51[<span class="number">1</span>] = &amp;off_DA0B48;</span><br><span class="line">  v35 = fmt_Fprintln((__int64)&amp;off_DA2218, qword_E23428, (__int64)v51, <span class="number">1LL</span>, <span class="number">1LL</span>, v33, *((__int64 *)&amp;v33 + <span class="number">1</span>), v34);</span><br><span class="line">  v50[<span class="number">0</span>] = <span class="string">&quot;\b&quot;</span>;</span><br><span class="line">  v50[<span class="number">1</span>] = &amp;qword_E23C30;</span><br><span class="line">  v30 = &amp;off_DA21F8;</span><br><span class="line">  v31 = qword_E23420;</span><br><span class="line">  v32 = v50;</span><br><span class="line">  *(_QWORD *)&amp;v33 = <span class="number">1LL</span>;</span><br><span class="line">  *((_QWORD *)&amp;v33 + <span class="number">1</span>) = <span class="number">1LL</span>;</span><br><span class="line">  fmt_Fscanf(v0, (__int64)v50, <span class="string">&quot;%37s&quot;</span>, &amp;qword_E23C30);</span><br><span class="line">  <span class="keyword">if</span> ( v35 )</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span> ( qword_E23C38 == <span class="number">37</span> &amp;&amp; *(_DWORD *)qword_E23C30 == <span class="string">&#x27;&#123;LCP&#x27;</span> &amp;&amp; *(_BYTE *)(qword_E23C30 + <span class="number">36</span>) == <span class="number">125</span> )<span class="comment">// 检测长度和PCL&#123;&#125;</span></span><br><span class="line">  &#123;</span><br><span class="line">    qword_E23C38 = <span class="number">32LL</span>;</span><br><span class="line">    <span class="keyword">if</span> ( dword_E66C60 )</span><br><span class="line">    &#123;</span><br><span class="line">      v0 = (<span class="type">unsigned</span> __int64)&amp;qword_E23C30;</span><br><span class="line">      runtime_gcWriteBarrierBX(&amp;qword_E23C30, v50, v17);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      qword_E23C30 += <span class="number">4LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    count = v38 + <span class="number">1</span>;</span><br><span class="line">    v2 = v37;</span><br><span class="line">    v3 = v44;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">  &#125;</span><br><span class="line">  v49[<span class="number">0</span>] = &amp;unk_D62740;</span><br><span class="line">  v49[<span class="number">1</span>] = &amp;off_DA0B58;</span><br><span class="line">  fmt_Fprintln((__int64)&amp;off_DA2218, qword_E23428, (__int64)v49, <span class="number">1LL</span>, <span class="number">1LL</span>, <span class="number">1LL</span>, <span class="number">1LL</span>, v34);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>指令集都在v43里，我们可以dump出来的，发现也就是几种指令，三个一组。前两个0xa和0xb是为了验证输入格式是否正确</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xBB</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0xBB</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0xBB</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x11B</span>, <span class="number">0xAA</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0xBB</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0xBB</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x7901</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0xBB</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x63</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x1FF6</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xBB</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xBB</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x21E</span>, <span class="number">0xAA</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0xBB</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x3331</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0xBB</span>, <span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0xBB</span>, <span class="number">0x02</span>, <span class="number">0x06</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x63</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x68</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x152</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x33</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x63</span>, <span class="number">0x0E</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x441</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x63</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x6B</span>, <span class="number">0x0C</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x10E</span>, <span class="number">0xAA</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x9E</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0xBB</span>, <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0xBB</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0xBB</span>, <span class="number">0x03</span>, <span class="number">0x0B</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x36CE</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0xBB</span>, <span class="number">0x03</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x682D</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0xBB</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x63</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x15</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0xBB</span>, <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0xBB</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x1AE</span>, <span class="number">0xAA</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0xBB</span>, <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x08</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x3709</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x0C</span>, <span class="number">0xBB</span>, <span class="number">0x01</span>, <span class="number">0x0D</span>, <span class="number">0xBB</span>, <span class="number">0x02</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x63</span>, <span class="number">0x0C</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x68</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0xFA</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x1E</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x63</span>, <span class="number">0x0E</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x18C</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x63</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x6B</span>, <span class="number">0x0C</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x83</span>, <span class="number">0xAA</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x47</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0xAA</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">0xF</span>uLL:</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">            runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">          v22 = v43[count + <span class="number">1</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v22 &gt;= <span class="number">4</span> )</span><br><span class="line">            runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">            runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">          v23 = v43[count + <span class="number">2</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v23 &gt;= <span class="number">4</span> )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_97;</span><br><span class="line">          v24 = *((_QWORD *)v42 + v23);</span><br><span class="line">          <span class="keyword">if</span> ( !v24 )</span><br><span class="line">          &#123;</span><br><span class="line">            v31 = runtime_panicdivide(v30);</span><br><span class="line">LABEL_97:</span><br><span class="line">            runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">          &#125;</span><br><span class="line">          v0 = v3;</span><br><span class="line">          *((_QWORD *)v42 + v22) /= v24;</span><br><span class="line">          count += <span class="number">3LL</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>

<p>如果opcode &#x3D;&#x3D; 0xf，那么后两位操作数进行一个相除</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">0xAA</span>uLL:</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">            runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">          v25 = v43[count + <span class="number">1</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v25 &gt;= <span class="number">4</span> )</span><br><span class="line">            runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">          v26 = *((_QWORD *)v42 + v25);</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">            runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">          v27 = v43[count + <span class="number">2</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v27 &gt;= <span class="number">4</span> )</span><br><span class="line">            runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">          v0 = *((_QWORD *)v42 + v27);</span><br><span class="line">          <span class="keyword">if</span> ( v0 != v26 )</span><br><span class="line">          &#123;</span><br><span class="line">            v47[<span class="number">0</span>] = &amp;unk_D62740;</span><br><span class="line">            v47[<span class="number">1</span>] = &amp;off_DA0B58;</span><br><span class="line">            fmt_Fprintln((__int64)&amp;off_DA2218, qword_E23428, (__int64)v47, <span class="number">1LL</span>, <span class="number">1LL</span>, v33, *((__int64 *)&amp;v33 + <span class="number">1</span>), v34);</span><br><span class="line">            v31 = os_Exit(<span class="number">0LL</span>);</span><br><span class="line">            count = v38;</span><br><span class="line">            v2 = v37;</span><br><span class="line">            v3 = v44;</span><br><span class="line">          &#125;</span><br><span class="line">          count += <span class="number">3LL</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>

<p>如果opcode &#x3D;&#x3D; 0xAA，就退出程序</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">0xBB</span>uLL:</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">            runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">          v28 = v43[count + <span class="number">2</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v28 &gt;= v2 )</span><br><span class="line">            runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">          v29 = *(_QWORD *)(v3 + <span class="number">8</span> * v28);</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">            runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">          v0 = v43[count + <span class="number">1</span>];</span><br><span class="line">          <span class="keyword">if</span> ( v0 &gt;= <span class="number">4</span> )</span><br><span class="line">            runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">          *((_QWORD *)v42 + v0) = v29;</span><br><span class="line">          count += <span class="number">3LL</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>

<p>如果opcode &#x3D;&#x3D; 0xbb，是一个赋值reg[0] &#x3D; input[0]</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ( opcode == <span class="number">13</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v18 = v43[count + <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v18 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v19 = v43[count + <span class="number">2</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v19 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      v0 = *((_QWORD *)v42 + v18) - *((_QWORD *)v42 + v19);</span><br><span class="line">      *((_QWORD *)v42 + v18) = v0;</span><br><span class="line">      count += <span class="number">3LL</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>opcode &#x3D;&#x3D; 13，是一个减法，第一个操作数减去第二个操作数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( opcode &lt;= <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( opcode == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v6 = v43[count + <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v6 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v7 = v43[count + <span class="number">2</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v7 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      v0 = *((_QWORD *)v42 + v7) ^ *((_QWORD *)v42 + v6);</span><br><span class="line">      *((_QWORD *)v42 + v6) = v0;</span><br><span class="line">      count += <span class="number">3LL</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>如果opcode &#x3D;&#x3D; 1，那么是个异或</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> ( opcode == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">2</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v0 = v43[count + <span class="number">2</span>];</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)(count + <span class="number">1</span>) &gt;= <span class="number">0x176</span> )</span><br><span class="line">        runtime_panicIndex((__int64)v30, v31);</span><br><span class="line">      v8 = v43[count + <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v8 &gt;= <span class="number">4</span> )</span><br><span class="line">        runtime_panicIndexU((__int64)v30, v31);</span><br><span class="line">      *((_QWORD *)v42 + v8) = v0;</span><br><span class="line">      count += <span class="number">3LL</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>如果opcode &#x3D;&#x3D; 2，是个赋值等于第二个操作数</p>
<p>用脚本恢复一下，发现可以用z3解决</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">opcode = [<span class="number">187</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">187</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">187</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">187</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">283</span>, <span class="number">170</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">187</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">187</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">30977</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">187</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">99</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">187</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">8182</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">187</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">187</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">187</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">542</span>, <span class="number">170</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">187</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">187</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">13105</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">187</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">187</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">187</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">99</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">104</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">338</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">51</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">99</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1089</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">99</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">107</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">270</span>, <span class="number">170</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">158</span>, <span class="number">187</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">187</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">187</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">187</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">187</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">14030</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">187</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">187</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">26669</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">187</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">99</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">187</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">21</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">187</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">187</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">187</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">430</span>, <span class="number">170</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">187</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">187</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">14089</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">187</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">187</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">187</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">99</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">104</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">250</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">30</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">99</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">396</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">99</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">107</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">131</span>, <span class="number">170</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">71</span>, <span class="number">187</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">170</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(opcode), <span class="number">3</span>):</span><br><span class="line">     op = opcode[i]</span><br><span class="line">     num1 = opcode[i + <span class="number">1</span>]</span><br><span class="line">     num2 = opcode[i + <span class="number">2</span>]</span><br><span class="line">     <span class="keyword">if</span> op == <span class="number">0xbb</span>:</span><br><span class="line">         <span class="built_in">print</span>(<span class="string">f&quot;buf[<span class="subst">&#123;num1&#125;</span>] = input[<span class="subst">&#123;num2&#125;</span>]&quot;</span>)</span><br><span class="line">     <span class="keyword">elif</span> op == <span class="number">0xaa</span>:</span><br><span class="line">         <span class="built_in">print</span>(<span class="string">f&quot;if buf[<span class="subst">&#123;num1&#125;</span>] != buf[<span class="subst">&#123;num2&#125;</span>] goto exit&quot;</span>)</span><br><span class="line">     <span class="keyword">elif</span> op == <span class="number">0xf</span>:</span><br><span class="line">         <span class="built_in">print</span>(<span class="string">f&quot;buf[<span class="subst">&#123;num1&#125;</span>] /= buf[<span class="subst">&#123;num2&#125;</span>]&quot;</span>)</span><br><span class="line">     <span class="keyword">elif</span> op == <span class="number">0xd</span>:</span><br><span class="line">         <span class="built_in">print</span>(<span class="string">f&quot;buf[<span class="subst">&#123;num1&#125;</span>] -= buf[<span class="subst">&#123;num2&#125;</span>]&quot;</span>)</span><br><span class="line">     <span class="keyword">elif</span> op == <span class="number">0xe</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;buf[<span class="subst">&#123;num1&#125;</span>] *= buf[<span class="subst">&#123;num2&#125;</span>]&quot;</span>)</span><br><span class="line">     <span class="keyword">elif</span> op == <span class="number">0x1</span>:</span><br><span class="line">         <span class="built_in">print</span>(<span class="string">f&quot;buf[<span class="subst">&#123;num1&#125;</span>] ^= buf[<span class="subst">&#123;num2&#125;</span>]&quot;</span>)</span><br><span class="line">     <span class="keyword">elif</span> op == <span class="number">0x2</span>:</span><br><span class="line">         <span class="built_in">print</span>(<span class="string">f&quot;buf[<span class="subst">&#123;num1&#125;</span>] = <span class="subst">&#123;num2&#125;</span>&quot;</span>)</span><br><span class="line">     <span class="keyword">elif</span> op == <span class="number">0xc</span>:</span><br><span class="line">         <span class="built_in">print</span>(<span class="string">f&quot;buf[<span class="subst">&#123;num1&#125;</span>] += buf[<span class="subst">&#123;num2&#125;</span>]&quot;</span>)</span><br><span class="line">     <span class="keyword">else</span>:</span><br><span class="line">         <span class="built_in">print</span>(<span class="string">&quot;gg&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[0]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="selector-tag">input</span><span class="selector-attr">[1]</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> = <span class="selector-tag">input</span><span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="selector-tag">input</span><span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> += buf<span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> = <span class="number">283</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[1]</span> != buf<span class="selector-attr">[2]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="selector-tag">input</span><span class="selector-attr">[1]</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> = <span class="selector-tag">input</span><span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> += buf<span class="selector-attr">[1]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> *= buf<span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> -= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> = <span class="number">30977</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[2]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[2]</span> = <span class="selector-tag">input</span><span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="number">99</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> ^= buf<span class="selector-attr">[0]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[0]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> *= buf<span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> -= buf<span class="selector-attr">[1]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> += buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="number">8182</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[1]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="selector-tag">input</span><span class="selector-attr">[1]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[0]</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> = <span class="selector-tag">input</span><span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> += buf<span class="selector-attr">[0]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> += buf<span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> += buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="number">542</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[1]</span> != buf<span class="selector-attr">[0]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="selector-tag">input</span><span class="selector-attr">[1]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[0]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> *= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> -= buf<span class="selector-attr">[1]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> += buf<span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">13105</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[3]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[4]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="selector-tag">input</span><span class="selector-attr">[5]</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> = <span class="selector-tag">input</span><span class="selector-attr">[6]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">99</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> += buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">104</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> ^= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">338</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[3]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">51</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> -= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">99</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> *= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="number">1089</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[1]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">99</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> ^= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">107</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> += buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="number">270</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[2]</span> != buf<span class="selector-attr">[1]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="number">158</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[7]</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[1]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[8]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="selector-tag">input</span><span class="selector-attr">[9]</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> = <span class="selector-tag">input</span><span class="selector-attr">[10]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="selector-tag">input</span><span class="selector-attr">[11]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> *= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">14030</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[3]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[8]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="selector-tag">input</span><span class="selector-attr">[11]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> += buf<span class="selector-attr">[1]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> *= buf<span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> -= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> = <span class="number">26669</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[2]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[2]</span> = <span class="selector-tag">input</span><span class="selector-attr">[10]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="number">99</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> ^= buf<span class="selector-attr">[0]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[8]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> *= buf<span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> -= buf<span class="selector-attr">[1]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> += buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="number">21</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[1]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="selector-tag">input</span><span class="selector-attr">[9]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[8]</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> = <span class="selector-tag">input</span><span class="selector-attr">[10]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> += buf<span class="selector-attr">[0]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> += buf<span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> += buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="number">430</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[1]</span> != buf<span class="selector-attr">[0]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="selector-tag">input</span><span class="selector-attr">[9]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[8]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> *= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> -= buf<span class="selector-attr">[1]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> += buf<span class="selector-attr">[2]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">14089</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[3]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[12]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="selector-tag">input</span><span class="selector-attr">[13]</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> = <span class="selector-tag">input</span><span class="selector-attr">[14]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">99</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> += buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">104</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> ^= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">250</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[3]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">30</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> -= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">99</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> *= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="number">396</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[1]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">99</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> ^= buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[3]</span> = <span class="number">107</span></span><br><span class="line">buf<span class="selector-attr">[2]</span> += buf<span class="selector-attr">[3]</span></span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="number">131</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[2]</span> != buf<span class="selector-attr">[1]</span> goto exit</span><br><span class="line">buf<span class="selector-attr">[1]</span> = <span class="number">71</span></span><br><span class="line">buf<span class="selector-attr">[0]</span> = <span class="selector-tag">input</span><span class="selector-attr">[15]</span></span><br><span class="line"><span class="keyword">if</span> buf<span class="selector-attr">[0]</span> != buf<span class="selector-attr">[1]</span> goto exit</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span>*</span><br><span class="line">flag = [BitVec(<span class="string">&quot;x%d&quot;</span> % i ,<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">s.add(flag[<span class="number">1</span>] + flag[<span class="number">2</span>] == <span class="number">283</span>)</span><br><span class="line">s.add((((flag[<span class="number">0</span>] + flag[<span class="number">1</span>]) * flag[<span class="number">2</span>]) - flag[<span class="number">3</span>]) == <span class="number">30977</span>)</span><br><span class="line">s.add((flag[<span class="number">0</span>] * (flag[<span class="number">2</span>] ^ <span class="number">99</span>)) - flag[<span class="number">1</span>] + flag[<span class="number">3</span>] == <span class="number">8182</span>)</span><br><span class="line">s.add((flag[<span class="number">0</span>] + flag[<span class="number">1</span>] + flag[<span class="number">2</span>] + flag[<span class="number">3</span>]) == <span class="number">542</span>)</span><br><span class="line">s.add(((flag[<span class="number">0</span>] * flag[<span class="number">3</span>]) - flag[<span class="number">1</span>] + flag[<span class="number">2</span>]) == <span class="number">13105</span>)</span><br><span class="line"></span><br><span class="line">s.add((flag[<span class="number">4</span>] + <span class="number">99</span>) ^ <span class="number">104</span> == <span class="number">338</span>)</span><br><span class="line">s.add((flag[<span class="number">5</span>] - <span class="number">51</span>) * <span class="number">99</span> == <span class="number">1089</span>)</span><br><span class="line">s.add((flag[<span class="number">6</span>] ^ <span class="number">99</span>) + <span class="number">107</span> == <span class="number">270</span>)</span><br><span class="line">s.add(flag[<span class="number">7</span>] == <span class="number">158</span>)</span><br><span class="line">s.add(flag[<span class="number">8</span>] * flag[<span class="number">11</span>] == <span class="number">14030</span>)</span><br><span class="line">s.add((flag[<span class="number">8</span>] + flag[<span class="number">9</span>]) * flag[<span class="number">10</span>] - flag[<span class="number">11</span>] == <span class="number">26669</span>)</span><br><span class="line">s.add(flag[<span class="number">8</span>] * (flag[<span class="number">10</span>] ^ <span class="number">99</span>) - flag[<span class="number">9</span>] + flag[<span class="number">11</span>] == <span class="number">21</span>)</span><br><span class="line">s.add((flag[<span class="number">8</span>] + flag[<span class="number">9</span>] + flag[<span class="number">10</span>] + flag[<span class="number">11</span>]) == <span class="number">430</span>)</span><br><span class="line">s.add(flag[<span class="number">8</span>] * flag[<span class="number">11</span>] - flag[<span class="number">9</span>] + flag[<span class="number">10</span>] == <span class="number">14089</span>)</span><br><span class="line">s.add((flag[<span class="number">12</span>] + <span class="number">99</span>) ^ <span class="number">104</span> == <span class="number">250</span>)</span><br><span class="line">s.add((flag[<span class="number">13</span>] - <span class="number">30</span>) * <span class="number">99</span> == <span class="number">396</span>)</span><br><span class="line">s.add((flag[<span class="number">14</span>] ^ <span class="number">99</span>) + <span class="number">107</span> == <span class="number">131</span>)</span><br><span class="line">s.add(flag[<span class="number">15</span>] == <span class="number">71</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    model = s.model()</span><br><span class="line">    <span class="built_in">print</span>(model)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;unsat&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>得到的结果取0xff然后拼接就对了</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">x</span><span class="number">12</span> <span class="operator">=</span> <span class="number">47</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">9</span> <span class="operator">=</span> <span class="number">40</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">4</span> <span class="operator">=</span> <span class="number">215</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">6</span> <span class="operator">=</span> <span class="number">192</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">8</span> <span class="operator">=</span> <span class="number">230</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">2</span> <span class="operator">=</span> <span class="number">32847</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">1</span> <span class="operator">=</span> <span class="number">32972</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">10</span> <span class="operator">=</span> <span class="number">99</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">11</span> <span class="operator">=</span> <span class="number">61</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">0</span> <span class="operator">=</span> <span class="number">189</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">3</span> <span class="operator">=</span> <span class="number">70</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">15</span> <span class="operator">=</span> <span class="number">71</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">13</span> <span class="operator">=</span> <span class="number">34</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">7</span> <span class="operator">=</span> <span class="number">158</span><span class="punctuation">,</span></span><br><span class="line"> <span class="keyword">x</span><span class="number">5</span> <span class="operator">=</span> <span class="number">62</span>]</span><br></pre></td></tr></table></figure>

<p>PCL{bdcc4f46d73ec09ee628633d2f227b47}</p>
<h2 id="dsctf"><a href="#dsctf" class="headerlink" title="dsctf"></a>dsctf</h2><h3 id="catchme"><a href="#catchme" class="headerlink" title="catchme"></a>catchme</h3><p>这题太折磨了，其实逻辑巨简单，就是一个aes和base64，，但其中的密文和密钥全部要先进行异或。当时看密文感觉不对，就想着动调，但里面反调试太多了，现在看着其实交叉引用就能定位到，只是简单的xor。</p>
<p>jadx看到关键函数是check函数，直接在so文件搜索不到，应该是JNI <em>OnLoad里使用RegisterNatives注册check sub</em> B2A4</p>
<p>jni里，本来以为 sub_AEC8是关键函数，但后面那个aes数据解密出来是：Congratulations,but tryagain?</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220718114127868.png" alt="image-20220718114127868"></p>
<p>通过交叉引用发现，key和对比数据都进行了异或</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220718114211385.png" alt="image-20220718114211385"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">key = <span class="string">&quot;\x24&lt;=76!5&amp;?72*rrrrS&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(key[i]) ^ <span class="number">0x53</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">data = <span class="string">&quot;&quot;</span></span><br><span class="line">data_encode = [<span class="number">0x4F</span>, <span class="number">0x1C</span>, <span class="number">0x36</span>, <span class="number">0x49</span>, <span class="number">0x09</span>, <span class="number">0x3A</span>, <span class="number">0x3F</span>, <span class="number">0x07</span>, <span class="number">0x4D</span>, <span class="number">0x3D</span>, <span class="number">0x22</span>, <span class="number">0x39</span>, <span class="number">0x00</span>, <span class="number">0x0A</span>, <span class="number">0x22</span>, <span class="number">0x25</span>, <span class="number">0x06</span>, <span class="number">0x09</span>, <span class="number">0x01</span>, <span class="number">0x20</span>, <span class="number">0x4A</span>, <span class="number">0x1B</span>, <span class="number">0x51</span>, <span class="number">0x51</span>, <span class="number">0x6C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data_encode)):</span><br><span class="line">    data += <span class="built_in">chr</span>(data_encode[i] ^ <span class="number">0x6c</span>)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line">base = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">diy_base = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&amp;*()+/&quot;</span></span><br><span class="line">s = <span class="string">&quot;&quot;&quot;#pZ%eVSk!QNUlfNIjemL&amp;w==&quot;&quot;&quot;</span></span><br><span class="line">ss = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s) - <span class="number">2</span>):</span><br><span class="line">    ss += base[diy_base.find(s[i])]</span><br><span class="line">ss += <span class="string">&quot;==&quot;</span></span><br><span class="line">a = base64.b64decode(ss)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">hex</span>, a)))</span><br><span class="line">x = [<span class="number">0</span>] * <span class="built_in">len</span>(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    x[i] = <span class="built_in">hex</span>(<span class="built_in">ord</span>(flag[i]))</span><br><span class="line"><span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure>

<p>之后aes解密</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">	AES_CYPHER_128,</span><br><span class="line">	AES_CYPHER_192,</span><br><span class="line">	AES_CYPHER_256,</span><br><span class="line">&#125; AES_CYPHER_T;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Encryption Rounds</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> g_aes_key_bits[] = &#123;</span><br><span class="line">	<span class="comment">/* AES_CYPHER_128 */</span> <span class="number">128</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_192 */</span> <span class="number">192</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_256 */</span> <span class="number">256</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> g_aes_rounds[] = &#123;</span><br><span class="line">	<span class="comment">/* AES_CYPHER_128 */</span>  <span class="number">10</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_192 */</span>  <span class="number">12</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_256 */</span>  <span class="number">14</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> g_aes_nk[] = &#123;</span><br><span class="line">	<span class="comment">/* AES_CYPHER_128 */</span>  <span class="number">4</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_192 */</span>  <span class="number">6</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_256 */</span>  <span class="number">8</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> g_aes_nb[] = &#123;</span><br><span class="line">	<span class="comment">/* AES_CYPHER_128 */</span>  <span class="number">4</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_192 */</span>  <span class="number">4</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_256 */</span>  <span class="number">4</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* aes Rcon:</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* WARNING: Rcon is designed starting from 1 to 15, not 0 to 14.</span></span><br><span class="line"><span class="comment">*          FIPS-197 Page 9: &quot;note that i starts at 1, not 0&quot;</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* i    |   0     1     2     3     4     5     6     7     8     9    10    11    12    13    14</span></span><br><span class="line"><span class="comment">* -----+------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*      | [01]  [02]  [04]  [08]  [10]  [20]  [40]  [80]  [1b]  [36]  [6c]  [d8]  [ab]  [4d]  [9a]</span></span><br><span class="line"><span class="comment">* RCON | [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]</span></span><br><span class="line"><span class="comment">*      | [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]</span></span><br><span class="line"><span class="comment">*      | [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> g_aes_rcon[] = &#123;</span><br><span class="line">	<span class="number">0x01000000</span>, <span class="number">0x02000000</span>, <span class="number">0x04000000</span>, <span class="number">0x08000000</span>, <span class="number">0x10000000</span>, <span class="number">0x20000000</span>, <span class="number">0x40000000</span>, <span class="number">0x80000000</span>,</span><br><span class="line">	<span class="number">0x1b000000</span>, <span class="number">0x36000000</span>, <span class="number">0x6c000000</span>, <span class="number">0xd8000000</span>, <span class="number">0xab000000</span>, <span class="number">0xed000000</span>, <span class="number">0x9a000000</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* aes sbox and invert-sbox</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint8_t</span> g_aes_sbox[<span class="number">256</span>] = &#123;</span><br><span class="line">	<span class="comment">/* 0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F  */</span></span><br><span class="line">	<span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span>,</span><br><span class="line">	<span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>, <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>,</span><br><span class="line">	<span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>, <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">	<span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span>,</span><br><span class="line">	<span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span>,</span><br><span class="line">	<span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>, <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span>,</span><br><span class="line">	<span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span>,</span><br><span class="line">	<span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>, <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span>,</span><br><span class="line">	<span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">	<span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span>,</span><br><span class="line">	<span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span>,</span><br><span class="line">	<span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>, <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span>,</span><br><span class="line">	<span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>, <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span>,</span><br><span class="line">	<span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span>,</span><br><span class="line">	<span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span>,</span><br><span class="line">	<span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint8_t</span> g_inv_sbox[<span class="number">256</span>] = &#123;</span><br><span class="line">	<span class="comment">/* 0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F  */</span></span><br><span class="line">	<span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6a</span>, <span class="number">0xd5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xa5</span>, <span class="number">0x38</span>, <span class="number">0xbf</span>, <span class="number">0x40</span>, <span class="number">0xa3</span>, <span class="number">0x9e</span>, <span class="number">0x81</span>, <span class="number">0xf3</span>, <span class="number">0xd7</span>, <span class="number">0xfb</span>,</span><br><span class="line">	<span class="number">0x7c</span>, <span class="number">0xe3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9b</span>, <span class="number">0x2f</span>, <span class="number">0xff</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8e</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xc4</span>, <span class="number">0xde</span>, <span class="number">0xe9</span>, <span class="number">0xcb</span>,</span><br><span class="line">	<span class="number">0x54</span>, <span class="number">0x7b</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xa6</span>, <span class="number">0xc2</span>, <span class="number">0x23</span>, <span class="number">0x3d</span>, <span class="number">0xee</span>, <span class="number">0x4c</span>, <span class="number">0x95</span>, <span class="number">0x0b</span>, <span class="number">0x42</span>, <span class="number">0xfa</span>, <span class="number">0xc3</span>, <span class="number">0x4e</span>,</span><br><span class="line">	<span class="number">0x08</span>, <span class="number">0x2e</span>, <span class="number">0xa1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xd9</span>, <span class="number">0x24</span>, <span class="number">0xb2</span>, <span class="number">0x76</span>, <span class="number">0x5b</span>, <span class="number">0xa2</span>, <span class="number">0x49</span>, <span class="number">0x6d</span>, <span class="number">0x8b</span>, <span class="number">0xd1</span>, <span class="number">0x25</span>,</span><br><span class="line">	<span class="number">0x72</span>, <span class="number">0xf8</span>, <span class="number">0xf6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xd4</span>, <span class="number">0xa4</span>, <span class="number">0x5c</span>, <span class="number">0xcc</span>, <span class="number">0x5d</span>, <span class="number">0x65</span>, <span class="number">0xb6</span>, <span class="number">0x92</span>,</span><br><span class="line">	<span class="number">0x6c</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xfd</span>, <span class="number">0xed</span>, <span class="number">0xb9</span>, <span class="number">0xda</span>, <span class="number">0x5e</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xa7</span>, <span class="number">0x8d</span>, <span class="number">0x9d</span>, <span class="number">0x84</span>,</span><br><span class="line">	<span class="number">0x90</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x00</span>, <span class="number">0x8c</span>, <span class="number">0xbc</span>, <span class="number">0xd3</span>, <span class="number">0x0a</span>, <span class="number">0xf7</span>, <span class="number">0xe4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xb8</span>, <span class="number">0xb3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line">	<span class="number">0xd0</span>, <span class="number">0x2c</span>, <span class="number">0x1e</span>, <span class="number">0x8f</span>, <span class="number">0xca</span>, <span class="number">0x3f</span>, <span class="number">0x0f</span>, <span class="number">0x02</span>, <span class="number">0xc1</span>, <span class="number">0xaf</span>, <span class="number">0xbd</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8a</span>, <span class="number">0x6b</span>,</span><br><span class="line">	<span class="number">0x3a</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4f</span>, <span class="number">0x67</span>, <span class="number">0xdc</span>, <span class="number">0xea</span>, <span class="number">0x97</span>, <span class="number">0xf2</span>, <span class="number">0xcf</span>, <span class="number">0xce</span>, <span class="number">0xf0</span>, <span class="number">0xb4</span>, <span class="number">0xe6</span>, <span class="number">0x73</span>,</span><br><span class="line">	<span class="number">0x96</span>, <span class="number">0xac</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xe7</span>, <span class="number">0xad</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xe2</span>, <span class="number">0xf9</span>, <span class="number">0x37</span>, <span class="number">0xe8</span>, <span class="number">0x1c</span>, <span class="number">0x75</span>, <span class="number">0xdf</span>, <span class="number">0x6e</span>,</span><br><span class="line">	<span class="number">0x47</span>, <span class="number">0xf1</span>, <span class="number">0x1a</span>, <span class="number">0x71</span>, <span class="number">0x1d</span>, <span class="number">0x29</span>, <span class="number">0xc5</span>, <span class="number">0x89</span>, <span class="number">0x6f</span>, <span class="number">0xb7</span>, <span class="number">0x62</span>, <span class="number">0x0e</span>, <span class="number">0xaa</span>, <span class="number">0x18</span>, <span class="number">0xbe</span>, <span class="number">0x1b</span>,</span><br><span class="line">	<span class="number">0xfc</span>, <span class="number">0x56</span>, <span class="number">0x3e</span>, <span class="number">0x4b</span>, <span class="number">0xc6</span>, <span class="number">0xd2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9a</span>, <span class="number">0xdb</span>, <span class="number">0xc0</span>, <span class="number">0xfe</span>, <span class="number">0x78</span>, <span class="number">0xcd</span>, <span class="number">0x5a</span>, <span class="number">0xf4</span>,</span><br><span class="line">	<span class="number">0x1f</span>, <span class="number">0xdd</span>, <span class="number">0xa8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xc7</span>, <span class="number">0x31</span>, <span class="number">0xb1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>,</span><br><span class="line">	<span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7f</span>, <span class="number">0xa9</span>, <span class="number">0x19</span>, <span class="number">0xb5</span>, <span class="number">0x4a</span>, <span class="number">0x0d</span>, <span class="number">0x2d</span>, <span class="number">0xe5</span>, <span class="number">0x7a</span>, <span class="number">0x9f</span>, <span class="number">0x93</span>, <span class="number">0xc9</span>, <span class="number">0x9c</span>, <span class="number">0xef</span>,</span><br><span class="line">	<span class="number">0xa0</span>, <span class="number">0xe0</span>, <span class="number">0x3b</span>, <span class="number">0x4d</span>, <span class="number">0xae</span>, <span class="number">0x2a</span>, <span class="number">0xf5</span>, <span class="number">0xb0</span>, <span class="number">0xc8</span>, <span class="number">0xeb</span>, <span class="number">0xbb</span>, <span class="number">0x3c</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line">	<span class="number">0x17</span>, <span class="number">0x2b</span>, <span class="number">0x04</span>, <span class="number">0x7e</span>, <span class="number">0xba</span>, <span class="number">0x77</span>, <span class="number">0xd6</span>, <span class="number">0x26</span>, <span class="number">0xe1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0c</span>, <span class="number">0x7d</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">aes_sub_sbox</span><span class="params">(<span class="type">uint8_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> g_aes_sbox[val];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">aes_sub_dword</span><span class="params">(<span class="type">uint32_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span> tmp = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	tmp |= ((<span class="type">uint32_t</span>)aes_sub_sbox((<span class="type">uint8_t</span>)((val &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>))) &lt;&lt; <span class="number">0</span>;</span><br><span class="line">	tmp |= ((<span class="type">uint32_t</span>)aes_sub_sbox((<span class="type">uint8_t</span>)((val &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>))) &lt;&lt; <span class="number">8</span>;</span><br><span class="line">	tmp |= ((<span class="type">uint32_t</span>)aes_sub_sbox((<span class="type">uint8_t</span>)((val &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>))) &lt;&lt; <span class="number">16</span>;</span><br><span class="line">	tmp |= ((<span class="type">uint32_t</span>)aes_sub_sbox((<span class="type">uint8_t</span>)((val &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>))) &lt;&lt; <span class="number">24</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">aes_rot_dword</span><span class="params">(<span class="type">uint32_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span> tmp = val;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> (val &gt;&gt; <span class="number">8</span>) | ((tmp &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">24</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">aes_swap_dword</span><span class="params">(<span class="type">uint32_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> (((val &amp; <span class="number">0x000000FF</span>) &lt;&lt; <span class="number">24</span>) |</span><br><span class="line">		((val &amp; <span class="number">0x0000FF00</span>) &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">		((val &amp; <span class="number">0x00FF0000</span>) &gt;&gt; <span class="number">8</span>) |</span><br><span class="line">		((val &amp; <span class="number">0xFF000000</span>) &gt;&gt; <span class="number">24</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* nr: number of rounds</span></span><br><span class="line"><span class="comment">* nb: number of columns comprising the state, nb = 4 dwords (16 bytes)</span></span><br><span class="line"><span class="comment">* nk: number of 32-bit words comprising cipher key, nk = 4, 6, 8 (KeyLength/(4*8))</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_key_expansion</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *key, <span class="type">uint8_t</span> *round)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span> *w = (<span class="type">uint32_t</span> *)round;</span><br><span class="line">	<span class="type">uint32_t</span>  t;</span><br><span class="line">	<span class="type">int</span>      i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		w[i] = *((<span class="type">uint32_t</span> *)&amp;key[i * <span class="number">4</span> + <span class="number">0</span>]);</span><br><span class="line">	&#125; <span class="keyword">while</span> (++i &lt; g_aes_nk[mode]);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> ((i % g_aes_nk[mode]) == <span class="number">0</span>) &#123;</span><br><span class="line">			t = aes_rot_dword(w[i - <span class="number">1</span>]);</span><br><span class="line">			t = aes_sub_dword(t);</span><br><span class="line">			t = t ^ aes_swap_dword(g_aes_rcon[i / g_aes_nk[mode] - <span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (g_aes_nk[mode] &gt; <span class="number">6</span> &amp;&amp; (i % g_aes_nk[mode]) == <span class="number">4</span>) &#123;</span><br><span class="line">			t = aes_sub_dword(w[i - <span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			t = w[i - <span class="number">1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		w[i] = w[i - g_aes_nk[mode]] ^ t;</span><br><span class="line">	&#125; <span class="keyword">while</span> (++i &lt; g_aes_nb[mode] * (g_aes_rounds[mode] + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_add_round_key</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state,</span></span><br><span class="line"><span class="params">	<span class="type">uint8_t</span> *round, <span class="type">int</span> nr)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span> *w = (<span class="type">uint32_t</span> *)round;</span><br><span class="line">	<span class="type">uint32_t</span> *s = (<span class="type">uint32_t</span> *)state;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		s[i] ^= w[nr * g_aes_nb[mode] + i];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_sub_bytes</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i, j;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">			state[i * <span class="number">4</span> + j] = aes_sub_sbox(state[i * <span class="number">4</span> + j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_shift_rows</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> *s = (<span class="type">uint8_t</span> *)state;</span><br><span class="line">	<span class="type">int</span> i, j, r;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">			<span class="type">uint8_t</span> tmp = s[i];</span><br><span class="line">			<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; g_aes_nb[mode]; r++) &#123;</span><br><span class="line">				s[i + r * <span class="number">4</span>] = s[i + (r + <span class="number">1</span>) * <span class="number">4</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			s[i + (g_aes_nb[mode] - <span class="number">1</span>) * <span class="number">4</span>] = tmp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">aes_xtime</span><span class="params">(<span class="type">uint8_t</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> ((x &lt;&lt; <span class="number">1</span>) ^ (((x &gt;&gt; <span class="number">7</span>) &amp; <span class="number">1</span>) * <span class="number">0x1b</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">aes_xtimes</span><span class="params">(<span class="type">uint8_t</span> x, <span class="type">int</span> ts)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span> (ts-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		x = aes_xtime(x);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">aes_mul</span><span class="params">(<span class="type">uint8_t</span> x, <span class="type">uint8_t</span> y)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	* encrypt: y has only 2 bits: can be 1, 2 or 3</span></span><br><span class="line"><span class="comment">	* decrypt: y could be any value of 9, b, d, or e</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ((((y &gt;&gt; <span class="number">0</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">0</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">1</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">2</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">2</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">3</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">3</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">4</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">4</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">5</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">5</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">6</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">6</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">7</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">7</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_mix_columns</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> y[<span class="number">16</span>] = &#123; <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>,  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>,  <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>,  <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span>];</span><br><span class="line">	<span class="type">int</span> i, j, r;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">			s[r] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">				s[r] = s[r] ^ aes_mul(state[i * <span class="number">4</span> + j], y[r * <span class="number">4</span> + j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">			state[i * <span class="number">4</span> + r] = s[r];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_encrypt</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> w[<span class="number">4</span> * <span class="number">4</span> * <span class="number">15</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* round key */</span></span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* state */</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nr, i, j;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* key expansion */</span></span><br><span class="line">	aes_key_expansion(mode, key, w);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* start data cypher loop over input buffer */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span> * g_aes_nb[mode]) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* init state from user buffer (plaintext) */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			s[j] = data[i + j];</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* start AES cypher loop over all AES rounds */</span></span><br><span class="line">		<span class="keyword">for</span> (nr = <span class="number">0</span>; nr &lt;= g_aes_rounds[mode]; nr++) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (nr &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do SubBytes */</span></span><br><span class="line">				aes_sub_bytes(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do ShiftRows */</span></span><br><span class="line">				aes_shift_rows(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (nr &lt; g_aes_rounds[mode]) &#123;</span><br><span class="line">					<span class="comment">/* do MixColumns */</span></span><br><span class="line">					aes_mix_columns(mode, s);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* do AddRoundKey */</span></span><br><span class="line">			aes_add_round_key(mode, s, w, nr);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* save state (cypher) to user buffer */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			data[i + j] = s[j];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_encrypt_ecb</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> aes_encrypt(mode, data, len, key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_encrypt_cbc</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key, <span class="type">uint8_t</span> *iv)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> w[<span class="number">4</span> * <span class="number">4</span> * <span class="number">15</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* round key */</span></span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* state */</span></span><br><span class="line">	<span class="type">uint8_t</span> v[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* iv */</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nr, i, j;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">/* key expansion */</span></span><br><span class="line">	aes_key_expansion(mode, key, w);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memcpy</span>(v, iv, <span class="keyword">sizeof</span>(v));</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* start data cypher loop over input buffer */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span> * g_aes_nb[mode]) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* init state from user buffer (plaintext) */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			s[j] = data[i + j] ^ v[j];</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* start AES cypher loop over all AES rounds */</span></span><br><span class="line">		<span class="keyword">for</span> (nr = <span class="number">0</span>; nr &lt;= g_aes_rounds[mode]; nr++) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (nr &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do SubBytes */</span></span><br><span class="line">				aes_sub_bytes(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do ShiftRows */</span></span><br><span class="line">				aes_shift_rows(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (nr &lt; g_aes_rounds[mode]) &#123;</span><br><span class="line">					<span class="comment">/* do MixColumns */</span></span><br><span class="line">					aes_mix_columns(mode, s);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* do AddRoundKey */</span></span><br><span class="line">			aes_add_round_key(mode, s, w, nr);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* save state (cypher) to user buffer */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			data[i + j] = v[j] = s[j];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">inv_shift_rows</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> *s = (<span class="type">uint8_t</span> *)state;</span><br><span class="line">	<span class="type">int</span> i, j, r;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; g_aes_nb[mode] - i; j++) &#123;</span><br><span class="line">			<span class="type">uint8_t</span> tmp = s[i];</span><br><span class="line">			<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; g_aes_nb[mode]; r++) &#123;</span><br><span class="line">				s[i + r * <span class="number">4</span>] = s[i + (r + <span class="number">1</span>) * <span class="number">4</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			s[i + (g_aes_nb[mode] - <span class="number">1</span>) * <span class="number">4</span>] = tmp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">inv_sub_sbox</span><span class="params">(<span class="type">uint8_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> g_inv_sbox[val];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">inv_sub_bytes</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i, j;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">			state[i * <span class="number">4</span> + j] = inv_sub_sbox(state[i * <span class="number">4</span> + j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">inv_mix_columns</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> y[<span class="number">16</span>] = &#123; <span class="number">0x0e</span>, <span class="number">0x0b</span>, <span class="number">0x0d</span>, <span class="number">0x09</span>,  <span class="number">0x09</span>, <span class="number">0x0e</span>, <span class="number">0x0b</span>, <span class="number">0x0d</span>,</span><br><span class="line">		<span class="number">0x0d</span>, <span class="number">0x09</span>, <span class="number">0x0e</span>, <span class="number">0x0b</span>,  <span class="number">0x0b</span>, <span class="number">0x0d</span>, <span class="number">0x09</span>, <span class="number">0x0e</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span>];</span><br><span class="line">	<span class="type">int</span> i, j, r;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">			s[r] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">				s[r] = s[r] ^ aes_mul(state[i * <span class="number">4</span> + j], y[r * <span class="number">4</span> + j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">			state[i * <span class="number">4</span> + r] = s[r];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_decrypt</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> w[<span class="number">4</span> * <span class="number">4</span> * <span class="number">15</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* round key */</span></span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* state */</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nr, i, j;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* key expansion */</span></span><br><span class="line">	aes_key_expansion(mode, key, w);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* start data cypher loop over input buffer */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span> * g_aes_nb[mode]) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* init state from user buffer (cyphertext) */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			s[j] = data[i + j];</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* start AES cypher loop over all AES rounds */</span></span><br><span class="line">		<span class="keyword">for</span> (nr = g_aes_rounds[mode]; nr &gt;= <span class="number">0</span>; nr--) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* do AddRoundKey */</span></span><br><span class="line">			aes_add_round_key(mode, s, w, nr);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (nr &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (nr &lt; g_aes_rounds[mode]) &#123;</span><br><span class="line">					<span class="comment">/* do MixColumns */</span></span><br><span class="line">					inv_mix_columns(mode, s);</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do ShiftRows */</span></span><br><span class="line">				inv_shift_rows(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do SubBytes */</span></span><br><span class="line">				inv_sub_bytes(mode, s);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* save state (cypher) to user buffer */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			data[i + j] = s[j];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_decrypt_ecb</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> aes_decrypt(mode, data, len, key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_decrypt_cbc</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key, <span class="type">uint8_t</span> *iv)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> w[<span class="number">4</span> * <span class="number">4</span> * <span class="number">15</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* round key */</span></span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* state */</span></span><br><span class="line">	<span class="type">uint8_t</span> v[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* iv */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nr, i, j;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* key expansion */</span></span><br><span class="line">	aes_key_expansion(mode, key, w);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memcpy</span>(v, iv, <span class="keyword">sizeof</span>(v));</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* start data cypher loop over input buffer */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span> * g_aes_nb[mode]) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">/* init state from user buffer (cyphertext) */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			s[j] = data[i + j];</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* start AES cypher loop over all AES rounds */</span></span><br><span class="line">		<span class="keyword">for</span> (nr = g_aes_rounds[mode]; nr &gt;= <span class="number">0</span>; nr--) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* do AddRoundKey */</span></span><br><span class="line">			aes_add_round_key(mode, s, w, nr);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (nr &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (nr &lt; g_aes_rounds[mode]) &#123;</span><br><span class="line">					<span class="comment">/* do MixColumns */</span></span><br><span class="line">					inv_mix_columns(mode, s);</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do ShiftRows */</span></span><br><span class="line">				inv_shift_rows(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do SubBytes */</span></span><br><span class="line">				inv_sub_bytes(mode, s);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* save state (cypher) to user buffer */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++) &#123;</span><br><span class="line">			<span class="type">uint8_t</span> p = s[j] ^ v[j];</span><br><span class="line">			v[j] = data[i + j];</span><br><span class="line">			data[i + j] = p;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_cypher_128_test</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 1</span></span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x00</span>, <span class="number">0x11</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x55</span>, <span class="number">0x66</span>, <span class="number">0x77</span>,</span><br><span class="line">		<span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0xaa</span>, <span class="number">0xbb</span>, <span class="number">0xcc</span>, <span class="number">0xdd</span>, <span class="number">0xee</span>, <span class="number">0xff</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>,</span><br><span class="line">		<span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span> &#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x32</span>, <span class="number">0x43</span>, <span class="number">0xf6</span>, <span class="number">0xa8</span>, <span class="number">0x88</span>, <span class="number">0x5a</span>, <span class="number">0x30</span>, <span class="number">0x8d</span>,</span><br><span class="line">		<span class="number">0x31</span>, <span class="number">0x31</span>, <span class="number">0x98</span>, <span class="number">0xa2</span>, <span class="number">0xe0</span>, <span class="number">0x37</span>, <span class="number">0x07</span>, <span class="number">0x34</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x2b</span>, <span class="number">0x7e</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x28</span>, <span class="number">0xae</span>, <span class="number">0xd2</span>, <span class="number">0xa6</span>,</span><br><span class="line">		<span class="number">0xab</span>, <span class="number">0xf7</span>, <span class="number">0x15</span>, <span class="number">0x88</span>, <span class="number">0x09</span>, <span class="number">0xcf</span>, <span class="number">0x4f</span>, <span class="number">0x3c</span> &#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	aes_encrypt(AES_CYPHER_128, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line"></span><br><span class="line">	aes_decrypt(AES_CYPHER_128, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_cypher_192_test</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x00</span>, <span class="number">0x11</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x55</span>, <span class="number">0x66</span>, <span class="number">0x77</span>,</span><br><span class="line">		<span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0xaa</span>, <span class="number">0xbb</span>, <span class="number">0xcc</span>, <span class="number">0xdd</span>, <span class="number">0xee</span>, <span class="number">0xff</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>,</span><br><span class="line">		<span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span>,</span><br><span class="line">		<span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span> &#125;;</span><br><span class="line"></span><br><span class="line">	aes_encrypt(AES_CYPHER_192, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line"></span><br><span class="line">	aes_decrypt(AES_CYPHER_192, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_cypher_256_test</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x00</span>, <span class="number">0x11</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x55</span>, <span class="number">0x66</span>, <span class="number">0x77</span>,</span><br><span class="line">		<span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0xaa</span>, <span class="number">0xbb</span>, <span class="number">0xcc</span>, <span class="number">0xdd</span>, <span class="number">0xee</span>, <span class="number">0xff</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>,</span><br><span class="line">		<span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span>,</span><br><span class="line">		<span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>,</span><br><span class="line">		<span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x1c</span>, <span class="number">0x1d</span>, <span class="number">0x1e</span>, <span class="number">0x1f</span> &#125;;</span><br><span class="line"></span><br><span class="line">	aes_encrypt(AES_CYPHER_256, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line"></span><br><span class="line">	aes_decrypt(AES_CYPHER_256, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;	</span><br><span class="line">	<span class="comment">//数据</span></span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0xda</span>, <span class="number">0x96</span>, <span class="number">0x78</span>, <span class="number">0x79</span>, <span class="number">0x54</span>, <span class="number">0xa4</span>, <span class="number">0xd1</span>, <span class="number">0x3</span>, <span class="number">0x54</span>, <span class="number">0x95</span>, <span class="number">0xf3</span>, <span class="number">0x48</span>, <span class="number">0x8d</span>, <span class="number">0xe9</span>, <span class="number">0x8b</span>, <span class="number">0xeb</span>&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//密钥</span></span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x77</span>, <span class="number">0x6f</span>, <span class="number">0x6e</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6c</span>,<span class="number">0x64</span>, <span class="number">0x61</span>,<span class="number">0x79</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x21</span>&#125;;</span><br><span class="line">	<span class="comment">//向量</span></span><br><span class="line">	<span class="type">uint8_t</span> iv[] = &#123;<span class="number">0x3c</span>, <span class="number">0x3d</span>, <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x21</span>, <span class="number">0x35</span>, <span class="number">0x26</span>, <span class="number">0x3f</span>, <span class="number">0x37</span>,<span class="number">0x32</span>, <span class="number">0x2a</span>, <span class="number">0x72</span>, <span class="number">0x72</span>, <span class="number">0x72</span>, <span class="number">0x72</span>, <span class="number">0x53</span>&#125;;</span><br><span class="line">	<span class="keyword">switch</span> (<span class="keyword">sizeof</span>(key))</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="comment">//ECB</span></span><br><span class="line">    </span><br><span class="line">	<span class="keyword">case</span> <span class="number">16</span>:aes_decrypt(AES_CYPHER_128, buf, <span class="keyword">sizeof</span>(buf), key); <span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">24</span>:aes_decrypt(AES_CYPHER_192, buf, <span class="keyword">sizeof</span>(buf), key); <span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">32</span>:aes_decrypt(AES_CYPHER_256, buf, <span class="keyword">sizeof</span>(buf), key); <span class="keyword">break</span>;</span><br><span class="line">	<span class="comment">//CBC</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	case 16:aes_decrypt_cbc(AES_CYPHER_128, buf, sizeof(buf), key, iv); break;</span></span><br><span class="line"><span class="comment">	case 24:aes_decrypt_cbc(AES_CYPHER_192, buf, sizeof(buf), key, iv); break;</span></span><br><span class="line"><span class="comment">	case 32:aes_decrypt_cbc(AES_CYPHER_256, buf, sizeof(buf), key, iv); break;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(buf); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, buf[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到：flag{weu&#x2F;.,iopl}</p>
<h3 id="FFunction"><a href="#FFunction" class="headerlink" title="FFunction"></a>FFunction</h3><p>这题搞得其实有点晕，好多信息要猜测，给了很多文件，我们找到关键my_plugin这个dll文件，在f函数中调试断点。</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220719184430550.png" alt="image-20220719184430550"></p>
<p>发现tea加密，提取数据，又发现传进来的数据进行了疑似base64的加密，据说只能猜。而且flag长度也要猜。。。。。。我们提取密文，解密一下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//加密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//解密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0x79B99E37</span> &lt;&lt; <span class="number">5</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">0x79B99E37</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> k[]=&#123;<span class="number">0x0BABEC0FE</span>,<span class="number">0x0DEADBEEF</span>,<span class="number">0x0FACEB00C</span>,<span class="number">0xDEADC0DE</span>&#125;,v[]=&#123;<span class="number">0x5C15754C</span>, <span class="number">0xD1D781E7</span>, <span class="number">0x501BF173</span>, <span class="number">0xCB4DB222</span>, <span class="number">0x215D61F5</span>, <span class="number">0x3FCA9EE7</span>, <span class="number">0x7C76B5C7</span>, <span class="number">0xC7DD8CB9</span>, <span class="number">0x990D23FA</span>, <span class="number">0x0BAB1AD3</span>, <span class="number">0x8E12C932</span>, <span class="number">0xD307BAF2</span>, <span class="number">0xE52DD123</span>, <span class="number">0xFBB68F2C</span>, <span class="number">0xBDD853E3</span>, <span class="number">0x892E1E4E</span>, <span class="number">0x39DD66FA</span>, <span class="number">0x87FEEC65</span>, <span class="number">0x307C5E60</span>, <span class="number">0x340C6C00</span>&#125;;</span><br><span class="line">    decrypt(v, k);</span><br><span class="line">    decrypt(v+<span class="number">2</span>, k);</span><br><span class="line">    decrypt(v+<span class="number">4</span>, k);</span><br><span class="line">    decrypt(v+<span class="number">6</span>, k);</span><br><span class="line">    decrypt(v+<span class="number">8</span>, k);</span><br><span class="line">    decrypt(v+<span class="number">10</span>, k);</span><br><span class="line">    decrypt(v+<span class="number">12</span>, k);</span><br><span class="line">    decrypt(v+<span class="number">14</span>, k);</span><br><span class="line">    decrypt(v+<span class="number">16</span>, k);</span><br><span class="line">    decrypt(v+<span class="number">18</span>, k);</span><br><span class="line">    decrypt(v+<span class="number">20</span>, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">2</span>],v[<span class="number">3</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">4</span>],v[<span class="number">5</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">6</span>],v[<span class="number">7</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">8</span>],v[<span class="number">9</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">10</span>],v[<span class="number">11</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">12</span>],v[<span class="number">13</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">14</span>],v[<span class="number">15</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">16</span>],v[<span class="number">17</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">18</span>],v[<span class="number">19</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">20</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>decode小端序拼接一下，两两相加进行一个base64解密，然后再手动搞一下flag就对了，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">a=<span class="string">&quot;30014006400460044007500230035008600c400a600e6003600c300930016004300340025004400d7007500250086002600f5006300050083007400e3000500a600840055007400970033001600e500a&quot;</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">ccc=re.findall(<span class="string">&quot;.&#123;2&#125;&quot;</span>,a)</span><br><span class="line">ccc=[<span class="built_in">int</span>(i,<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> ccc]</span><br><span class="line">fl=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(ccc),<span class="number">2</span>):</span><br><span class="line">    fl+=(<span class="built_in">chr</span>(ccc[index]+ccc[index+<span class="number">1</span>]))</span><br><span class="line"><span class="built_in">print</span>(fl[::-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(fl[::-<span class="number">1</span>]).decode())</span><br><span class="line"><span class="comment">#Zn1sIWEhZ0N7X0VobXRwMTB3d19lcnJlX3RGdDF1</span></span><br><span class="line"><span class="comment">#f&#125;l!a!gC&#123;_Ehmtp10ww_erre_tFt1u</span></span><br></pre></td></tr></table></figure>

<p>手动一下：<strong>flag{Emp0wer_F1utter_w1th_C!!}</strong></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/06/29/re1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/29/re1/" class="post-title-link" itemprop="url">re1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-29 23:27:38" itemprop="dateCreated datePublished" datetime="2022-06-29T23:27:38+08:00">2022-06-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-05 23:13:33" itemprop="dateModified" datetime="2022-07-05T23:13:33+08:00">2022-07-05</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h1><p>好久没整博客了，因为博客的文件被我不小心手欠删了，但一直有写，后面有时间就传上去！中间打了很多比赛，也被虐的很惨，稍微复现几道题。</p>
<h2 id="Destdog3的几道题"><a href="#Destdog3的几道题" class="headerlink" title="Destdog3的几道题"></a>Destdog3的几道题</h2><h3 id="1、go"><a href="#1、go" class="headerlink" title="1、go"></a>1、go</h3><p>这个题目就看出来是一个go语言的逆向，go语言的逆向首先看字符串是否恢复，如果没恢复就要用到某些插件了，其次找main_main这个函数，这个函数的入口如果直接能搜到，那就很好，没搜到也没关系，我们自己写个程序从start跟到main_main来看一看。</p>
<p>如果没有任何修改的话，我们进入程序直接f5是这个场面，一直跟进函数</p>
<p><img src="/re1/image-20220629233706561.png"></p>
<p>跟到下图：<img src="/re1/image-20220629233806232.png"></p>
<p>我们进入runtime_mainPC函数</p>
<p><img src="/re1/image-20220629233838199.png"></p>
<p>在.rdata段,通过交叉引用找到.text段的，找到main_main入口</p>
<p><img src="/re1/image-20220629233926322.png"></p>
<p>这个题也是这样，不过这个程序被处理了，代码并没有变成汇编，我们找到对应地方后，点c点p给他整成函数就行</p>
<p><img src="/re1/image-20220629234339050.png"></p>
<p><img src="/re1/image-20220629234427308.png" alt="image-20220629234427308"></p>
<p>我们用findcrypt很轻松的查出来有两个加密，第一个是tea，第二个是aes加密</p>
<p><img src="/re1/image-20220629234631877.png"></p>
<p>看着看着发现这玩意不能动态调试，应该是有反调试，但静态也能猜出来，我们先看看tea加密</p>
<p><img src="/re1/image-20220629234838667.png"></p>
<p><img src="/re1/image-20220629235012930.png"></p>
<p>很显然v17为key，v16位data，直接写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdint.h&gt;</span></span><br><span class="line"> </span><br><span class="line">//加密函数</span><br><span class="line">void encrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], <span class="built_in">sum</span>=<span class="number">0</span>, i;           /* <span class="built_in">set</span> up */</span><br><span class="line">    uint32_t delta=<span class="number">0x9e3779b9</span>;                     /* a key schedule constant */</span><br><span class="line">    uint32_t k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   /* cache key */</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       /* basic cycle start */</span><br><span class="line">        <span class="built_in">sum</span> += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + <span class="built_in">sum</span>) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + <span class="built_in">sum</span>) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">    &#125;                                              /* end cycle */</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line">//解密函数</span><br><span class="line">void decrypt (uint32_t* v, uint32_t* k) &#123;</span><br><span class="line">    uint32_t v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], <span class="built_in">sum</span>=<span class="number">0xC6EF3720</span>, i;  /* <span class="built_in">set</span> up */</span><br><span class="line">    uint32_t delta=<span class="number">0x9e3779b9</span>;                     /* a key schedule constant */</span><br><span class="line">    uint32_t k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   /* cache key */</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                         /* basic cycle start */</span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + <span class="built_in">sum</span>) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + <span class="built_in">sum</span>) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        <span class="built_in">sum</span> -= delta;</span><br><span class="line">    &#125;                                              /* end cycle */</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t v[<span class="number">2</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,k[<span class="number">4</span>]=&#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    // v为要加密的数据是两个<span class="number">32</span>位无符号整数</span><br><span class="line">    // k为加密解密密钥，为<span class="number">4</span>个<span class="number">32</span>位无符号整数，即密钥长度为<span class="number">128</span>位</span><br><span class="line">    printf(<span class="string">&quot;加密前原始数据：%x %x\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    encrypt(v, k);</span><br><span class="line">    printf(<span class="string">&quot;加密后的数据：%x %x\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    decrypt(v, k);</span><br><span class="line">    printf(<span class="string">&quot;解密后的数据：%x %x\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>发现hint是see_sbox。。。。。。那不就是aes吗。</p>
<p>找了个js脚本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = [</span><br><span class="line">    <span class="number">0x34</span>, <span class="number">0xC9</span>, <span class="number">0x05</span>, <span class="number">0xB3</span>, <span class="number">0x67</span>, <span class="number">0x81</span>, <span class="number">0xC8</span>, <span class="number">0xAD</span>, <span class="number">0x20</span>, <span class="number">0xC2</span>, <span class="number">0x2F</span>, <span class="number">0x07</span>,</span><br><span class="line">    <span class="number">0x93</span>, <span class="number">0x03</span>, <span class="number">0xD6</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0x2E</span>, <span class="number">0xBA</span>, <span class="number">0xF4</span>, <span class="number">0x7C</span>, <span class="number">0x71</span>, <span class="number">0x0B</span>, <span class="number">0xEC</span>,</span><br><span class="line">    <span class="number">0xC4</span>, <span class="number">0x81</span>, <span class="number">0x34</span>, <span class="number">0xDA</span>, <span class="number">0xDC</span>, <span class="number">0xE9</span>, <span class="number">0x7E</span>, <span class="number">0xEE</span>, <span class="number">0x05</span>, <span class="number">0xCF</span>, <span class="number">0x21</span>, <span class="number">0xC7</span>,</span><br><span class="line">    <span class="number">0xD9</span>, <span class="number">0x76</span>, <span class="number">0xE1</span>, <span class="number">0x76</span>, <span class="number">0x84</span>, <span class="number">0x82</span>, <span class="number">0xDE</span>, <span class="number">0xD9</span>, <span class="number">0xCB</span>, <span class="number">0x77</span>, <span class="number">0x5E</span>, <span class="number">0xA0</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> keyiv = <span class="title class_">Buffer</span>.<span class="title function_">from</span>(<span class="string">&#x27;12fe32ba87654321&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(keyiv)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> deci = crypto.<span class="title function_">createDecipheriv</span>(<span class="string">&#x27;aes-128-cbc&#x27;</span>, keyiv, keyiv)</span><br><span class="line"><span class="keyword">let</span> dec = deci.<span class="title function_">update</span>(<span class="title class_">Buffer</span>.<span class="title function_">from</span>(data))</span><br><span class="line">dec += deci.<span class="title function_">final</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dec)</span><br></pre></td></tr></table></figure>

<p>还有c的脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">	AES_CYPHER_128,</span><br><span class="line">	AES_CYPHER_192,</span><br><span class="line">	AES_CYPHER_256,</span><br><span class="line">&#125; AES_CYPHER_T;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Encryption Rounds</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> g_aes_key_bits[] = &#123;</span><br><span class="line">	<span class="comment">/* AES_CYPHER_128 */</span> <span class="number">128</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_192 */</span> <span class="number">192</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_256 */</span> <span class="number">256</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> g_aes_rounds[] = &#123;</span><br><span class="line">	<span class="comment">/* AES_CYPHER_128 */</span>  <span class="number">10</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_192 */</span>  <span class="number">12</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_256 */</span>  <span class="number">14</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> g_aes_nk[] = &#123;</span><br><span class="line">	<span class="comment">/* AES_CYPHER_128 */</span>  <span class="number">4</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_192 */</span>  <span class="number">6</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_256 */</span>  <span class="number">8</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> g_aes_nb[] = &#123;</span><br><span class="line">	<span class="comment">/* AES_CYPHER_128 */</span>  <span class="number">4</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_192 */</span>  <span class="number">4</span>,</span><br><span class="line">	<span class="comment">/* AES_CYPHER_256 */</span>  <span class="number">4</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* aes Rcon:</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* WARNING: Rcon is designed starting from 1 to 15, not 0 to 14.</span></span><br><span class="line"><span class="comment">*          FIPS-197 Page 9: &quot;note that i starts at 1, not 0&quot;</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* i    |   0     1     2     3     4     5     6     7     8     9    10    11    12    13    14</span></span><br><span class="line"><span class="comment">* -----+------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*      | [01]  [02]  [04]  [08]  [10]  [20]  [40]  [80]  [1b]  [36]  [6c]  [d8]  [ab]  [4d]  [9a]</span></span><br><span class="line"><span class="comment">* RCON | [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]</span></span><br><span class="line"><span class="comment">*      | [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]</span></span><br><span class="line"><span class="comment">*      | [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]  [00]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> g_aes_rcon[] = &#123;</span><br><span class="line">	<span class="number">0x01000000</span>, <span class="number">0x02000000</span>, <span class="number">0x04000000</span>, <span class="number">0x08000000</span>, <span class="number">0x10000000</span>, <span class="number">0x20000000</span>, <span class="number">0x40000000</span>, <span class="number">0x80000000</span>,</span><br><span class="line">	<span class="number">0x1b000000</span>, <span class="number">0x36000000</span>, <span class="number">0x6c000000</span>, <span class="number">0xd8000000</span>, <span class="number">0xab000000</span>, <span class="number">0xed000000</span>, <span class="number">0x9a000000</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* aes sbox and invert-sbox</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint8_t</span> g_aes_sbox[<span class="number">256</span>] = &#123;</span><br><span class="line">	<span class="comment">/* 0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F  */</span></span><br><span class="line">	<span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span>,</span><br><span class="line">	<span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>, <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>,</span><br><span class="line">	<span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>, <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">	<span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span>,</span><br><span class="line">	<span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span>,</span><br><span class="line">	<span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>, <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span>,</span><br><span class="line">	<span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span>,</span><br><span class="line">	<span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>, <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span>,</span><br><span class="line">	<span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">	<span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span>,</span><br><span class="line">	<span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span>,</span><br><span class="line">	<span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>, <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span>,</span><br><span class="line">	<span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>, <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span>,</span><br><span class="line">	<span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span>,</span><br><span class="line">	<span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span>,</span><br><span class="line">	<span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint8_t</span> g_inv_sbox[<span class="number">256</span>] = &#123;</span><br><span class="line">	<span class="comment">/* 0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F  */</span></span><br><span class="line">	<span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6a</span>, <span class="number">0xd5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xa5</span>, <span class="number">0x38</span>, <span class="number">0xbf</span>, <span class="number">0x40</span>, <span class="number">0xa3</span>, <span class="number">0x9e</span>, <span class="number">0x81</span>, <span class="number">0xf3</span>, <span class="number">0xd7</span>, <span class="number">0xfb</span>,</span><br><span class="line">	<span class="number">0x7c</span>, <span class="number">0xe3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9b</span>, <span class="number">0x2f</span>, <span class="number">0xff</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8e</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xc4</span>, <span class="number">0xde</span>, <span class="number">0xe9</span>, <span class="number">0xcb</span>,</span><br><span class="line">	<span class="number">0x54</span>, <span class="number">0x7b</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xa6</span>, <span class="number">0xc2</span>, <span class="number">0x23</span>, <span class="number">0x3d</span>, <span class="number">0xee</span>, <span class="number">0x4c</span>, <span class="number">0x95</span>, <span class="number">0x0b</span>, <span class="number">0x42</span>, <span class="number">0xfa</span>, <span class="number">0xc3</span>, <span class="number">0x4e</span>,</span><br><span class="line">	<span class="number">0x08</span>, <span class="number">0x2e</span>, <span class="number">0xa1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xd9</span>, <span class="number">0x24</span>, <span class="number">0xb2</span>, <span class="number">0x76</span>, <span class="number">0x5b</span>, <span class="number">0xa2</span>, <span class="number">0x49</span>, <span class="number">0x6d</span>, <span class="number">0x8b</span>, <span class="number">0xd1</span>, <span class="number">0x25</span>,</span><br><span class="line">	<span class="number">0x72</span>, <span class="number">0xf8</span>, <span class="number">0xf6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xd4</span>, <span class="number">0xa4</span>, <span class="number">0x5c</span>, <span class="number">0xcc</span>, <span class="number">0x5d</span>, <span class="number">0x65</span>, <span class="number">0xb6</span>, <span class="number">0x92</span>,</span><br><span class="line">	<span class="number">0x6c</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xfd</span>, <span class="number">0xed</span>, <span class="number">0xb9</span>, <span class="number">0xda</span>, <span class="number">0x5e</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xa7</span>, <span class="number">0x8d</span>, <span class="number">0x9d</span>, <span class="number">0x84</span>,</span><br><span class="line">	<span class="number">0x90</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x00</span>, <span class="number">0x8c</span>, <span class="number">0xbc</span>, <span class="number">0xd3</span>, <span class="number">0x0a</span>, <span class="number">0xf7</span>, <span class="number">0xe4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xb8</span>, <span class="number">0xb3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line">	<span class="number">0xd0</span>, <span class="number">0x2c</span>, <span class="number">0x1e</span>, <span class="number">0x8f</span>, <span class="number">0xca</span>, <span class="number">0x3f</span>, <span class="number">0x0f</span>, <span class="number">0x02</span>, <span class="number">0xc1</span>, <span class="number">0xaf</span>, <span class="number">0xbd</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8a</span>, <span class="number">0x6b</span>,</span><br><span class="line">	<span class="number">0x3a</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4f</span>, <span class="number">0x67</span>, <span class="number">0xdc</span>, <span class="number">0xea</span>, <span class="number">0x97</span>, <span class="number">0xf2</span>, <span class="number">0xcf</span>, <span class="number">0xce</span>, <span class="number">0xf0</span>, <span class="number">0xb4</span>, <span class="number">0xe6</span>, <span class="number">0x73</span>,</span><br><span class="line">	<span class="number">0x96</span>, <span class="number">0xac</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xe7</span>, <span class="number">0xad</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xe2</span>, <span class="number">0xf9</span>, <span class="number">0x37</span>, <span class="number">0xe8</span>, <span class="number">0x1c</span>, <span class="number">0x75</span>, <span class="number">0xdf</span>, <span class="number">0x6e</span>,</span><br><span class="line">	<span class="number">0x47</span>, <span class="number">0xf1</span>, <span class="number">0x1a</span>, <span class="number">0x71</span>, <span class="number">0x1d</span>, <span class="number">0x29</span>, <span class="number">0xc5</span>, <span class="number">0x89</span>, <span class="number">0x6f</span>, <span class="number">0xb7</span>, <span class="number">0x62</span>, <span class="number">0x0e</span>, <span class="number">0xaa</span>, <span class="number">0x18</span>, <span class="number">0xbe</span>, <span class="number">0x1b</span>,</span><br><span class="line">	<span class="number">0xfc</span>, <span class="number">0x56</span>, <span class="number">0x3e</span>, <span class="number">0x4b</span>, <span class="number">0xc6</span>, <span class="number">0xd2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9a</span>, <span class="number">0xdb</span>, <span class="number">0xc0</span>, <span class="number">0xfe</span>, <span class="number">0x78</span>, <span class="number">0xcd</span>, <span class="number">0x5a</span>, <span class="number">0xf4</span>,</span><br><span class="line">	<span class="number">0x1f</span>, <span class="number">0xdd</span>, <span class="number">0xa8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xc7</span>, <span class="number">0x31</span>, <span class="number">0xb1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>,</span><br><span class="line">	<span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7f</span>, <span class="number">0xa9</span>, <span class="number">0x19</span>, <span class="number">0xb5</span>, <span class="number">0x4a</span>, <span class="number">0x0d</span>, <span class="number">0x2d</span>, <span class="number">0xe5</span>, <span class="number">0x7a</span>, <span class="number">0x9f</span>, <span class="number">0x93</span>, <span class="number">0xc9</span>, <span class="number">0x9c</span>, <span class="number">0xef</span>,</span><br><span class="line">	<span class="number">0xa0</span>, <span class="number">0xe0</span>, <span class="number">0x3b</span>, <span class="number">0x4d</span>, <span class="number">0xae</span>, <span class="number">0x2a</span>, <span class="number">0xf5</span>, <span class="number">0xb0</span>, <span class="number">0xc8</span>, <span class="number">0xeb</span>, <span class="number">0xbb</span>, <span class="number">0x3c</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line">	<span class="number">0x17</span>, <span class="number">0x2b</span>, <span class="number">0x04</span>, <span class="number">0x7e</span>, <span class="number">0xba</span>, <span class="number">0x77</span>, <span class="number">0xd6</span>, <span class="number">0x26</span>, <span class="number">0xe1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0c</span>, <span class="number">0x7d</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">aes_sub_sbox</span><span class="params">(<span class="type">uint8_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> g_aes_sbox[val];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">aes_sub_dword</span><span class="params">(<span class="type">uint32_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span> tmp = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	tmp |= ((<span class="type">uint32_t</span>)aes_sub_sbox((<span class="type">uint8_t</span>)((val &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0xFF</span>))) &lt;&lt; <span class="number">0</span>;</span><br><span class="line">	tmp |= ((<span class="type">uint32_t</span>)aes_sub_sbox((<span class="type">uint8_t</span>)((val &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>))) &lt;&lt; <span class="number">8</span>;</span><br><span class="line">	tmp |= ((<span class="type">uint32_t</span>)aes_sub_sbox((<span class="type">uint8_t</span>)((val &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>))) &lt;&lt; <span class="number">16</span>;</span><br><span class="line">	tmp |= ((<span class="type">uint32_t</span>)aes_sub_sbox((<span class="type">uint8_t</span>)((val &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>))) &lt;&lt; <span class="number">24</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">aes_rot_dword</span><span class="params">(<span class="type">uint32_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span> tmp = val;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> (val &gt;&gt; <span class="number">8</span>) | ((tmp &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">24</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">aes_swap_dword</span><span class="params">(<span class="type">uint32_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> (((val &amp; <span class="number">0x000000FF</span>) &lt;&lt; <span class="number">24</span>) |</span><br><span class="line">		((val &amp; <span class="number">0x0000FF00</span>) &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">		((val &amp; <span class="number">0x00FF0000</span>) &gt;&gt; <span class="number">8</span>) |</span><br><span class="line">		((val &amp; <span class="number">0xFF000000</span>) &gt;&gt; <span class="number">24</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* nr: number of rounds</span></span><br><span class="line"><span class="comment">* nb: number of columns comprising the state, nb = 4 dwords (16 bytes)</span></span><br><span class="line"><span class="comment">* nk: number of 32-bit words comprising cipher key, nk = 4, 6, 8 (KeyLength/(4*8))</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_key_expansion</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *key, <span class="type">uint8_t</span> *round)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span> *w = (<span class="type">uint32_t</span> *)round;</span><br><span class="line">	<span class="type">uint32_t</span>  t;</span><br><span class="line">	<span class="type">int</span>      i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		w[i] = *((<span class="type">uint32_t</span> *)&amp;key[i * <span class="number">4</span> + <span class="number">0</span>]);</span><br><span class="line">	&#125; <span class="keyword">while</span> (++i &lt; g_aes_nk[mode]);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> ((i % g_aes_nk[mode]) == <span class="number">0</span>) &#123;</span><br><span class="line">			t = aes_rot_dword(w[i - <span class="number">1</span>]);</span><br><span class="line">			t = aes_sub_dword(t);</span><br><span class="line">			t = t ^ aes_swap_dword(g_aes_rcon[i / g_aes_nk[mode] - <span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (g_aes_nk[mode] &gt; <span class="number">6</span> &amp;&amp; (i % g_aes_nk[mode]) == <span class="number">4</span>) &#123;</span><br><span class="line">			t = aes_sub_dword(w[i - <span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			t = w[i - <span class="number">1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		w[i] = w[i - g_aes_nk[mode]] ^ t;</span><br><span class="line">	&#125; <span class="keyword">while</span> (++i &lt; g_aes_nb[mode] * (g_aes_rounds[mode] + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_add_round_key</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state,</span></span><br><span class="line"><span class="params">	<span class="type">uint8_t</span> *round, <span class="type">int</span> nr)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span> *w = (<span class="type">uint32_t</span> *)round;</span><br><span class="line">	<span class="type">uint32_t</span> *s = (<span class="type">uint32_t</span> *)state;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		s[i] ^= w[nr * g_aes_nb[mode] + i];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_sub_bytes</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i, j;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">			state[i * <span class="number">4</span> + j] = aes_sub_sbox(state[i * <span class="number">4</span> + j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_shift_rows</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> *s = (<span class="type">uint8_t</span> *)state;</span><br><span class="line">	<span class="type">int</span> i, j, r;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">			<span class="type">uint8_t</span> tmp = s[i];</span><br><span class="line">			<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; g_aes_nb[mode]; r++) &#123;</span><br><span class="line">				s[i + r * <span class="number">4</span>] = s[i + (r + <span class="number">1</span>) * <span class="number">4</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			s[i + (g_aes_nb[mode] - <span class="number">1</span>) * <span class="number">4</span>] = tmp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">aes_xtime</span><span class="params">(<span class="type">uint8_t</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> ((x &lt;&lt; <span class="number">1</span>) ^ (((x &gt;&gt; <span class="number">7</span>) &amp; <span class="number">1</span>) * <span class="number">0x1b</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">aes_xtimes</span><span class="params">(<span class="type">uint8_t</span> x, <span class="type">int</span> ts)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span> (ts-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		x = aes_xtime(x);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">aes_mul</span><span class="params">(<span class="type">uint8_t</span> x, <span class="type">uint8_t</span> y)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	* encrypt: y has only 2 bits: can be 1, 2 or 3</span></span><br><span class="line"><span class="comment">	* decrypt: y could be any value of 9, b, d, or e</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ((((y &gt;&gt; <span class="number">0</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">0</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">1</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">2</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">2</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">3</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">3</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">4</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">4</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">5</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">5</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">6</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">6</span>)) ^</span><br><span class="line">		(((y &gt;&gt; <span class="number">7</span>) &amp; <span class="number">1</span>) * aes_xtimes(x, <span class="number">7</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_mix_columns</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> y[<span class="number">16</span>] = &#123; <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>,  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>,  <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>,  <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span>];</span><br><span class="line">	<span class="type">int</span> i, j, r;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">			s[r] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">				s[r] = s[r] ^ aes_mul(state[i * <span class="number">4</span> + j], y[r * <span class="number">4</span> + j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">			state[i * <span class="number">4</span> + r] = s[r];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_encrypt</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> w[<span class="number">4</span> * <span class="number">4</span> * <span class="number">15</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* round key */</span></span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* state */</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nr, i, j;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* key expansion */</span></span><br><span class="line">	aes_key_expansion(mode, key, w);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* start data cypher loop over input buffer */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span> * g_aes_nb[mode]) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* init state from user buffer (plaintext) */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			s[j] = data[i + j];</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* start AES cypher loop over all AES rounds */</span></span><br><span class="line">		<span class="keyword">for</span> (nr = <span class="number">0</span>; nr &lt;= g_aes_rounds[mode]; nr++) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (nr &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do SubBytes */</span></span><br><span class="line">				aes_sub_bytes(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do ShiftRows */</span></span><br><span class="line">				aes_shift_rows(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (nr &lt; g_aes_rounds[mode]) &#123;</span><br><span class="line">					<span class="comment">/* do MixColumns */</span></span><br><span class="line">					aes_mix_columns(mode, s);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* do AddRoundKey */</span></span><br><span class="line">			aes_add_round_key(mode, s, w, nr);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* save state (cypher) to user buffer */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			data[i + j] = s[j];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_encrypt_ecb</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> aes_encrypt(mode, data, len, key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_encrypt_cbc</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key, <span class="type">uint8_t</span> *iv)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> w[<span class="number">4</span> * <span class="number">4</span> * <span class="number">15</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* round key */</span></span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* state */</span></span><br><span class="line">	<span class="type">uint8_t</span> v[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* iv */</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nr, i, j;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">/* key expansion */</span></span><br><span class="line">	aes_key_expansion(mode, key, w);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memcpy</span>(v, iv, <span class="keyword">sizeof</span>(v));</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* start data cypher loop over input buffer */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span> * g_aes_nb[mode]) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* init state from user buffer (plaintext) */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			s[j] = data[i + j] ^ v[j];</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* start AES cypher loop over all AES rounds */</span></span><br><span class="line">		<span class="keyword">for</span> (nr = <span class="number">0</span>; nr &lt;= g_aes_rounds[mode]; nr++) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (nr &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do SubBytes */</span></span><br><span class="line">				aes_sub_bytes(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do ShiftRows */</span></span><br><span class="line">				aes_shift_rows(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (nr &lt; g_aes_rounds[mode]) &#123;</span><br><span class="line">					<span class="comment">/* do MixColumns */</span></span><br><span class="line">					aes_mix_columns(mode, s);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* do AddRoundKey */</span></span><br><span class="line">			aes_add_round_key(mode, s, w, nr);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* save state (cypher) to user buffer */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			data[i + j] = v[j] = s[j];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">inv_shift_rows</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> *s = (<span class="type">uint8_t</span> *)state;</span><br><span class="line">	<span class="type">int</span> i, j, r;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; g_aes_nb[mode] - i; j++) &#123;</span><br><span class="line">			<span class="type">uint8_t</span> tmp = s[i];</span><br><span class="line">			<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; g_aes_nb[mode]; r++) &#123;</span><br><span class="line">				s[i + r * <span class="number">4</span>] = s[i + (r + <span class="number">1</span>) * <span class="number">4</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			s[i + (g_aes_nb[mode] - <span class="number">1</span>) * <span class="number">4</span>] = tmp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">uint8_t</span> <span class="title function_">inv_sub_sbox</span><span class="params">(<span class="type">uint8_t</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> g_inv_sbox[val];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">inv_sub_bytes</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i, j;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">			state[i * <span class="number">4</span> + j] = inv_sub_sbox(state[i * <span class="number">4</span> + j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">inv_mix_columns</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> y[<span class="number">16</span>] = &#123; <span class="number">0x0e</span>, <span class="number">0x0b</span>, <span class="number">0x0d</span>, <span class="number">0x09</span>,  <span class="number">0x09</span>, <span class="number">0x0e</span>, <span class="number">0x0b</span>, <span class="number">0x0d</span>,</span><br><span class="line">		<span class="number">0x0d</span>, <span class="number">0x09</span>, <span class="number">0x0e</span>, <span class="number">0x0b</span>,  <span class="number">0x0b</span>, <span class="number">0x0d</span>, <span class="number">0x09</span>, <span class="number">0x0e</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span>];</span><br><span class="line">	<span class="type">int</span> i, j, r;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; g_aes_nb[mode]; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">			s[r] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">				s[r] = s[r] ^ aes_mul(state[i * <span class="number">4</span> + j], y[r * <span class="number">4</span> + j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; <span class="number">4</span>; r++) &#123;</span><br><span class="line">			state[i * <span class="number">4</span> + r] = s[r];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_decrypt</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> w[<span class="number">4</span> * <span class="number">4</span> * <span class="number">15</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* round key */</span></span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* state */</span></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nr, i, j;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* key expansion */</span></span><br><span class="line">	aes_key_expansion(mode, key, w);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* start data cypher loop over input buffer */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span> * g_aes_nb[mode]) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* init state from user buffer (cyphertext) */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			s[j] = data[i + j];</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* start AES cypher loop over all AES rounds */</span></span><br><span class="line">		<span class="keyword">for</span> (nr = g_aes_rounds[mode]; nr &gt;= <span class="number">0</span>; nr--) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* do AddRoundKey */</span></span><br><span class="line">			aes_add_round_key(mode, s, w, nr);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (nr &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (nr &lt; g_aes_rounds[mode]) &#123;</span><br><span class="line">					<span class="comment">/* do MixColumns */</span></span><br><span class="line">					inv_mix_columns(mode, s);</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do ShiftRows */</span></span><br><span class="line">				inv_shift_rows(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do SubBytes */</span></span><br><span class="line">				inv_sub_bytes(mode, s);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* save state (cypher) to user buffer */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			data[i + j] = s[j];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_decrypt_ecb</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> aes_decrypt(mode, data, len, key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">aes_decrypt_cbc</span><span class="params">(AES_CYPHER_T mode, <span class="type">uint8_t</span> *data, <span class="type">int</span> len, <span class="type">uint8_t</span> *key, <span class="type">uint8_t</span> *iv)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> w[<span class="number">4</span> * <span class="number">4</span> * <span class="number">15</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* round key */</span></span><br><span class="line">	<span class="type">uint8_t</span> s[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* state */</span></span><br><span class="line">	<span class="type">uint8_t</span> v[<span class="number">4</span> * <span class="number">4</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">/* iv */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nr, i, j;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* key expansion */</span></span><br><span class="line">	aes_key_expansion(mode, key, w);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memcpy</span>(v, iv, <span class="keyword">sizeof</span>(v));</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* start data cypher loop over input buffer */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span> * g_aes_nb[mode]) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">/* init state from user buffer (cyphertext) */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++)</span><br><span class="line">			s[j] = data[i + j];</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* start AES cypher loop over all AES rounds */</span></span><br><span class="line">		<span class="keyword">for</span> (nr = g_aes_rounds[mode]; nr &gt;= <span class="number">0</span>; nr--) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* do AddRoundKey */</span></span><br><span class="line">			aes_add_round_key(mode, s, w, nr);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (nr &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (nr &lt; g_aes_rounds[mode]) &#123;</span><br><span class="line">					<span class="comment">/* do MixColumns */</span></span><br><span class="line">					inv_mix_columns(mode, s);</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do ShiftRows */</span></span><br><span class="line">				inv_shift_rows(mode, s);</span><br><span class="line"></span><br><span class="line">				<span class="comment">/* do SubBytes */</span></span><br><span class="line">				inv_sub_bytes(mode, s);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* save state (cypher) to user buffer */</span></span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span> * g_aes_nb[mode]; j++) &#123;</span><br><span class="line">			<span class="type">uint8_t</span> p = s[j] ^ v[j];</span><br><span class="line">			v[j] = data[i + j];</span><br><span class="line">			data[i + j] = p;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_cypher_128_test</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 1</span></span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x00</span>, <span class="number">0x11</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x55</span>, <span class="number">0x66</span>, <span class="number">0x77</span>,</span><br><span class="line">		<span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0xaa</span>, <span class="number">0xbb</span>, <span class="number">0xcc</span>, <span class="number">0xdd</span>, <span class="number">0xee</span>, <span class="number">0xff</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>,</span><br><span class="line">		<span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span> &#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x32</span>, <span class="number">0x43</span>, <span class="number">0xf6</span>, <span class="number">0xa8</span>, <span class="number">0x88</span>, <span class="number">0x5a</span>, <span class="number">0x30</span>, <span class="number">0x8d</span>,</span><br><span class="line">		<span class="number">0x31</span>, <span class="number">0x31</span>, <span class="number">0x98</span>, <span class="number">0xa2</span>, <span class="number">0xe0</span>, <span class="number">0x37</span>, <span class="number">0x07</span>, <span class="number">0x34</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x2b</span>, <span class="number">0x7e</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x28</span>, <span class="number">0xae</span>, <span class="number">0xd2</span>, <span class="number">0xa6</span>,</span><br><span class="line">		<span class="number">0xab</span>, <span class="number">0xf7</span>, <span class="number">0x15</span>, <span class="number">0x88</span>, <span class="number">0x09</span>, <span class="number">0xcf</span>, <span class="number">0x4f</span>, <span class="number">0x3c</span> &#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	aes_encrypt(AES_CYPHER_128, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line"></span><br><span class="line">	aes_decrypt(AES_CYPHER_128, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_cypher_192_test</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x00</span>, <span class="number">0x11</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x55</span>, <span class="number">0x66</span>, <span class="number">0x77</span>,</span><br><span class="line">		<span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0xaa</span>, <span class="number">0xbb</span>, <span class="number">0xcc</span>, <span class="number">0xdd</span>, <span class="number">0xee</span>, <span class="number">0xff</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>,</span><br><span class="line">		<span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span>,</span><br><span class="line">		<span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span> &#125;;</span><br><span class="line"></span><br><span class="line">	aes_encrypt(AES_CYPHER_192, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line"></span><br><span class="line">	aes_decrypt(AES_CYPHER_192, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_cypher_256_test</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x00</span>, <span class="number">0x11</span>, <span class="number">0x22</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x55</span>, <span class="number">0x66</span>, <span class="number">0x77</span>,</span><br><span class="line">		<span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0xaa</span>, <span class="number">0xbb</span>, <span class="number">0xcc</span>, <span class="number">0xdd</span>, <span class="number">0xee</span>, <span class="number">0xff</span> &#125;;</span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>,</span><br><span class="line">		<span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span>,</span><br><span class="line">		<span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>,</span><br><span class="line">		<span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x1c</span>, <span class="number">0x1d</span>, <span class="number">0x1e</span>, <span class="number">0x1f</span> &#125;;</span><br><span class="line"></span><br><span class="line">	aes_encrypt(AES_CYPHER_256, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line"></span><br><span class="line">	aes_decrypt(AES_CYPHER_256, buf, <span class="keyword">sizeof</span>(buf), key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************************************************************************************************/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//数据</span></span><br><span class="line">	<span class="type">uint8_t</span> buf[] = &#123; <span class="number">0x34</span>, <span class="number">0xC9</span>, <span class="number">0x05</span>, <span class="number">0xB3</span>, <span class="number">0x67</span>, <span class="number">0x81</span>, <span class="number">0xC8</span>, <span class="number">0xAD</span>, <span class="number">0x20</span>, <span class="number">0xC2</span>, <span class="number">0x2F</span>, <span class="number">0x07</span>,</span><br><span class="line">    <span class="number">0x93</span>, <span class="number">0x03</span>, <span class="number">0xD6</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0x2E</span>, <span class="number">0xBA</span>, <span class="number">0xF4</span>, <span class="number">0x7C</span>, <span class="number">0x71</span>, <span class="number">0x0B</span>, <span class="number">0xEC</span>,</span><br><span class="line">    <span class="number">0xC4</span>, <span class="number">0x81</span>, <span class="number">0x34</span>, <span class="number">0xDA</span>, <span class="number">0xDC</span>, <span class="number">0xE9</span>, <span class="number">0x7E</span>, <span class="number">0xEE</span>, <span class="number">0x05</span>, <span class="number">0xCF</span>, <span class="number">0x21</span>, <span class="number">0xC7</span>,</span><br><span class="line">    <span class="number">0xD9</span>, <span class="number">0x76</span>, <span class="number">0xE1</span>, <span class="number">0x76</span>, <span class="number">0x84</span>, <span class="number">0x82</span>, <span class="number">0xDE</span>, <span class="number">0xD9</span>, <span class="number">0xCB</span>, <span class="number">0x77</span>, <span class="number">0x5E</span>, <span class="number">0xA0</span>&#125;;</span><br><span class="line">	<span class="comment">//密钥</span></span><br><span class="line">	<span class="type">uint8_t</span> key[] = &#123; <span class="number">49</span>, <span class="number">50</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">51</span>, <span class="number">50</span>, <span class="number">98</span>, <span class="number">97</span>, <span class="number">56</span>, <span class="number">55</span>, <span class="number">54</span>, <span class="number">53</span>, <span class="number">52</span>, <span class="number">51</span>, <span class="number">50</span>, <span class="number">49</span> &#125;;</span><br><span class="line">	<span class="comment">//向量</span></span><br><span class="line">	<span class="type">uint8_t</span> iv[] = &#123;<span class="number">49</span>, <span class="number">50</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">51</span>, <span class="number">50</span>, <span class="number">98</span>, <span class="number">97</span>, <span class="number">56</span>, <span class="number">55</span>, <span class="number">54</span>, <span class="number">53</span>, <span class="number">52</span>, <span class="number">51</span>, <span class="number">50</span>, <span class="number">49</span>&#125;;</span><br><span class="line">	<span class="keyword">switch</span> (<span class="keyword">sizeof</span>(key))</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="comment">//ECB</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">	case 16:aes_decrypt(AES_CYPHER_128, buf, sizeof(buf), key); break;</span></span><br><span class="line"><span class="comment">	case 24:aes_decrypt(AES_CYPHER_192, buf, sizeof(buf), key); break;</span></span><br><span class="line"><span class="comment">	case 32:aes_decrypt(AES_CYPHER_256, buf, sizeof(buf), key); break;</span></span><br><span class="line"><span class="comment">	//CBC</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">case</span> <span class="number">16</span>:aes_decrypt_cbc(AES_CYPHER_128, buf, <span class="keyword">sizeof</span>(buf), key, iv); <span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">24</span>:aes_decrypt_cbc(AES_CYPHER_192, buf, <span class="keyword">sizeof</span>(buf), key, iv); <span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">32</span>:aes_decrypt_cbc(AES_CYPHER_256, buf, <span class="keyword">sizeof</span>(buf), key, iv); <span class="keyword">break</span>;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(buf); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, buf[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>跑出来是一样的：Dest0g3{4a9ff880-ea23-5016-b1aa-2ee3bf985533}</p>
<p>一点都没魔改的aes。</p>
<h3 id="2、ttttea"><a href="#2、ttttea" class="headerlink" title="2、ttttea"></a>2、ttttea</h3><p>这题就是个魔改的xxtea，本来以为很简单，但跑出来的脚本总是不对，才发现有TLS回调函数，里面改了delta</p>
<p><img src="/re1/image-20220630170408100.png"></p>
<p><img src="/re1/image-20220630170420207.png"></p>
<p>发现key是delta，这个还魔改了一个右移6</p>
<p>我们直接到exports里看tls回调函数：</p>
<p><img src="/re1/image-20220630170754591.png"></p>
<p><img src="/re1/image-20220630170645456.png"></p>
<p>先改了delta，然后又异或了一下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x74746561</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;6^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">btea</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds*DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[]= &#123;<span class="number">0x2F222303</span>, <span class="number">0x43FD8836</span>, <span class="number">0x655BE821</span>, <span class="number">0xA63B1E31</span>, <span class="number">0x88DCB84B</span>, <span class="number">0x6F841980</span>, <span class="number">0x26217297</span>, <span class="number">0xBBEE64AD</span>, <span class="number">0x064D0488</span>, <span class="number">0x6BE5262F</span>, <span class="number">0x73F54B81</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>]= &#123;<span class="number">0x61</span>,<span class="number">0x65</span>,<span class="number">0x74</span>,<span class="number">0x74</span>&#125;;</span><br><span class="line">    <span class="type">int</span> n= <span class="number">11</span>; <span class="comment">//n的绝对值表示v的长度，取正表示加密，取负表示解密</span></span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;beforecode:%x %x\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="comment">//btea(v, n, k);</span></span><br><span class="line">    <span class="comment">//printf(&quot;encode:%x %x\n&quot;,v[0],v[1]);</span></span><br><span class="line">    btea(v, -n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">2</span>],v[<span class="number">3</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">4</span>],v[<span class="number">5</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">6</span>],v[<span class="number">7</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x %x\n&quot;</span>,v[<span class="number">8</span>],v[<span class="number">9</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;decode:%x&quot;</span>,v[<span class="number">10</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果小端序就对了。</p>
<h2 id="鹏城杯的re"><a href="#鹏城杯的re" class="headerlink" title="鹏城杯的re"></a>鹏城杯的re</h2><p>分最少的re反而是最难的，属实难崩</p>
<h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><p>其实这个题逻辑和迷宫都很清晰，就是一棵树，有链表连成的树，脚本比较难写，其他还好。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">sub_40500A</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 end; <span class="comment">// rbp</span></span><br><span class="line">  <span class="type">char</span> input; <span class="comment">// [rsp+Fh] [rbp-29h] BYREF</span></span><br><span class="line">  __int64 start; <span class="comment">// [rsp+10h] [rbp-28h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// [rsp+18h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  initmap();                                    <span class="comment">// 生成地图</span></span><br><span class="line">  end = *(_QWORD *)(*(_QWORD *)(*(_QWORD *)(qword_5D3680 + <span class="number">8</span>) + <span class="number">8LL</span>) + <span class="number">8LL</span>);<span class="comment">// 终点节点</span></span><br><span class="line">  start = *(_QWORD *)(*(_QWORD *)(*(_QWORD *)(*(_QWORD *)(qword_5D36A0 + <span class="number">8</span>) + <span class="number">8LL</span>) + <span class="number">8LL</span>) + <span class="number">8LL</span>);<span class="comment">// 最初节点</span></span><br><span class="line">  *(_BYTE *)(start + <span class="number">27</span>) = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">printf</span>(&amp;unk_5D45C0, <span class="string">&quot;Welcome to Hexagonal maze\nplz enter the foot print\n&quot;</span>);</span><br><span class="line">  input = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_46D9D0(&amp;unk_5D45C0, <span class="string">&quot;&gt; &quot;</span>, <span class="number">2LL</span>);</span><br><span class="line">    sub_452070(&amp;unk_5D46E0, &amp;input);</span><br><span class="line">    main_func(&amp;start, (<span class="type">unsigned</span> <span class="type">int</span>)input);<span class="comment">//对输入进行验证</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( start != end );</span><br><span class="line">  sub_46D9D0(&amp;unk_5D45C0, <span class="string">&quot;flag is md5 your input&quot;</span>, <span class="number">22LL</span>);</span><br><span class="line">  sub_46D7E0(&amp;unk_5D45C0);</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(<span class="number">0x28</span>u) != v4 )</span><br><span class="line">    sub_52CB40();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查看main_func函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *__fastcall <span class="title function_">sub_404BF5</span><span class="params">(_QWORD **a1, <span class="type">char</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  _QWORD *v2; <span class="comment">// rax</span></span><br><span class="line">  _QWORD *v3; <span class="comment">// rax</span></span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line">  _QWORD *v5; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;l&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span> ( *((_BYTE *)*a1 + <span class="number">24</span>) || (v3 = (_QWORD *)**a1) == <span class="number">0LL</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0LL</span>);</span><br><span class="line">      *a1 = v3;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span> ( *((_BYTE *)*a1 + <span class="number">25</span>) || (v5 = (_QWORD *)(*a1)[<span class="number">1</span>]) == <span class="number">0LL</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0LL</span>);</span><br><span class="line">      *a1 = v5;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;t&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span> ( *((_BYTE *)*a1 + <span class="number">26</span>) || (v2 = (_QWORD *)(*a1)[<span class="number">2</span>]) == <span class="number">0LL</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0LL</span>);</span><br><span class="line">      *a1 = v2;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0LL</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  result = *a1;</span><br><span class="line">  <span class="keyword">if</span> ( *((_BYTE *)*a1 + <span class="number">27</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0LL</span>);</span><br><span class="line">  *((_BYTE *)result + <span class="number">27</span>) = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输入就是从“l“，”r”，“t”中选的，如果输入是l，那么对这棵树进行判断，判断其标志位是否是0，是0可通过，是1不可通过</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220705152407696.png" alt="image-20220705152407696"></p>
<p>查看这个链表组成的结构体，偏移为0x0处是代表l，偏移为0x8代表r，偏移为0x10是代表t，偏移为0x18的数代表是否通行，偏移为0x28的是代表这个节点结束。每个节点的大小是相同的，那么只需要找到地图边界的起点和终点就行。然后idapython写个脚本提取一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">0x00000000019df8f0</span>,<span class="number">0x00000000019E0310</span>] </span><br><span class="line">maze = [] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(x[<span class="number">0</span>],x[<span class="number">1</span>],<span class="number">8</span>*<span class="number">6</span>): </span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>): </span><br><span class="line">        maze.append(get_qword(i+k*<span class="number">8</span>)) </span><br><span class="line"><span class="built_in">print</span>(maze)</span><br></pre></td></tr></table></figure>

<p>整理成二维数组：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">map_o = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">0</span>, <span class="number">27130192</span>, <span class="number">27130528</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130144</span>, <span class="number">27130240</span>, <span class="number">0</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130192</span>, <span class="number">27130288</span>, <span class="number">27130624</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130240</span>, <span class="number">27130336</span>, <span class="number">0</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130288</span>, <span class="number">27130384</span>, <span class="number">27130720</span>, <span class="number">65537</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130336</span>, <span class="number">27130432</span>, <span class="number">0</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130384</span>, <span class="number">0</span>, <span class="number">27130816</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">0</span>, <span class="number">27130528</span>, <span class="number">27130960</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130480</span>, <span class="number">27130576</span>, <span class="number">27130144</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130528</span>, <span class="number">27130624</span>, <span class="number">27131056</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130576</span>, <span class="number">27130672</span>, <span class="number">27130240</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130624</span>, <span class="number">27130720</span>, <span class="number">27131152</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130672</span>, <span class="number">27130768</span>, <span class="number">27130336</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130720</span>, <span class="number">27130816</span>, <span class="number">27131248</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130768</span>, <span class="number">27130864</span>, <span class="number">27130432</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130816</span>, <span class="number">0</span>, <span class="number">27131344</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">0</span>, <span class="number">27130960</span>, <span class="number">27131440</span>, <span class="number">257</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130912</span>, <span class="number">27131008</span>, <span class="number">27130480</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27130960</span>, <span class="number">27131056</span>, <span class="number">27131536</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131008</span>, <span class="number">27131104</span>, <span class="number">27130576</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131056</span>, <span class="number">27131152</span>, <span class="number">27131632</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131104</span>, <span class="number">27131200</span>, <span class="number">27130672</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131152</span>, <span class="number">27131248</span>, <span class="number">27131728</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131200</span>, <span class="number">27131296</span>, <span class="number">27130768</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131248</span>, <span class="number">27131344</span>, <span class="number">27131824</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131296</span>, <span class="number">27131392</span>, <span class="number">27130864</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131344</span>, <span class="number">0</span>, <span class="number">27131920</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">0</span>, <span class="number">27131488</span>, <span class="number">27130912</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131440</span>, <span class="number">27131536</span>, <span class="number">27131968</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131488</span>, <span class="number">27131584</span>, <span class="number">27131008</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131536</span>, <span class="number">27131632</span>, <span class="number">27132064</span>, <span class="number">65792</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131584</span>, <span class="number">27131680</span>, <span class="number">27131104</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131632</span>, <span class="number">27131728</span>, <span class="number">27132160</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131680</span>, <span class="number">27131776</span>, <span class="number">27131200</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131728</span>, <span class="number">27131824</span>, <span class="number">27132256</span>, <span class="number">257</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131776</span>, <span class="number">27131872</span>, <span class="number">27131296</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131824</span>, <span class="number">27131920</span>, <span class="number">27132352</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131872</span>, <span class="number">0</span>, <span class="number">27131392</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">0</span>, <span class="number">27132016</span>, <span class="number">27131488</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27131968</span>, <span class="number">27132064</span>, <span class="number">27132400</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27132016</span>, <span class="number">27132112</span>, <span class="number">27131584</span>, <span class="number">65537</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27132064</span>, <span class="number">27132160</span>, <span class="number">27132496</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27132112</span>, <span class="number">27132208</span>, <span class="number">27131680</span>, <span class="number">16777216</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27132160</span>, <span class="number">27132256</span>, <span class="number">27132592</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27132208</span>, <span class="number">27132304</span>, <span class="number">27131776</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27132256</span>, <span class="number">27132352</span>, <span class="number">27132688</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27132304</span>, <span class="number">0</span>, <span class="number">27131872</span>, <span class="number">256</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">0</span>, <span class="number">27132448</span>, <span class="number">27132016</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27132400</span>, <span class="number">27132496</span>, <span class="number">0</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27132448</span>, <span class="number">27132544</span>, <span class="number">27132112</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27132496</span>, <span class="number">27132592</span>, <span class="number">0</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27132544</span>, <span class="number">27132640</span>, <span class="number">27132208</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">27132592</span>, <span class="number">27132688</span>, <span class="number">0</span>, <span class="number">65536</span>, <span class="number">0</span>, <span class="number">49</span>]</span><br><span class="line"><span class="built_in">map</span> = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>)] <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">54</span>)]</span><br><span class="line">cout = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(map_o),<span class="number">6</span>):</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">7</span>):</span><br><span class="line">        <span class="built_in">map</span>[cout][k] = map_o[i+k-<span class="number">1</span>]</span><br><span class="line">    cout += <span class="number">1</span></span><br><span class="line"><span class="comment">#print(map)</span></span><br><span class="line">cout = <span class="number">0</span></span><br><span class="line">ea = [<span class="number">0x00000000019df8f0</span>,<span class="number">0x00000000019E0310</span>] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ea[<span class="number">0</span>],ea[<span class="number">1</span>],<span class="number">6</span>*<span class="number">8</span>):</span><br><span class="line">    <span class="built_in">map</span>[cout][<span class="number">0</span>] = i</span><br><span class="line">    cout += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">map</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">54</span>):</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">map</span>[i][k]),end=<span class="string">&quot;, &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; &quot;</span>)</span><br><span class="line">&#123;<span class="number">0x19df8f0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,  </span><br><span class="line">&#123;<span class="number">0x19df920</span>, <span class="number">0x0</span>, <span class="number">0x19df950</span>, <span class="number">0x19dfaa0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19df950</span>, <span class="number">0x19df920</span>, <span class="number">0x19df980</span>, <span class="number">0x0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19df980</span>, <span class="number">0x19df950</span>, <span class="number">0x19df9b0</span>, <span class="number">0x19dfb00</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19df9b0</span>, <span class="number">0x19df980</span>, <span class="number">0x19df9e0</span>, <span class="number">0x0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19df9e0</span>, <span class="number">0x19df9b0</span>, <span class="number">0x19dfa10</span>, <span class="number">0x19dfb60</span>, <span class="number">0x10001</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfa10</span>, <span class="number">0x19df9e0</span>, <span class="number">0x19dfa40</span>, <span class="number">0x0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfa40</span>, <span class="number">0x19dfa10</span>, <span class="number">0x0</span>, <span class="number">0x19dfbc0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfa70</span>, <span class="number">0x0</span>, <span class="number">0x19dfaa0</span>, <span class="number">0x19dfc50</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfaa0</span>, <span class="number">0x19dfa70</span>, <span class="number">0x19dfad0</span>, <span class="number">0x19df920</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfad0</span>, <span class="number">0x19dfaa0</span>, <span class="number">0x19dfb00</span>, <span class="number">0x19dfcb0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfb00</span>, <span class="number">0x19dfad0</span>, <span class="number">0x19dfb30</span>, <span class="number">0x19df980</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfb30</span>, <span class="number">0x19dfb00</span>, <span class="number">0x19dfb60</span>, <span class="number">0x19dfd10</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfb60</span>, <span class="number">0x19dfb30</span>, <span class="number">0x19dfb90</span>, <span class="number">0x19df9e0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfb90</span>, <span class="number">0x19dfb60</span>, <span class="number">0x19dfbc0</span>, <span class="number">0x19dfd70</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfbc0</span>, <span class="number">0x19dfb90</span>, <span class="number">0x19dfbf0</span>, <span class="number">0x19dfa40</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfbf0</span>, <span class="number">0x19dfbc0</span>, <span class="number">0x0</span>, <span class="number">0x19dfdd0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfc20</span>, <span class="number">0x0</span>, <span class="number">0x19dfc50</span>, <span class="number">0x19dfe30</span>, <span class="number">0x101</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfc50</span>, <span class="number">0x19dfc20</span>, <span class="number">0x19dfc80</span>, <span class="number">0x19dfa70</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfc80</span>, <span class="number">0x19dfc50</span>, <span class="number">0x19dfcb0</span>, <span class="number">0x19dfe90</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfcb0</span>, <span class="number">0x19dfc80</span>, <span class="number">0x19dfce0</span>, <span class="number">0x19dfad0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfce0</span>, <span class="number">0x19dfcb0</span>, <span class="number">0x19dfd10</span>, <span class="number">0x19dfef0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfd10</span>, <span class="number">0x19dfce0</span>, <span class="number">0x19dfd40</span>, <span class="number">0x19dfb30</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfd40</span>, <span class="number">0x19dfd10</span>, <span class="number">0x19dfd70</span>, <span class="number">0x19dff50</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfd70</span>, <span class="number">0x19dfd40</span>, <span class="number">0x19dfda0</span>, <span class="number">0x19dfb90</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfda0</span>, <span class="number">0x19dfd70</span>, <span class="number">0x19dfdd0</span>, <span class="number">0x19dffb0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfdd0</span>, <span class="number">0x19dfda0</span>, <span class="number">0x19dfe00</span>, <span class="number">0x19dfbf0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfe00</span>, <span class="number">0x19dfdd0</span>, <span class="number">0x0</span>, <span class="number">0x19e0010</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfe30</span>, <span class="number">0x0</span>, <span class="number">0x19dfe60</span>, <span class="number">0x19dfc20</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfe60</span>, <span class="number">0x19dfe30</span>, <span class="number">0x19dfe90</span>, <span class="number">0x19e0040</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfe90</span>, <span class="number">0x19dfe60</span>, <span class="number">0x19dfec0</span>, <span class="number">0x19dfc80</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfec0</span>, <span class="number">0x19dfe90</span>, <span class="number">0x19dfef0</span>, <span class="number">0x19e00a0</span>, <span class="number">0x10100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfef0</span>, <span class="number">0x19dfec0</span>, <span class="number">0x19dff20</span>, <span class="number">0x19dfce0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dff20</span>, <span class="number">0x19dfef0</span>, <span class="number">0x19dff50</span>, <span class="number">0x19e0100</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dff50</span>, <span class="number">0x19dff20</span>, <span class="number">0x19dff80</span>, <span class="number">0x19dfd40</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dff80</span>, <span class="number">0x19dff50</span>, <span class="number">0x19dffb0</span>, <span class="number">0x19e0160</span>, <span class="number">0x101</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dffb0</span>, <span class="number">0x19dff80</span>, <span class="number">0x19dffe0</span>, <span class="number">0x19dfda0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dffe0</span>, <span class="number">0x19dffb0</span>, <span class="number">0x19e0010</span>, <span class="number">0x19e01c0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,  </span><br><span class="line">&#123;<span class="number">0x19e0010</span>, <span class="number">0x19dffe0</span>, <span class="number">0x0</span>, <span class="number">0x19dfe00</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0040</span>, <span class="number">0x0</span>, <span class="number">0x19e0070</span>, <span class="number">0x19dfe60</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0070</span>, <span class="number">0x19e0040</span>, <span class="number">0x19e00a0</span>, <span class="number">0x19e01f0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e00a0</span>, <span class="number">0x19e0070</span>, <span class="number">0x19e00d0</span>, <span class="number">0x19dfec0</span>, <span class="number">0x10001</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e00d0</span>, <span class="number">0x19e00a0</span>, <span class="number">0x19e0100</span>, <span class="number">0x19e0250</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0100</span>, <span class="number">0x19e00d0</span>, <span class="number">0x19e0130</span>, <span class="number">0x19dff20</span>, <span class="number">0x1000000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0130</span>, <span class="number">0x19e0100</span>, <span class="number">0x19e0160</span>, <span class="number">0x19e02b0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0160</span>, <span class="number">0x19e0130</span>, <span class="number">0x19e0190</span>, <span class="number">0x19dff80</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0190</span>, <span class="number">0x19e0160</span>, <span class="number">0x19e01c0</span>, <span class="number">0x19e0310</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e01c0</span>, <span class="number">0x19e0190</span>, <span class="number">0x0</span>, <span class="number">0x19dffe0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e01f0</span>, <span class="number">0x0</span>, <span class="number">0x19e0220</span>, <span class="number">0x19e0070</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0220</span>, <span class="number">0x19e01f0</span>, <span class="number">0x19e0250</span>, <span class="number">0x0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0250</span>, <span class="number">0x19e0220</span>, <span class="number">0x19e0280</span>, <span class="number">0x19e00d0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0280</span>, <span class="number">0x19e0250</span>, <span class="number">0x19e02b0</span>, <span class="number">0x0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e02b0</span>, <span class="number">0x19e0280</span>, <span class="number">0x19e02e0</span>, <span class="number">0x19e0130</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e02e0</span>, <span class="number">0x19e02b0</span>, <span class="number">0x19e0310</span>, <span class="number">0x0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br></pre></td></tr></table></figure>

<p>这个二维数组被解释为第一位是节点，第二三四位是l，r，t。第5位是判断位，先给出c++写的脚本：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;String&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">100005</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> a[<span class="number">1000</span>][<span class="number">10</span>]=&#123;</span><br><span class="line">&#123;<span class="number">0x19df8f0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,  </span><br><span class="line">&#123;<span class="number">0x19df920</span>, <span class="number">0x0</span>, <span class="number">0x19df950</span>, <span class="number">0x19dfaa0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19df950</span>, <span class="number">0x19df920</span>, <span class="number">0x19df980</span>, <span class="number">0x0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19df980</span>, <span class="number">0x19df950</span>, <span class="number">0x19df9b0</span>, <span class="number">0x19dfb00</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19df9b0</span>, <span class="number">0x19df980</span>, <span class="number">0x19df9e0</span>, <span class="number">0x0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19df9e0</span>, <span class="number">0x19df9b0</span>, <span class="number">0x19dfa10</span>, <span class="number">0x19dfb60</span>, <span class="number">0x10001</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfa10</span>, <span class="number">0x19df9e0</span>, <span class="number">0x19dfa40</span>, <span class="number">0x0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfa40</span>, <span class="number">0x19dfa10</span>, <span class="number">0x0</span>, <span class="number">0x19dfbc0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfa70</span>, <span class="number">0x0</span>, <span class="number">0x19dfaa0</span>, <span class="number">0x19dfc50</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfaa0</span>, <span class="number">0x19dfa70</span>, <span class="number">0x19dfad0</span>, <span class="number">0x19df920</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfad0</span>, <span class="number">0x19dfaa0</span>, <span class="number">0x19dfb00</span>, <span class="number">0x19dfcb0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfb00</span>, <span class="number">0x19dfad0</span>, <span class="number">0x19dfb30</span>, <span class="number">0x19df980</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfb30</span>, <span class="number">0x19dfb00</span>, <span class="number">0x19dfb60</span>, <span class="number">0x19dfd10</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfb60</span>, <span class="number">0x19dfb30</span>, <span class="number">0x19dfb90</span>, <span class="number">0x19df9e0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfb90</span>, <span class="number">0x19dfb60</span>, <span class="number">0x19dfbc0</span>, <span class="number">0x19dfd70</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfbc0</span>, <span class="number">0x19dfb90</span>, <span class="number">0x19dfbf0</span>, <span class="number">0x19dfa40</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfbf0</span>, <span class="number">0x19dfbc0</span>, <span class="number">0x0</span>, <span class="number">0x19dfdd0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfc20</span>, <span class="number">0x0</span>, <span class="number">0x19dfc50</span>, <span class="number">0x19dfe30</span>, <span class="number">0x101</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfc50</span>, <span class="number">0x19dfc20</span>, <span class="number">0x19dfc80</span>, <span class="number">0x19dfa70</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfc80</span>, <span class="number">0x19dfc50</span>, <span class="number">0x19dfcb0</span>, <span class="number">0x19dfe90</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfcb0</span>, <span class="number">0x19dfc80</span>, <span class="number">0x19dfce0</span>, <span class="number">0x19dfad0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfce0</span>, <span class="number">0x19dfcb0</span>, <span class="number">0x19dfd10</span>, <span class="number">0x19dfef0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfd10</span>, <span class="number">0x19dfce0</span>, <span class="number">0x19dfd40</span>, <span class="number">0x19dfb30</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfd40</span>, <span class="number">0x19dfd10</span>, <span class="number">0x19dfd70</span>, <span class="number">0x19dff50</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfd70</span>, <span class="number">0x19dfd40</span>, <span class="number">0x19dfda0</span>, <span class="number">0x19dfb90</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfda0</span>, <span class="number">0x19dfd70</span>, <span class="number">0x19dfdd0</span>, <span class="number">0x19dffb0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfdd0</span>, <span class="number">0x19dfda0</span>, <span class="number">0x19dfe00</span>, <span class="number">0x19dfbf0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfe00</span>, <span class="number">0x19dfdd0</span>, <span class="number">0x0</span>, <span class="number">0x19e0010</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfe30</span>, <span class="number">0x0</span>, <span class="number">0x19dfe60</span>, <span class="number">0x19dfc20</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfe60</span>, <span class="number">0x19dfe30</span>, <span class="number">0x19dfe90</span>, <span class="number">0x19e0040</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfe90</span>, <span class="number">0x19dfe60</span>, <span class="number">0x19dfec0</span>, <span class="number">0x19dfc80</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfec0</span>, <span class="number">0x19dfe90</span>, <span class="number">0x19dfef0</span>, <span class="number">0x19e00a0</span>, <span class="number">0x10100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dfef0</span>, <span class="number">0x19dfec0</span>, <span class="number">0x19dff20</span>, <span class="number">0x19dfce0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dff20</span>, <span class="number">0x19dfef0</span>, <span class="number">0x19dff50</span>, <span class="number">0x19e0100</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dff50</span>, <span class="number">0x19dff20</span>, <span class="number">0x19dff80</span>, <span class="number">0x19dfd40</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dff80</span>, <span class="number">0x19dff50</span>, <span class="number">0x19dffb0</span>, <span class="number">0x19e0160</span>, <span class="number">0x101</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dffb0</span>, <span class="number">0x19dff80</span>, <span class="number">0x19dffe0</span>, <span class="number">0x19dfda0</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19dffe0</span>, <span class="number">0x19dffb0</span>, <span class="number">0x19e0010</span>, <span class="number">0x19e01c0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,  </span><br><span class="line">&#123;<span class="number">0x19e0010</span>, <span class="number">0x19dffe0</span>, <span class="number">0x0</span>, <span class="number">0x19dfe00</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0040</span>, <span class="number">0x0</span>, <span class="number">0x19e0070</span>, <span class="number">0x19dfe60</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0070</span>, <span class="number">0x19e0040</span>, <span class="number">0x19e00a0</span>, <span class="number">0x19e01f0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e00a0</span>, <span class="number">0x19e0070</span>, <span class="number">0x19e00d0</span>, <span class="number">0x19dfec0</span>, <span class="number">0x10001</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e00d0</span>, <span class="number">0x19e00a0</span>, <span class="number">0x19e0100</span>, <span class="number">0x19e0250</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0100</span>, <span class="number">0x19e00d0</span>, <span class="number">0x19e0130</span>, <span class="number">0x19dff20</span>, <span class="number">0x1000000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0130</span>, <span class="number">0x19e0100</span>, <span class="number">0x19e0160</span>, <span class="number">0x19e02b0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0160</span>, <span class="number">0x19e0130</span>, <span class="number">0x19e0190</span>, <span class="number">0x19dff80</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0190</span>, <span class="number">0x19e0160</span>, <span class="number">0x19e01c0</span>, <span class="number">0x19e0310</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e01c0</span>, <span class="number">0x19e0190</span>, <span class="number">0x0</span>, <span class="number">0x19dffe0</span>, <span class="number">0x100</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e01f0</span>, <span class="number">0x0</span>, <span class="number">0x19e0220</span>, <span class="number">0x19e0070</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0220</span>, <span class="number">0x19e01f0</span>, <span class="number">0x19e0250</span>, <span class="number">0x0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0250</span>, <span class="number">0x19e0220</span>, <span class="number">0x19e0280</span>, <span class="number">0x19e00d0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e0280</span>, <span class="number">0x19e0250</span>, <span class="number">0x19e02b0</span>, <span class="number">0x0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e02b0</span>, <span class="number">0x19e0280</span>, <span class="number">0x19e02e0</span>, <span class="number">0x19e0130</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;,</span><br><span class="line">&#123;<span class="number">0x19e02e0</span>, <span class="number">0x19e02b0</span>, <span class="number">0x19e0310</span>, <span class="number">0x0</span>, <span class="number">0x10000</span>, <span class="number">0x0</span>, <span class="number">0x31</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n=<span class="number">54</span>,h[N],cnt,tot,st,ed,pr[N];</span><br><span class="line"><span class="type">bool</span> v[N];</span><br><span class="line">map&lt;<span class="type">long</span> <span class="type">long</span>,<span class="type">int</span>&gt;mp;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qwe</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> ne,to;</span><br><span class="line">	string va;</span><br><span class="line">&#125;e[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,string w)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//cout&lt;&lt;u&lt;&lt;&quot; &quot;&lt;&lt;v&lt;&lt;&quot; &quot;&lt;&lt;w&lt;&lt;endl;</span></span><br><span class="line">	cnt++;</span><br><span class="line">	e[cnt].ne=h[u];</span><br><span class="line">	e[cnt].to=v;</span><br><span class="line">	e[cnt].va=w;</span><br><span class="line">	h[u]=cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">		<span class="keyword">if</span>(!mp[a[i][<span class="number">0</span>]])</span><br><span class="line">			mp[a[i][<span class="number">0</span>]]=++tot;</span><br><span class="line">		</span><br><span class="line">	st=mp[<span class="number">0x19e0100</span>];</span><br><span class="line">	ed=mp[<span class="number">0x19df9b0</span>];</span><br><span class="line">	<span class="comment">// cout&lt;&lt;st&lt;&lt;&quot; &quot;&lt;&lt;ed&lt;&lt;endl;</span></span><br><span class="line">		</span><br><span class="line">	<span class="comment">//lrt</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(!(a[i][<span class="number">4</span>]&amp;<span class="number">0x1</span>))<span class="comment">//l</span></span><br><span class="line">			<span class="built_in">add</span>(mp[a[i][<span class="number">0</span>]],mp[a[i][<span class="number">1</span>]],<span class="string">&quot;l&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(!(a[i][<span class="number">4</span>]&amp;<span class="number">0x100</span>))<span class="comment">//r</span></span><br><span class="line">			<span class="built_in">add</span>(mp[a[i][<span class="number">0</span>]],mp[a[i][<span class="number">2</span>]],<span class="string">&quot;r&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(!(a[i][<span class="number">4</span>]&amp;<span class="number">0x10000</span>))<span class="comment">//t</span></span><br><span class="line">			<span class="built_in">add</span>(mp[a[i][<span class="number">0</span>]],mp[a[i][<span class="number">3</span>]],<span class="string">&quot;t&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	queue&lt;pair&lt;<span class="type">int</span>,string&gt; &gt;q;</span><br><span class="line">	v[st]=<span class="number">1</span>;</span><br><span class="line">	q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(st,<span class="string">&quot;&quot;</span>));</span><br><span class="line">	<span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		pair&lt;<span class="type">int</span>,string&gt;u=q.<span class="built_in">front</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="comment">// cout&lt;&lt;u.first&lt;&lt;endl;</span></span><br><span class="line">		<span class="keyword">if</span>(u.first==ed)</span><br><span class="line">		&#123;</span><br><span class="line">			cout&lt;&lt;u.second&lt;&lt;endl;</span><br><span class="line">			<span class="comment">//return 0;</span></span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=h[u.first];i;i=e[i].ne)</span><br><span class="line">			<span class="keyword">if</span>(!v[e[i].to])</span><br><span class="line">			&#123;</span><br><span class="line">				v[e[i].to]=<span class="number">1</span>;</span><br><span class="line">				q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(e[i].to,u.second+e[i].va));</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看别人的wp发现还能用pwntools来搞，学习一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">cmds = [<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;t&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">cmd_list</span>):</span><br><span class="line">    n=<span class="number">0</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p = process(<span class="string">&#x27;./maze&#x27;</span>)</span><br><span class="line">        p.recvuntil(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> cmd_list:</span><br><span class="line">            p.sendline(i)</span><br><span class="line">            rev = p.recvuntil(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(rev)</span><br><span class="line">        p.close()</span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ff</span>(<span class="params">cmd_list,f1</span>):</span><br><span class="line">    cmds = [<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;x&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> cmds:</span><br><span class="line">        c = [k <span class="keyword">for</span> k <span class="keyword">in</span> cmd_list]</span><br><span class="line">        c.append(i)</span><br><span class="line">        <span class="comment">#print(c)</span></span><br><span class="line">        <span class="comment">#print(cmd_list)</span></span><br><span class="line">        <span class="keyword">if</span> f(c) == <span class="built_in">len</span>(c):</span><br><span class="line">            c = ff(c,f1)</span><br><span class="line">            f1.write(<span class="built_in">str</span>(c))</span><br><span class="line">            f1.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(c)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    f1= <span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    cmd_list=[]</span><br><span class="line">    ff(cmd_list,f1)</span><br><span class="line">    f1.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>respect,很牛的方法，这个方法不需要i大python导出数据，直接程序里进行dfs跑。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/06/23/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/06/23/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-23 01:06:21" itemprop="dateCreated datePublished" datetime="2022-06-23T01:06:21+08:00">2022-06-23</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="bj777"
      src="/images/bitbug_favicon.ico">
  <p class="site-author-name" itemprop="name">bj777</p>
  <div class="site-description" itemprop="description">一位逆向菜狗</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">25</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/jonathanbest7" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jonathanbest7" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/506611735@qq.com" title="E-Mail → 506611735@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/bang-ji-1" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;bang-ji-1" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>知乎</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">bj777</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  
		<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
		<script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
		<script type="text/javascript" src="/js/src/fireworks.js"></script>
  
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":300,"height":600},"mobile":{"show":false},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
