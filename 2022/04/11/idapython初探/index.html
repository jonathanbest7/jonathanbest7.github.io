<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/bitbug_favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/bitbug_favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jonathanbest7.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="idapython初探也到了该系统学习idapython的阶段了！ 之前看别人的wp用的idapython在新的版本中已经不能用来，idapython升级了！现大概学习一下怎么用，然后在文档中学习： idapython官方函数文档：https:&#x2F;&#x2F;www.hex-rays.com&#x2F;products&#x2F;ida&#x2F;support&#x2F;idapython_docs&#x2F; 旧版本和新版本差异：https:&#x2F;&#x2F;www.">
<meta property="og:type" content="article">
<meta property="og:title" content="idapython初探">
<meta property="og:url" content="https://jonathanbest7.github.io/2022/04/11/idapython%E5%88%9D%E6%8E%A2/index.html">
<meta property="og:site_name" content="bj777的blog">
<meta property="og:description" content="idapython初探也到了该系统学习idapython的阶段了！ 之前看别人的wp用的idapython在新的版本中已经不能用来，idapython升级了！现大概学习一下怎么用，然后在文档中学习： idapython官方函数文档：https:&#x2F;&#x2F;www.hex-rays.com&#x2F;products&#x2F;ida&#x2F;support&#x2F;idapython_docs&#x2F; 旧版本和新版本差异：https:&#x2F;&#x2F;www.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://jonathanbest7.github.io/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411155039777.png">
<meta property="og:image" content="https://jonathanbest7.github.io/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411162518089.png">
<meta property="og:image" content="https://jonathanbest7.github.io/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411170422358.png">
<meta property="og:image" content="https://jonathanbest7.github.io/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411181105721.png">
<meta property="og:image" content="https://jonathanbest7.github.io/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411182506660.png">
<meta property="og:image" content="https://jonathanbest7.github.io/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411185445159.png">
<meta property="og:image" content="https://jonathanbest7.github.io/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411190928332.png">
<meta property="og:image" content="https://jonathanbest7.github.io/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411191332094.png">
<meta property="article:published_time" content="2022-04-11T07:30:31.000Z">
<meta property="article:modified_time" content="2022-07-17T16:43:34.628Z">
<meta property="article:author" content="bj777">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jonathanbest7.github.io/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411155039777.png">

<link rel="canonical" href="https://jonathanbest7.github.io/2022/04/11/idapython%E5%88%9D%E6%8E%A2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>idapython初探 | bj777的blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">bj777的blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">记录学习每一瞬间</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">32</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/04/11/idapython%E5%88%9D%E6%8E%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          idapython初探
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-04-11 15:30:31" itemprop="dateCreated datePublished" datetime="2022-04-11T15:30:31+08:00">2022-04-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-18 00:43:34" itemprop="dateModified" datetime="2022-07-18T00:43:34+08:00">2022-07-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="idapython初探"><a href="#idapython初探" class="headerlink" title="idapython初探"></a>idapython初探</h1><p>也到了该系统学习idapython的阶段了！</p>
<p>之前看别人的wp用的idapython在新的版本中已经不能用来，idapython升级了！现大概学习一下怎么用，然后在文档中学习：</p>
<p>idapython官方函数文档：<a target="_blank" rel="noopener" href="https://www.hex-rays.com/products/ida/support/idapython_docs/">https://www.hex-rays.com/products/ida/support/idapython_docs/</a></p>
<p>旧版本和新版本差异：<a target="_blank" rel="noopener" href="https://www.hex-rays.com/products/ida/support/ida74_idapython_no_bc695_porting_guide.shtml">https://www.hex-rays.com/products/ida/support/ida74_idapython_no_bc695_porting_guide.shtml</a></p>
<p>idapython图片集合版：<a target="_blank" rel="noopener" href="https://github.com/inforion/idapython-cheatsheet/blob/master/IDAPython-7x_cheatsheet_web_en.png">https://github.com/inforion/idapython-cheatsheet/blob/master/IDAPython-7x_cheatsheet_web_en.png</a></p>
<h2 id="1、获取函数地址"><a href="#1、获取函数地址" class="headerlink" title="1、获取函数地址"></a>1、获取函数地址</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(idc.here()))/<span class="comment">#获取当前在查看函数地址</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(idc.get_screen_ea()))<span class="comment">#获取当前在查看的函数地址</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(ida_ida.inf_get_min_ea()))<span class="comment">#获取这个程序最小的地址</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(ida_ida.inf_get_max_ea()))<span class="comment">#获取这个程序最大的地址</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(idc.read_selection_start()))<span class="comment">#如果你选择了某块地址 那么使用此函数则返回你选择的这块地址的起始地址,否则返回-1，选择的意思是光标选择其地址</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(idc.read_selection_end()))<span class="comment">#同上</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> idaapi.BADADDR == idc.here():</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;BadAddress addr invalid&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;addr is ok&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>idaapi.BADADDR</strong>，用来判断函数是否存在</p>
<h2 id="2-获取数值"><a href="#2-获取数值" class="headerlink" title="2.获取数值"></a>2.获取数值</h2><p>在之前看wp，用Byte永远是错的，今天才知道原来改了函数：</p>
<p><img src="/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411155039777.png" alt="image-20220411155039777"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">idc.get_wide_byte(addr)//以字节为单位获取地址处的值</span><br><span class="line">idc.get_wide_word(addr)//获取<span class="number">2</span>字节的值</span><br><span class="line">idc.get_wide_dword(addr)//获取<span class="number">4</span>字节</span><br><span class="line">idc.get_qword(addr)//获取<span class="number">8</span>字节</span><br></pre></td></tr></table></figure>

<p>下面进行一个获取当前地址下的数值操作，如果不是数据段，获得的是硬编码，在hex显示中能看到的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line">ea = idc.get_screen_ea()</span><br><span class="line">value = idc.get_wide_byte(ea)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(value)))</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">idc.isByte() Word Dwrd Qwrd</th>
<th align="center">ida_bytes.is_byte word dword qword</th>
</tr>
</thead>
</table>
<p>上面是对应的判断函数</p>
<h2 id="3-修改数值操作"><a href="#3-修改数值操作" class="headerlink" title="3.修改数值操作"></a>3.修改数值操作</h2><p>修改数值的方法，一般用patch，或者用python也行。</p>
<p><img src="/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411162518089.png" alt="image-20220411162518089"></p>
<p>当然修改的值韩式byte是1字节，word2字节，Dword4字节，Qword8字节</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ea = idc.get_screen_ea()</span><br><span class="line">value = idc.get_wide_byte(ea)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;修改前&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(value)))</span><br><span class="line">ida_bytes.patch_byte(ea,<span class="number">0x90</span>)</span><br><span class="line">value = idc.get_wide_byte(ea)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;修改前&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(value)))</span><br><span class="line"><span class="comment">#修改前0x0</span></span><br><span class="line"><span class="comment">#修改前0x90</span></span><br></pre></td></tr></table></figure>

<p>我们修改当前选中地址的数据</p>
<p>如果要将一段地址中所有0x0换成0x77，如何写呢？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line">start_addr = <span class="number">0x0040b1cd</span></span><br><span class="line">end_addr = <span class="number">0x0040b1ff</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(end_addr - start_addr):</span><br><span class="line">    now_addr = i + start_addr</span><br><span class="line">    tmp = idc.get_wide_byte(now_addr)</span><br><span class="line">    <span class="keyword">if</span> tmp == <span class="number">0</span>:</span><br><span class="line">        ida_bytes.patch_byte(now_addr,<span class="number">0x77</span>)</span><br></pre></td></tr></table></figure>

<p>我的建议是每次写的时候将三个import全部导入，反正就这三个。</p>
<h2 id="4-汇编提取"><a href="#4-汇编提取" class="headerlink" title="4.汇编提取"></a>4.汇编提取</h2><p><img src="/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411170422358.png" alt="image-20220411170422358"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line"></span><br><span class="line">ea = idc.here()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;当前模块基址&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(idaapi.get_imagebase())))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;当前汇编指令&#123;&#125;&quot;</span>.<span class="built_in">format</span>(idc.print_insn_mnem(ea)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;当前汇编语句&#123;&#125;&quot;</span>.<span class="built_in">format</span>(idc.GetDisasm(ea)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;当前操作数&#123;&#125;&quot;</span>.<span class="built_in">format</span>(idc.print_operand(ea,<span class="number">0</span>)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;当前的操作数值为: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(idc.get_operand_value(ea,<span class="number">0</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#当前模块基址0x400000</span></span><br><span class="line"><span class="comment">#当前汇编指令xor</span></span><br><span class="line"><span class="comment">#当前汇编语句xor     rsi, qword ptr [rsp+58h+PerformanceCount]</span></span><br><span class="line"><span class="comment">#当前操作数rsi</span></span><br><span class="line"><span class="comment">#当前的操作数值为: 6</span></span><br></pre></td></tr></table></figure>

<h2 id="5-段操作"><a href="#5-段操作" class="headerlink" title="5.段操作"></a>5.段操作</h2><p><img src="/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411181105721.png" alt="image-20220411181105721"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> seg <span class="keyword">in</span> idautils.Segments():</span><br><span class="line">    segname = idc.get_segm_name(seg)</span><br><span class="line">    segstart = idc.get_segm_start(seg)</span><br><span class="line">    segend = idc.get_segm_end(seg)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;段名 = &#123;&#125; 起始地址 = &#123;&#125; 结束地址 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(segname, <span class="built_in">hex</span>(segstart), <span class="built_in">hex</span>(segend)))</span><br><span class="line"><span class="comment">#段名 = .text 起始地址 = 0x401000 结束地址 = 0x404000</span></span><br><span class="line"><span class="comment">#段名 = .data 起始地址 = 0x404000 结束地址 = 0x405000</span></span><br><span class="line"><span class="comment">#段名 = .rdata 起始地址 = 0x405000 结束地址 = 0x406000</span></span><br><span class="line"><span class="comment">#段名 = .pdata 起始地址 = 0x406000 结束地址 = 0x407000</span></span><br><span class="line"><span class="comment">#段名 = .xdata 起始地址 = 0x407000 结束地址 = 0x408000</span></span><br><span class="line"><span class="comment">#段名 = .bss 起始地址 = 0x408000 结束地址 = 0x409000</span></span><br><span class="line"><span class="comment">#段名 = .idata 起始地址 = 0x4091dc 结束地址 = 0x40937c</span></span><br><span class="line"><span class="comment">#段名 = .CRT 起始地址 = 0x40a000 结束地址 = 0x40b000</span></span><br><span class="line"><span class="comment">#段名 = .tls 起始地址 = 0x40b000 结束地址 = 0x40c000</span></span><br></pre></td></tr></table></figure>

<h2 id="6-函数操作"><a href="#6-函数操作" class="headerlink" title="6.函数操作"></a>6.函数操作</h2><p><img src="/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411182506660.png" alt="image-20220411182506660"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> seg <span class="keyword">in</span> idautils.Segments():</span><br><span class="line">    segname = idc.get_segm_name(seg)</span><br><span class="line">    segstart = idc.get_segm_start(seg)</span><br><span class="line">    segend   = idc.get_segm_end(seg)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;段名 = &#123;&#125; 起始地址= &#123;&#125; 结束地址 = &#123;&#125; &quot;</span>.<span class="built_in">format</span>(segname,<span class="built_in">hex</span>(segstart),<span class="built_in">hex</span>(segend)))</span><br><span class="line">    <span class="keyword">if</span> segname == <span class="string">&#x27;.text&#x27;</span>:</span><br><span class="line">        <span class="keyword">for</span> funcaddr <span class="keyword">in</span> Functions(segstart, segend):</span><br><span class="line">            funname = idc.get_func_name(funcaddr)</span><br><span class="line">            funend = idc.find_func_end(funcaddr)</span><br><span class="line">            funnext = idc.get_next_func(funcaddr)</span><br><span class="line">            funnextname = idc.get_func_name(funnext)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;当前函数名 = &#123;&#125; 当前结束地址 = &#123;&#125; 下一个函数地址 = &#123;&#125; 下一个函数名 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(funname, <span class="built_in">hex</span>(funend), <span class="built_in">hex</span>(funnext), funnextname)) </span><br><span class="line">ea = idc.get_screen_ea()</span><br><span class="line">funnextoffset = idc.get_func_off_str(ea)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;当前选择地址距离当前函数的偏移：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(funnextoffset))</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">段名 = .text 起始地址= <span class="number">0x401000</span> 结束地址 = <span class="number">0x404000</span> </span><br><span class="line">当前函数名 = __mingw_invalidParameterHandler 当前结束地址 = <span class="number">0x401001</span> 下一个函数地址 = <span class="number">0x401010</span> 下一个函数名 = pre_c_init</span><br><span class="line">当前函数名 = pre_c_init 当前结束地址 = <span class="number">0x401121</span> 下一个函数地址 = <span class="number">0x401130</span> 下一个函数名 = pre_cpp_init</span><br><span class="line">当前函数名 = pre_cpp_init 当前结束地址 = <span class="number">0x401179</span> 下一个函数地址 = <span class="number">0x401180</span> 下一个函数名 = __tmainCRTStartup</span><br><span class="line">当前函数名 = __tmainCRTStartup 当前结束地址 = <span class="number">0x4014a6</span> 下一个函数地址 = <span class="number">0x4014b0</span> 下一个函数名 = WinMainCRTStartup</span><br><span class="line">当前函数名 = WinMainCRTStartup 当前结束地址 = <span class="number">0x4014d2</span> 下一个函数地址 = <span class="number">0x4014e0</span> 下一个函数名 = mainCRTStartup</span><br><span class="line">当前函数名 = mainCRTStartup 当前结束地址 = <span class="number">0x401502</span> 下一个函数地址 = <span class="number">0x401510</span> 下一个函数名 = atexit</span><br><span class="line">当前函数名 = atexit 当前结束地址 = <span class="number">0x401529</span> 下一个函数地址 = <span class="number">0x401530</span> 下一个函数名 = __gcc_register_frame</span><br><span class="line">当前函数名 = __gcc_register_frame 当前结束地址 = <span class="number">0x40153c</span> 下一个函数地址 = <span class="number">0x401540</span> 下一个函数名 = __gcc_deregister_frame</span><br><span class="line">当前函数名 = __gcc_deregister_frame 当前结束地址 = <span class="number">0x401541</span> 下一个函数地址 = <span class="number">0x401550</span> 下一个函数名 = <span class="built_in">input</span></span><br><span class="line">当前函数名 = <span class="built_in">input</span> 当前结束地址 = <span class="number">0x40163d</span> 下一个函数地址 = <span class="number">0x40163d</span> 下一个函数名 = output</span><br><span class="line">当前函数名 = output 当前结束地址 = <span class="number">0x401725</span> 下一个函数地址 = <span class="number">0x401725</span> 下一个函数名 = Findmax</span><br><span class="line">当前函数名 = Findmax 当前结束地址 = <span class="number">0x4017a6</span> 下一个函数地址 = <span class="number">0x4017a6</span> 下一个函数名 = sort</span><br><span class="line">当前函数名 = sort 当前结束地址 = <span class="number">0x4019a0</span> 下一个函数地址 = <span class="number">0x4019a0</span> 下一个函数名 = main</span><br><span class="line">当前函数名 = main 当前结束地址 = <span class="number">0x401aeb</span> 下一个函数地址 = <span class="number">0x401af0</span> 下一个函数名 = __do_global_dtors</span><br><span class="line">当前函数名 = __do_global_dtors 当前结束地址 = <span class="number">0x401b25</span> 下一个函数地址 = <span class="number">0x401b30</span> 下一个函数名 = __do_global_ctors</span><br><span class="line">当前函数名 = __do_global_ctors 当前结束地址 = <span class="number">0x401b96</span> 下一个函数地址 = <span class="number">0x401ba0</span> 下一个函数名 = __main</span><br><span class="line">当前函数名 = __main 当前结束地址 = <span class="number">0x401bbf</span> 下一个函数地址 = <span class="number">0x401bc0</span> 下一个函数名 = my_lconv_init</span><br><span class="line">当前函数名 = my_lconv_init 当前结束地址 = <span class="number">0x401bc7</span> 下一个函数地址 = <span class="number">0x401bd0</span> 下一个函数名 = _setargv</span><br><span class="line">当前函数名 = _setargv 当前结束地址 = <span class="number">0x401bd3</span> 下一个函数地址 = <span class="number">0x401be0</span> 下一个函数名 = __security_init_cookie</span><br><span class="line">当前函数名 = __security_init_cookie 当前结束地址 = <span class="number">0x401cb6</span> 下一个函数地址 = <span class="number">0x401cc0</span> 下一个函数名 = __report_gsfailure</span><br><span class="line">当前函数名 = __report_gsfailure 当前结束地址 = <span class="number">0x401db8</span> 下一个函数地址 = <span class="number">0x401dc0</span> 下一个函数名 = __dyn_tls_dtor</span><br><span class="line">当前函数名 = __dyn_tls_dtor 当前结束地址 = <span class="number">0x401def</span> 下一个函数地址 = <span class="number">0x401df0</span> 下一个函数名 = __dyn_tls_init</span><br><span class="line">当前函数名 = __dyn_tls_init 当前结束地址 = <span class="number">0x401e63</span> 下一个函数地址 = <span class="number">0x401e70</span> 下一个函数名 = __tlregdtor</span><br><span class="line">当前函数名 = __tlregdtor 当前结束地址 = <span class="number">0x401e73</span> 下一个函数地址 = <span class="number">0x401e80</span> 下一个函数名 = __mingw_raise_matherr</span><br><span class="line">当前函数名 = __mingw_raise_matherr 当前结束地址 = <span class="number">0x401ec1</span> 下一个函数地址 = <span class="number">0x401ed0</span> 下一个函数名 = __mingw_setusermatherr</span><br><span class="line">当前函数名 = __mingw_setusermatherr 当前结束地址 = <span class="number">0x401edc</span> 下一个函数地址 = <span class="number">0x401ee0</span> 下一个函数名 = _matherr</span><br><span class="line">当前函数名 = _matherr 当前结束地址 = <span class="number">0x401fdc</span> 下一个函数地址 = <span class="number">0x401fe0</span> 下一个函数名 = fpreset</span><br><span class="line">当前函数名 = fpreset 当前结束地址 = <span class="number">0x401fe3</span> 下一个函数地址 = <span class="number">0x401ff0</span> 下一个函数名 = _decode_pointer</span><br><span class="line">当前函数名 = _decode_pointer 当前结束地址 = <span class="number">0x401ff4</span> 下一个函数地址 = <span class="number">0x402000</span> 下一个函数名 = _encode_pointer</span><br><span class="line">当前函数名 = _encode_pointer 当前结束地址 = <span class="number">0x402004</span> 下一个函数地址 = <span class="number">0x402010</span> 下一个函数名 = __write_memory.part<span class="number">.0</span></span><br><span class="line">当前函数名 = __write_memory.part<span class="number">.0</span> 当前结束地址 = <span class="number">0x4021dc</span> 下一个函数地址 = <span class="number">0x4021e0</span> 下一个函数名 = _pei386_runtime_relocator</span><br><span class="line">当前函数名 = _pei386_runtime_relocator 当前结束地址 = <span class="number">0x40249a</span> 下一个函数地址 = <span class="number">0x4024a0</span> 下一个函数名 = __mingw_SEH_error_handler</span><br><span class="line">当前函数名 = __mingw_SEH_error_handler 当前结束地址 = <span class="number">0x402640</span> 下一个函数地址 = <span class="number">0x402640</span> 下一个函数名 = __mingw_init_ehandler</span><br><span class="line">当前函数名 = __mingw_init_ehandler 当前结束地址 = <span class="number">0x40272c</span> 下一个函数地址 = <span class="number">0x402920</span> 下一个函数名 = __mingwthr_run_key_dtors.part<span class="number">.0</span></span><br><span class="line">当前函数名 = __mingwthr_run_key_dtors.part<span class="number">.0</span> 当前结束地址 = <span class="number">0x40298a</span> 下一个函数地址 = <span class="number">0x402990</span> 下一个函数名 = ___w64_mingwthr_add_key_dtor</span><br><span class="line">当前函数名 = ___w64_mingwthr_add_key_dtor 当前结束地址 = <span class="number">0x402a0f</span> 下一个函数地址 = <span class="number">0x402a10</span> 下一个函数名 = ___w64_mingwthr_remove_key_dtor</span><br><span class="line">当前函数名 = ___w64_mingwthr_remove_key_dtor 当前结束地址 = <span class="number">0x402ab0</span> 下一个函数地址 = <span class="number">0x402ab0</span> 下一个函数名 = __mingw_TLScallback</span><br><span class="line">当前函数名 = __mingw_TLScallback 当前结束地址 = <span class="number">0x402b8a</span> 下一个函数地址 = <span class="number">0x402b90</span> 下一个函数名 = _ValidateImageBase.part<span class="number">.0</span></span><br><span class="line">当前函数名 = _ValidateImageBase.part<span class="number">.0</span> 当前结束地址 = <span class="number">0x402bae</span> 下一个函数地址 = <span class="number">0x402bb0</span> 下一个函数名 = _ValidateImageBase</span><br><span class="line">当前函数名 = _ValidateImageBase 当前结束地址 = <span class="number">0x402bc2</span> 下一个函数地址 = <span class="number">0x402bd0</span> 下一个函数名 = _FindPESection</span><br><span class="line">当前函数名 = _FindPESection 当前结束地址 = <span class="number">0x402c14</span> 下一个函数地址 = <span class="number">0x402c20</span> 下一个函数名 = _FindPESectionByName</span><br><span class="line">当前函数名 = _FindPESectionByName 当前结束地址 = <span class="number">0x402cad</span> 下一个函数地址 = <span class="number">0x402cb0</span> 下一个函数名 = __mingw_GetSectionForAddress</span><br><span class="line">当前函数名 = __mingw_GetSectionForAddress 当前结束地址 = <span class="number">0x402d24</span> 下一个函数地址 = <span class="number">0x402d30</span> 下一个函数名 = __mingw_GetSectionCount</span><br><span class="line">当前函数名 = __mingw_GetSectionCount 当前结束地址 = <span class="number">0x402d6e</span> 下一个函数地址 = <span class="number">0x402d70</span> 下一个函数名 = _FindPESectionExec</span><br><span class="line">当前函数名 = _FindPESectionExec 当前结束地址 = <span class="number">0x402ddf</span> 下一个函数地址 = <span class="number">0x402de0</span> 下一个函数名 = _GetPEImageBase</span><br><span class="line">当前函数名 = _GetPEImageBase 当前结束地址 = <span class="number">0x402e17</span> 下一个函数地址 = <span class="number">0x402e20</span> 下一个函数名 = _IsNonwritableInCurrentImage</span><br><span class="line">当前函数名 = _IsNonwritableInCurrentImage 当前结束地址 = <span class="number">0x402eb1</span> 下一个函数地址 = <span class="number">0x402ec0</span> 下一个函数名 = __mingw_enum_import_library_names</span><br><span class="line">当前函数名 = __mingw_enum_import_library_names 当前结束地址 = <span class="number">0x402f66</span> 下一个函数地址 = <span class="number">0x402f70</span> 下一个函数名 = ___chkstk_ms</span><br><span class="line">当前函数名 = ___chkstk_ms 当前结束地址 = <span class="number">0x402fa2</span> 下一个函数地址 = <span class="number">0x402fb0</span> 下一个函数名 = vfprintf</span><br><span class="line">当前函数名 = vfprintf 当前结束地址 = <span class="number">0x402fb6</span> 下一个函数地址 = <span class="number">0x402fb8</span> 下一个函数名 = strncmp</span><br><span class="line">当前函数名 = strncmp 当前结束地址 = <span class="number">0x402fbe</span> 下一个函数地址 = <span class="number">0x402fc0</span> 下一个函数名 = strlen</span><br><span class="line">当前函数名 = strlen 当前结束地址 = <span class="number">0x402fc6</span> 下一个函数地址 = <span class="number">0x402fc8</span> 下一个函数名 = signal</span><br><span class="line">当前函数名 = signal 当前结束地址 = <span class="number">0x402fce</span> 下一个函数地址 = <span class="number">0x402fd0</span> 下一个函数名 = scanf</span><br><span class="line">当前函数名 = scanf 当前结束地址 = <span class="number">0x402fd6</span> 下一个函数地址 = <span class="number">0x402fd8</span> 下一个函数名 = printf</span><br><span class="line">当前函数名 = printf 当前结束地址 = <span class="number">0x402fde</span> 下一个函数地址 = <span class="number">0x402fe0</span> 下一个函数名 = memcpy</span><br><span class="line">当前函数名 = memcpy 当前结束地址 = <span class="number">0x402fe6</span> 下一个函数地址 = <span class="number">0x402fe8</span> 下一个函数名 = malloc</span><br><span class="line">当前函数名 = malloc 当前结束地址 = <span class="number">0x402fee</span> 下一个函数地址 = <span class="number">0x402ff0</span> 下一个函数名 = fwrite</span><br><span class="line">当前函数名 = fwrite 当前结束地址 = <span class="number">0x402ff6</span> 下一个函数地址 = <span class="number">0x402ff8</span> 下一个函数名 = free</span><br><span class="line">当前函数名 = free 当前结束地址 = <span class="number">0x402ffe</span> 下一个函数地址 = <span class="number">0x403000</span> 下一个函数名 = fprintf</span><br><span class="line">当前函数名 = fprintf 当前结束地址 = <span class="number">0x403006</span> 下一个函数地址 = <span class="number">0x403008</span> 下一个函数名 = exit</span><br><span class="line">当前函数名 = exit 当前结束地址 = <span class="number">0x40300e</span> 下一个函数地址 = <span class="number">0x403010</span> 下一个函数名 = calloc</span><br><span class="line">当前函数名 = calloc 当前结束地址 = <span class="number">0x403016</span> 下一个函数地址 = <span class="number">0x403018</span> 下一个函数名 = abort</span><br><span class="line">当前函数名 = abort 当前结束地址 = <span class="number">0x40301e</span> 下一个函数地址 = <span class="number">0x403020</span> 下一个函数名 = _onexit</span><br><span class="line">当前函数名 = _onexit 当前结束地址 = <span class="number">0x403026</span> 下一个函数地址 = <span class="number">0x403028</span> 下一个函数名 = _initterm</span><br><span class="line">当前函数名 = _initterm 当前结束地址 = <span class="number">0x40302e</span> 下一个函数地址 = <span class="number">0x403030</span> 下一个函数名 = _cexit</span><br><span class="line">当前函数名 = _cexit 当前结束地址 = <span class="number">0x403036</span> 下一个函数地址 = <span class="number">0x403038</span> 下一个函数名 = _amsg_exit</span><br><span class="line">当前函数名 = _amsg_exit 当前结束地址 = <span class="number">0x40303e</span> 下一个函数地址 = <span class="number">0x403040</span> 下一个函数名 = __setusermatherr</span><br><span class="line">当前函数名 = __setusermatherr 当前结束地址 = <span class="number">0x403046</span> 下一个函数地址 = <span class="number">0x403048</span> 下一个函数名 = __set_app_type</span><br><span class="line">当前函数名 = __set_app_type 当前结束地址 = <span class="number">0x40304e</span> 下一个函数地址 = <span class="number">0x403050</span> 下一个函数名 = __lconv_init</span><br><span class="line">当前函数名 = __lconv_init 当前结束地址 = <span class="number">0x403056</span> 下一个函数地址 = <span class="number">0x403058</span> 下一个函数名 = __getmainargs</span><br><span class="line">当前函数名 = __getmainargs 当前结束地址 = <span class="number">0x40305e</span> 下一个函数地址 = <span class="number">0x403060</span> 下一个函数名 = __C_specific_handler</span><br><span class="line">当前函数名 = __C_specific_handler 当前结束地址 = <span class="number">0x403066</span> 下一个函数地址 = <span class="number">0x403070</span> 下一个函数名 = __acrt_iob_func</span><br><span class="line">当前函数名 = __acrt_iob_func 当前结束地址 = <span class="number">0x40308f</span> 下一个函数地址 = <span class="number">0x403090</span> 下一个函数名 = _get_invalid_parameter_handler</span><br><span class="line">当前函数名 = _get_invalid_parameter_handler 当前结束地址 = <span class="number">0x403098</span> 下一个函数地址 = <span class="number">0x4030a0</span> 下一个函数名 = _set_invalid_parameter_handler</span><br><span class="line">当前函数名 = _set_invalid_parameter_handler 当前结束地址 = <span class="number">0x4030ab</span> 下一个函数地址 = <span class="number">0x4030b0</span> 下一个函数名 = __p__acmdln</span><br><span class="line">当前函数名 = __p__acmdln 当前结束地址 = <span class="number">0x4030bb</span> 下一个函数地址 = <span class="number">0x4030c0</span> 下一个函数名 = __p__fmode</span><br><span class="line">当前函数名 = __p__fmode 当前结束地址 = <span class="number">0x4030cb</span> 下一个函数地址 = <span class="number">0x4030d0</span> 下一个函数名 = __iob_func</span><br><span class="line">当前函数名 = __iob_func 当前结束地址 = <span class="number">0x4030d6</span> 下一个函数地址 = <span class="number">0x4030e0</span> 下一个函数名 = VirtualQuery</span><br><span class="line">当前函数名 = VirtualQuery 当前结束地址 = <span class="number">0x4030e6</span> 下一个函数地址 = <span class="number">0x4030e8</span> 下一个函数名 = VirtualProtect</span><br><span class="line">当前函数名 = VirtualProtect 当前结束地址 = <span class="number">0x4030ee</span> 下一个函数地址 = <span class="number">0x4030f0</span> 下一个函数名 = UnhandledExceptionFilter</span><br><span class="line">当前函数名 = UnhandledExceptionFilter 当前结束地址 = <span class="number">0x4030f6</span> 下一个函数地址 = <span class="number">0x4030f8</span> 下一个函数名 = TlsGetValue</span><br><span class="line">当前函数名 = TlsGetValue 当前结束地址 = <span class="number">0x4030fe</span> 下一个函数地址 = <span class="number">0x403100</span> 下一个函数名 = TerminateProcess</span><br><span class="line">当前函数名 = TerminateProcess 当前结束地址 = <span class="number">0x403106</span> 下一个函数地址 = <span class="number">0x403108</span> 下一个函数名 = Sleep</span><br><span class="line">当前函数名 = Sleep 当前结束地址 = <span class="number">0x40310e</span> 下一个函数地址 = <span class="number">0x403110</span> 下一个函数名 = SetUnhandledExceptionFilter</span><br><span class="line">当前函数名 = SetUnhandledExceptionFilter 当前结束地址 = <span class="number">0x403116</span> 下一个函数地址 = <span class="number">0x403118</span> 下一个函数名 = RtlVirtualUnwind</span><br><span class="line">当前函数名 = RtlVirtualUnwind 当前结束地址 = <span class="number">0x40311e</span> 下一个函数地址 = <span class="number">0x403120</span> 下一个函数名 = RtlLookupFunctionEntry</span><br><span class="line">当前函数名 = RtlLookupFunctionEntry 当前结束地址 = <span class="number">0x403126</span> 下一个函数地址 = <span class="number">0x403128</span> 下一个函数名 = RtlCaptureContext</span><br><span class="line">当前函数名 = RtlCaptureContext 当前结束地址 = <span class="number">0x40312e</span> 下一个函数地址 = <span class="number">0x403130</span> 下一个函数名 = RtlAddFunctionTable</span><br><span class="line">当前函数名 = RtlAddFunctionTable 当前结束地址 = <span class="number">0x403136</span> 下一个函数地址 = <span class="number">0x403138</span> 下一个函数名 = QueryPerformanceCounter</span><br><span class="line">当前函数名 = QueryPerformanceCounter 当前结束地址 = <span class="number">0x40313e</span> 下一个函数地址 = <span class="number">0x403140</span> 下一个函数名 = LeaveCriticalSection</span><br><span class="line">当前函数名 = LeaveCriticalSection 当前结束地址 = <span class="number">0x403146</span> 下一个函数地址 = <span class="number">0x403148</span> 下一个函数名 = InitializeCriticalSection</span><br><span class="line">当前函数名 = InitializeCriticalSection 当前结束地址 = <span class="number">0x40314e</span> 下一个函数地址 = <span class="number">0x403150</span> 下一个函数名 = GetTickCount</span><br><span class="line">当前函数名 = GetTickCount 当前结束地址 = <span class="number">0x403156</span> 下一个函数地址 = <span class="number">0x403158</span> 下一个函数名 = GetSystemTimeAsFileTime</span><br><span class="line">当前函数名 = GetSystemTimeAsFileTime 当前结束地址 = <span class="number">0x40315e</span> 下一个函数地址 = <span class="number">0x403160</span> 下一个函数名 = GetStartupInfoA</span><br><span class="line">当前函数名 = GetStartupInfoA 当前结束地址 = <span class="number">0x403166</span> 下一个函数地址 = <span class="number">0x403168</span> 下一个函数名 = GetLastError</span><br><span class="line">当前函数名 = GetLastError 当前结束地址 = <span class="number">0x40316e</span> 下一个函数地址 = <span class="number">0x403170</span> 下一个函数名 = GetCurrentThreadId</span><br><span class="line">当前函数名 = GetCurrentThreadId 当前结束地址 = <span class="number">0x403176</span> 下一个函数地址 = <span class="number">0x403178</span> 下一个函数名 = GetCurrentProcessId</span><br><span class="line">当前函数名 = GetCurrentProcessId 当前结束地址 = <span class="number">0x40317e</span> 下一个函数地址 = <span class="number">0x403180</span> 下一个函数名 = GetCurrentProcess</span><br><span class="line">当前函数名 = GetCurrentProcess 当前结束地址 = <span class="number">0x403186</span> 下一个函数地址 = <span class="number">0x403188</span> 下一个函数名 = EnterCriticalSection</span><br><span class="line">当前函数名 = EnterCriticalSection 当前结束地址 = <span class="number">0x40318e</span> 下一个函数地址 = <span class="number">0x403190</span> 下一个函数名 = DeleteCriticalSection</span><br><span class="line">当前函数名 = DeleteCriticalSection 当前结束地址 = <span class="number">0x403196</span> 下一个函数地址 = <span class="number">0x4031a0</span> 下一个函数名 = .text_46</span><br><span class="line">当前函数名 = .text_46 当前结束地址 = <span class="number">0x403209</span> 下一个函数地址 = <span class="number">0x403210</span> 下一个函数名 = register_frame_ctor</span><br><span class="line">当前函数名 = register_frame_ctor 当前结束地址 = <span class="number">0x403215</span> 下一个函数地址 = <span class="number">0xffffffffffffffff</span> 下一个函数名 = </span><br><span class="line">段名 = .data 起始地址= <span class="number">0x404000</span> 结束地址 = <span class="number">0x405000</span> </span><br><span class="line">段名 = .rdata 起始地址= <span class="number">0x405000</span> 结束地址 = <span class="number">0x406000</span> </span><br><span class="line">段名 = .pdata 起始地址= <span class="number">0x406000</span> 结束地址 = <span class="number">0x407000</span> </span><br><span class="line">段名 = .xdata 起始地址= <span class="number">0x407000</span> 结束地址 = <span class="number">0x408000</span> </span><br><span class="line">段名 = .bss 起始地址= <span class="number">0x408000</span> 结束地址 = <span class="number">0x409000</span> </span><br><span class="line">段名 = .idata 起始地址= <span class="number">0x4091dc</span> 结束地址 = <span class="number">0x40937c</span> </span><br><span class="line">段名 = .CRT 起始地址= <span class="number">0x40a000</span> 结束地址 = <span class="number">0x40b000</span> </span><br><span class="line">段名 = .tls 起始地址= <span class="number">0x40b000</span> 结束地址 = <span class="number">0x40c000</span> </span><br><span class="line">当前选择地址距离当前函数的偏移：__security_init_cookie+9B</span><br></pre></td></tr></table></figure>

<h2 id="7-搜索函数"><a href="#7-搜索函数" class="headerlink" title="7.搜索函数"></a>7.搜索函数</h2><p><img src="/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411185445159.png" alt="image-20220411185445159"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">flag的取值：</span><br><span class="line">SEARCH_DOWN 向下搜索</span><br><span class="line">SEARCH_UP 向上搜索</span><br><span class="line">SEARCH_NEXT 获取下一个找到的对象。</span><br><span class="line">SEARCH_CASE 指定大小写敏感度</span><br><span class="line">SEARCH_UNICODE 搜索 Unicode 字符串。</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line"></span><br><span class="line">ea = idc.here()</span><br><span class="line">value = ida_search.find_binary(ea, SEARCH_DOWN, <span class="string">&#x27;8D 4D 08&#x27;</span>)</span><br><span class="line">value1 = ida_search.find_code(ea, SEARCH_DOWN)</span><br><span class="line">value2 = ida_search.find_data(ea, SEARCH_DOWN)</span><br></pre></td></tr></table></figure>

<p>上述idc.find_binary已经不用了，被ida_search.find_binary代替了</p>
<h2 id="8-数据检验函数"><a href="#8-数据检验函数" class="headerlink" title="8.数据检验函数"></a>8.数据检验函数</h2><p>也就是相当于进行一个判断，判断是否传回正确的值！</p>
<p><img src="/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411190928332.png" alt="image-20220411190928332"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line">ea = here()</span><br><span class="line">value1 = idc.find_code(ea,SEARCH_DOWN)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(value1))</span><br><span class="line">flag = ida_bytes.get_full_flags(value1)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(ida_bytes.is_code(flag))</span><br><span class="line"><span class="comment">#0x401c6e</span></span><br><span class="line"><span class="comment">#67465</span></span><br><span class="line"><span class="comment">#True</span></span><br></pre></td></tr></table></figure>

<h2 id="9-交叉引用"><a href="#9-交叉引用" class="headerlink" title="9.交叉引用"></a>9.交叉引用</h2><p><img src="/2022/04/11/idapython%E5%88%9D%E6%8E%A2/image-20220411191332094.png" alt="image-20220411191332094"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line">ea = here()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> CodeRefsTo(ea,<span class="literal">False</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(i))</span><br></pre></td></tr></table></figure>

<p>这个一般是对着函数用的。</p>
<p>就先写这么多，什么时候遇到再补充，最起码现在遇见idapython不慌了！</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/03/21/classic/" rel="prev" title="classicproblem">
      <i class="fa fa-chevron-left"></i> classicproblem
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/04/17/starCTF2022/" rel="next" title="XCTF2022">
      XCTF2022 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#idapython%E5%88%9D%E6%8E%A2"><span class="nav-text">idapython初探</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E8%8E%B7%E5%8F%96%E5%87%BD%E6%95%B0%E5%9C%B0%E5%9D%80"><span class="nav-text">1、获取函数地址</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E8%8E%B7%E5%8F%96%E6%95%B0%E5%80%BC"><span class="nav-text">2.获取数值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E4%BF%AE%E6%94%B9%E6%95%B0%E5%80%BC%E6%93%8D%E4%BD%9C"><span class="nav-text">3.修改数值操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E6%B1%87%E7%BC%96%E6%8F%90%E5%8F%96"><span class="nav-text">4.汇编提取</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E6%AE%B5%E6%93%8D%E4%BD%9C"><span class="nav-text">5.段操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E5%87%BD%E6%95%B0%E6%93%8D%E4%BD%9C"><span class="nav-text">6.函数操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-%E6%90%9C%E7%B4%A2%E5%87%BD%E6%95%B0"><span class="nav-text">7.搜索函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E6%95%B0%E6%8D%AE%E6%A3%80%E9%AA%8C%E5%87%BD%E6%95%B0"><span class="nav-text">8.数据检验函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-%E4%BA%A4%E5%8F%89%E5%BC%95%E7%94%A8"><span class="nav-text">9.交叉引用</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="bj777"
      src="/images/bitbug_favicon.ico">
  <p class="site-author-name" itemprop="name">bj777</p>
  <div class="site-description" itemprop="description">一位逆向菜狗</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">32</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/jonathanbest7" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jonathanbest7" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/506611735@qq.com" title="E-Mail → 506611735@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/bang-ji-1" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;bang-ji-1" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>知乎</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">bj777</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  
		<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
		<script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
		<script type="text/javascript" src="/js/src/fireworks.js"></script>
  
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":300,"height":600},"mobile":{"show":false},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
