<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/bitbug_favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/bitbug_favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jonathanbest7.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Angr有好几个题目，我们全部用angr来做， 00_angr_find1234567891011121314151617int __cdecl main(int argc, const char **argv, const char **envp)&amp;#123;  int i; &#x2F;&#x2F; [esp+1Ch] [ebp-1Ch]  char s1[9]; &#x2F;&#x2F; [esp+23h] [ebp-15h] B">
<meta property="og:type" content="article">
<meta property="og:title" content="angr">
<meta property="og:url" content="https://jonathanbest7.github.io/2022/03/12/angr/index.html">
<meta property="og:site_name" content="bj777的blog">
<meta property="og:description" content="Angr有好几个题目，我们全部用angr来做， 00_angr_find1234567891011121314151617int __cdecl main(int argc, const char **argv, const char **envp)&amp;#123;  int i; &#x2F;&#x2F; [esp+1Ch] [ebp-1Ch]  char s1[9]; &#x2F;&#x2F; [esp+23h] [ebp-15h] B">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://jonathanbest7.github.io/2022/03/12/angr/image-20220312141817120.png">
<meta property="og:image" content="https://jonathanbest7.github.io/2022/03/12/angr/image-20220312150126326.png">
<meta property="og:image" content="https://jonathanbest7.github.io/2022/03/12/angr/image-20220312161752967.png">
<meta property="og:image" content="https://jonathanbest7.github.io/Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220313151556700.png">
<meta property="og:image" content="https://jonathanbest7.github.io/2022/03/12/angr/image-20220315122941509.png">
<meta property="article:published_time" content="2022-03-12T03:40:18.000Z">
<meta property="article:modified_time" content="2022-07-17T16:18:47.149Z">
<meta property="article:author" content="bj777">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jonathanbest7.github.io/2022/03/12/angr/image-20220312141817120.png">

<link rel="canonical" href="https://jonathanbest7.github.io/2022/03/12/angr/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>angr | bj777的blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">bj777的blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">记录学习每一瞬间</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">34</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jonathanbest7.github.io/2022/03/12/angr/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/bitbug_favicon.ico">
      <meta itemprop="name" content="bj777">
      <meta itemprop="description" content="一位逆向菜狗">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bj777的blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          angr
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-12 11:40:18" itemprop="dateCreated datePublished" datetime="2022-03-12T11:40:18+08:00">2022-03-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-18 00:18:47" itemprop="dateModified" datetime="2022-07-18T00:18:47+08:00">2022-07-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Angr"><a href="#Angr" class="headerlink" title="Angr"></a>Angr</h1><p>有好几个题目，我们全部用angr来做，</p>
<h2 id="00-angr-find"><a href="#00-angr-find" class="headerlink" title="00_angr_find"></a>00_angr_find</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+1Ch] [ebp-1Ch]</span></span><br><span class="line">  <span class="type">char</span> s1[<span class="number">9</span>]; <span class="comment">// [esp+23h] [ebp-15h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [esp+2Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%8s&quot;</span>, s1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">    s1[i] = complex_function(s1[i], i);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;ILIUFVJF&quot;</span>) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>comlex函数中也就是一个if函数和return，并不难，如何用angr写脚本是一个难的问题</p>
<p>angr的使用也比较麻烦，因为angr带有z3，如果直接安装，会出现问题，这个z3与python的z3是由一点去别的，所以我们每次用都要搞一个虚拟环境，我们每次使用先打开虚拟环境：</p>
<p>其实只用后两个命令都行</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd</span><br><span class="line">sudo apt-<span class="built_in">get</span> install python-dev libffi-dev build-essential virtualenvwrapper</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">WORKON_HOME</span>=~/HOME</span><br><span class="line"><span class="attribute">VIRTUALENVWRAPPER_PYTHON</span>=/usr/bin/python3</span><br><span class="line">source /usr/share/virtualenvwrapper/virtualenvwrapper.sh</span><br><span class="line">mkvirtualenv <span class="attribute">--python</span>=$(which python3) angr &amp;&amp; pip install angr</span><br></pre></td></tr></table></figure>

<p>这样就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">argv</span>):</span><br><span class="line">    <span class="comment">#目标文件路径</span></span><br><span class="line">    path_to_binary = <span class="string">&#x27;./00_angr_find/00_angr_find&#x27;</span></span><br><span class="line">    <span class="comment">#创建项目</span></span><br><span class="line">    project = angr.Project(path_to_binary)</span><br><span class="line">    <span class="comment">#设置项目起点，entry_state是程序的入口处，相当于main</span></span><br><span class="line">    initial_state = project.factory.entry_state()</span><br><span class="line">    <span class="comment">#设置模拟器</span></span><br><span class="line">    simulation = project.factory.simgr(initial_state)</span><br><span class="line">    <span class="comment">#设置目标地址</span></span><br><span class="line">    print_good_addr = <span class="number">0x08048694</span></span><br><span class="line">    simulation.explore(find=print_good_addr)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#如果到达目标地址，打印此时符号向量</span></span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))</span><br><span class="line"></span><br><span class="line">        <span class="comment">#无解或出错抛出异常</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not find solution&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main(sys.argv)</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(angr) ┌─(~/syclover/angr/decode)───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────(jonathan@DESKTOP-4L3BSKM:pts/0)─┐</span><br><span class="line">└─(12:51:45)──&gt; python3 angr0.py</span><br><span class="line">WARNING | 2022-03-12 12:53:13,212 | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line">WARNING | 2022-03-12 12:53:13,212 | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line">WARNING | 2022-03-12 12:53:13,212 | angr.storage.memory_mixins.default_filler_mixin | 1) setting a value to the initial state</span><br><span class="line">WARNING | 2022-03-12 12:53:13,212 | angr.storage.memory_mixins.default_filler_mixin | 2) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line">WARNING | 2022-03-12 12:53:13,212 | angr.storage.memory_mixins.default_filler_mixin | 3) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line">WARNING | 2022-03-12 12:53:13,213 | angr.storage.memory_mixins.default_filler_mixin | Filling register edi with 4 unconstrained bytes referenced from 0x80486c1 (__libc_csu_init+0x1 in 00_angr_find (0x80486c1))</span><br><span class="line">WARNING | 2022-03-12 12:53:14,270 | angr.storage.memory_mixins.default_filler_mixin | Filling memory at 0x7ffeff50 with 4 unconstrained bytes referenced from 0x8186b80 (strcmp+0x0 in libc.so.6 (0x86b80))</span><br><span class="line">b&#x27;IICLTGRK&#x27;</span><br></pre></td></tr></table></figure>

<p>得到结果。</p>
<p><strong>sys.argv</strong></p>
<p>传递给Python脚本的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%91%BD%E4%BB%A4%E8%A1%8C&spm=1001.2101.3001.7020">命令行</a>参数列表。argv[0]是脚本名称（依赖于操作系统，无论这是否是完整路径名）。如果使用-c解释器的命令行选项执行命令，argv[0]则将其设置为字符串’-c’。如果没有脚本名称传递给Python解释器，argv[0]则为空字符串。</p>
<p>这个就是命令行输入</p>
<h3 id="if-name-x3D-x3D-‘main‘"><a href="#if-name-x3D-x3D-‘main‘" class="headerlink" title="if name &#x3D;&#x3D; ‘main‘:"></a>if <strong>name</strong> &#x3D;&#x3D; ‘<strong>main</strong>‘:</h3><p>不能在import引用的脚本中执行。一个python文件通常有两种使用方法，第一是作为脚本直接执行，第二是 import 到其他的 python 脚本中被调用（模块重用）执行。因此 if <strong>name</strong> &#x3D;&#x3D; ‘main’: 的作用就是控制这两种情况执行代码的过程，在 if <strong>name</strong> &#x3D;&#x3D; ‘main’: 下的代码只有在第一种情况下</p>
<h3 id="factory"><a href="#factory" class="headerlink" title="factory"></a>factory</h3><p>angr中有许多使用时需要一个实例化的project的类，可以使用project.factory而不用把project到处传递。</p>
<p><strong>states</strong></p>
<p>Project对象只代表程序的一个初始化镜像，当你使用angr来执行时，你在使用一个表示模拟程序状态的一个特殊对象SimState</p>
<h2 id="01-angr-avoid"><a href="#01-angr-avoid" class="headerlink" title="01_angr_avoid"></a>01_angr_avoid</h2><p>通过字符串搜索到good job</p>
<p>这一题是明显让我们使用avoid，那么avoid其实就是告诉脚本不要走哪边。</p>
<p>主函数太大，无法反编译，估计是有很多别的路，所以要加avoid，我们可以用上一个脚本，但稍微改一下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> doctest <span class="keyword">import</span> FAIL_FAST</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">argv</span>):</span><br><span class="line">    path_to_binary = <span class="string">&#x27;../solutions/01_angr_avoid/01_angr_avoid&#x27;</span></span><br><span class="line">    project = angr.Project(path_to_binary)</span><br><span class="line"></span><br><span class="line">    initial_state = project.factory.entry_state()</span><br><span class="line"></span><br><span class="line">    simulation = project.factory.simgr(initial_state)</span><br><span class="line">    print_good_address = <span class="number">0x080485FC</span></span><br><span class="line">    fail_address = <span class="number">0x0804860E</span></span><br><span class="line">    simulation.explore(find=print_good_address,avoid=fail_address)</span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not find solution&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main(sys.argv)</span><br></pre></td></tr></table></figure>

<p>我们只是在模拟器中添加了avoid。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">12</span>:<span class="number">22</span>,<span class="number">299</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">12</span>:<span class="number">22</span>,<span class="number">299</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">12</span>:<span class="number">22</span>,<span class="number">299</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">12</span>:<span class="number">22</span>,<span class="number">299</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">12</span>:<span class="number">22</span>,<span class="number">299</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">12</span>:<span class="number">22</span>,<span class="number">300</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x80d45b1 (__libc_csu_init+<span class="number">0</span>x1 in <span class="number">01</span>_angr_avoid (<span class="number">0</span>x80d45b1))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">12</span>:<span class="number">51</span>,<span class="number">054</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="number">0</span>x7ffeff1d with <span class="number">11</span> unconstrained bytes referenced from <span class="number">0</span>x8187170 (strncmp+<span class="number">0</span>x0 in libc.so.<span class="number">6</span> (<span class="number">0</span>x87170))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">12</span>:<span class="number">51</span>,<span class="number">054</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="number">0</span>x7ffeff40 with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x8187170 (strncmp+<span class="number">0</span>x0 in libc.so.<span class="number">6</span> (<span class="number">0</span>x87170))</span><br><span class="line"><span class="attribute">b</span>&#x27;JLVUSGJZ&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="02-angr-find-condition"><a href="#02-angr-find-condition" class="headerlink" title="02_angr_find_condition"></a>02_angr_find_condition</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+18h] [ebp-40h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [esp+1Ch] [ebp-3Ch]</span></span><br><span class="line">  <span class="type">char</span> s1[<span class="number">20</span>]; <span class="comment">// [esp+24h] [ebp-34h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s2[<span class="number">20</span>]; <span class="comment">// [esp+38h] [ebp-20h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v8; <span class="comment">// [esp+4Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">19</span>; ++i )</span><br><span class="line">    s2[i] = <span class="number">0</span>;</span><br><span class="line">  qmemcpy(s2, <span class="string">&quot;CAWMCZTB&quot;</span>, <span class="number">8</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%8s&quot;</span>, s1);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">7</span>; ++j )</span><br><span class="line">    s1[j] = complex_function(s1[j], j + <span class="number">8</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, s2) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个题哦，看上去没啥区别，当我们找puts时，就会出现问题</p>
<p><img src="/2022/03/12/angr/image-20220312141817120.png"></p>
<p>这么多puts：good，应该怎么办，解决方法是通过判断控制台输出数据是不是”Good Job” 和”Try again” 来确认执行到了成功还是失败分支.即我们不再确认地址，我们只看输出是不是我们想要的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">argv</span>):</span><br><span class="line">    path = <span class="string">&#x27;../solutions/02_angr_find_condition/02_angr_find_condition&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line">    state = project.factory.entry_state()</span><br><span class="line">    simulation = project.factory.simgr(state)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">good_job</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Good Job&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line">    <span class="comment">#含义就是在所有输出里找try again</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">try_again</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Try again&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line">    </span><br><span class="line">    simulation.explore(find=good_job,avoid=try_again)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        <span class="comment">#下面是打印输入流，输出是stdout</span></span><br><span class="line">        <span class="built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;NOooooooo!&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main(sys.argv)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">41</span>:<span class="number">20</span>,<span class="number">664</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">41</span>:<span class="number">20</span>,<span class="number">664</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">41</span>:<span class="number">20</span>,<span class="number">664</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">41</span>:<span class="number">20</span>,<span class="number">664</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">41</span>:<span class="number">20</span>,<span class="number">664</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">41</span>:<span class="number">20</span>,<span class="number">664</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x804d2a1 (__libc_csu_init+<span class="number">0</span>x1 in <span class="number">02</span>_angr_find_condition (<span class="number">0</span>x804d2a1))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">41</span>:<span class="number">21</span>,<span class="number">644</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="number">0</span>x7ffeff0d with <span class="number">11</span> unconstrained bytes referenced from <span class="number">0</span>x8186b80 (strcmp+<span class="number">0</span>x0 in libc.so.<span class="number">6</span> (<span class="number">0</span>x86b80))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">41</span>:<span class="number">21</span>,<span class="number">644</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="number">0</span>x7ffeff30 with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x8186b80 (strcmp+<span class="number">0</span>x0 in libc.so.<span class="number">6</span> (<span class="number">0</span>x86b80))</span><br><span class="line"><span class="attribute">b</span>&#x27;OHYJUMBE&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="03-angr-symbolic-registers"><a href="#03-angr-symbolic-registers" class="headerlink" title="03_angr_symbolic_registers"></a>03_angr_symbolic_registers</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 user_input; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp+4h] [ebp-14h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp+8h] [ebp-10h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  user_input = get_user_input();</span><br><span class="line">  v7 = HIDWORD(user_input);</span><br><span class="line">  v5 = complex_function_1(user_input);</span><br><span class="line">  v6 = complex_function_2();</span><br><span class="line">  v8 = complex_function_3(v7);</span><br><span class="line">  <span class="keyword">if</span> ( v5 || v6 || v8 )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>三个complex，里面全是运算，有一点这三个函数只有两个有参数，但我们看汇编发现其实是有三个值，那么我们只需要求出eax，ebx，edx的值就行了</p>
<p><img src="/2022/03/12/angr/image-20220312150126326.png"></p>
<p>那么我们就要学会如何从寄存器中获得输入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/03_angr_symbolic_registers/03_angr_symbolic_registers&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line">    <span class="comment">#自己设置项目起始地址</span></span><br><span class="line">    start_addr = <span class="number">0x080488C7</span></span><br><span class="line">    state = project.factory.blank_state(addr=start_addr)</span><br><span class="line"></span><br><span class="line">    bit_lenth = <span class="number">32</span></span><br><span class="line">    psd0 = claripy.BVS(<span class="string">&#x27;psd0&#x27;</span>,bit_lenth)</span><br><span class="line">    psd1 = claripy.BVS(<span class="string">&#x27;psd1&#x27;</span>,bit_lenth)</span><br><span class="line">    psd2 = claripy.BVS(<span class="string">&#x27;psd2&#x27;</span>,bit_lenth)</span><br><span class="line"></span><br><span class="line">    state.regs.eax = psd0</span><br><span class="line">    state.regs.ebx = psd1</span><br><span class="line">    state.regs.edx = psd2</span><br><span class="line"></span><br><span class="line">    simulation = project.factory.simgr(state)</span><br><span class="line"></span><br><span class="line">    good_add = <span class="number">0x0804892F</span></span><br><span class="line">    fail_add = <span class="number">0x0804891D</span></span><br><span class="line">    simulation.explore(find=good_add,avoid=fail_add)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        <span class="comment">#如何进行寄存器输出</span></span><br><span class="line">        solution0 =solution_state.se.<span class="built_in">eval</span>(psd0)</span><br><span class="line">        solution1 =solution_state.se.<span class="built_in">eval</span>(psd1)</span><br><span class="line">        solution2 =solution_state.se.<span class="built_in">eval</span>(psd2)</span><br><span class="line">        solution = <span class="string">&#x27; &#x27;</span>.join(<span class="built_in">map</span>(<span class="string">&#x27;&#123;:x&#125;&#x27;</span>.<span class="built_in">format</span>,[solution0,solution1,solution2]))</span><br><span class="line">        <span class="built_in">print</span>(solution)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;Noooooooo!&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最主要的是，如果我们要从寄存器中找数据，那么我们一定要自己把函数位置找到，因为寄存器是会变的。</p>
<p>初始化寄存器操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bit_length = <span class="number">32</span></span><br><span class="line">psd0 = claripy.BVS(<span class="string">&#x27;psd0&#x27;</span>, bit_length)</span><br><span class="line">initial_state.regs.eax = psd0</span><br></pre></td></tr></table></figure>

<h3 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h3><p>是Python的一个内置函数，功能十分强大，这个函数的作用是，返回传入字符串的表达式的结果。就是说：将字符串当成有效的表达式 来求值 并 返回计算结果。</p>
<h3 id="formamt"><a href="#formamt" class="headerlink" title="formamt"></a>formamt</h3><p>fotmat作为Python的的格式字符串函数，主要通过字符串中的花括号{}，来识别替换字段，从而完成字符串的格式化。</p>
<p>上面主要是变成十六进制再连起来</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">15</span>:<span class="number">33</span>:<span class="number">58</span>,<span class="number">675</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">15</span>:<span class="number">33</span>:<span class="number">58</span>,<span class="number">676</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">15</span>:<span class="number">33</span>:<span class="number">58</span>,<span class="number">676</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">15</span>:<span class="number">33</span>:<span class="number">58</span>,<span class="number">676</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">15</span>:<span class="number">33</span>:<span class="number">58</span>,<span class="number">676</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">15</span>:<span class="number">33</span>:<span class="number">58</span>,<span class="number">676</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebp with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x80488c7 (main+<span class="number">0</span>x26 in <span class="number">03</span>_angr_symbolic_registers (<span class="number">0</span>x80488c7))</span><br><span class="line"><span class="attribute">CRITICAL</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">15</span>:<span class="number">33</span>:<span class="number">59</span>,<span class="number">119</span> | angr.sim_state | The name state.se is deprecated; please use state.solver.</span><br><span class="line"><span class="attribute">e9b37483</span> <span class="number">7</span>aab5fde <span class="number">8</span>f5b48ea</span><br></pre></td></tr></table></figure>

<p>总结：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">project<span class="selector-class">.factory</span><span class="selector-class">.blank_state</span>(addr=start_address) =&gt; 创建自定义入口的状态上下文</span><br><span class="line"></span><br><span class="line">initial_state<span class="selector-class">.regs</span> =&gt; 操作状态上下文的寄存器</span><br><span class="line"></span><br><span class="line">claripy<span class="selector-class">.BVS</span>(<span class="string">&#x27;变量名&#x27;</span>, 变量大小) =&gt; 创建求解变量</span><br><span class="line"></span><br><span class="line">solution_state<span class="selector-class">.se</span><span class="selector-class">.eval</span>(变量) =&gt; 求解符号变量</span><br></pre></td></tr></table></figure>



<h2 id="04-angr-symbolic-stack"><a href="#04-angr-symbolic-stack" class="headerlink" title="04_angr_symbolic_stack"></a>04_angr_symbolic_stack</h2><p>这个题又不一样了，这个是局部变量</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  handle_user();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">handle_user</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [esp+8h] [ebp-10h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v2[<span class="number">3</span>]; <span class="comment">// [esp+Ch] [ebp-Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%u %u&quot;</span>, v2, &amp;v1);</span><br><span class="line">  v2[<span class="number">0</span>] = complex_function0(v2[<span class="number">0</span>]);</span><br><span class="line">  v1 = complex_function1(v1);</span><br><span class="line">  <span class="keyword">if</span> ( v2[<span class="number">0</span>] == <span class="number">2083606899</span> &amp;&amp; v1 == <span class="number">-99478518</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们知道局部变量是储存在栈中的，所以我们要构造栈上的内存</p>
<p><img src="/2022/03/12/angr/image-20220312161752967.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mimetypes <span class="keyword">import</span> init</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    binary_path = <span class="string">&#x27;../solutions/04_angr_symbolic_stack/04_angr_symbolic_stack&#x27;</span></span><br><span class="line">    project = angr.Project(binary_path)</span><br><span class="line"></span><br><span class="line">    start_addr = <span class="number">0x080486AE</span></span><br><span class="line">    initial_state = project.factory.blank_state(addr=start_addr)</span><br><span class="line"></span><br><span class="line">    initial_state.regs.ebp = initial_state.regs.esp <span class="comment"># 初始化栈，令ebp等于esp</span></span><br><span class="line"></span><br><span class="line">    password0 = claripy.BVS(<span class="string">&#x27;password0&#x27;</span>, <span class="number">32</span>) <span class="comment"># 初始化两个位向量</span></span><br><span class="line">    password1 = claripy.BVS(<span class="string">&#x27;password1&#x27;</span>, <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">    padding_length_in_bytes = <span class="number">0x8</span> <span class="comment"># 填充栈 integer * 2</span></span><br><span class="line">    initial_state.regs.esp -= padding_length_in_bytes </span><br><span class="line"></span><br><span class="line">    initial_state.stack_push(password0) <span class="comment"># 将位向量压入栈中</span></span><br><span class="line">    initial_state.stack_push(password1)</span><br><span class="line"></span><br><span class="line">    simulation = project.factory.simgr(initial_state)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_successful</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;Good Job&#x27;</span> <span class="keyword">in</span> stdout_output</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">should_abort</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;Try again&#x27;</span> <span class="keyword">in</span> stdout_output</span><br><span class="line"></span><br><span class="line">    simulation.explore(find=is_successful, avoid=should_abort)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        solution0 = solution_state.se.<span class="built_in">eval</span>(password0)</span><br><span class="line">        solution1 = solution_state.se.<span class="built_in">eval</span>(password1)</span><br><span class="line"></span><br><span class="line">        solution = <span class="string">&#x27;%u %u&#x27;</span> % (solution0, solution1)</span><br><span class="line">        <span class="built_in">print</span>(solution)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;could not find the solution&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>符号化栈空间的运用：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">initial_state<span class="number">.</span>regs<span class="number">.</span><span class="built_in">ebp</span> = initial_state<span class="number">.</span>regs<span class="number">.</span><span class="built_in">esp</span> # 初始化栈，令<span class="built_in">ebp</span>等于<span class="built_in">esp</span></span><br><span class="line"></span><br><span class="line">padding_length_in_bytes = <span class="number">0xC</span> # 填充栈</span><br><span class="line">initial_state<span class="number">.</span>regs<span class="number">.</span><span class="built_in">esp</span> -= padding_length_in_bytes </span><br><span class="line"></span><br><span class="line">initial_state<span class="number">.</span>stack_push(password0) # 将位向量压入栈中</span><br></pre></td></tr></table></figure>

<h2 id="05-angr-symbolic-memory"><a href="#05-angr-symbolic-memory" class="headerlink" title="05_angr_symbolic_memory"></a>05_angr_symbolic_memory</h2><p>这个题考的是bss段的输入，我们要构造bss段符号表示</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(user_input, <span class="number">0</span>, <span class="number">0x21</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%8s %8s %8s %8s&quot;</span>, user_input, &amp;unk_AB232C8, &amp;unk_AB232D0, &amp;unk_AB232D8);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">    *(_BYTE *)(i + <span class="number">179450560</span>) = complex_function(*(<span class="type">char</span> *)(i + <span class="number">179450560</span>), i);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(user_input, <span class="string">&quot;OSIWHBXIFOQVSBZBISILSCLBIAXSEWUT&quot;</span>, <span class="number">0x20</span>u) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">complex_function</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1 &lt;= <span class="number">64</span> || a1 &gt; <span class="number">90</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (<span class="number">9</span> * a2 + a1 - <span class="number">65</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>给出脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">agrv</span>):</span><br><span class="line">    path = <span class="string">&#x27;../solutions/05_angr_symbolic_memory/05_angr_symbolic_memory&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line">    adds = <span class="number">0x08048618</span><span class="comment">#scanf后</span></span><br><span class="line">    state = project.factory.blank_state(add=adds)</span><br><span class="line">    <span class="comment"># 64 = 8(8个字符) * 1(每个字符一字节) * 8(每个字节8比特)</span></span><br><span class="line">    psd0 =claripy.BVS(<span class="string">&#x27;psd0&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">    psd1 =claripy.BVS(<span class="string">&#x27;psd1&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">    psd2 =claripy.BVS(<span class="string">&#x27;psd2&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">    psd3 =claripy.BVS(<span class="string">&#x27;psd3&#x27;</span>,<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">    psd0_add = <span class="number">0x0AB232C0</span></span><br><span class="line">    psd1_add = <span class="number">0x0AB232C8</span></span><br><span class="line">    psd2_add = <span class="number">0x0AB232D0</span></span><br><span class="line">    psd3_add = <span class="number">0x0AB232D8</span> </span><br><span class="line"></span><br><span class="line">    state.memory.store(psd0_add,psd0)<span class="comment">#把位向量存入内存</span></span><br><span class="line">    state.memory.store(psd1_add,psd1)</span><br><span class="line">    state.memory.store(psd2_add,psd2)</span><br><span class="line">    state.memory.store(psd3_add,psd3)</span><br><span class="line"></span><br><span class="line">    simulation = project.factory.simgr(state)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">good_add</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Good Job.&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fail_add</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Try again.&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line"></span><br><span class="line">    simulation.explore(find=good_add,avoid=fail_add)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        solution0 = solution_state.se.<span class="built_in">eval</span>(psd0)</span><br><span class="line">        solution1 = solution_state.se.<span class="built_in">eval</span>(psd1)</span><br><span class="line">        solution2 = solution_state.se.<span class="built_in">eval</span>(psd2)</span><br><span class="line">        solution3 = solution_state.se.<span class="built_in">eval</span>(psd3)</span><br><span class="line">        solution = <span class="string">&#x27; &#x27;</span>.join(<span class="built_in">map</span>(<span class="string">&#x27;&#123;:x&#125;&#x27;</span>.<span class="built_in">format</span>, [ solution0, solution1,solution2,solution3 ]))</span><br><span class="line">        <span class="built_in">print</span>(solution)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;Noooooooo!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main(sys.argv)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">20</span>:<span class="number">06</span>:<span class="number">00</span>,<span class="number">666</span> | angr.sim_state | Unused keyword arguments passed to SimState: add</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">20</span>:<span class="number">06</span>:<span class="number">00</span>,<span class="number">673</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">20</span>:<span class="number">06</span>:<span class="number">00</span>,<span class="number">674</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">20</span>:<span class="number">06</span>:<span class="number">00</span>,<span class="number">674</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">20</span>:<span class="number">06</span>:<span class="number">00</span>,<span class="number">674</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">20</span>:<span class="number">06</span>:<span class="number">00</span>,<span class="number">674</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">20</span>:<span class="number">06</span>:<span class="number">00</span>,<span class="number">674</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="number">0</span>x7fff0000 with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x8048432 (_start+<span class="number">0</span>x2 in <span class="number">05</span>_angr_symbolic_memory (<span class="number">0</span>x8048432))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">20</span>:<span class="number">06</span>:<span class="number">00</span>,<span class="number">675</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register eax with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x8048438 (_start+<span class="number">0</span>x8 in <span class="number">05</span>_angr_symbolic_memory (<span class="number">0</span>x8048438))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">20</span>:<span class="number">06</span>:<span class="number">00</span>,<span class="number">676</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edx with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x804843a (_start+<span class="number">0</span>xa in <span class="number">05</span>_angr_symbolic_memory (<span class="number">0</span>x804843a))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">20</span>:<span class="number">06</span>:<span class="number">00</span>,<span class="number">746</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x80486a1 (__libc_csu_init+<span class="number">0</span>x1 in <span class="number">05</span>_angr_symbolic_memory (<span class="number">0</span>x80486a1))</span><br><span class="line"><span class="attribute">CRITICAL</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">12</span> <span class="number">20</span>:<span class="number">06</span>:<span class="number">05</span>,<span class="number">988</span> | angr.sim_state | The name state.se is deprecated; please use state.solver.</span><br><span class="line"><span class="attribute">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h2 id="06-angr-symbolic-dynamic-memory"><a href="#06-angr-symbolic-dynamic-memory" class="headerlink" title="06_angr_symbolic_dynamic_memory"></a>06_angr_symbolic_dynamic_memory</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  buffer0 = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">9u</span>);</span><br><span class="line">  buffer1 = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">9u</span>);</span><br><span class="line">  <span class="built_in">memset</span>(buffer0, <span class="number">0</span>, <span class="number">9u</span>);</span><br><span class="line">  <span class="built_in">memset</span>(buffer1, <span class="number">0</span>, <span class="number">9u</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%8s %8s&quot;</span>, buffer0, buffer1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    buffer0[i] = complex_function(buffer0[i], i);</span><br><span class="line">    buffer1[i] = complex_function(buffer1[i], i + <span class="number">32</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(buffer0, <span class="string">&quot;OSIWHBXI&quot;</span>, <span class="number">8u</span>) &amp;&amp; !<span class="built_in">strncmp</span>(buffer1, <span class="string">&quot;FOQVSBZB&quot;</span>, <span class="number">8u</span>) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  <span class="built_in">free</span>(buffer0);</span><br><span class="line">  <span class="built_in">free</span>(buffer1);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这次scanf() 有两个输入参数,数据保存的位置是通过全局变量的char* 指针来保存到buffer 中,大小为8 字节.我们主要是对buffer两个内存进行求解。我们如何将两块动态申请来的内存符号化，malloc申请的空间是动态的，但存放malloc的buffer是再bss段，属于静态，我们选择伪造指针使其指向一片可写的内存，将内存符号化</p>
<p><img src="/../../../Users/86159/AppData/Roaming/Typora/typora-user-images/image-20220313151556700.png" alt="image-20220313151556700">	</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> is_</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/06_angr_symbolic_dynamic_memory/06_angr_symbolic_dynamic_memory&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line"></span><br><span class="line">    start_address = <span class="number">0x080486AF</span></span><br><span class="line">    state = project.factory.blank_state(addr=start_address)</span><br><span class="line"></span><br><span class="line">    psd0 = claripy.BVS(<span class="string">&#x27;psd0&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">    psd1 = claripy.BVS(<span class="string">&#x27;psd1&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">    fake_address0 = <span class="number">0x0A2DEF30</span><span class="comment"># 伪造malloc得来的内存，在bss上随便找的</span></span><br><span class="line">    pointer_to_address0 = <span class="number">0x0A2DEF74</span><span class="comment"># 指向伪造内存的指针</span></span><br><span class="line">    state.memory.store(pointer_to_address0,fake_address0,endness=project.arch.memory_endness)<span class="comment"># 将指针指向伪造的内存</span></span><br><span class="line">    fake_address1 = <span class="number">0x0A2DEF40</span></span><br><span class="line">    pointer_to_address1 = <span class="number">0x0A2DEF7C</span></span><br><span class="line">    state.memory.store(pointer_to_address1,fake_address1,endness=project.arch.memory_endness)</span><br><span class="line">    state.memory.store(fake_address0,psd0)<span class="comment"># 将伪造的内存符号化</span></span><br><span class="line">    state.memory.store(fake_address1,psd1)</span><br><span class="line">    simulation = project.factory.simgr(state)</span><br><span class="line">    simulation.explore(find=<span class="number">0x0804877A</span>,avoid=<span class="number">0x08048768</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        solution0 = solution_state.se.<span class="built_in">eval</span>(psd0)</span><br><span class="line">        solution1 = solution_state.se.<span class="built_in">eval</span>(psd1)</span><br><span class="line">        solution = <span class="string">&#x27; &#x27;</span>.join(<span class="built_in">map</span>(<span class="string">&#x27;&#123;:x&#125;&#x27;</span>.<span class="built_in">format</span>,[solution0,solution1]))</span><br><span class="line">        <span class="built_in">print</span>(solution)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;Nooooooooo!&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">11</span>,<span class="number">666</span> | angr.storage.memory_mixins.bvv_conversion_mixin | Unknown size for memory data <span class="number">0</span>xa2def30. Default to arch.bits.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">11</span>,<span class="number">667</span> | angr.storage.memory_mixins.bvv_conversion_mixin | Unknown size for memory data <span class="number">0</span>xa2def40. Default to arch.bits.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">11</span>,<span class="number">672</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">11</span>,<span class="number">672</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">11</span>,<span class="number">672</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">11</span>,<span class="number">672</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">11</span>,<span class="number">672</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">11</span>,<span class="number">672</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebp with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x80486af (main+<span class="number">0</span>x8c in <span class="number">06</span>_angr_symbolic_dynamic_memory (<span class="number">0</span>x80486af))</span><br><span class="line"><span class="attribute">CRITICAL</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">07</span>:<span class="number">15</span>,<span class="number">521</span> | angr.sim_state | The name state.se is deprecated; please use state.solver.</span><br><span class="line"><span class="attribute">4f46494a484f5856</span> <span class="number">46425149534</span>f5a4f</span><br></pre></td></tr></table></figure>

<p>这节学到了符号化申请动态内存，通过伪造内存方式：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">initial_state.memory.store(buffer0_addr, fake0_addr, endness=<span class="keyword">project</span>.arch.memory_endness) <span class="comment"># 将指针指向伪造的内存</span></span><br><span class="line">initial_state.memory.store(fake0_addr, password0) <span class="comment"># 将伪造的内存符号化</span></span><br></pre></td></tr></table></figure>

<p>endness的参数是小端写入，因为angr默认大端。</p>
<h2 id="07-angr-symbolic-file"><a href="#07-angr-symbolic-file" class="headerlink" title="07_angr_symbolic_file"></a>07_angr_symbolic_file</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [esp-14h] [ebp-30h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp-10h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp-Ch] [ebp-28h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp-8h] [ebp-24h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp-4h] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [esp+0h] [ebp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+0h] [ebp-1Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(buffer, <span class="number">0</span>, <span class="keyword">sizeof</span>(buffer));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%64s&quot;</span>, buffer, v3, v4, v5, v6, v7, v8);</span><br><span class="line">  ignore_me((<span class="type">int</span>)buffer, <span class="number">0x40</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(buffer, <span class="number">0</span>, <span class="keyword">sizeof</span>(buffer));</span><br><span class="line">  fp = fopen(<span class="string">&quot;FOQVSBZB.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">  fread(buffer, <span class="number">1u</span>, <span class="number">0x40</span>u, fp);</span><br><span class="line">  fclose(fp);</span><br><span class="line">  unlink(<span class="string">&quot;FOQVSBZB.txt&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">    *(_BYTE *)(i + <span class="number">134520992</span>) = complex_function(*(<span class="type">char</span> *)(i + <span class="number">134520992</span>), i);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(buffer, <span class="string">&quot;OSIWHBXI&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个是将输入写入文件，然后再打开文件进行加密</p>
<p>所以要构建文件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/07_angr_symbolic_file/07_angr_symbolic_file&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line"></span><br><span class="line">    start_address = <span class="number">0x080488BC</span></span><br><span class="line">    initial_state = project.factory.blank_state(add=start_address)</span><br><span class="line"></span><br><span class="line">    filename = <span class="string">&#x27;FOQVSBZB.txt&#x27;</span></span><br><span class="line">    symbolic_file_size_bytes = <span class="number">0x40</span><span class="comment">#64位</span></span><br><span class="line"></span><br><span class="line">    psd = claripy.BVS(<span class="string">&#x27;psd&#x27;</span>,symbolic_file_size_bytes * <span class="number">8</span>)</span><br><span class="line">    psd_file = angr.SimFile(filename, content=psd, size=symbolic_file_size_bytes) <span class="comment"># 符号化文件</span></span><br><span class="line"></span><br><span class="line">    initial_state = project.factory.blank_state(addr=start_address, fs=&#123;filename: psd_file&#125;) <span class="comment"># 再初始状态中添加一个虚拟的文件系统</span></span><br><span class="line">    simulation = project.factory.simgr(initial_state)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">good_job</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Good Job&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">try_again</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Try again&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line"></span><br><span class="line">    simulation.explore(find=good_job,avoid=try_again)</span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        solution = n2s(solution_state.solver.<span class="built_in">eval</span>(psd))</span><br><span class="line">        <span class="built_in">print</span>(solution)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;Nooooooo!!!&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">50</span>:<span class="number">33</span>,<span class="number">858</span> | angr.sim_state | Unused keyword arguments passed to SimState: add</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">50</span>:<span class="number">33</span>,<span class="number">908</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">50</span>:<span class="number">33</span>,<span class="number">909</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">50</span>:<span class="number">33</span>,<span class="number">909</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">50</span>:<span class="number">33</span>,<span class="number">909</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">50</span>:<span class="number">33</span>,<span class="number">909</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">50</span>:<span class="number">33</span>,<span class="number">909</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebp with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x8048922 (main+<span class="number">0</span>xc4 in <span class="number">07</span>_angr_symbolic_file (<span class="number">0</span>x8048922))</span><br><span class="line"><span class="attribute">OBAXRUZT</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">angr<span class="selector-class">.storage</span><span class="selector-class">.SimFile</span>(文件名,文件内容, size = 文件大小) =&gt; 创建一个模拟文件,当有被执行的程序fopen 打开文件时,我们可以控制其里面的内容</span><br><span class="line"></span><br><span class="line">initial_state<span class="selector-class">.posix</span><span class="selector-class">.fs</span> =&gt; 状态上下文的文件系统对象</span><br></pre></td></tr></table></figure>

<p>要注意点，但我们创建符号good_job其参数是state，所以我们在创建项目时，不能用state，可以用initial_state</p>
<h2 id="08-angr-constraints"><a href="#08-angr-constraints" class="headerlink" title="08_angr_constraints"></a>08_angr_constraints</h2><p>这道题的特点就是会一个一个字符比较，所以不能用之前的方法，否则会有2的16次方中可能，会爆炸的，我们要做的就是符号化buffer，然后进行加密加密后获得控制权，从而检查psd是否与对比的一致</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  qmemcpy(&amp;password, <span class="string">&quot;OSIWHBXIFOQVSBZB&quot;</span>, <span class="number">16</span>);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;buffer, <span class="number">0</span>, <span class="number">0x11</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%16s&quot;</span>, &amp;buffer);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">    *(_BYTE *)(i + <span class="number">134520896</span>) = complex_function(*(<span class="type">char</span> *)(i + <span class="number">134520896</span>), <span class="number">15</span> - i);</span><br><span class="line">  <span class="keyword">if</span> ( check_equals_OSIWHBXIFOQVSBZB(&amp;buffer, <span class="number">16</span>) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>给出脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/08_angr_constraints/08_angr_constraints&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line">    start_add = <span class="number">0x0804863C</span> <span class="comment">#scanf后面</span></span><br><span class="line">    initial_state = project.factory.blank_state(add=start_add)</span><br><span class="line">    buffer = claripy.BVS(<span class="string">&#x27;buffer&#x27;</span>,<span class="number">0x10</span>*<span class="number">8</span>)<span class="comment">#buffer的大小是0x10 字节,也就是0x10 * 8 比特</span></span><br><span class="line">    buffer_address = <span class="number">0x0804A040</span></span><br><span class="line">    initial_state.memory.store(buffer_address,buffer)<span class="comment">#buffer 是全局变量,地址是0x804A040</span></span><br><span class="line">    simulation = project.factory.simgr(initial_state)</span><br><span class="line">    address_to_check_constraint = <span class="number">0x08048683</span></span><br><span class="line">    simulation.explore(find=address_to_check_constraint)<span class="comment">#  compilex_function() 计算结束位置</span></span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        constrained_parameter_address = <span class="number">0x0804A040</span> <span class="comment">#  计算约束的内存位置</span></span><br><span class="line">        constrained_parameter_size_bytes = <span class="number">0x10</span> <span class="comment">#  计算约束的内存大小</span></span><br><span class="line">        constrained_parameter_bitvector = solution_state.memory.load(  constrained_parameter_address,constrained_parameter_size_bytes) <span class="comment">#  加载内存</span></span><br><span class="line"></span><br><span class="line">        constrained_parameter_desired_value = <span class="string">&quot;OSIWHBXIFOQVSBZB&quot;</span><span class="comment">#  Key-String</span></span><br><span class="line">        solution_state.add_constraints(constrained_parameter_bitvector == constrained_parameter_desired_value )<span class="comment"># 添加约束</span></span><br><span class="line">        solution = solution_state.se.<span class="built_in">eval</span>(buffer)</span><br><span class="line">        <span class="built_in">print</span>(n2s(solution))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;nooooooooo!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>学到：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">solution_state<span class="selector-class">.memory</span><span class="selector-class">.load</span>(内存地址,内存大小) =&gt; 加载内存</span><br><span class="line"></span><br><span class="line">solution_state<span class="selector-class">.add_constraints</span>(约束条件) =&gt; 添加约束条件</span><br></pre></td></tr></table></figure>

<h2 id="09-angr-hooks"><a href="#09-angr-hooks" class="headerlink" title="09_angr_hooks"></a>09_angr_hooks</h2><p>这个题主要是对比的时候在遍历分支的时候会用很长时间，我们直接hook掉，然后替换成我们自己对比函数就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/09_angr_hooks/09_angr_hooks&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line">    initial_state = project.factory.entry_state()</span><br><span class="line"></span><br><span class="line">    check_equals = <span class="number">0x080486CA</span></span><br><span class="line">    instruction_to_skip_lenth = <span class="number">5</span></span><br><span class="line"><span class="meta">    @project.hook(<span class="params">check_equals, length=instruction_to_skip_lenth</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">skip_check_equals</span>(<span class="params">state</span>):</span><br><span class="line">        user_input_buffer_addr = <span class="number">0x0804A044</span><span class="comment">#buffer地址</span></span><br><span class="line">        user_input_buffer_lenth = <span class="number">16</span></span><br><span class="line"></span><br><span class="line">        user_input_string = state.memory.laod( user_input_buffer_addr,user_input_buffer_lenth)</span><br><span class="line">        check_against_string = <span class="string">&#x27;OSIWHBXIFOQVSBZB&#x27;</span></span><br><span class="line">        state.regs.eax = claripy.If(user_input_string == check_against_string,claripy.BVV(<span class="number">1</span>,<span class="number">32</span>),claripy.BVV(<span class="number">0</span>,<span class="number">32</span>))</span><br><span class="line">    simulation = project.factory.simgr(initial_state)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_successful</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Good Job.&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">should_abort</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Try again.&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line"></span><br><span class="line">    simulation.explore(find=is_successful, avoid=should_abort)  <span class="comment">#  Try Explore Execute Path</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        solution = solution_state.posix.dumps(sys.stdin.fileno())  <span class="comment">#  Get data ..</span></span><br><span class="line">        <span class="built_in">print</span>(solution)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not find the solution&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>上面脚本不如下面脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/09_angr_hooks/09_angr_hooks&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line"></span><br><span class="line">    initial_state = project.factory.entry_state()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">ReplacementCheckEquals</span>(angr.SimProcedure):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self, check_data_address, check_data_length</span>):</span><br><span class="line">            check_input_string = self.state.memory.load(check_data_address,check_data_length)</span><br><span class="line">            check_against_string = <span class="string">&#x27;OSIWHBXIFOQVSBZB&#x27;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> claripy.If(check_input_string == check_against_string,claripy.BVV(<span class="number">1</span>,<span class="number">32</span>),claripy.BVV(<span class="number">0</span>,<span class="number">32</span>))</span><br><span class="line">        </span><br><span class="line">    check_equals_symbol = <span class="string">&#x27;check_equals_OSIWHBXIFOQVSBZB&#x27;</span></span><br><span class="line">    project.hook_symbol(check_equals_symbol,ReplacementCheckEquals())</span><br><span class="line"></span><br><span class="line">    simulation = project.factory.simgr(initial_state)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">good_job</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Good Job&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">should_abort</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Try again&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line"></span><br><span class="line">    simulation.explore(find=good_job,avoid=should_abort)</span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        solution = solution_state.posix.dumps(sys.stdin.fileno())</span><br><span class="line">        <span class="built_in">print</span>(solution)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">40</span>:<span class="number">43</span>,<span class="number">538</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">40</span>:<span class="number">43</span>,<span class="number">538</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">40</span>:<span class="number">43</span>,<span class="number">538</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">40</span>:<span class="number">43</span>,<span class="number">538</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">40</span>:<span class="number">43</span>,<span class="number">538</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">40</span>:<span class="number">43</span>,<span class="number">539</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x80487a1 (__libc_csu_init+<span class="number">0</span>x1 in <span class="number">09</span>_angr_hooks (<span class="number">0</span>x80487a1))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">40</span>:<span class="number">46</span>,<span class="number">867</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">b</span>&#x27;QREPXOHPJPOQKQLKNOBMULEMGMLNHNIH&#x27;</span><br></pre></td></tr></table></figure>

<p>总结：</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Hook回调函数格式:</span><br><span class="line"></span><br><span class="line">@project.hook(Hook地址,执行完Hook函数后指令往后跳转n字节) def skip_check_equals_(<span class="keyword">state</span>):</span><br><span class="line"></span><br><span class="line"><span class="built_in">pass</span></span><br><span class="line"></span><br><span class="line">claripy.If(条件,条件为True时的返回值,条件为False时的返回值) =&gt; 创建条件判断</span><br><span class="line"></span><br><span class="line">claripy.BVV(值,值大小) =&gt; 创建一个数值</span><br></pre></td></tr></table></figure>

<h2 id="10-angr-simprocedures"><a href="#10-angr-simprocedures" class="headerlink" title="10_angr_simprocedures"></a>10_angr_simprocedures</h2><p>还是一样，先输入flag然后循环运算，接下来函数中对比。逐字节比较太麻烦，我们仍需对比</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+20h] [ebp-28h]</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">17</span>]; <span class="comment">// [esp+2Bh] [ebp-1Dh] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [esp+3Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">memcpy</span>(&amp;password, <span class="string">&quot;OSIWHBXIFOQVSBZB&quot;</span>, <span class="number">0x10</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%16s&quot;</span>, s);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">    s[i] = complex_function(s[i], <span class="number">18</span> - i);</span><br><span class="line">  <span class="keyword">if</span> ( check_equals_OSIWHBXIFOQVSBZB(s, <span class="number">16</span>) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>本题跟9题的区别就在于，本题call equal指令太多，不像9题只有一个，所以我们需要多个hook</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/10_angr_simprocedures/10_angr_simprocedures&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line"></span><br><span class="line">    initial_state = project.factory.entry_state()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">ReplacementCheckEquals</span>(angr.SimProcedure):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self, check_data_address, check_data_length</span>):</span><br><span class="line">            check_input_string = self.state.memory.load(check_data_address,check_data_length)</span><br><span class="line">            check_against_string = <span class="string">&#x27;OSIWHBXIFOQVSBZB&#x27;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> claripy.If(check_input_string == check_against_string,claripy.BVV(<span class="number">1</span>,<span class="number">32</span>),claripy.BVV(<span class="number">0</span>,<span class="number">32</span>))</span><br><span class="line">        </span><br><span class="line">    check_equals_symbol = <span class="string">&#x27;check_equals_OSIWHBXIFOQVSBZB&#x27;</span></span><br><span class="line">    project.hook_symbol(check_equals_symbol,ReplacementCheckEquals())</span><br><span class="line"></span><br><span class="line">    simulation = project.factory.simgr(initial_state)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">good_job</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Good Job&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">should_abort</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Try again&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line"></span><br><span class="line">    simulation.explore(find=good_job,avoid=should_abort)</span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        solution = solution_state.posix.dumps(sys.stdin.fileno())</span><br><span class="line">        <span class="built_in">print</span>(solution)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">02</span>:<span class="number">40</span>,<span class="number">607</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">02</span>:<span class="number">40</span>,<span class="number">607</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">02</span>:<span class="number">40</span>,<span class="number">607</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">02</span>:<span class="number">40</span>,<span class="number">607</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">02</span>:<span class="number">40</span>,<span class="number">607</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">02</span>:<span class="number">40</span>,<span class="number">607</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x804a9d1 (__libc_csu_init+<span class="number">0</span>x1 in <span class="number">10</span>_angr_simprocedures (<span class="number">0</span>x804a9d1))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">15</span>:<span class="number">02</span>:<span class="number">43</span>,<span class="number">850</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">b</span>&#x27;MTMDRONBBNSAAMNS&#x27;</span><br></pre></td></tr></table></figure>

<p>这个题hook整个函数。采用SimProcedure类</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Hook</span> 回调函数格式:</span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="type">ReplacementCheckEquals</span>(<span class="title">angr</span>.<span class="type">SimProcedure</span>):</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">def run(<span class="title">self</span>, <span class="type">Hook</span>的函数参数列表):</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">   ….</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">   return 函数返回值 # 如果是void函数可以省略</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">project.hook_symbol(要<span class="type">Hook</span>的函数名,<span class="type">SimProcedure</span>类实例)</span></span><br></pre></td></tr></table></figure>

<p>通过这个题，我在想上个题是否也能用这个回调函数呢，这个脚本会省去很多事，成功了！</p>
<h2 id="11-angr-sim-scanf"><a href="#11-angr-sim-scanf" class="headerlink" title="11_angr_sim_scanf"></a>11_angr_sim_scanf</h2><p>本题加密的是对比数据，加密完再输入，然后对比</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+20h] [ebp-28h]</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">20</span>]; <span class="comment">// [esp+28h] [ebp-20h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [esp+3Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">  qmemcpy(s, <span class="string">&quot;LOGMHXHI&quot;</span>, <span class="number">8</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">    s[i] = complex_function(s[i], i);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%u %u&quot;</span>, buffer0, buffer1);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(buffer0, s, <span class="number">4u</span>) &amp;&amp; !<span class="built_in">strncmp</span>(buffer1, &amp;s[<span class="number">4</span>], <span class="number">4u</span>) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这道题是让我们模拟scanf</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> angr </span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/11_angr_sim_scanf/11_angr_sim_scanf&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line"></span><br><span class="line">    initial_state = project.factory.entry_state()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">ReplacementScanf</span>(angr.SimProcedure):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self,format_string,scanf0_address,scanf1_address</span>):</span><br><span class="line">            scanf0 = claripy.BVS(<span class="string">&#x27;scanf0&#x27;</span>, <span class="number">32</span>)</span><br><span class="line">            scanf1 = claripy.BVS(<span class="string">&#x27;scanf1&#x27;</span>, <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">            self.state.memory.store(scanf0_address,scanf0,endness=project.arch.memory_endness)</span><br><span class="line">            self.state.memory.store(scanf1_address,scanf1,endness=project.arch.memory_endness)</span><br><span class="line"></span><br><span class="line">            self.state.<span class="built_in">globals</span>[<span class="string">&#x27;solution0&#x27;</span>] = scanf0</span><br><span class="line">            self.state.<span class="built_in">globals</span>[<span class="string">&#x27;solution1&#x27;</span>] = scanf1</span><br><span class="line"></span><br><span class="line">    scanf_symbol = <span class="string">&#x27;__isoc99_scanf&#x27;</span></span><br><span class="line">    project.hook_symbol(scanf_symbol, ReplacementScanf())</span><br><span class="line">    simulation = project.factory.simgr(initial_state)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">good_job</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Good Job.&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">should_abort</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Try again&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line"></span><br><span class="line">    simulation.explore(find=good_job,avoid=should_abort)</span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        store_solution0 = solution_state.<span class="built_in">globals</span>[<span class="string">&#x27;solution0&#x27;</span>]</span><br><span class="line">        store_solution1 = solution_state.<span class="built_in">globals</span>[<span class="string">&#x27;solution1&#x27;</span>]</span><br><span class="line">        solution0 = solution_state.se.<span class="built_in">eval</span>(store_solution0)</span><br><span class="line">        solution1 = solution_state.se.<span class="built_in">eval</span>(store_solution1)</span><br><span class="line">        <span class="built_in">print</span>(solution0,solution1)</span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">09</span>:<span class="number">33</span>,<span class="number">831</span> | angr.project | Address is already hooked, during hook(<span class="number">0</span>x81513a0, &lt;SimProcedure ReplacementScanf&gt;). Re-hooking.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">09</span>:<span class="number">33</span>,<span class="number">903</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">09</span>:<span class="number">33</span>,<span class="number">903</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">09</span>:<span class="number">33</span>,<span class="number">903</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">09</span>:<span class="number">33</span>,<span class="number">903</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">09</span>:<span class="number">33</span>,<span class="number">903</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">09</span>:<span class="number">33</span>,<span class="number">903</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x804fce1 (__libc_csu_init+<span class="number">0</span>x1 in <span class="number">11</span>_angr_sim_scanf (<span class="number">0</span>x804fce1))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">09</span>:<span class="number">34</span>,<span class="number">137</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="number">0</span>x7ffeff40 with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x8187170 (strncmp+<span class="number">0</span>x0 in libc.so.<span class="number">6</span> (<span class="number">0</span>x87170))</span><br><span class="line"><span class="attribute">CRITICAL</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">09</span>:<span class="number">34</span>,<span class="number">334</span> | angr.sim_state | The name state.se is deprecated; please use state.solver.</span><br><span class="line"><span class="attribute">1447907916</span> <span class="number">1146768724</span></span><br></pre></td></tr></table></figure>

<p>这个题学到了构造scanf的hook：</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将位向量储存到当前状态并且获取位向量的方法</span></span><br><span class="line"><span class="literal">self</span>.<span class="keyword">state</span>.globals[&#x27;solution0&#x27;] = scanf0</span><br><span class="line"><span class="comment">#保存当前状态</span></span><br><span class="line">solution0 = solution_state.globals[&#x27;solution0&#x27;]</span><br><span class="line"><span class="comment">#去出scanf</span></span><br></pre></td></tr></table></figure>

<h2 id="12-angr-veritesting"><a href="#12-angr-veritesting" class="headerlink" title="12_angr_veritesting"></a>12_angr_veritesting</h2><p>如果说这个题跟第一题有什么区别的话，就是这个输入32位，很容易爆炸，所以有veritesting参数来表示是否合并路径</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/12_angr_veritesting/12_angr_veritesting&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line">    initial_state = project.factory.entry_state()</span><br><span class="line">    simulation = project.factory.simgr(initial_state,veritesting = <span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_successful</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Good Job.&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)  <span class="comment"># :boolean</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">should_abort</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Try again.&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line">    </span><br><span class="line">    simulation.explore(find=is_successful,avoid=should_abort)</span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution = simulation.found[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(solution.posix.dumps(sys.stdin.fileno()))</span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">745</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">745</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">745</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">745</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">745</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">746</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x80486e1 (__libc_csu_init+<span class="number">0</span>x1 in <span class="number">12</span>_angr_veritesting (<span class="number">0</span>x80486e1))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">757</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">758</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">Deprecation</span> warning: Use self.model.get_any_node() instead of get_any_node</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">789</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">790</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">852</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">853</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">887</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">57</span>,<span class="number">887</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">58</span>,<span class="number">001</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">58</span>,<span class="number">001</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">58</span>,<span class="number">098</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">58</span>,<span class="number">099</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">58</span>,<span class="number">209</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">58</span>,<span class="number">209</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x0 (not part of a loaded object)</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">58</span>,<span class="number">322</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">58</span>,<span class="number">564</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">58</span>,<span class="number">807</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">59</span>,<span class="number">033</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">59</span>,<span class="number">259</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">59</span>,<span class="number">507</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">30</span>:<span class="number">59</span>,<span class="number">751</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">00</span>,<span class="number">001</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">00</span>,<span class="number">253</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">00</span>,<span class="number">526</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">00</span>,<span class="number">801</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">01</span>,<span class="number">072</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">01</span>,<span class="number">352</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">01</span>,<span class="number">645</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">01</span>,<span class="number">934</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">02</span>,<span class="number">240</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">02</span>,<span class="number">541</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">02</span>,<span class="number">851</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">03</span>,<span class="number">179</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">03</span>,<span class="number">504</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">03</span>,<span class="number">826</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">04</span>,<span class="number">170</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">04</span>,<span class="number">519</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">04</span>,<span class="number">869</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">05</span>,<span class="number">314</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">05</span>,<span class="number">676</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">06</span>,<span class="number">060</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">06</span>,<span class="number">456</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">06</span>,<span class="number">859</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">07</span>,<span class="number">269</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">07</span>,<span class="number">704</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">16</span>:<span class="number">31</span>:<span class="number">08</span>,<span class="number">188</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge <span class="literal">all</span> states.</span><br><span class="line"><span class="attribute">b</span>&#x27;YNCRGVKZODSHWLAPETIXMBQFUJYNCRGV&#x27;</span><br></pre></td></tr></table></figure>

<p>学习了如何自动合并路径：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">simulation</span> = project.factory.simgr(initial_state, veritesting=<span class="literal">True</span>) </span><br></pre></td></tr></table></figure>

<h2 id="13-angr-static-binary"><a href="#13-angr-static-binary" class="headerlink" title="13_angr_static_binary"></a>13_angr_static_binary</h2><p>看起来很简单，用第一问的脚本就行了，实际不行，因为这个是用静态链接编译的，我们还要实现或者引用一些函数的hook</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+1Ch] [ebp-3Ch]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [esp+20h] [ebp-38h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">20</span>]; <span class="comment">// [esp+24h] [ebp-34h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">20</span>]; <span class="comment">// [esp+38h] [ebp-20h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v8; <span class="comment">// [esp+4Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">19</span>; ++i )</span><br><span class="line">    v7[i] = <span class="number">0</span>;</span><br><span class="line">  qmemcpy(v7, <span class="string">&quot;ELZXQOOQ&quot;</span>, <span class="number">8</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  _isoc99_scanf(<span class="string">&quot;%8s&quot;</span>, v6);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">7</span>; ++j )</span><br><span class="line">    v6[j] = complex_function(v6[j], j);</span><br><span class="line">  <span class="keyword">if</span> ( j_strcmp_ifunc(v6, v7) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/13_angr_static_binary/13_angr_static_binary&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line">    initial_state = project.factory.entry_state()</span><br><span class="line">    simulation = project.factory.simgr(initial_state,veritesting = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    project.hook(<span class="number">0x0804FAB0</span>,angr.SIM_PROCEDURES[<span class="string">&#x27;libc&#x27;</span>][<span class="string">&#x27;printf&#x27;</span>]())</span><br><span class="line">    project.hook(<span class="number">0x0804FB10</span>,angr.SIM_PROCEDURES[<span class="string">&#x27;libc&#x27;</span>][<span class="string">&#x27;scanf&#x27;</span>]())</span><br><span class="line">    project.hook(<span class="number">0x080503F0</span>,angr.SIM_PROCEDURES[<span class="string">&#x27;libc&#x27;</span>][<span class="string">&#x27;puts&#x27;</span>]())</span><br><span class="line">    project.hook(<span class="number">0x08048D60</span>,angr.SIM_PROCEDURES[<span class="string">&#x27;glibc&#x27;</span>][<span class="string">&#x27;__libc_start_main&#x27;</span>]())</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_successful</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Good Job.&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)  <span class="comment"># :boolean</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">should_abort</span>(<span class="params">state</span>):</span><br><span class="line">        stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Try again.&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)</span><br><span class="line"></span><br><span class="line">    simulation.explore(find=is_successful,avoid=should_abort)</span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">180</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">180</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">180</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">180</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">181</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">181</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> edi with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x80497b1</span> (__libc_csu_init+<span class="number">0x1</span> in <span class="number">13</span>_angr_static_binary (<span class="number">0x80497b1</span>))</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">185</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">186</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">Deprecation warning: Use self.model.get_any_node() instead of get_any_node</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">255</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">255</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">279</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">279</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">323</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">325</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">406</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">406</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">422</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">422</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">502</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">502</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">528</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">528</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">566</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">19</span>,<span class="number">566</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">20</span>,<span class="number">020</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">20</span>,<span class="number">021</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">20</span>,<span class="number">310</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">20</span>,<span class="number">311</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">20</span>,<span class="number">391</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">20</span>,<span class="number">392</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">21</span>,<span class="number">303</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">21</span>,<span class="number">304</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">24</span>,<span class="number">416</span> | angr.sim_manager | Cannot find states with common history line to merge. Fall back to the naive merging strategy and merge all states.</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">25</span>,<span class="number">412</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> es with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">WARNING | <span class="number">2022</span><span class="number">-03</span><span class="number">-14</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">25</span>,<span class="number">412</span> | angr.storage.memory_mixins.default_filler_mixin | Filling <span class="keyword">register</span> gs with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0x0</span> (not part of a loaded object)</span><br><span class="line">b<span class="number">&#x27;</span>EADQYLAR<span class="number">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>我们学到了获取angr内部系统函数：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">angr<span class="selector-class">.SIM_PROCEDURES</span><span class="selector-attr">[ 系统库名 ]</span> <span class="selector-attr">[ 系统函数名 ]</span> () =&gt; 获取Angr 内部实现的系统函数</span><br></pre></td></tr></table></figure>

<h2 id="14-angr-shared-library"><a href="#14-angr-shared-library" class="headerlink" title="14_angr_shared_library"></a>14_angr_shared_library</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">16</span>]; <span class="comment">// [esp+1Ch] [ebp-1Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [esp+2Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%8s&quot;</span>, s);</span><br><span class="line">  <span class="keyword">if</span> ( validate(s, <span class="number">8</span>) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>好像很简单，但我们发现validate函数在另一个so文件，该题考的是动态链接的符号执行，我们只要搞出validate的符号执行就ok</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/14_angr_shared_library/lib14_angr_shared_library.so&#x27;</span></span><br><span class="line">    base = <span class="number">0x40000000</span><span class="comment">#随意</span></span><br><span class="line">    project = angr.Project(path,load_options=&#123;<span class="string">&#x27;main_opts&#x27;</span> : &#123;<span class="string">&#x27;custom_base_addr&#x27;</span> : base&#125;&#125;)</span><br><span class="line">    buffer_pointer = claripy.BVV(<span class="number">0x30000000</span>,<span class="number">32</span>)<span class="comment">#创建buffer指针</span></span><br><span class="line">    validate_function_address = base + <span class="number">0x670</span> <span class="comment">#在该文件中的调用地址</span></span><br><span class="line">    initial_state = project.factory.call_state(validate_function_address,buffer_pointer,claripy.BVV(<span class="number">8</span>,<span class="number">32</span>))</span><br><span class="line">    <span class="comment">#  调用validate_function,因为函数声明validata_function(buffer_point,buffer_length) ,所以我们构造出调用validata_function(0x3000000,0x8) .</span></span><br><span class="line">    password = claripy.BVS(<span class="string">&#x27;password&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">    </span><br><span class="line">    initial_state.memory.store(buffer_pointer,password) </span><br><span class="line">    simulation = project.factory.simgr(initial_state)</span><br><span class="line">    simulation.explore(find=base+<span class="number">0x71C</span>)<span class="comment">#  执行到validate 函数的RETN 指令</span></span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        solution_state.add_constraints(solution_state.regs.eax !=<span class="number">0</span>)</span><br><span class="line">        solution = solution_state.se.<span class="built_in">eval</span>(password)</span><br><span class="line">        <span class="built_in">print</span>(solution)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">CRITICAL</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">36</span>,<span class="number">605</span> | cle.backends | Deprecation warning: the custom_base_addr parameter has been renamed to base_addr</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">36</span>,<span class="number">862</span> | angr.calling_conventions | Guessing call prototype. Please specify prototype.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">36</span>,<span class="number">868</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">36</span>,<span class="number">869</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">36</span>,<span class="number">869</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">36</span>,<span class="number">869</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">36</span>,<span class="number">869</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">36</span>,<span class="number">869</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebp with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x40000670 (validate+<span class="number">0</span>x0 in lib14_angr_shared_library.so (<span class="number">0</span>x670))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">36</span>,<span class="number">870</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebx with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x40000673 (validate+<span class="number">0</span>x3 in lib14_angr_shared_library.so (<span class="number">0</span>x673))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">37</span>,<span class="number">842</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="number">0</span>x30000008 with <span class="number">121</span> unconstrained bytes referenced from <span class="number">0</span>x40186b80 (strcmp+<span class="number">0</span>x0 in libc.so.<span class="number">6</span> (<span class="number">0</span>x86b80))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">37</span>,<span class="number">911</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="number">0</span>x7ffeffe8 with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x40186b80 (strcmp+<span class="number">0</span>x0 in libc.so.<span class="number">6</span> (<span class="number">0</span>x86b80))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">37</span>,<span class="number">911</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="number">0</span>x7fff0000 with <span class="number">77</span> unconstrained bytes referenced from <span class="number">0</span>x40186b80 (strcmp+<span class="number">0</span>x0 in libc.so.<span class="number">6</span> (<span class="number">0</span>x86b80))</span><br><span class="line"><span class="attribute">CRITICAL</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">14</span> <span class="number">17</span>:<span class="number">38</span>:<span class="number">38</span>,<span class="number">105</span> | angr.sim_state | The name state.se is deprecated; please use state.solver.</span><br><span class="line"><span class="attribute">6076275416825026394</span></span><br></pre></td></tr></table></figure>

<p>学习到了：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">如何加载共享库</span><br><span class="line">base = <span class="number">0x40000000</span>#随意</span><br><span class="line">    project = angr.<span class="constructor">Project(<span class="params">path</span>,<span class="params">load_options</span>=&#123;&#x27;<span class="params">main_opts</span>&#x27; : &#123;&#x27;<span class="params">custom_base_addr</span>&#x27; : <span class="params">base</span>&#125;&#125;)</span></span><br><span class="line">    initial_state = project.factory.call<span class="constructor">_state(<span class="params">validate_function_address</span>,<span class="params">buffer_pointer</span>,<span class="params">claripy</span>.BVV(8,32)</span>)</span><br><span class="line">    #  构造指针给函数使用.</span><br><span class="line">   </span><br></pre></td></tr></table></figure>

<h2 id="15-angr-arbitrary-read"><a href="#15-angr-arbitrary-read" class="headerlink" title="15_angr_arbitrary_read"></a>15_angr_arbitrary_read</h2><p>当if成立，s输出，以为会输出tryagain，但v4要写入20字节，就会有溢出，因为s到v4只有16字节</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [esp+Ch] [ebp-1Ch] BYREF</span></span><br><span class="line">  <span class="type">char</span> *s; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  s = try_again;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%u %20s&quot;</span>, &amp;key, &amp;v4);</span><br><span class="line">  <span class="keyword">if</span> ( key == <span class="number">2358019</span> )</span><br><span class="line">    <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(try_again);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/15_angr_arbitrary_read/15_angr_arbitrary_read&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line"></span><br><span class="line">    initial_state = project.factory.entry_state()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">ReplacementScanf</span>(angr.SimProcedure):<span class="comment">#  实现Scanf Hook 函数</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self,format_string, check_key_address,input_buffer_address</span>):</span><br><span class="line">            scanf0 = claripy.BVS(<span class="string">&#x27;scanf0&#x27;</span>,<span class="number">32</span>)<span class="comment">#check_key</span></span><br><span class="line">            scanf1 = claripy.BVS(<span class="string">&#x27;scanf1&#x27;</span>,<span class="number">160</span>)<span class="comment">#inputbuffer</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> char <span class="keyword">in</span> scanf1.chop(bits=<span class="number">8</span>):</span><br><span class="line">                self.state.add_constraints(char &gt;= <span class="string">&#x27;0&#x27;</span>, char &lt;= <span class="string">&#x27;z&#x27;</span>)<span class="comment">#  对input_buffer 的输入约束</span></span><br><span class="line"></span><br><span class="line">            self.state.memory.store(check_key_address,scanf0 ,endness =project.arch.memory_endness)<span class="comment">#  保存求解变量到指定的内存中</span></span><br><span class="line"></span><br><span class="line">            self.state.memory.store(input_buffer_address,scanf1 ,endness =project.arch.memory_endness)</span><br><span class="line"></span><br><span class="line">            self.state.<span class="built_in">globals</span>[<span class="string">&#x27;solution0&#x27;</span>] = scanf0<span class="comment">#  保存这两个变量到state 中,后续求解需要用到</span></span><br><span class="line">            self.state.<span class="built_in">globals</span>[<span class="string">&#x27;solution1&#x27;</span>] = scanf1</span><br><span class="line"></span><br><span class="line">    scanf_symbol = <span class="string">&#x27;__isoc99_scanf&#x27;</span></span><br><span class="line">    project.hook_symbol(scanf_symbol,ReplacementScanf())</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check_puts</span>(<span class="params">state</span>):</span><br><span class="line">        puts_parameter = state.memory.load(state.regs.esp + <span class="number">4</span>,<span class="number">4</span>,endness=project.arch.memory_endness)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> state.se.symbolic(puts_parameter):</span><br><span class="line">            good_job_string_address = <span class="number">0x08048562</span><span class="comment">#利用try again的函数调用</span></span><br><span class="line">            copied_state = state.copy() <span class="comment">#  复制执行状态上下文进行约束求解,不影响原理的执行上下文</span></span><br><span class="line">            copied_state.add_constraints(puts_parameter == good_job_string_address)<span class="comment">#  puts 的参数地址是否可以被指定为 0x08048562 ,如果可以的话,那就证明这个值是可控的</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> copied_state.satisfiable():<span class="comment">#  判断添加了上面这个约束是否有解</span></span><br><span class="line">                state.add_constrains(puts_parameter == good_job_string_address) <span class="comment">#  如果有解的话就保存到我们执行的那个状态对象</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    simulation = project.factory.simgr(initial_state)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_successful</span>(<span class="params">state</span>):</span><br><span class="line">        puts_address = <span class="number">0x0804854F</span><span class="comment">#  当程序执行到puts() 函数时,我们就认为路径探索到了这里,然后再去通过check_puts() 判断这里是否存在漏洞,告诉Angr这是不是我们需要找的那条执行路径</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> state.addr == puts_address:</span><br><span class="line">            <span class="keyword">return</span> check_puts(state)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    simulation.explore(find=is_successful)</span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        solution0 = solution_state.se.<span class="built_in">eval</span>(solution_state.<span class="built_in">globals</span>[<span class="string">&#x27;solution0&#x27;</span>])</span><br><span class="line">        solution1 = solution_state.se.<span class="built_in">eval</span>(solution_state.<span class="built_in">globals</span>[<span class="string">&#x27;solution1&#x27;</span>],cast_to=<span class="built_in">bytes</span>)</span><br><span class="line">        <span class="built_in">print</span>(solution0,solution1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">state</span>.copy() =&gt; 复制状态上下文</span><br><span class="line"></span><br><span class="line"><span class="keyword">state</span>.satisfiable() =&gt; 判断当前的所有约束是否有解</span><br><span class="line"></span><br><span class="line">solution_state.se.eval(求解变量,cast_to=bytes) =&gt; 序列化变量内容为字符串</span><br></pre></td></tr></table></figure>

<h2 id="16-angr-arbitrary-write"><a href="#16-angr-arbitrary-write" class="headerlink" title="16_angr_arbitrary_write"></a>16_angr_arbitrary_write</h2><p>这个题很明显，password是不等于NEDVTNOP，所以我们可以用s溢出覆盖dest的值，使其指向password，这样就能修改其内容了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">16</span>]; <span class="comment">// [esp+Ch] [ebp-1Ch] BYREF</span></span><br><span class="line">  <span class="type">char</span> *dest; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  dest = unimportant_buffer;</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">  <span class="built_in">strncpy</span>(password_buffer, <span class="string">&quot;PASSWORD&quot;</span>, <span class="number">0xC</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%u %20s&quot;</span>, &amp;key, s);</span><br><span class="line">  <span class="keyword">if</span> ( key == <span class="number">6712341</span> )</span><br><span class="line">    <span class="built_in">strncpy</span>(dest, s, <span class="number">0x10</span>u);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">strncpy</span>(unimportant_buffer, s, <span class="number">0x10</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(password_buffer, <span class="string">&quot;NEDVTNOP&quot;</span>, <span class="number">8u</span>) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Good Job.&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/03/12/angr/image-20220315122941509.png"></p>
<p>我们输入20个字节是正好覆盖s的16个字节+的dest的字节的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    path = <span class="string">&#x27;../solutions/16_angr_arbitrary_write/16_angr_arbitrary_write&#x27;</span></span><br><span class="line">    project = angr.Project(path)</span><br><span class="line">    initial_state = project.factory.entry_state()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">ReplacementScanf</span>(angr.SimProcedure):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self,format_string,check_key,input_buffer</span>):</span><br><span class="line">            scanf0 = claripy.BVS(<span class="string">&#x27;scanf0&#x27;</span>,<span class="number">32</span>)</span><br><span class="line">            scanf1 = claripy.BVS(<span class="string">&#x27;scanf1&#x27;</span>,<span class="number">160</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> char <span class="keyword">in</span> scanf1.chop(bits=<span class="number">8</span>):</span><br><span class="line">                self.state.add_constraints(char &gt;= <span class="string">&#x27;a&#x27;</span>,char &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            self.state.memory.store(check_key,scanf0,endness=project.arch.memory_endness)</span><br><span class="line">            self.state.memory.store(input_buffer,scanf1,endness=project.arch.memory_endness)</span><br><span class="line"></span><br><span class="line">            self.state.<span class="built_in">globals</span>[<span class="string">&#x27;solution0&#x27;</span>] = scanf0</span><br><span class="line">            self.state.<span class="built_in">globals</span>[<span class="string">&#x27;solution1&#x27;</span>] = scanf1</span><br><span class="line">    </span><br><span class="line">    scanf_symbol = <span class="string">&#x27;__isoc99_scanf&#x27;</span></span><br><span class="line">    project.hook_symbol(scanf_symbol,ReplacementScanf())</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check_strnpy</span>(<span class="params">state</span>):</span><br><span class="line">        strncpy_dest = state.memory.load(state.regs.esp + <span class="number">4</span>,<span class="number">4</span>,endness=project.arch.memory_endness)</span><br><span class="line">        strncpy_src  = state.memory.load(state.regs.esp + <span class="number">8</span>, <span class="number">4</span>, endness=project.arch.memory_endness)</span><br><span class="line">        strncpy_len  = state.memory.load(state.regs.esp + <span class="number">12</span>, <span class="number">4</span>, endness=project.arch.memory_endness)</span><br><span class="line">        src_contents = state.memory.load(strncpy_src, strncpy_len)</span><br><span class="line">        <span class="comment">#  因为参数中只保存了地址,我们需要根据这个地址去获取内容</span></span><br><span class="line">        <span class="keyword">if</span> state.se.symbolic(strncpy_dest) <span class="keyword">and</span> state.se.symbolic(src_contents):</span><br><span class="line">            <span class="comment">#  判断dest 和src 的内容是不是符号化对象</span></span><br><span class="line">            <span class="keyword">if</span> state.satisfiable(extra_constraints=(src_contents[-<span class="number">1</span>:-<span class="number">64</span>] == <span class="string">&#x27;NEDVTNOP&#x27;</span>,strncpy_dest == <span class="number">0x4D43523C</span>)):</span><br><span class="line">                <span class="comment">#  尝试求解,其中strncpy_dest == 0x4D43523C 的意思是判断dest 是否可控为password 的地址;src_contents[ -1 : -64 ] == &#x27;KZYRKMKE&#x27; 是判断input_buffer 的内容是否可控为&#x27;KZYRKMKE&#x27; ,因为这块内存是倒序,所以需要通过[ -1 : -64 ] 倒转(contentes 的内容是比特,获取8 字节的大小为:8*8 = 64),然后判断该值是否为字符串&#x27;KZYRKMKE&#x27;</span></span><br><span class="line">                state.add_constraints(src_contents[ -<span class="number">1</span> : -<span class="number">64</span> ] == <span class="string">&#x27;NEDVTNOP&#x27;</span>,strncpy_dest == <span class="number">0x4D43523C</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    simulation = project.factory.simgr(initial_state)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">good_job</span>(<span class="params">state</span>):</span><br><span class="line">        strncpy_address = <span class="number">0x0804860D</span></span><br><span class="line">        <span class="keyword">if</span> state.addr == strncpy_address:</span><br><span class="line">            <span class="keyword">return</span> check_strnpy(state)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    simulation.explore(find=good_job)</span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">        solution0 = solution_state.se.<span class="built_in">eval</span>(solution_state.<span class="built_in">globals</span>[<span class="string">&#x27;solution0&#x27;</span>])</span><br><span class="line">        solution1 = solution_state.se.<span class="built_in">eval</span>(solution_state.<span class="built_in">globals</span>[<span class="string">&#x27;solution1&#x27;</span>],cast_to=<span class="built_in">bytes</span>)</span><br><span class="line">        <span class="built_in">print</span>(solution0,solution1)</span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>总结：state.satisfiable(extra_constraints&#x3D;(条件1,条件2)) &#x3D;&gt; 合并多个条件计算是否存在满足约束的解(注意两个或多个条件之间是And 合并判断,不是Or )</p>
<h2 id="17-angr-arbitrary-jump"><a href="#17-angr-arbitrary-jump" class="headerlink" title="17_angr_arbitrary_jump"></a>17_angr_arbitrary_jump</h2><p>最后一题，在read_print中检查返回地址是否是godjob</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the password: &quot;</span>);</span><br><span class="line">  read_input();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Try again.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    binary_path = <span class="string">&#x27;../solutions/17_angr_arbitrary_jump/17_angr_arbitrary_jump&#x27;</span></span><br><span class="line">    project = angr.Project(binary_path)</span><br><span class="line"></span><br><span class="line">    initial_state = project.factory.entry_state()</span><br><span class="line">    simulation = project.factory.simgr(</span><br><span class="line">    initial_state,</span><br><span class="line">    save_unconstrained=<span class="literal">True</span>,</span><br><span class="line">    stashes=&#123;</span><br><span class="line">      <span class="string">&#x27;active&#x27;</span> : [initial_state],</span><br><span class="line">      <span class="string">&#x27;unconstrained&#x27;</span> : [],</span><br><span class="line">      <span class="string">&#x27;found&#x27;</span> : [],</span><br><span class="line">      <span class="string">&#x27;not_needed&#x27;</span> : []</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">ReplacementScanf</span>(angr.SimProcedure):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self, fmt, string_addr</span>):</span><br><span class="line">            exploit = claripy.BVS(<span class="string">&#x27;exploit&#x27;</span>, <span class="number">8</span> * <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> char <span class="keyword">in</span> exploit.chop(bits=<span class="number">8</span>):</span><br><span class="line">                self.state.add_constraints(char &gt;= <span class="string">&#x27;0&#x27;</span>, char &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            exploit_addr = string_addr</span><br><span class="line">            self.state.memory.store(exploit_addr, exploit)</span><br><span class="line">            </span><br><span class="line">            self.state.<span class="built_in">globals</span>[<span class="string">&#x27;solution&#x27;</span>] = exploit</span><br><span class="line">    </span><br><span class="line">    scanf_symbol = <span class="string">&#x27;__isoc99_scanf&#x27;</span></span><br><span class="line">    project.hook_symbol(scanf_symbol, ReplacementScanf())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (simulation.active <span class="keyword">or</span> simulation.unconstrained) <span class="keyword">and</span> (<span class="keyword">not</span> simulation.found):  </span><br><span class="line">        <span class="keyword">for</span> unconstrained_state <span class="keyword">in</span> simulation.unconstrained:</span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">should_move</span>(<span class="params">s</span>):</span><br><span class="line">                <span class="keyword">return</span> s <span class="keyword">is</span> unconstrained_state</span><br><span class="line">      </span><br><span class="line">            simulation.move(<span class="string">&#x27;unconstrained&#x27;</span>, <span class="string">&#x27;found&#x27;</span>, filter_func=should_move)</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">        simulation.step() </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        solution_state.add_constraints(solution_state.regs.eip == <span class="number">0x4D435250</span>) </span><br><span class="line"></span><br><span class="line">        solution = solution_state.se.<span class="built_in">eval</span>(solution_state.<span class="built_in">globals</span>[<span class="string">&#x27;solution&#x27;</span>],cast_to = <span class="built_in">bytes</span>) </span><br><span class="line">        <span class="built_in">print</span>(solution)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not find the solution&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">088</span> | angr.project | Address is already hooked, during hook(<span class="number">0</span>x4d5513a0, &lt;SimProcedure ReplacementScanf&gt;). Re-hooking.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">226</span> | angr.storage.memory_mixins.default_filler_mixin | The program is accessing memory or registers with an unspecified value. This could indicate unwanted behavior.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">226</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope with this by generating an unconstrained symbolic variable and continuing. You can resolve this by:</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">226</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">1</span>) setting a value to the initial state</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">226</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to make unknown regions hold null</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">226</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_&#123;MEMORY,REGISTERS&#125;, to suppress these messages.</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">226</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x4d4352e1 (__libc_csu_init+<span class="number">0</span>x1 in <span class="number">17</span>_angr_arbitrary_jump (<span class="number">0</span>x4d4352e1))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">229</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi with <span class="number">4</span> unconstrained bytes referenced from <span class="number">0</span>x4d4352e1 (__libc_csu_init+<span class="number">0</span>x1 in <span class="number">17</span>_angr_arbitrary_jump (<span class="number">0</span>x4d4352e1))</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">340</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">340</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">341</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">341</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">341</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">341</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">341</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">341</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">341</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">341</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">341</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">342</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">342</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">342</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">342</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">342</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">342</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">342</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">342</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">342</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">342</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">343</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">343</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">343</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">343</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">343</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">343</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">343</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">343</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">343</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">343</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">344</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">344</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">344</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">344</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">344</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">344</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">344</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">344</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">344</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">344</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">344</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">345</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">345</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">345</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">345</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">345</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">345</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">345</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">345</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">345</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">345</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">346</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">346</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">346</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">346</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">346</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">346</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">346</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">346</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">346</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">346</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">347</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">347</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">347</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">347</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">347</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">347</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">347</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">347</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">347</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">347</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">348</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">348</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">348</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">348</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">348</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">348</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">348</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">348</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">348</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">348</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">349</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">349</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">349</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">349</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">349</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">349</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">349</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">349</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">349</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">349</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">350</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">350</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">350</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">350</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">350</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">350</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">351</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">351</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">351</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">351</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">351</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">351</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">352</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">352</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">352</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">352</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">352</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">352</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">352</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">352</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">352</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">352</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">353</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">353</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">353</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">353</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">353</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">353</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">353</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">353</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">353</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">353</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">354</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">354</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">354</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">354</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">393</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">394</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">394</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">394</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">394</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">394</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">395</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">395</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">395</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">395</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">395</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">395</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">395</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">395</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">395</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">395</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">396</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">396</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">396</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">396</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">396</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">396</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">396</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">396</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">396</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">396</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">397</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">397</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">397</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">397</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">397</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">397</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">397</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">397</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">397</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">398</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">398</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">398</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">398</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">398</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">398</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">398</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">398</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">398</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">398</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">398</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">399</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">399</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">399</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">399</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">399</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">399</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">399</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">399</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">400</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">400</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">400</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">400</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">400</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">400</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">400</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">400</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">400</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">401</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">401</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">401</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">401</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">401</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">401</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">401</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">401</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">401</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">402</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">402</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">402</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">402</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">402</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">402</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">402</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">402</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">402</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">402</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">403</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">403</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">403</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">403</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">403</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">403</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">403</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">403</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">403</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">404</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">404</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">404</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">404</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">404</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">404</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">404</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">404</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">404</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">405</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">405</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">405</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">405</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">405</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">405</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">405</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">405</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">405</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">405</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">406</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">406</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">406</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">406</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">406</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">406</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">406</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">406</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">406</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">406</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">407</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">407</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">407</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">407</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">407</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">407</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">407</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">407</span> | claripy.ast.bv | BVV value is being coerced from a unicode string, encoding as utf-<span class="number">8</span></span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">38</span>,<span class="number">766</span> | angr.engines.successors | Exit state has over <span class="number">256</span> possible solutions. Likely unconstrained; skipping. &lt;BV32 Reverse(exploit_11_512[<span class="number">135</span>:<span class="number">104</span>])&gt;</span><br><span class="line"><span class="attribute">WARNING</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">39</span>,<span class="number">144</span> | angr.engines.successors | Exit state has over <span class="number">256</span> possible solutions. Likely unconstrained; skipping. &lt;BV32 Reverse(exploit_12_512[<span class="number">135</span>:<span class="number">104</span>])&gt;</span><br><span class="line"><span class="attribute">CRITICAL</span> | <span class="number">2022</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">13</span>:<span class="number">47</span>:<span class="number">39</span>,<span class="number">181</span> | angr.sim_state | The name state.se is deprecated; please use state.solver.</span><br><span class="line"><span class="attribute">b</span>&#x27;<span class="number">00000000000000000000000000000000000000000000000</span>PRCM00@<span class="number">0000000000</span>&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ReplacementScanf</span>(angr.SimProcedure):<span class="keyword">class</span> <span class="title class_">ReplacementScanf</span>(angr.SimProcedure):<span class="keyword">import</span> angr</span><br><span class="line"><span class="comment">#导入文件</span></span><br><span class="line">path = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#打开二进制文件</span></span><br><span class="line">project = angr.Project(path)</span><br><span class="line"><span class="comment">#接下来两种选择</span></span><br><span class="line"><span class="comment">#第一种</span></span><br><span class="line">initial_state = project.factory.entry_state()<span class="comment">#直接创建空白的执行上下文环境</span></span><br><span class="line"><span class="comment">#第二种</span></span><br><span class="line">start_address = xxxx</span><br><span class="line">initial_state = project.factory.blank_state(addr=start_address)</span><br><span class="line"><span class="comment">#创建模拟器,第二个参数是指定是否合并路径，路径多会爆炸</span></span><br><span class="line">simulation = project.factory.simgr(initial_state，veritesting = <span class="literal">True</span>)</span><br><span class="line"><span class="comment">#good和try有两种方法，第一个是找到call puts的地址不再说了</span></span><br><span class="line"><span class="comment">#第二种是进行函数定义</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_successful</span>(<span class="params">state</span>):</span><br><span class="line"><span class="comment">#从输出中提取</span></span><br><span class="line">    stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Good Job&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output) <span class="comment"># :boolean</span></span><br><span class="line"> <span class="keyword">def</span> <span class="title function_">should_abort</span>(<span class="params">state</span>): </span><br><span class="line">    stdout_output = state.posix.dumps(sys.stdout.fileno())</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Try again&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(stdout_output)  <span class="comment"># :boolean</span></span><br><span class="line"><span class="comment">#执行搜索路径(里面是要到达的地址)</span></span><br><span class="line">simulation.explore(find=print_good_address，avoid=print_try_avoid)</span><br><span class="line"><span class="comment">#打印出结果,搜索结果的集合，simulation.found是python的list集合</span></span><br><span class="line"><span class="keyword">if</span> simulation.found:</span><br><span class="line">    solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">    <span class="comment">#获取标准输入</span></span><br><span class="line">    <span class="built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))</span><br><span class="line">    </span><br><span class="line"><span class="comment">#寄存器类，比如输入了好几个参数，我们能从寄存器下手找到输入源</span></span><br><span class="line"><span class="comment">#创建求解变量</span></span><br><span class="line">password0 = claripy.BVS(<span class="string">&#x27;password0&#x27;</span>, password0_size_in_bits)</span><br><span class="line"><span class="comment">#告诉符号执行，执行的寄存器是什么</span></span><br><span class="line">initial_state.regs.eax = password0 </span><br><span class="line"><span class="comment">#在if中进行求解符号变量</span></span><br><span class="line">solution0 = solution_state.se.<span class="built_in">eval</span>(password0)</span><br><span class="line"><span class="comment">#栈类，如果结果保存在栈中</span></span><br><span class="line"><span class="comment">#将创建的变量从stack中取出来</span></span><br><span class="line">initial_state.stack_push(password0)</span><br><span class="line"><span class="comment">#变量存在bss段，符号化内存</span></span><br><span class="line"><span class="comment">#第一个参数是变量的地址</span></span><br><span class="line">initial_state.memory.store(password0_address, password0)</span><br><span class="line"><span class="comment">#数字字节顺序，可以表示为：project.arch.memory_endness</span></span><br><span class="line">initial_state.memory.store(地址,数据,endness = 数据字节顺序) =&gt; 设置初始化内存数据</span><br><span class="line"><span class="comment">#有关文件就是第七题</span></span><br><span class="line"><span class="comment">#多分支比较，建立比较机制</span></span><br><span class="line"><span class="comment">#先在if里进行约束</span></span><br><span class="line">constrained_parameter_address = <span class="number">0x804A050</span>  <span class="comment">#  计算约束的内存位置</span></span><br><span class="line">constrained_parameter_size_bytes = <span class="number">0x10</span>    <span class="comment">#  计算约束的内存大小</span></span><br><span class="line">constrained_parameter_bitvector = solution_state.memory.load(  <span class="comment">#  加载内存</span></span><br><span class="line">      constrained_parameter_address,</span><br><span class="line">      constrained_parameter_size_bytes</span><br><span class="line">    )</span><br><span class="line"><span class="comment">#再用下述的进行字符串比较</span></span><br><span class="line">solution_state.memory.load(内存地址,内存大小) =&gt; 加载内存</span><br><span class="line">solution_state.add_constraints(约束条件) =&gt; 添加约束条件</span><br><span class="line"><span class="comment">#hook的写法</span></span><br><span class="line"><span class="comment">#连个参数分别是，hook的地址，执行后往后跳过几个字节</span></span><br><span class="line"><span class="meta">@project.hook(<span class="params">check_equals_called_address, length=instruction_to_skip_length</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">skip_check_equals_</span>(<span class="params">state</span>):</span><br><span class="line">    加载内存</span><br><span class="line">    claripy.If(条件,条件为<span class="literal">True</span>时的返回值,条件为<span class="literal">False</span>时的返回值) =&gt; 创建条件判断</span><br><span class="line">    claripy.BVV(值,值大小) =&gt; 创建一个数值</span><br><span class="line"><span class="comment">#另一种常见hook方法，常见于想hook的函数太多，无法定位情况</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ReplacementCheckEquals</span>(angr.SimProcedure):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self, Hook的函数参数列表</span>):</span><br><span class="line">        加载内存</span><br><span class="line">        <span class="keyword">return</span> 用claripy.If对比来返回值<span class="comment"># 如果是void函数可以省略</span></span><br><span class="line"><span class="comment">#hook的函数名是真实函数名，第二个参数是ReplacementCheckEquals（）</span></span><br><span class="line">project.hook_symbol(要Hook的函数名,SimProcedure类实例)</span><br><span class="line"><span class="comment">#scanf太多，hookscanf</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ReplacementScanf</span>(angr.SimProcedure):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self, format_string, scanf0_address, scanf1_address </span>)：</span><br><span class="line">    <span class="comment">#创建求解变量</span></span><br><span class="line">        scanf0 = claripy.BVS(<span class="string">&#x27;scanf0&#x27;</span>, <span class="number">4</span> * <span class="number">8</span>)</span><br><span class="line">    <span class="comment">#初始化内存</span></span><br><span class="line">        self.state.memory.store(scanf0_address, scanf0, endness=project.arch.memory_endness)</span><br><span class="line">    <span class="comment">#保存当前状态</span></span><br><span class="line">        self.state.<span class="built_in">globals</span>[<span class="string">&#x27;solution0&#x27;</span>] = scanf0</span><br><span class="line">project.hook_symbol(要Hook的函数名,SimProcedure类实例)</span><br><span class="line"><span class="comment">#用angr自带hook程序</span></span><br><span class="line"><span class="comment">#用在simgr后</span></span><br><span class="line">project.hook(<span class="number">0x804ed40</span>, angr.SIM_PROCEDURES[<span class="string">&#x27;libc&#x27;</span>][<span class="string">&#x27;printf&#x27;</span>]())</span><br><span class="line">angr.SIM_PROCEDURES[ 系统库名 ] [ 系统函数名 ] () =&gt; 获取Angr 内部实现的系统函数</span><br><span class="line"><span class="comment">#遇到函数是动态链接的</span></span><br><span class="line"><span class="comment">#现设基地址</span></span><br><span class="line">base = <span class="number">0x40000000</span>（随便）</span><br><span class="line"><span class="comment">#我们的path是指那个so文件</span></span><br><span class="line">project = angr.Project(path_to_binary, load_options=&#123;</span><br><span class="line">    <span class="string">&#x27;main_opts&#x27;</span> : &#123;</span><br><span class="line">      <span class="string">&#x27;custom_base_addr&#x27;</span> : base</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">initial_state = project.factory.call_state(validate_function_address, buffer_pointer,claripy.BVV(<span class="number">8</span>, <span class="number">32</span>))  <span class="comment">#  调用validate_function,因为函数声明validata_function(buffer_point,buffer_length) ,所以我们构造出调用validata_function(0x3000000,0x8) </span></span><br><span class="line"><span class="comment">#对于溢出而覆盖的题</span></span><br><span class="line"><span class="comment">#下面是约束的写法</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> scanf1.chop(bits=<span class="number">8</span>):</span><br><span class="line">        self.state.add_constraints(char &gt;= <span class="string">&#x27;0&#x27;</span>, char &lt;= <span class="string">&#x27;z&#x27;</span>)  <span class="comment">#  对input_buffer 的输入约束</span></span><br><span class="line"><span class="comment">#约束完，存入内存，获取想要的puts</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_puts</span>(<span class="params">state</span>):</span><br><span class="line">    puts_parameter = state.memory.load(state.regs.esp + <span class="number">4</span>, <span class="number">4</span>, endness=project.arch.memory_endness)  </span><br><span class="line"><span class="comment">#检查这个参数是否为符号化对象</span></span><br><span class="line"><span class="keyword">if</span> state.se.symbolic(puts_parameter):</span><br><span class="line"><span class="comment">#复制执行状态上下文进行约束求解,不影响原理的执行上下文</span></span><br><span class="line">    copied_state = state.copy()</span><br><span class="line">    <span class="keyword">if</span> copied_state.satisfiable():  <span class="comment">#  判断添加了上面这个约束是否有解</span></span><br><span class="line">        state.add_constraints(puts_parameter == good_job_string_address)  <span class="comment">#  如果有解的话就保存到我们执行的那个状态对象</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> </span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="comment">#序列化变量内容为字符串</span></span><br><span class="line">solution_state.se.<span class="built_in">eval</span>(求解变量,cast_to=<span class="built_in">bytes</span>)</span><br><span class="line"><span class="comment">#合并多个条件计算是否存在满足约束的解(注意两个或多个条件之间是And 合并判断,不是Or )</span></span><br><span class="line">state.satisfiable(extra_constraints=(条件<span class="number">1</span>,条件<span class="number">2</span>))</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/02/28/LC-3/" rel="prev" title="LC-3">
      <i class="fa fa-chevron-left"></i> LC-3
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/03/21/classic/" rel="next" title="classicproblem">
      classicproblem <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Angr"><span class="nav-text">Angr</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#00-angr-find"><span class="nav-text">00_angr_find</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#if-name-x3D-x3D-%E2%80%98main%E2%80%98"><span class="nav-text">if name &#x3D;&#x3D; ‘main‘:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#factory"><span class="nav-text">factory</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#01-angr-avoid"><span class="nav-text">01_angr_avoid</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#02-angr-find-condition"><span class="nav-text">02_angr_find_condition</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#03-angr-symbolic-registers"><span class="nav-text">03_angr_symbolic_registers</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#eval"><span class="nav-text">eval</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#formamt"><span class="nav-text">formamt</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#04-angr-symbolic-stack"><span class="nav-text">04_angr_symbolic_stack</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#05-angr-symbolic-memory"><span class="nav-text">05_angr_symbolic_memory</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#06-angr-symbolic-dynamic-memory"><span class="nav-text">06_angr_symbolic_dynamic_memory</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#07-angr-symbolic-file"><span class="nav-text">07_angr_symbolic_file</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#08-angr-constraints"><span class="nav-text">08_angr_constraints</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#09-angr-hooks"><span class="nav-text">09_angr_hooks</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-angr-simprocedures"><span class="nav-text">10_angr_simprocedures</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-angr-sim-scanf"><span class="nav-text">11_angr_sim_scanf</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-angr-veritesting"><span class="nav-text">12_angr_veritesting</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-angr-static-binary"><span class="nav-text">13_angr_static_binary</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#14-angr-shared-library"><span class="nav-text">14_angr_shared_library</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#15-angr-arbitrary-read"><span class="nav-text">15_angr_arbitrary_read</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-angr-arbitrary-write"><span class="nav-text">16_angr_arbitrary_write</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#17-angr-arbitrary-jump"><span class="nav-text">17_angr_arbitrary_jump</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="nav-text">总结：</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="bj777"
      src="/images/bitbug_favicon.ico">
  <p class="site-author-name" itemprop="name">bj777</p>
  <div class="site-description" itemprop="description">一位逆向菜狗</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">34</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/jonathanbest7" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jonathanbest7" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/506611735@qq.com" title="E-Mail → 506611735@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/bang-ji-1" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;bang-ji-1" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>知乎</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">bj777</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  
		<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
		<script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
		<script type="text/javascript" src="/js/src/fireworks.js"></script>
  
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":300,"height":600},"mobile":{"show":false},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
